const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ccip-DQzBFxi6.js","assets/localBatchGatewayRequest-C9fJH1PX.js","assets/index-CrjlC3mJ.js","assets/parseSignature-BnYmAkus.js","assets/secp256k1-D7k8_PHw.js","assets/hashTypedData-CRAOXGbX.js","assets/embedded-wallet-BxjSnX0n.js","assets/index-DjryHvFF.js","assets/index-DNpy9kj1.js","assets/if-defined-DFTrRwBX.js","assets/ref-CPYqc3lj.js","assets/index-DbrfZRCb.js","assets/HelpersUtil-DY7uv9jK.js","assets/ConstantsUtil-COJBkkkj.js","assets/index-WG6BssrH.js","assets/index-C09oVk7v.js","assets/index-C8c87VY9.js","assets/index-BuFKZRQm.js","assets/index-IYxBeqlz.js","assets/NavigationUtil-DmfK5sOV.js","assets/email-Rdhs9bHd.js","assets/index-CgI1sFp8.js","assets/index-BpfmglRo.js","assets/socials-kOj-qu62.js","assets/index-BAZyDSWK.js","assets/index-BZobddYX.js","assets/index-DuSKB2Te.js","assets/index-ikdbqXbd.js","assets/index-d4avts7-.js","assets/swaps-ydseLVsp.js","assets/index-CFXSG-wk.js","assets/index-ChNdxAC4.js","assets/SwapController-CIhaiPM6.js","assets/index-DcSZ8kP8.js","assets/send-DXxRzXfJ.js","assets/index-CqK8FAfc.js","assets/index-Cefl4KWU.js","assets/index-eGkge2DK.js","assets/index-Getrv3QF.js","assets/receive-BTJfq6vp.js","assets/onramp-GYjv5BN7.js","assets/index-sVKMmoHK.js","assets/index-DqV-cWC5.js","assets/index-DygunZbn.js","assets/pay-with-exchange-TZ_iRJtk.js","assets/ExchangeController-BGSoD9aZ.js","assets/transactions-BD7WJ1x8.js","assets/index-YF2areLv.js","assets/index-DIAf_Gi5.js","assets/index-C6-wrYey.js","assets/index-CGrFM6Tj.js","assets/index-darZNVYe.js","assets/data-capture-B2IXCRVc.js","assets/features-3CHfQQze.js","assets/index-xh0ZPyKN.js","assets/index-JrYhG9G9.js","assets/w3m-modal-BMmZVRKH.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();const II=Symbol(),Am=Object.getPrototypeOf,dp=new WeakMap,SI=t=>t&&(dp.has(t)?dp.get(t):Am(t)===Object.prototype||Am(t)===Array.prototype),xI=t=>SI(t)&&t[II]||null,Im=(t,e=!0)=>{dp.set(t,e)},Qu={},W0=t=>typeof t=="object"&&t!==null,NI=t=>W0(t)&&!vl.has(t)&&(Array.isArray(t)||!(Symbol.iterator in t))&&!(t instanceof WeakMap)&&!(t instanceof WeakSet)&&!(t instanceof Error)&&!(t instanceof Number)&&!(t instanceof Date)&&!(t instanceof String)&&!(t instanceof RegExp)&&!(t instanceof ArrayBuffer)&&!(t instanceof Promise),oE=(t,e)=>{const n=fp.get(t);if((n==null?void 0:n[0])===e)return n[1];const r=Array.isArray(t)?[]:Object.create(Object.getPrototypeOf(t));return Im(r,!0),fp.set(t,[e,r]),Reflect.ownKeys(t).forEach(s=>{if(Object.getOwnPropertyDescriptor(r,s))return;const i=Reflect.get(t,s),{enumerable:o}=Reflect.getOwnPropertyDescriptor(t,s),a={value:i,enumerable:o,configurable:!0};if(vl.has(i))Im(i,!1);else if(vi.has(i)){const[c,l]=vi.get(i);a.value=oE(c,l())}Object.defineProperty(r,s,a)}),Object.preventExtensions(r)},TI=(t,e,n,r)=>({deleteProperty(s,i){const o=Reflect.get(s,i);n(i);const a=Reflect.deleteProperty(s,i);return a&&r(["delete",[i],o]),a},set(s,i,o,a){const c=!t()&&Reflect.has(s,i),l=Reflect.get(s,i,a);if(c&&(Sm(l,o)||Ac.has(o)&&Sm(l,Ac.get(o))))return!0;n(i),W0(o)&&(o=xI(o)||o);const u=!vi.has(o)&&RI(o)?Qe(o):o;return e(i,u),Reflect.set(s,i,u,a),r(["set",[i],o,l]),!0}}),vi=new WeakMap,vl=new WeakSet,fp=new WeakMap,Uu=[1],Ac=new WeakMap;let Sm=Object.is,OI=(t,e)=>new Proxy(t,e),RI=NI,PI=oE,kI=TI;function Qe(t={}){if(!W0(t))throw new Error("object required");const e=Ac.get(t);if(e)return e;let n=Uu[0];const r=new Set,s=(m,E=++Uu[0])=>{n!==E&&(i=n=E,r.forEach(A=>A(m,E)))};let i=n;const o=(m=Uu[0])=>(i!==m&&(i=m,c.forEach(([E])=>{const A=E[1](m);A>n&&(n=A)})),n),a=m=>(E,A)=>{const b=[...E];b[1]=[m,...b[1]],s(b,A)},c=new Map,l=(m,E)=>{const A=!vl.has(E)&&vi.get(E);if(A){if((Qu?"production":void 0)!=="production"&&c.has(m))throw new Error("prop listener already exists");if(r.size){const b=A[2](a(m));c.set(m,[A,b])}else c.set(m,[A])}},u=m=>{var E;const A=c.get(m);A&&(c.delete(m),(E=A[1])==null||E.call(A))},d=m=>(r.add(m),r.size===1&&c.forEach(([A,b],_)=>{if((Qu?"production":void 0)!=="production"&&b)throw new Error("remove already exists");const C=A[2](a(_));c.set(_,[A,C])}),()=>{r.delete(m),r.size===0&&c.forEach(([A,b],_)=>{b&&(b(),c.set(_,[A]))})});let f=!0;const h=kI(()=>f,l,u,s),p=OI(t,h);Ac.set(t,p);const g=[t,o,d];return vi.set(p,g),Reflect.ownKeys(t).forEach(m=>{const E=Object.getOwnPropertyDescriptor(t,m);"value"in E&&E.writable&&(p[m]=t[m])}),f=!1,p}function Ft(t,e,n){const r=vi.get(t);(Qu?"production":void 0)!=="production"&&!r&&console.warn("Please use proxy object");let s;const i=[],o=r[2];let a=!1;const l=o(u=>{i.push(u),s||(s=Promise.resolve().then(()=>{s=void 0,a&&e(i.splice(0))}))});return a=!0,()=>{a=!1,l()}}function Ic(t){const e=vi.get(t);(Qu?"production":void 0)!=="production"&&!e&&console.warn("Please use proxy object");const[n,r]=e;return PI(n,r())}function Sc(t){return vl.add(t),t}function DI(){return{proxyStateMap:vi,refSet:vl,snapCache:fp,versionHolder:Uu,proxyCache:Ac}}function Dt(t,e,n,r){let s=t[e];return Ft(t,()=>{const i=t[e];Object.is(s,i)||n(s=i)})}const{proxyStateMap:$I,snapCache:UI}=DI(),Kl=t=>$I.has(t);function BI(t){const e=[];let n=0;const r=new Map,s=new WeakMap,i=()=>{const l=UI.get(a),u=l==null?void 0:l[1];if(u&&!s.has(u)){const d=new Map(r);s.set(u,d)}},o=l=>s.get(l)||r,a={data:e,index:n,epoch:0,get size(){return Kl(this)||i(),o(this).size},get(l){const d=o(this).get(l);if(d===void 0){this.epoch;return}return this.data[d]},has(l){const u=o(this);return this.epoch,u.has(l)},set(l,u){if(!Kl(this))throw new Error("Cannot perform mutations on a snapshot");const d=r.get(l);return d===void 0?(r.set(l,this.index),this.data[this.index++]=u):this.data[d]=u,this.epoch++,this},delete(l){if(!Kl(this))throw new Error("Cannot perform mutations on a snapshot");const u=r.get(l);return u===void 0?!1:(delete this.data[u],r.delete(l),this.epoch++,!0)},clear(){if(!Kl(this))throw new Error("Cannot perform mutations on a snapshot");this.data.length=0,this.index=0,this.epoch++,r.clear()},forEach(l){this.epoch,o(this).forEach((d,f)=>{l(this.data[d],f,this)})},*entries(){this.epoch;const l=o(this);for(const[u,d]of l)yield[u,this.data[d]]},*keys(){this.epoch;const l=o(this);for(const u of l.keys())yield u},*values(){this.epoch;const l=o(this);for(const u of l.values())yield this.data[u]},[Symbol.iterator](){return this.entries()},get[Symbol.toStringTag](){return"Map"},toJSON(){return new Map(this.entries())}},c=Qe(a);return Object.defineProperties(c,{size:{enumerable:!1},index:{enumerable:!1},epoch:{enumerable:!1},data:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(c),c}const aE={isLowerCaseMatch(t,e){return(t==null?void 0:t.toLowerCase())===(e==null?void 0:e.toLowerCase())}};var Mr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Hd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function LI(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var xm={};const B={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",BASE_ACCOUNT:"baseAccount",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122",TON:"ton"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos",sui:"Sui",stacks:"Stacks",ton:"TON"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",TON:"ton"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],SOLANA_SPL_TOKEN_ADDRESSES:{SOL:"So11111111111111111111111111111111111111112"},HTTP_STATUS_CODES:{SERVER_ERROR:500,TOO_MANY_REQUESTS:429,SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(typeof process<"u"&&typeof xm<"u"?xm.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",REMOTE_FEATURES_ALERTS:{MULTI_WALLET_NOT_ENABLED:{DEFAULT:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com."},CONNECTIONS_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnections hook."},CONNECTION_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnection hook."}},HEADLESS_NOT_ENABLED:{DEFAULT:{displayMessage:"",debugMessage:"Headless support is not enabled. Please enable it with the features.headless option in the AppKit configuration and make sure your current plan supports it."}}},IS_DEVELOPMENT:typeof process<"u"&&!1,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://localhost:*","http://127.0.0.1:*","https://127.0.0.1:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"],METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",OKX_CONNECTOR_NAME:"OKX Wallet",BINANCE_CONNECTOR_NAME:"Binance Wallet",EIP155:"eip155",ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"AUTH"},xc={caipNetworkIdToNumber(t){return t?Number(t.split(":")[1]):void 0},parseEvmChainId(t){return typeof t=="string"?this.caipNetworkIdToNumber(t):t},getNetworksByNamespace(t,e){return(t==null?void 0:t.filter(n=>n.chainNamespace===e))||[]},getFirstNetworkByNamespace(t,e){return this.getNetworksByNamespace(t,e)[0]},getNetworkNameByCaipNetworkId(t,e){var s;if(!e)return;const n=t.find(i=>i.caipNetworkId===e);if(n)return n.name;const[r]=e.split(":");return((s=B.CHAIN_NAME_MAP)==null?void 0:s[r])||void 0}},cE=["eip155","solana","polkadot","bip122","cosmos","sui","stacks"];var MI=20,FI=1,lo=1e6,Nm=1e6,jI=-7,HI=21,WI=!1,Cl="[big.js] ",Io=Cl+"Invalid ",Wd=Io+"decimal places",zI=Io+"rounding mode",lE=Cl+"Division by zero",Ve={},qr=void 0,qI=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function uE(){function t(e){var n=this;if(!(n instanceof t))return e===qr?uE():new t(e);if(e instanceof t)n.s=e.s,n.e=e.e,n.c=e.c.slice();else{if(typeof e!="string"){if(t.strict===!0&&typeof e!="bigint")throw TypeError(Io+"value");e=e===0&&1/e<0?"-0":String(e)}VI(n,e)}n.constructor=t}return t.prototype=Ve,t.DP=MI,t.RM=FI,t.NE=jI,t.PE=HI,t.strict=WI,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}function VI(t,e){var n,r,s;if(!qI.test(e))throw Error(Io+"number");for(t.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),s=e.length,r=0;r<s&&e.charAt(r)=="0";)++r;if(r==s)t.c=[t.e=0];else{for(;s>0&&e.charAt(--s)=="0";);for(t.e=n-r-1,t.c=[],n=0;r<=s;)t.c[n++]=+e.charAt(r++)}return t}function So(t,e,n,r){var s=t.c;if(n===qr&&(n=t.constructor.RM),n!==0&&n!==1&&n!==2&&n!==3)throw Error(zI);if(e<1)r=n===3&&(r||!!s[0])||e===0&&(n===1&&s[0]>=5||n===2&&(s[0]>5||s[0]===5&&(r||s[1]!==qr))),s.length=1,r?(t.e=t.e-e+1,s[0]=1):s[0]=t.e=0;else if(e<s.length){if(r=n===1&&s[e]>=5||n===2&&(s[e]>5||s[e]===5&&(r||s[e+1]!==qr||s[e-1]&1))||n===3&&(r||!!s[0]),s.length=e,r){for(;++s[--e]>9;)if(s[e]=0,e===0){++t.e,s.unshift(1);break}}for(e=s.length;!s[--e];)s.pop()}return t}function xo(t,e,n){var r=t.e,s=t.c.join(""),i=s.length;if(e)s=s.charAt(0)+(i>1?"."+s.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)s="0"+s;s="0."+s}else if(r>0)if(++r>i)for(r-=i;r--;)s+="0";else r<i&&(s=s.slice(0,r)+"."+s.slice(r));else i>1&&(s=s.charAt(0)+"."+s.slice(1));return t.s<0&&n?"-"+s:s}Ve.abs=function(){var t=new this.constructor(this);return t.s=1,t};Ve.cmp=function(t){var e,n=this,r=n.c,s=(t=new n.constructor(t)).c,i=n.s,o=t.s,a=n.e,c=t.e;if(!r[0]||!s[0])return r[0]?i:s[0]?-o:0;if(i!=o)return i;if(e=i<0,a!=c)return a>c^e?1:-1;for(o=(a=r.length)<(c=s.length)?a:c,i=-1;++i<o;)if(r[i]!=s[i])return r[i]>s[i]^e?1:-1;return a==c?0:a>c^e?1:-1};Ve.div=function(t){var e=this,n=e.constructor,r=e.c,s=(t=new n(t)).c,i=e.s==t.s?1:-1,o=n.DP;if(o!==~~o||o<0||o>lo)throw Error(Wd);if(!s[0])throw Error(lE);if(!r[0])return t.s=i,t.c=[t.e=0],t;var a,c,l,u,d,f=s.slice(),h=a=s.length,p=r.length,g=r.slice(0,a),m=g.length,E=t,A=E.c=[],b=0,_=o+(E.e=e.e-t.e)+1;for(E.s=i,i=_<0?0:_,f.unshift(0);m++<a;)g.push(0);do{for(l=0;l<10;l++){if(a!=(m=g.length))u=a>m?1:-1;else for(d=-1,u=0;++d<a;)if(s[d]!=g[d]){u=s[d]>g[d]?1:-1;break}if(u<0){for(c=m==a?s:f;m;){if(g[--m]<c[m]){for(d=m;d&&!g[--d];)g[d]=9;--g[d],g[m]+=10}g[m]-=c[m]}for(;!g[0];)g.shift()}else break}A[b++]=u?l:++l,g[0]&&u?g[m]=r[h]||0:g=[r[h]]}while((h++<p||g[0]!==qr)&&i--);return!A[0]&&b!=1&&(A.shift(),E.e--,_--),b>_&&So(E,_,n.RM,g[0]!==qr),E};Ve.eq=function(t){return this.cmp(t)===0};Ve.gt=function(t){return this.cmp(t)>0};Ve.gte=function(t){return this.cmp(t)>-1};Ve.lt=function(t){return this.cmp(t)<0};Ve.lte=function(t){return this.cmp(t)<1};Ve.minus=Ve.sub=function(t){var e,n,r,s,i=this,o=i.constructor,a=i.s,c=(t=new o(t)).s;if(a!=c)return t.s=-c,i.plus(t);var l=i.c.slice(),u=i.e,d=t.c,f=t.e;if(!l[0]||!d[0])return d[0]?t.s=-c:l[0]?t=new o(i):t.s=1,t;if(a=u-f){for((s=a<0)?(a=-a,r=l):(f=u,r=d),r.reverse(),c=a;c--;)r.push(0);r.reverse()}else for(n=((s=l.length<d.length)?l:d).length,a=c=0;c<n;c++)if(l[c]!=d[c]){s=l[c]<d[c];break}if(s&&(r=l,l=d,d=r,t.s=-t.s),(c=(n=d.length)-(e=l.length))>0)for(;c--;)l[e++]=0;for(c=e;n>a;){if(l[--n]<d[n]){for(e=n;e&&!l[--e];)l[e]=9;--l[e],l[n]+=10}l[n]-=d[n]}for(;l[--c]===0;)l.pop();for(;l[0]===0;)l.shift(),--f;return l[0]||(t.s=1,l=[f=0]),t.c=l,t.e=f,t};Ve.mod=function(t){var e,n=this,r=n.constructor,s=n.s,i=(t=new r(t)).s;if(!t.c[0])throw Error(lE);return n.s=t.s=1,e=t.cmp(n)==1,n.s=s,t.s=i,e?new r(n):(s=r.DP,i=r.RM,r.DP=r.RM=0,n=n.div(t),r.DP=s,r.RM=i,this.minus(n.times(t)))};Ve.neg=function(){var t=new this.constructor(this);return t.s=-t.s,t};Ve.plus=Ve.add=function(t){var e,n,r,s=this,i=s.constructor;if(t=new i(t),s.s!=t.s)return t.s=-t.s,s.minus(t);var o=s.e,a=s.c,c=t.e,l=t.c;if(!a[0]||!l[0])return l[0]||(a[0]?t=new i(s):t.s=s.s),t;if(a=a.slice(),e=o-c){for(e>0?(c=o,r=l):(e=-e,r=a),r.reverse();e--;)r.push(0);r.reverse()}for(a.length-l.length<0&&(r=l,l=a,a=r),e=l.length,n=0;e;a[e]%=10)n=(a[--e]=a[e]+l[e]+n)/10|0;for(n&&(a.unshift(n),++c),e=a.length;a[--e]===0;)a.pop();return t.c=a,t.e=c,t};Ve.pow=function(t){var e=this,n=new e.constructor("1"),r=n,s=t<0;if(t!==~~t||t<-Nm||t>Nm)throw Error(Io+"exponent");for(s&&(t=-t);t&1&&(r=r.times(e)),t>>=1,!!t;)e=e.times(e);return s?n.div(r):r};Ve.prec=function(t,e){if(t!==~~t||t<1||t>lo)throw Error(Io+"precision");return So(new this.constructor(this),t,e)};Ve.round=function(t,e){if(t===qr)t=0;else if(t!==~~t||t<-lo||t>lo)throw Error(Wd);return So(new this.constructor(this),t+this.e+1,e)};Ve.sqrt=function(){var t,e,n,r=this,s=r.constructor,i=r.s,o=r.e,a=new s("0.5");if(!r.c[0])return new s(r);if(i<0)throw Error(Cl+"No square root");i=Math.sqrt(+xo(r,!0,!0)),i===0||i===1/0?(e=r.c.join(""),e.length+o&1||(e+="0"),i=Math.sqrt(e),o=((o+1)/2|0)-(o<0||o&1),t=new s((i==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+o)):t=new s(i+""),o=t.e+(s.DP+=4);do n=t,t=a.times(n.plus(r.div(n)));while(n.c.slice(0,o).join("")!==t.c.slice(0,o).join(""));return So(t,(s.DP-=4)+t.e+1,s.RM)};Ve.times=Ve.mul=function(t){var e,n=this,r=n.constructor,s=n.c,i=(t=new r(t)).c,o=s.length,a=i.length,c=n.e,l=t.e;if(t.s=n.s==t.s?1:-1,!s[0]||!i[0])return t.c=[t.e=0],t;for(t.e=c+l,o<a&&(e=s,s=i,i=e,l=o,o=a,a=l),e=new Array(l=o+a);l--;)e[l]=0;for(c=a;c--;){for(a=0,l=o+c;l>c;)a=e[l]+i[c]*s[l-c-1]+a,e[l--]=a%10,a=a/10|0;e[l]=a}for(a?++t.e:e.shift(),c=e.length;!e[--c];)e.pop();return t.c=e,t};Ve.toExponential=function(t,e){var n=this,r=n.c[0];if(t!==qr){if(t!==~~t||t<0||t>lo)throw Error(Wd);for(n=So(new n.constructor(n),++t,e);n.c.length<t;)n.c.push(0)}return xo(n,!0,!!r)};Ve.toFixed=function(t,e){var n=this,r=n.c[0];if(t!==qr){if(t!==~~t||t<0||t>lo)throw Error(Wd);for(n=So(new n.constructor(n),t+n.e+1,e),t=t+n.e+1;n.c.length<t;)n.c.push(0)}return xo(n,!1,!!r)};Ve[Symbol.for("nodejs.util.inspect.custom")]=Ve.toJSON=Ve.toString=function(){var t=this,e=t.constructor;return xo(t,t.e<=e.NE||t.e>=e.PE,!!t.c[0])};Ve.toNumber=function(){var t=+xo(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(t.toString()))throw Error(Cl+"Imprecise conversion");return t};Ve.toPrecision=function(t,e){var n=this,r=n.constructor,s=n.c[0];if(t!==qr){if(t!==~~t||t<1||t>lo)throw Error(Io+"precision");for(n=So(new r(n),t,e);n.c.length<t;)n.c.push(0)}return xo(n,t<=n.e||n.e<=r.NE||n.e>=r.PE,!!s)};Ve.valueOf=function(){var t=this,e=t.constructor;if(e.strict===!0)throw Error(Cl+"valueOf disallowed");return xo(t,t.e<=e.NE||t.e>=e.PE,!0)};var Ls=uE();const KI={bigNumber(t){return t?new Ls(t):new Ls(0)},multiply(t,e){if(t===void 0||e===void 0)return new Ls(0);const n=new Ls(t),r=new Ls(e);return n.times(r)},toFixed(t,e=2){return t===void 0||t===""?new Ls(0).toFixed(e):new Ls(t).toFixed(e)},formatNumberToLocalString(t,e=2){return t===void 0||t===""?"0.00":typeof t=="number"?t.toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"}):parseFloat(t).toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"})},parseLocalStringToNumber(t){if(t===void 0||t==="")return 0;const e=t.replace(/,/gu,"");return new Ls(e).toNumber()}},GI=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],YI=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],ZI=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],JI={getERC20Abi:t=>B.USDT_CONTRACT_ADDRESSES.includes(t)?ZI:GI,getSwapAbi:()=>YI},sn={ConnectorExplorerIds:{[B.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[B.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[B.CONNECTOR_ID.BASE_ACCOUNT]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[B.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[B.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[B.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[B.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[B.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[B.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[B.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[B.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[B.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[B.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[B.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[B.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[B.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[B.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13",[B.OKX_CONNECTOR_NAME]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[B.BINANCE_CONNECTOR_NAME]:"2fafea35bb471d22889ccb49c08d99dd0a18a37982602c33f696a5723934ba25"},ConnectorImageIds:{[B.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[B.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[B.CONNECTOR_ID.BASE_ACCOUNT]:"bba2c8be-7fd1-463e-42b1-796ecb0ad200",[B.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[B.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[B.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[B.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[B.CONNECTOR_ID.INJECTED]:"Browser Wallet",[B.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[B.CONNECTOR_ID.COINBASE]:"Coinbase",[B.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[B.CONNECTOR_ID.BASE_ACCOUNT]:"Base Account",[B.CONNECTOR_ID.LEDGER]:"Ledger",[B.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[B.CONNECTOR_ID.INJECTED]:"INJECTED",[B.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[B.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[B.CONNECTOR_ID.AUTH]:"AUTH"}},It={validateCaipAddress(t){var e;if(((e=t.split(":"))==null?void 0:e.length)!==3)throw new Error("Invalid CAIP Address");return t},parseCaipAddress(t){const e=t.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${t}`);const[n,r,s]=e;if(!n||!r||!s)throw new Error(`Invalid CAIP-10 address: ${t}`);return{chainNamespace:n,chainId:r,address:s}},parseCaipNetworkId(t){const e=t.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${t}`);const[n,r]=e;if(!n||!r)throw new Error(`Invalid CAIP-2 network id: ${t}`);return{chainNamespace:n,chainId:r}}},br={RPC_ERROR_CODE:{USER_REJECTED_REQUEST:4001,USER_REJECTED_METHODS:5002,USER_REJECTED:5e3},PROVIDER_RPC_ERROR_NAME:{PROVIDER_RPC:"ProviderRpcError",USER_REJECTED_REQUEST:"UserRejectedRequestError"},isRpcProviderError(t){try{if(typeof t=="object"&&t!==null){const e=t,n=typeof e.message=="string",r=typeof e.code=="number";return n&&r}return!1}catch{return!1}},isUserRejectedMessage(t){return t.toLowerCase().includes("user rejected")||t.toLowerCase().includes("user cancelled")||t.toLowerCase().includes("user canceled")},isUserRejectedRequestError(t){if(br.isRpcProviderError(t)){const e=t.code===br.RPC_ERROR_CODE.USER_REJECTED_REQUEST,n=t.code===br.RPC_ERROR_CODE.USER_REJECTED_METHODS;return e||n||br.isUserRejectedMessage(t.message)}return t instanceof Error?br.isUserRejectedMessage(t.message):!1}};let XI=class extends Error{constructor(e,n){super(n.message,{cause:e}),this.name=br.PROVIDER_RPC_ERROR_NAME.PROVIDER_RPC,this.code=n.code}},Zo=class extends XI{constructor(e){super(e,{code:br.RPC_ERROR_CODE.USER_REJECTED_REQUEST,message:"User rejected the request"}),this.name=br.PROVIDER_RPC_ERROR_NAME.USER_REJECTED_REQUEST}};const fe={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",RECENT_WALLET:"@appkit/recent_wallet",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types",CONNECTIONS:"@appkit/connections",DISCONNECTED_CONNECTOR_IDS:"@appkit/disconnected_connector_ids",HISTORY_TRANSACTIONS_CACHE:"@appkit/history_transactions_cache",TOKEN_PRICE_CACHE:"@appkit/token_price_cache",RECENT_EMAILS:"@appkit/recent_emails",LATEST_APPKIT_VERSION:"@appkit/latest_version",TON_WALLETS_CACHE:"@appkit/ton_wallets_cache"};function Df(t){if(!t)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${t}:connected_connector_id`}const de={setItem(t,e){ac()&&e!==void 0&&localStorage.setItem(t,e)},getItem(t){if(ac())return localStorage.getItem(t)||void 0},removeItem(t){ac()&&localStorage.removeItem(t)},clear(){ac()&&localStorage.clear()}};function ac(){return typeof window<"u"&&typeof localStorage<"u"}function Nc(t,e){const n=(t==null?void 0:t["--apkt-accent"])??(t==null?void 0:t["--w3m-accent"]);return e==="light"?{"--w3m-accent":n||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":n||"hsla(230, 100%, 67%, 1)","--w3m-background":"#202020"}}var Tm={};const $f=(typeof process<"u"&&typeof Tm<"u"?Tm.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",dE=[{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],QI="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",Oe={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:$f,SECURE_SITE_DASHBOARD:`${$f}/dashboard`,SECURE_SITE_FAVICON:`${$f}/images/favicon.png`,SOLANA_NATIVE_TOKEN_ADDRESS:"So11111111111111111111111111111111111111111",RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],SUGGESTED_TOKENS_BY_CHAIN:{"eip155:42161":["USDâ‚®0"]},BALANCE_SUPPORTED_CHAINS:[B.CHAIN.EVM,B.CHAIN.SOLANA],SEND_PARAMS_SUPPORTED_CHAINS:[B.CHAIN.EVM],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:[B.CHAIN.EVM],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:[B.CHAIN.EVM,B.CHAIN.SOLANA],PAY_WITH_EXCHANGE_SUPPORTED_CHAIN_NAMESPACES:[B.CHAIN.EVM,B.CHAIN.SOLANA],ACTIVITY_ENABLED_CHAIN_NAMESPACES:[B.CHAIN.EVM,B.CHAIN.TON],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x",sui:"0x",stacks:"0x",ton:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in the wallet app",WEB:"Open and continue in the wallet app"},SEND_SUPPORTED_NAMESPACES:[B.CHAIN.EVM,B.CHAIN.SOLANA],DEFAULT_REMOTE_FEATURES:{swaps:["1inch"],onramp:["meld"],email:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],activity:!0,reownBranding:!0,multiWallet:!1,emailCapture:!1,payWithExchange:!1,payments:!1,reownAuthentication:!1,headless:!1},DEFAULT_REMOTE_FEATURES_DISABLED:{email:!1,socials:!1,swaps:!1,onramp:!1,activity:!1,reownBranding:!1,emailCapture:!1,reownAuthentication:!1,headless:!1},DEFAULT_FEATURES:{receive:!0,send:!0,emailShowWallets:!0,connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1,reownAuthentication:!1,headless:!1},DEFAULT_SOCIALS:["google","x","farcaster","discord","apple","github","facebook"],DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa",ton:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"},SIWX_DEFAULTS:{signOutOnDisconnect:!0},MANDATORY_WALLET_IDS_ON_MOBILE:[sn.ConnectorExplorerIds[B.CONNECTOR_ID.COINBASE],sn.ConnectorExplorerIds[B.CONNECTOR_ID.COINBASE_SDK],sn.ConnectorExplorerIds[B.CONNECTOR_ID.BASE_ACCOUNT],sn.ConnectorExplorerIds[B.SOLFLARE_CONNECTOR_NAME],sn.ConnectorExplorerIds[B.PHANTOM_CONNECTOR_NAME],sn.ConnectorExplorerIds[B.BINANCE_CONNECTOR_NAME]],DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"]},W={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5,transactionsHistory:15e3,tokenPrice:15e3,latestAppKitVersion:6048e5,tonWallets:864e5},isCacheExpired(t,e){return Date.now()-t>e},getActiveNetworkProps(){const t=W.getActiveNamespace(),e=W.getActiveCaipNetworkId(),n=e?e.split(":")[1]:void 0,r=n?isNaN(Number(n))?n:Number(n):void 0;return{namespace:t,caipNetworkId:e,chainId:r}},setWalletConnectDeepLink({name:t,href:e}){try{de.setItem(fe.DEEPLINK_CHOICE,JSON.stringify({href:e,name:t}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const t=de.getItem(fe.DEEPLINK_CHOICE);if(t)return JSON.parse(t)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{de.removeItem(fe.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(t){try{de.setItem(fe.ACTIVE_NAMESPACE,t)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(t){try{de.setItem(fe.ACTIVE_CAIP_NETWORK_ID,t),W.setActiveNamespace(t.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return de.getItem(fe.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{de.removeItem(fe.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(t){try{const e=Df(t);de.removeItem(e)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(t){try{const e=W.getRecentWallets();e.find(r=>r.id===t.id)||(e.unshift(t),e.length>2&&e.pop(),de.setItem(fe.RECENT_WALLETS,JSON.stringify(e)),de.setItem(fe.RECENT_WALLET,JSON.stringify(t)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const t=de.getItem(fe.RECENT_WALLETS);return t?JSON.parse(t):[]}catch{console.info("Unable to get AppKit recent")}return[]},getRecentWallet(){try{const t=de.getItem(fe.RECENT_WALLET);return t?JSON.parse(t):null}catch{console.info("Unable to get AppKit recent")}return null},deleteRecentWallet(){try{de.removeItem(fe.RECENT_WALLET)}catch{console.info("Unable to delete AppKit recent")}},setConnectedConnectorId(t,e){try{const n=Df(t);de.setItem(n,e)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return de.getItem(fe.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(t){if(t)try{const e=Df(t);return de.getItem(e)}catch{console.info("Unable to get connected connector id in namespace",t)}},setConnectedSocialProvider(t){try{de.setItem(fe.CONNECTED_SOCIAL,t)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return de.getItem(fe.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{de.removeItem(fe.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return de.getItem(fe.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){var n;const t=de.getItem(fe.ACTIVE_CAIP_NETWORK_ID);return(n=t==null?void 0:t.split(":"))==null?void 0:n[1]},setConnectionStatus(t){try{de.setItem(fe.CONNECTION_STATUS,t)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return de.getItem(fe.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const t=de.getItem(fe.CONNECTED_NAMESPACES);return t!=null&&t.length?t.split(","):[]}catch{return[]}},setConnectedNamespaces(t){try{const e=Array.from(new Set(t));de.setItem(fe.CONNECTED_NAMESPACES,e.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(t){try{const e=W.getConnectedNamespaces();e.includes(t)||(e.push(t),W.setConnectedNamespaces(e))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(t){try{const e=W.getConnectedNamespaces(),n=e.indexOf(t);n>-1&&(e.splice(n,1),W.setConnectedNamespaces(e))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return de.getItem(fe.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(t){try{de.setItem(fe.TELEGRAM_SOCIAL_PROVIDER,t)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{de.removeItem(fe.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let t={};try{const e=de.getItem(fe.PORTFOLIO_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromBalanceCache(t){try{const e=W.getBalanceCache();de.setItem(fe.PORTFOLIO_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getBalanceCacheForCaipAddress(t){try{const n=W.getBalanceCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.portfolio))return n.balance;W.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateBalanceCache(t){try{const e=W.getBalanceCache();e[t.caipAddress]=t,de.setItem(fe.PORTFOLIO_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getNativeBalanceCache(){let t={};try{const e=de.getItem(fe.NATIVE_BALANCE_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromNativeBalanceCache(t){try{const e=W.getBalanceCache();de.setItem(fe.NATIVE_BALANCE_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getNativeBalanceCacheForCaipAddress(t){try{const n=W.getNativeBalanceCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.nativeBalance))return n;console.info("Discarding cache for address",t),W.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateNativeBalanceCache(t){try{const e=W.getNativeBalanceCache();e[t.caipAddress]=t,de.setItem(fe.NATIVE_BALANCE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getEnsCache(){let t={};try{const e=de.getItem(fe.ENS_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get ens name cache")}return t},getEnsFromCacheForAddress(t){try{const n=W.getEnsCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.ens))return n.ens;W.removeEnsFromCache(t)}catch{console.info("Unable to get ens name from cache",t)}},updateEnsCache(t){try{const e=W.getEnsCache();e[t.address]=t,de.setItem(fe.ENS_CACHE,JSON.stringify(e))}catch{console.info("Unable to update ens name cache",t)}},removeEnsFromCache(t){try{const e=W.getEnsCache();de.setItem(fe.ENS_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove ens name from cache",t)}},getIdentityCache(){let t={};try{const e=de.getItem(fe.IDENTITY_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get identity cache")}return t},getIdentityFromCacheForAddress(t){try{const n=W.getIdentityCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.identity))return n.identity;W.removeIdentityFromCache(t)}catch{console.info("Unable to get identity from cache",t)}},updateIdentityCache(t){try{const e=W.getIdentityCache();e[t.address]={identity:t.identity,timestamp:t.timestamp},de.setItem(fe.IDENTITY_CACHE,JSON.stringify(e))}catch{console.info("Unable to update identity cache",t)}},removeIdentityFromCache(t){try{const e=W.getIdentityCache();de.setItem(fe.IDENTITY_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove identity from cache",t)}},getTonWalletsCache(){try{const t=de.getItem(fe.TON_WALLETS_CACHE),e=t?JSON.parse(t):void 0;if(e&&!this.isCacheExpired(e.timestamp,this.cacheExpiry.tonWallets))return e;W.removeTonWalletsCache()}catch{console.info("Unable to get ton wallets cache")}},updateTonWalletsCache(t){try{const e=W.getTonWalletsCache()||{timestamp:0,wallets:[]};e.timestamp=new Date().getTime(),e.wallets=t,de.setItem(fe.TON_WALLETS_CACHE,JSON.stringify(e))}catch{console.info("Unable to update ton wallets cache",t)}},removeTonWalletsCache(){try{de.removeItem(fe.TON_WALLETS_CACHE)}catch{console.info("Unable to remove ton wallets cache")}},clearAddressCache(){try{de.removeItem(fe.PORTFOLIO_CACHE),de.removeItem(fe.NATIVE_BALANCE_CACHE),de.removeItem(fe.ENS_CACHE),de.removeItem(fe.IDENTITY_CACHE),de.removeItem(fe.HISTORY_TRANSACTIONS_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(t){try{de.setItem(fe.PREFERRED_ACCOUNT_TYPES,JSON.stringify(t))}catch{console.info("Unable to set preferred account types",t)}},getPreferredAccountTypes(){try{const t=de.getItem(fe.PREFERRED_ACCOUNT_TYPES);return t?JSON.parse(t):{}}catch{console.info("Unable to get preferred account types")}return{}},setConnections(t,e){try{const n=W.getConnections(),r=n[e]??[],s=new Map;for(const o of r)s.set(o.connectorId,{...o});for(const o of t){const a=s.get(o.connectorId),c=o.connectorId===B.CONNECTOR_ID.AUTH;if(a&&!c){const l=new Set(a.accounts.map(d=>d.address.toLowerCase())),u=o.accounts.filter(d=>!l.has(d.address.toLowerCase()));a.accounts.push(...u)}else s.set(o.connectorId,{...o})}const i={...n,[e]:Array.from(s.values())};de.setItem(fe.CONNECTIONS,JSON.stringify(i))}catch(n){console.error("Unable to sync connections to storage",n)}},getConnections(){try{const t=de.getItem(fe.CONNECTIONS);return t?JSON.parse(t):{}}catch(t){return console.error("Unable to get connections from storage",t),{}}},deleteAddressFromConnection({connectorId:t,address:e,namespace:n}){try{const r=W.getConnections(),s=r[n]??[],i=new Map(s.map(a=>[a.connectorId,a])),o=i.get(t);o&&(o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase()).length===0?i.delete(t):i.set(t,{...o,accounts:o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase())})),de.setItem(fe.CONNECTIONS,JSON.stringify({...r,[n]:Array.from(i.values())}))}catch{console.error(`Unable to remove address "${e}" from connector "${t}" in namespace "${n}"`)}},getDisconnectedConnectorIds(){try{const t=de.getItem(fe.DISCONNECTED_CONNECTOR_IDS);return t?JSON.parse(t):{}}catch{console.info("Unable to get disconnected connector ids")}return{}},addDisconnectedConnectorId(t,e){try{const n=W.getDisconnectedConnectorIds(),r=n[e]??[];r.push(t),de.setItem(fe.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[e]:Array.from(new Set(r))}))}catch{console.error(`Unable to set disconnected connector id "${t}" for namespace "${e}"`)}},removeDisconnectedConnectorId(t,e){try{const n=W.getDisconnectedConnectorIds();let r=n[e]??[];r=r.filter(s=>s.toLowerCase()!==t.toLowerCase()),de.setItem(fe.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[e]:Array.from(new Set(r))}))}catch{console.error(`Unable to remove disconnected connector id "${t}" for namespace "${e}"`)}},isConnectorDisconnected(t,e){try{return(W.getDisconnectedConnectorIds()[e]??[]).some(s=>s.toLowerCase()===t.toLowerCase())}catch{console.info(`Unable to get disconnected connector id "${t}" for namespace "${e}"`)}return!1},getTransactionsCache(){try{const t=de.getItem(fe.HISTORY_TRANSACTIONS_CACHE);return t?JSON.parse(t):{}}catch{console.info("Unable to get transactions cache")}return{}},getTransactionsCacheForAddress({address:t,chainId:e=""}){var n;try{const s=(n=W.getTransactionsCache()[t])==null?void 0:n[e];if(s&&!this.isCacheExpired(s.timestamp,this.cacheExpiry.transactionsHistory))return s.transactions;W.removeTransactionsCache({address:t,chainId:e})}catch{console.info("Unable to get transactions cache")}},updateTransactionsCache({address:t,chainId:e="",timestamp:n,transactions:r}){try{const s=W.getTransactionsCache();s[t]={...s[t],[e]:{timestamp:n,transactions:r}},de.setItem(fe.HISTORY_TRANSACTIONS_CACHE,JSON.stringify(s))}catch{console.info("Unable to update transactions cache",{address:t,chainId:e,timestamp:n,transactions:r})}},removeTransactionsCache({address:t,chainId:e}){try{const n=W.getTransactionsCache(),r=(n==null?void 0:n[t])||{},{[e]:s,...i}=r;de.setItem(fe.HISTORY_TRANSACTIONS_CACHE,JSON.stringify({...n,[t]:i}))}catch{console.info("Unable to remove transactions cache",{address:t,chainId:e})}},getTokenPriceCache(){try{const t=de.getItem(fe.TOKEN_PRICE_CACHE);return t?JSON.parse(t):{}}catch{console.info("Unable to get token price cache")}return{}},getTokenPriceCacheForAddresses(t){try{const n=W.getTokenPriceCache()[t.join(",")];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.tokenPrice))return n.tokenPrice;W.removeTokenPriceCache(t)}catch{console.info("Unable to get token price cache for addresses",t)}},updateTokenPriceCache(t){try{const e=W.getTokenPriceCache();e[t.addresses.join(",")]={timestamp:t.timestamp,tokenPrice:t.tokenPrice},de.setItem(fe.TOKEN_PRICE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update token price cache",t)}},removeTokenPriceCache(t){try{const e=W.getTokenPriceCache();de.setItem(fe.TOKEN_PRICE_CACHE,JSON.stringify({...e,[t.join(",")]:void 0}))}catch{console.info("Unable to remove token price cache",t)}},getLatestAppKitVersion(){try{const t=this.getLatestAppKitVersionCache(),e=t==null?void 0:t.version;return e&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.latestAppKitVersion)?e:void 0}catch{console.info("Unable to get latest AppKit version")}},getLatestAppKitVersionCache(){try{const t=de.getItem(fe.LATEST_APPKIT_VERSION);return t?JSON.parse(t):{}}catch{console.info("Unable to get latest AppKit version cache")}return{}},updateLatestAppKitVersion(t){try{const e=W.getLatestAppKitVersionCache();e.timestamp=t.timestamp,e.version=t.version,de.setItem(fe.LATEST_APPKIT_VERSION,JSON.stringify(e))}catch{console.info("Unable to update latest AppKit version on local storage",t)}}},Q={getWindow(){if(!(typeof window>"u"))return window},isMobile(){var t;return this.isClient()?!!(window!=null&&window.matchMedia&&typeof window.matchMedia=="function"&&((t=window.matchMedia("(pointer:coarse)"))!=null&&t.matches)||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},checkCaipNetwork(t,e=""){return t==null?void 0:t.caipNetworkId.toLocaleLowerCase().includes(e.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return Q.isMobile()&&t.includes("android")},isIos(){if(!this.isMobile())return!1;const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return t.includes("iphone")||t.includes("ipad")},isSafari(){return this.isClient()?(window==null?void 0:window.navigator.userAgent.toLowerCase()).includes("safari"):!1},isClient(){return typeof window<"u"},isPairingExpired(t){return t?t-Date.now()<=Oe.TEN_SEC_MS:!0},isAllowedRetry(t,e=Oe.ONE_SEC_MS){return Date.now()-t>=e},copyToClopboard(t){navigator.clipboard.writeText(t)},isIframe(){try{return(window==null?void 0:window.self)!==(window==null?void 0:window.top)}catch{return!1}},isSafeApp(){var t,e;if(Q.isClient()&&window.self!==window.top)try{const n=(e=(t=window==null?void 0:window.location)==null?void 0:t.ancestorOrigins)==null?void 0:e[0],r="https://app.safe.global";if(n){const s=new URL(n),i=new URL(r);return s.hostname===i.hostname}}catch{return!1}return!1},getPairingExpiry(){return Date.now()+Oe.FOUR_MINUTES_MS},getNetworkId(t){return t==null?void 0:t.split(":")[1]},getPlainAddress(t){return t==null?void 0:t.split(":")[2]},async wait(t){return new Promise(e=>{setTimeout(e,t)})},debounce(t,e=500){let n;return(...r)=>{function s(){t(...r)}n&&clearTimeout(n),n=setTimeout(s,e)}},isHttpUrl(t){return t.startsWith("http://")||t.startsWith("https://")},formatNativeUrl(t,e,n=null){if(Q.isHttpUrl(t))return this.formatUniversalUrl(t,e);let r=t,s=n;r.includes("://")||(r=t.replaceAll("/","").replaceAll(":",""),r=`${r}://`),r.endsWith("/")||(r=`${r}/`),s&&!(s!=null&&s.endsWith("/"))&&(s=`${s}/`),this.isTelegram()&&this.isAndroid()&&(e=encodeURIComponent(e));const i=encodeURIComponent(e);return{redirect:`${r}wc?uri=${i}`,redirectUniversalLink:s?`${s}wc?uri=${i}`:void 0,href:r}},formatUniversalUrl(t,e){if(!Q.isHttpUrl(t))return this.formatNativeUrl(t,e);let n=t;n.endsWith("/")||(n=`${n}/`);const r=encodeURIComponent(e);return{redirect:`${n}wc?uri=${r}`,href:n}},getOpenTargetForPlatform(t){return t==="popupWindow"?t:this.isTelegram()?W.getTelegramSocialProvider()?"_top":"_blank":t},openHref(t,e,n){window==null||window.open(t,this.getOpenTargetForPlatform(e),n||"noreferrer noopener")},returnOpenHref(t,e,n){return window==null?void 0:window.open(t,this.getOpenTargetForPlatform(e),n||"noreferrer noopener")},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},isPWA(){var n,r;if(typeof window>"u")return!1;const t=window!=null&&window.matchMedia&&typeof window.matchMedia=="function"?(n=window.matchMedia("(display-mode: standalone)"))==null?void 0:n.matches:!1,e=(r=window==null?void 0:window.navigator)==null?void 0:r.standalone;return!!(t||e)},async preloadImage(t){const e=new Promise((n,r)=>{const s=new Image;s.onload=n,s.onerror=r,s.crossOrigin="anonymous",s.src=t});return Promise.race([e,Q.wait(2e3)])},parseBalance(t,e){let n="0.000";if(typeof t=="string"){const c=Number(t);if(!isNaN(c)){const l=(Math.floor(c*1e3)/1e3).toFixed(3);l&&(n=l)}}const[r,s]=n.split("."),i=r||"0",o=s||"000";return{formattedText:`${i}.${o}${e?` ${e}`:""}`,value:i,decimals:o,symbol:e}},getApiUrl(){return B.W3M_API_URL},getBlockchainApiUrl(){return B.BLOCKCHAIN_API_RPC_URL},getAnalyticsUrl(){return B.PULSE_API_URL},getUUID(){return crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})},parseError(t){var e,n;return typeof t=="string"?t:typeof((n=(e=t==null?void 0:t.issues)==null?void 0:e[0])==null?void 0:n.message)=="string"?t.issues[0].message:t instanceof Error?t.message:"Unknown error"},sortRequestedNetworks(t,e=[]){const n={};return e&&t&&(t.forEach((r,s)=>{n[r]=s}),e.sort((r,s)=>{const i=n[r.id],o=n[s.id];return i!==void 0&&o!==void 0?i-o:i!==void 0?-1:o!==void 0?1:0})),e},calculateBalance(t){let e=0;for(const n of t)e+=n.value??0;return e},formatTokenBalance(t){const e=t.toFixed(2),[n,r]=e.split(".");return{dollars:n,pennies:r}},isAddress(t,e="eip155"){switch(e){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)){if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)||/^(?:0x)?[0-9A-F]{40}$/iu.test(t))return!0}else return!1;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(t);default:return!1}},uniqueBy(t,e){const n=new Set;return t.filter(r=>{const s=r[e];return n.has(s)?!1:(n.add(s),!0)})},generateSdkVersion(t,e,n){const s=t.length===0?Oe.ADAPTER_TYPES.UNIVERSAL:t.map(i=>i.adapterType).join(",");return`${e}-${s}-${n}`},createAccount(t,e,n,r,s){return{namespace:t,address:e,type:n,publicKey:r,path:s}},isCaipAddress(t){if(typeof t!="string")return!1;const e=t.split(":"),n=e[0];return e.filter(Boolean).length===3&&n in B.CHAIN_NAME_MAP},getAccount(t){return t?typeof t=="string"?{address:t,chainId:void 0}:{address:t.address,chainId:t.chainId}:{address:void 0,chainId:void 0}},isMac(){const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return t.includes("macintosh")&&!t.includes("safari")},formatTelegramSocialLoginUrl(t){const e=`--${encodeURIComponent(window==null?void 0:window.location.href)}`,n="state=";if(new URL(t).host==="auth.magic.link"){const s="provider_authorization_url=",i=t.substring(t.indexOf(s)+s.length),o=this.injectIntoUrl(decodeURIComponent(i),n,e);return t.replace(i,encodeURIComponent(o))}return this.injectIntoUrl(t,n,e)},injectIntoUrl(t,e,n){const r=t.indexOf(e);if(r===-1)throw new Error(`${e} parameter not found in the URL: ${t}`);const s=t.indexOf("&",r),i=e.length,o=s!==-1?s:t.length,a=t.substring(0,r+i),c=t.substring(r+i,o),l=t.substring(s),u=c+n;return a+u+l}};var fa={};const eS="https://secure.walletconnect.org/sdk",tS=(typeof process<"u"&&typeof fa<"u"?fa.NEXT_PUBLIC_SECURE_SITE_SDK_URL:void 0)||eS,nS=(typeof process<"u"&&typeof fa<"u"?fa.NEXT_PUBLIC_DEFAULT_LOG_LEVEL:void 0)||"error",rS=(typeof process<"u"&&typeof fa<"u"?fa.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION:void 0)||"4",ue={APP_EVENT_KEY:"@w3m-app/",FRAME_EVENT_KEY:"@w3m-frame/",RPC_METHOD_KEY:"RPC_",STORAGE_KEY:"@appkit-wallet/",SESSION_TOKEN_KEY:"SESSION_TOKEN_KEY",EMAIL_LOGIN_USED_KEY:"EMAIL_LOGIN_USED_KEY",LAST_USED_CHAIN_KEY:"LAST_USED_CHAIN_KEY",LAST_EMAIL_LOGIN_TIME:"LAST_EMAIL_LOGIN_TIME",EMAIL:"EMAIL",PREFERRED_ACCOUNT_TYPE:"PREFERRED_ACCOUNT_TYPE",SMART_ACCOUNT_ENABLED:"SMART_ACCOUNT_ENABLED",SMART_ACCOUNT_ENABLED_NETWORKS:"SMART_ACCOUNT_ENABLED_NETWORKS",SOCIAL_USERNAME:"SOCIAL_USERNAME",APP_SWITCH_NETWORK:"@w3m-app/SWITCH_NETWORK",APP_CONNECT_EMAIL:"@w3m-app/CONNECT_EMAIL",APP_CONNECT_DEVICE:"@w3m-app/CONNECT_DEVICE",APP_CONNECT_OTP:"@w3m-app/CONNECT_OTP",APP_CONNECT_SOCIAL:"@w3m-app/CONNECT_SOCIAL",APP_GET_SOCIAL_REDIRECT_URI:"@w3m-app/GET_SOCIAL_REDIRECT_URI",APP_GET_USER:"@w3m-app/GET_USER",APP_SIGN_OUT:"@w3m-app/SIGN_OUT",APP_IS_CONNECTED:"@w3m-app/IS_CONNECTED",APP_GET_CHAIN_ID:"@w3m-app/GET_CHAIN_ID",APP_RPC_REQUEST:"@w3m-app/RPC_REQUEST",APP_UPDATE_EMAIL:"@w3m-app/UPDATE_EMAIL",APP_UPDATE_EMAIL_PRIMARY_OTP:"@w3m-app/UPDATE_EMAIL_PRIMARY_OTP",APP_UPDATE_EMAIL_SECONDARY_OTP:"@w3m-app/UPDATE_EMAIL_SECONDARY_OTP",APP_AWAIT_UPDATE_EMAIL:"@w3m-app/AWAIT_UPDATE_EMAIL",APP_SYNC_THEME:"@w3m-app/SYNC_THEME",APP_SYNC_DAPP_DATA:"@w3m-app/SYNC_DAPP_DATA",APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS:"@w3m-app/GET_SMART_ACCOUNT_ENABLED_NETWORKS",APP_INIT_SMART_ACCOUNT:"@w3m-app/INIT_SMART_ACCOUNT",APP_SET_PREFERRED_ACCOUNT:"@w3m-app/SET_PREFERRED_ACCOUNT",APP_CONNECT_FARCASTER:"@w3m-app/CONNECT_FARCASTER",APP_GET_FARCASTER_URI:"@w3m-app/GET_FARCASTER_URI",APP_RELOAD:"@w3m-app/RELOAD",APP_RPC_ABORT:"@w3m-app/RPC_ABORT",FRAME_SWITCH_NETWORK_ERROR:"@w3m-frame/SWITCH_NETWORK_ERROR",FRAME_SWITCH_NETWORK_SUCCESS:"@w3m-frame/SWITCH_NETWORK_SUCCESS",FRAME_CONNECT_EMAIL_ERROR:"@w3m-frame/CONNECT_EMAIL_ERROR",FRAME_CONNECT_EMAIL_SUCCESS:"@w3m-frame/CONNECT_EMAIL_SUCCESS",FRAME_CONNECT_DEVICE_ERROR:"@w3m-frame/CONNECT_DEVICE_ERROR",FRAME_CONNECT_DEVICE_SUCCESS:"@w3m-frame/CONNECT_DEVICE_SUCCESS",FRAME_CONNECT_OTP_SUCCESS:"@w3m-frame/CONNECT_OTP_SUCCESS",FRAME_CONNECT_OTP_ERROR:"@w3m-frame/CONNECT_OTP_ERROR",FRAME_CONNECT_SOCIAL_SUCCESS:"@w3m-frame/CONNECT_SOCIAL_SUCCESS",FRAME_CONNECT_SOCIAL_ERROR:"@w3m-frame/CONNECT_SOCIAL_ERROR",FRAME_CONNECT_FARCASTER_SUCCESS:"@w3m-frame/CONNECT_FARCASTER_SUCCESS",FRAME_CONNECT_FARCASTER_ERROR:"@w3m-frame/CONNECT_FARCASTER_ERROR",FRAME_GET_FARCASTER_URI_SUCCESS:"@w3m-frame/GET_FARCASTER_URI_SUCCESS",FRAME_GET_FARCASTER_URI_ERROR:"@w3m-frame/GET_FARCASTER_URI_ERROR",FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_SUCCESS",FRAME_GET_SOCIAL_REDIRECT_URI_ERROR:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_ERROR",FRAME_GET_USER_SUCCESS:"@w3m-frame/GET_USER_SUCCESS",FRAME_GET_USER_ERROR:"@w3m-frame/GET_USER_ERROR",FRAME_SIGN_OUT_SUCCESS:"@w3m-frame/SIGN_OUT_SUCCESS",FRAME_SIGN_OUT_ERROR:"@w3m-frame/SIGN_OUT_ERROR",FRAME_IS_CONNECTED_SUCCESS:"@w3m-frame/IS_CONNECTED_SUCCESS",FRAME_IS_CONNECTED_ERROR:"@w3m-frame/IS_CONNECTED_ERROR",FRAME_GET_CHAIN_ID_SUCCESS:"@w3m-frame/GET_CHAIN_ID_SUCCESS",FRAME_GET_CHAIN_ID_ERROR:"@w3m-frame/GET_CHAIN_ID_ERROR",FRAME_RPC_REQUEST_SUCCESS:"@w3m-frame/RPC_REQUEST_SUCCESS",FRAME_RPC_REQUEST_ERROR:"@w3m-frame/RPC_REQUEST_ERROR",FRAME_SESSION_UPDATE:"@w3m-frame/SESSION_UPDATE",FRAME_UPDATE_EMAIL_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SUCCESS",FRAME_UPDATE_EMAIL_ERROR:"@w3m-frame/UPDATE_EMAIL_ERROR",FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_ERROR",FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_ERROR",FRAME_SYNC_THEME_SUCCESS:"@w3m-frame/SYNC_THEME_SUCCESS",FRAME_SYNC_THEME_ERROR:"@w3m-frame/SYNC_THEME_ERROR",FRAME_SYNC_DAPP_DATA_SUCCESS:"@w3m-frame/SYNC_DAPP_DATA_SUCCESS",FRAME_SYNC_DAPP_DATA_ERROR:"@w3m-frame/SYNC_DAPP_DATA_ERROR",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR",FRAME_INIT_SMART_ACCOUNT_SUCCESS:"@w3m-frame/INIT_SMART_ACCOUNT_SUCCESS",FRAME_INIT_SMART_ACCOUNT_ERROR:"@w3m-frame/INIT_SMART_ACCOUNT_ERROR",FRAME_SET_PREFERRED_ACCOUNT_SUCCESS:"@w3m-frame/SET_PREFERRED_ACCOUNT_SUCCESS",FRAME_SET_PREFERRED_ACCOUNT_ERROR:"@w3m-frame/SET_PREFERRED_ACCOUNT_ERROR",FRAME_READY:"@w3m-frame/READY",FRAME_RELOAD_SUCCESS:"@w3m-frame/RELOAD_SUCCESS",FRAME_RELOAD_ERROR:"@w3m-frame/RELOAD_ERROR",FRAME_RPC_ABORT_SUCCESS:"@w3m-frame/RPC_ABORT_SUCCESS",FRAME_RPC_ABORT_ERROR:"@w3m-frame/RPC_ABORT_ERROR",RPC_RESPONSE_TYPE_ERROR:"RPC_RESPONSE_ERROR",RPC_RESPONSE_TYPE_TX:"RPC_RESPONSE_TRANSACTION_HASH",RPC_RESPONSE_TYPE_OBJECT:"RPC_RESPONSE_OBJECT"},ft={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}},Om={transactionHash:/^0x(?:[A-Fa-f0-9]{64})$/u,signedMessage:/^0x(?:[a-fA-F0-9]{62,})$/u},Ct={set(t,e){Hn.isClient&&localStorage.setItem(`${ue.STORAGE_KEY}${t}`,e)},get(t){return Hn.isClient?localStorage.getItem(`${ue.STORAGE_KEY}${t}`):null},delete(t,e){Hn.isClient&&(e?localStorage.removeItem(t):localStorage.removeItem(`${ue.STORAGE_KEY}${t}`))}},Gl=30*1e3,Hn={checkIfAllowedToTriggerEmail(){const t=Ct.get(ue.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<Gl){const n=Math.ceil((Gl-e)/1e3);throw new Error(`Please try again after ${n} seconds`)}}},getTimeToNextEmailLogin(){const t=Ct.get(ue.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<Gl)return Math.ceil((Gl-e)/1e3)}return 0},checkIfRequestExists(t){return ft.NOT_SAFE_RPC_METHODS.includes(t.method)||ft.SAFE_RPC_METHODS.includes(t.method)},getResponseType(t){return typeof t=="string"&&((t==null?void 0:t.match(Om.transactionHash))||(t==null?void 0:t.match(Om.signedMessage)))?ue.RPC_RESPONSE_TYPE_TX:ue.RPC_RESPONSE_TYPE_OBJECT},checkIfRequestIsSafe(t){return ft.SAFE_RPC_METHODS.includes(t.method)},isClient:typeof window<"u"};var je;(function(t){t.assertEqual=s=>s;function e(s){}t.assertIs=e;function n(s){throw new Error}t.assertNever=n,t.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(const a of i)o[a]=s[a];return t.objectValues(o)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},t.find=(s,i)=>{for(const o of s)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(je||(je={}));var hp;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(hp||(hp={}));const ie=je.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ci=t=>{switch(typeof t){case"undefined":return ie.undefined;case"string":return ie.string;case"number":return isNaN(t)?ie.nan:ie.number;case"boolean":return ie.boolean;case"function":return ie.function;case"bigint":return ie.bigint;case"symbol":return ie.symbol;case"object":return Array.isArray(t)?ie.array:t===null?ie.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?ie.promise:typeof Map<"u"&&t instanceof Map?ie.map:typeof Set<"u"&&t instanceof Set?ie.set:typeof Date<"u"&&t instanceof Date?ie.date:ie.object;default:return ie.unknown}},Y=je.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),sS=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class Cr extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(i){return i.message},r={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let a=r,c=0;for(;c<o.path.length;){const l=o.path[c];c===o.path.length-1?(a[l]=a[l]||{_errors:[]},a[l]._errors.push(n(o))):a[l]=a[l]||{_errors:[]},a=a[l],c++}}};return s(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,je.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Cr.create=t=>new Cr(t);const Tc=(t,e)=>{let n;switch(t.code){case Y.invalid_type:t.received===ie.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case Y.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,je.jsonStringifyReplacer)}`;break;case Y.unrecognized_keys:n=`Unrecognized key(s) in object: ${je.joinValues(t.keys,", ")}`;break;case Y.invalid_union:n="Invalid input";break;case Y.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${je.joinValues(t.options)}`;break;case Y.invalid_enum_value:n=`Invalid enum value. Expected ${je.joinValues(t.options)}, received '${t.received}'`;break;case Y.invalid_arguments:n="Invalid function arguments";break;case Y.invalid_return_type:n="Invalid function return type";break;case Y.invalid_date:n="Invalid date";break;case Y.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:je.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case Y.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case Y.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case Y.custom:n="Invalid input";break;case Y.invalid_intersection_types:n="Intersection results could not be merged";break;case Y.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case Y.not_finite:n="Number must be finite";break;default:n=e.defaultError,je.assertNever(t)}return{message:n}};let fE=Tc;function iS(t){fE=t}function ed(){return fE}const td=t=>{const{data:e,path:n,errorMaps:r,issueData:s}=t,i=[...n,...s.path||[]],o={...s,path:i};let a="";const c=r.filter(l=>!!l).slice().reverse();for(const l of c)a=l(o,{data:e,defaultError:a}).message;return{...s,path:i,message:s.message||a}},oS=[];function le(t,e){const n=td({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,ed(),Tc].filter(r=>!!r)});t.common.issues.push(n)}class en{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const s of n){if(s.status==="aborted")return Ce;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const s of n)r.push({key:await s.key,value:await s.value});return en.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const s of n){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return Ce;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[i.value]=o.value)}return{status:e.value,value:r}}}const Ce=Object.freeze({status:"aborted"}),hE=t=>({status:"dirty",value:t}),dn=t=>({status:"valid",value:t}),pp=t=>t.status==="aborted",gp=t=>t.status==="dirty",Oc=t=>t.status==="valid",nd=t=>typeof Promise<"u"&&t instanceof Promise;var ye;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(ye||(ye={}));class Gr{constructor(e,n,r,s){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Rm=(t,e)=>{if(Oc(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Cr(t.common.issues);return this._error=n,this._error}}};function Ae(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:s}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>o.code!=="invalid_type"?{message:a.defaultError}:typeof a.data>"u"?{message:r??a.defaultError}:{message:n??a.defaultError},description:s}}class xe{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return ci(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:ci(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new en,ctx:{common:e.parent.common,data:e.data,parsedType:ci(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(nd(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){var r;const s={common:{issues:[],async:(r=n==null?void 0:n.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ci(e)},i=this._parseSync({data:e,path:s.path,parent:s});return Rm(s,i)}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ci(e)},s=this._parse({data:e,path:r.path,parent:r}),i=await(nd(s)?s:Promise.resolve(s));return Rm(r,i)}refine(e,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const o=e(s),a=()=>i.addIssue({code:Y.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,n){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(e){return new xr({schema:this,typeName:we.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Is.create(this,this._def)}nullable(){return ho.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return _r.create(this,this._def)}promise(){return pa.create(this,this._def)}or(e){return Dc.create([this,e],this._def)}and(e){return $c.create(this,e,this._def)}transform(e){return new xr({...Ae(this._def),schema:this,typeName:we.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new Fc({...Ae(this._def),innerType:this,defaultValue:n,typeName:we.ZodDefault})}brand(){return new gE({typeName:we.ZodBranded,type:this,...Ae(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new od({...Ae(this._def),innerType:this,catchValue:n,typeName:we.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return _l.create(this,e)}readonly(){return cd.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const aS=/^c[^\s-]{8,}$/i,cS=/^[a-z][a-z0-9]*$/,lS=/^[0-9A-HJKMNP-TV-Z]{26}$/,uS=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,dS=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,fS="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Uf;const hS=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,pS=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,gS=t=>t.precision?t.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}Z$`):t.precision===0?t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function mS(t,e){return!!((e==="v4"||!e)&&hS.test(t)||(e==="v6"||!e)&&pS.test(t))}class vr extends xe{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ie.string){const i=this._getOrReturnCtx(e);return le(i,{code:Y.invalid_type,expected:ie.string,received:i.parsedType}),Ce}const r=new en;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),le(s,{code:Y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),le(s,{code:Y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?le(s,{code:Y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&le(s,{code:Y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")dS.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"email",code:Y.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")Uf||(Uf=new RegExp(fS,"u")),Uf.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"emoji",code:Y.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")uS.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"uuid",code:Y.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")aS.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"cuid",code:Y.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")cS.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"cuid2",code:Y.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")lS.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"ulid",code:Y.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),le(s,{validation:"url",code:Y.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"regex",code:Y.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),le(s,{code:Y.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),le(s,{code:Y.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),le(s,{code:Y.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?gS(i).test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{code:Y.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="ip"?mS(e.data,i.version)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"ip",code:Y.invalid_string,message:i.message}),r.dirty()):je.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(s=>e.test(s),{validation:n,code:Y.invalid_string,...ye.errToObj(r)})}_addCheck(e){return new vr({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ye.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ye.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ye.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ye.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ye.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ye.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ye.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ye.errToObj(e)})}datetime(e){var n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(n=e==null?void 0:e.offset)!==null&&n!==void 0?n:!1,...ye.errToObj(e==null?void 0:e.message)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...ye.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...ye.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...ye.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...ye.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...ye.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...ye.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...ye.errToObj(n)})}nonempty(e){return this.min(1,ye.errToObj(e))}trim(){return new vr({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new vr({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new vr({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}vr.create=t=>{var e;return new vr({checks:[],typeName:we.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ae(t)})};function yS(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=n>r?n:r,i=parseInt(t.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}class Ci extends xe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ie.number){const i=this._getOrReturnCtx(e);return le(i,{code:Y.invalid_type,expected:ie.number,received:i.parsedType}),Ce}let r;const s=new en;for(const i of this._def.checks)i.kind==="int"?je.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),le(r,{code:Y.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),le(r,{code:Y.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),le(r,{code:Y.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?yS(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),le(r,{code:Y.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),le(r,{code:Y.not_finite,message:i.message}),s.dirty()):je.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,ye.toString(n))}gt(e,n){return this.setLimit("min",e,!1,ye.toString(n))}lte(e,n){return this.setLimit("max",e,!0,ye.toString(n))}lt(e,n){return this.setLimit("max",e,!1,ye.toString(n))}setLimit(e,n,r,s){return new Ci({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:ye.toString(s)}]})}_addCheck(e){return new Ci({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ye.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ye.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ye.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ye.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ye.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:ye.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:ye.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ye.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ye.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&je.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}Ci.create=t=>new Ci({checks:[],typeName:we.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Ae(t)});class _i extends xe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==ie.bigint){const i=this._getOrReturnCtx(e);return le(i,{code:Y.invalid_type,expected:ie.bigint,received:i.parsedType}),Ce}let r;const s=new en;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),le(r,{code:Y.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),le(r,{code:Y.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),le(r,{code:Y.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):je.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,ye.toString(n))}gt(e,n){return this.setLimit("min",e,!1,ye.toString(n))}lte(e,n){return this.setLimit("max",e,!0,ye.toString(n))}lt(e,n){return this.setLimit("max",e,!1,ye.toString(n))}setLimit(e,n,r,s){return new _i({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:ye.toString(s)}]})}_addCheck(e){return new _i({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ye.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ye.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ye.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ye.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:ye.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}_i.create=t=>{var e;return new _i({checks:[],typeName:we.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ae(t)})};class Rc extends xe{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ie.boolean){const r=this._getOrReturnCtx(e);return le(r,{code:Y.invalid_type,expected:ie.boolean,received:r.parsedType}),Ce}return dn(e.data)}}Rc.create=t=>new Rc({typeName:we.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Ae(t)});class uo extends xe{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ie.date){const i=this._getOrReturnCtx(e);return le(i,{code:Y.invalid_type,expected:ie.date,received:i.parsedType}),Ce}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return le(i,{code:Y.invalid_date}),Ce}const r=new en;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),le(s,{code:Y.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),le(s,{code:Y.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):je.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new uo({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:ye.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:ye.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}uo.create=t=>new uo({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:we.ZodDate,...Ae(t)});class rd extends xe{_parse(e){if(this._getType(e)!==ie.symbol){const r=this._getOrReturnCtx(e);return le(r,{code:Y.invalid_type,expected:ie.symbol,received:r.parsedType}),Ce}return dn(e.data)}}rd.create=t=>new rd({typeName:we.ZodSymbol,...Ae(t)});class Pc extends xe{_parse(e){if(this._getType(e)!==ie.undefined){const r=this._getOrReturnCtx(e);return le(r,{code:Y.invalid_type,expected:ie.undefined,received:r.parsedType}),Ce}return dn(e.data)}}Pc.create=t=>new Pc({typeName:we.ZodUndefined,...Ae(t)});class kc extends xe{_parse(e){if(this._getType(e)!==ie.null){const r=this._getOrReturnCtx(e);return le(r,{code:Y.invalid_type,expected:ie.null,received:r.parsedType}),Ce}return dn(e.data)}}kc.create=t=>new kc({typeName:we.ZodNull,...Ae(t)});class ha extends xe{constructor(){super(...arguments),this._any=!0}_parse(e){return dn(e.data)}}ha.create=t=>new ha({typeName:we.ZodAny,...Ae(t)});class io extends xe{constructor(){super(...arguments),this._unknown=!0}_parse(e){return dn(e.data)}}io.create=t=>new io({typeName:we.ZodUnknown,...Ae(t)});class Rs extends xe{_parse(e){const n=this._getOrReturnCtx(e);return le(n,{code:Y.invalid_type,expected:ie.never,received:n.parsedType}),Ce}}Rs.create=t=>new Rs({typeName:we.ZodNever,...Ae(t)});class sd extends xe{_parse(e){if(this._getType(e)!==ie.undefined){const r=this._getOrReturnCtx(e);return le(r,{code:Y.invalid_type,expected:ie.void,received:r.parsedType}),Ce}return dn(e.data)}}sd.create=t=>new sd({typeName:we.ZodVoid,...Ae(t)});class _r extends xe{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),s=this._def;if(n.parsedType!==ie.array)return le(n,{code:Y.invalid_type,expected:ie.array,received:n.parsedType}),Ce;if(s.exactLength!==null){const o=n.data.length>s.exactLength.value,a=n.data.length<s.exactLength.value;(o||a)&&(le(n,{code:o?Y.too_big:Y.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(le(n,{code:Y.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(le(n,{code:Y.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,a)=>s.type._parseAsync(new Gr(n,o,n.path,a)))).then(o=>en.mergeArray(r,o));const i=[...n.data].map((o,a)=>s.type._parseSync(new Gr(n,o,n.path,a)));return en.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new _r({...this._def,minLength:{value:e,message:ye.toString(n)}})}max(e,n){return new _r({...this._def,maxLength:{value:e,message:ye.toString(n)}})}length(e,n){return new _r({...this._def,exactLength:{value:e,message:ye.toString(n)}})}nonempty(e){return this.min(1,e)}}_r.create=(t,e)=>new _r({type:t,minLength:null,maxLength:null,exactLength:null,typeName:we.ZodArray,...Ae(e)});function Ko(t){if(t instanceof it){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=Is.create(Ko(r))}return new it({...t._def,shape:()=>e})}else return t instanceof _r?new _r({...t._def,type:Ko(t.element)}):t instanceof Is?Is.create(Ko(t.unwrap())):t instanceof ho?ho.create(Ko(t.unwrap())):t instanceof Yr?Yr.create(t.items.map(e=>Ko(e))):t}class it extends xe{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=je.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==ie.object){const l=this._getOrReturnCtx(e);return le(l,{code:Y.invalid_type,expected:ie.object,received:l.parsedType}),Ce}const{status:r,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Rs&&this._def.unknownKeys==="strip"))for(const l in s.data)o.includes(l)||a.push(l);const c=[];for(const l of o){const u=i[l],d=s.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new Gr(s,d,s.path,l)),alwaysSet:l in s.data})}if(this._def.catchall instanceof Rs){const l=this._def.unknownKeys;if(l==="passthrough")for(const u of a)c.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(l==="strict")a.length>0&&(le(s,{code:Y.unrecognized_keys,keys:a}),r.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const u of a){const d=s.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new Gr(s,d,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const l=[];for(const u of c){const d=await u.key;l.push({key:d,value:await u.value,alwaysSet:u.alwaysSet})}return l}).then(l=>en.mergeObjectSync(r,l)):en.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return ye.errToObj,new it({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var s,i,o,a;const c=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,n,r).message)!==null&&o!==void 0?o:r.defaultError;return n.code==="unrecognized_keys"?{message:(a=ye.errToObj(e).message)!==null&&a!==void 0?a:c}:{message:c}}}:{}})}strip(){return new it({...this._def,unknownKeys:"strip"})}passthrough(){return new it({...this._def,unknownKeys:"passthrough"})}extend(e){return new it({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new it({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:we.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new it({...this._def,catchall:e})}pick(e){const n={};return je.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new it({...this._def,shape:()=>n})}omit(e){const n={};return je.objectKeys(this.shape).forEach(r=>{e[r]||(n[r]=this.shape[r])}),new it({...this._def,shape:()=>n})}deepPartial(){return Ko(this)}partial(e){const n={};return je.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];e&&!e[r]?n[r]=s:n[r]=s.optional()}),new it({...this._def,shape:()=>n})}required(e){const n={};return je.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof Is;)i=i._def.innerType;n[r]=i}}),new it({...this._def,shape:()=>n})}keyof(){return pE(je.objectKeys(this.shape))}}it.create=(t,e)=>new it({shape:()=>t,unknownKeys:"strip",catchall:Rs.create(),typeName:we.ZodObject,...Ae(e)});it.strictCreate=(t,e)=>new it({shape:()=>t,unknownKeys:"strict",catchall:Rs.create(),typeName:we.ZodObject,...Ae(e)});it.lazycreate=(t,e)=>new it({shape:t,unknownKeys:"strip",catchall:Rs.create(),typeName:we.ZodObject,...Ae(e)});class Dc extends xe{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function s(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new Cr(a.ctx.common.issues));return le(n,{code:Y.invalid_union,unionErrors:o}),Ce}if(n.common.async)return Promise.all(r.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const c of r){const l={...n,common:{...n.common,issues:[]},parent:null},u=c._parseSync({data:n.data,path:n.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:l}),l.common.issues.length&&o.push(l.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(c=>new Cr(c));return le(n,{code:Y.invalid_union,unionErrors:a}),Ce}}get options(){return this._def.options}}Dc.create=(t,e)=>new Dc({options:t,typeName:we.ZodUnion,...Ae(e)});const Bu=t=>t instanceof Bc?Bu(t.schema):t instanceof xr?Bu(t.innerType()):t instanceof Lc?[t.value]:t instanceof Ai?t.options:t instanceof Mc?Object.keys(t.enum):t instanceof Fc?Bu(t._def.innerType):t instanceof Pc?[void 0]:t instanceof kc?[null]:null;class zd extends xe{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==ie.object)return le(n,{code:Y.invalid_type,expected:ie.object,received:n.parsedType}),Ce;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(le(n,{code:Y.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),Ce)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const s=new Map;for(const i of n){const o=Bu(i.shape[e]);if(!o)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new zd({typeName:we.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:s,...Ae(r)})}}function mp(t,e){const n=ci(t),r=ci(e);if(t===e)return{valid:!0,data:t};if(n===ie.object&&r===ie.object){const s=je.objectKeys(e),i=je.objectKeys(t).filter(a=>s.indexOf(a)!==-1),o={...t,...e};for(const a of i){const c=mp(t[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(n===ie.array&&r===ie.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const o=t[i],a=e[i],c=mp(o,a);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return n===ie.date&&r===ie.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class $c extends xe{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=(i,o)=>{if(pp(i)||pp(o))return Ce;const a=mp(i.value,o.value);return a.valid?((gp(i)||gp(o))&&n.dirty(),{status:n.value,value:a.data}):(le(r,{code:Y.invalid_intersection_types}),Ce)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}$c.create=(t,e,n)=>new $c({left:t,right:e,typeName:we.ZodIntersection,...Ae(n)});class Yr extends xe{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ie.array)return le(r,{code:Y.invalid_type,expected:ie.array,received:r.parsedType}),Ce;if(r.data.length<this._def.items.length)return le(r,{code:Y.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ce;!this._def.rest&&r.data.length>this._def.items.length&&(le(r,{code:Y.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((o,a)=>{const c=this._def.items[a]||this._def.rest;return c?c._parse(new Gr(r,o,r.path,a)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>en.mergeArray(n,o)):en.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new Yr({...this._def,rest:e})}}Yr.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Yr({items:t,typeName:we.ZodTuple,rest:null,...Ae(e)})};class Uc extends xe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ie.object)return le(r,{code:Y.invalid_type,expected:ie.object,received:r.parsedType}),Ce;const s=[],i=this._def.keyType,o=this._def.valueType;for(const a in r.data)s.push({key:i._parse(new Gr(r,a,r.path,a)),value:o._parse(new Gr(r,r.data[a],r.path,a))});return r.common.async?en.mergeObjectAsync(n,s):en.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof xe?new Uc({keyType:e,valueType:n,typeName:we.ZodRecord,...Ae(r)}):new Uc({keyType:vr.create(),valueType:e,typeName:we.ZodRecord,...Ae(n)})}}class id extends xe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ie.map)return le(r,{code:Y.invalid_type,expected:ie.map,received:r.parsedType}),Ce;const s=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([a,c],l)=>({key:s._parse(new Gr(r,a,r.path,[l,"key"])),value:i._parse(new Gr(r,c,r.path,[l,"value"]))}));if(r.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const c of o){const l=await c.key,u=await c.value;if(l.status==="aborted"||u.status==="aborted")return Ce;(l.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(l.value,u.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const c of o){const l=c.key,u=c.value;if(l.status==="aborted"||u.status==="aborted")return Ce;(l.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(l.value,u.value)}return{status:n.value,value:a}}}}id.create=(t,e,n)=>new id({valueType:e,keyType:t,typeName:we.ZodMap,...Ae(n)});class fo extends xe{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ie.set)return le(r,{code:Y.invalid_type,expected:ie.set,received:r.parsedType}),Ce;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(le(r,{code:Y.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(le(r,{code:Y.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function o(c){const l=new Set;for(const u of c){if(u.status==="aborted")return Ce;u.status==="dirty"&&n.dirty(),l.add(u.value)}return{status:n.value,value:l}}const a=[...r.data.values()].map((c,l)=>i._parse(new Gr(r,c,r.path,l)));return r.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,n){return new fo({...this._def,minSize:{value:e,message:ye.toString(n)}})}max(e,n){return new fo({...this._def,maxSize:{value:e,message:ye.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}fo.create=(t,e)=>new fo({valueType:t,minSize:null,maxSize:null,typeName:we.ZodSet,...Ae(e)});class ta extends xe{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==ie.function)return le(n,{code:Y.invalid_type,expected:ie.function,received:n.parsedType}),Ce;function r(a,c){return td({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,ed(),Tc].filter(l=>!!l),issueData:{code:Y.invalid_arguments,argumentsError:c}})}function s(a,c){return td({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,ed(),Tc].filter(l=>!!l),issueData:{code:Y.invalid_return_type,returnTypeError:c}})}const i={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof pa){const a=this;return dn(async function(...c){const l=new Cr([]),u=await a._def.args.parseAsync(c,i).catch(h=>{throw l.addIssue(r(c,h)),l}),d=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(d,i).catch(h=>{throw l.addIssue(s(d,h)),l})})}else{const a=this;return dn(function(...c){const l=a._def.args.safeParse(c,i);if(!l.success)throw new Cr([r(c,l.error)]);const u=Reflect.apply(o,this,l.data),d=a._def.returns.safeParse(u,i);if(!d.success)throw new Cr([s(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ta({...this._def,args:Yr.create(e).rest(io.create())})}returns(e){return new ta({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new ta({args:e||Yr.create([]).rest(io.create()),returns:n||io.create(),typeName:we.ZodFunction,...Ae(r)})}}class Bc extends xe{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Bc.create=(t,e)=>new Bc({getter:t,typeName:we.ZodLazy,...Ae(e)});class Lc extends xe{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return le(n,{received:n.data,code:Y.invalid_literal,expected:this._def.value}),Ce}return{status:"valid",value:e.data}}get value(){return this._def.value}}Lc.create=(t,e)=>new Lc({value:t,typeName:we.ZodLiteral,...Ae(e)});function pE(t,e){return new Ai({values:t,typeName:we.ZodEnum,...Ae(e)})}class Ai extends xe{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return le(n,{expected:je.joinValues(r),received:n.parsedType,code:Y.invalid_type}),Ce}if(this._def.values.indexOf(e.data)===-1){const n=this._getOrReturnCtx(e),r=this._def.values;return le(n,{received:n.data,code:Y.invalid_enum_value,options:r}),Ce}return dn(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e){return Ai.create(e)}exclude(e){return Ai.create(this.options.filter(n=>!e.includes(n)))}}Ai.create=pE;class Mc extends xe{_parse(e){const n=je.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==ie.string&&r.parsedType!==ie.number){const s=je.objectValues(n);return le(r,{expected:je.joinValues(s),received:r.parsedType,code:Y.invalid_type}),Ce}if(n.indexOf(e.data)===-1){const s=je.objectValues(n);return le(r,{received:r.data,code:Y.invalid_enum_value,options:s}),Ce}return dn(e.data)}get enum(){return this._def.values}}Mc.create=(t,e)=>new Mc({values:t,typeName:we.ZodNativeEnum,...Ae(e)});class pa extends xe{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==ie.promise&&n.common.async===!1)return le(n,{code:Y.invalid_type,expected:ie.promise,received:n.parsedType}),Ce;const r=n.parsedType===ie.promise?n.data:Promise.resolve(n.data);return dn(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}pa.create=(t,e)=>new pa({type:t,typeName:we.ZodPromise,...Ae(e)});class xr extends xe{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===we.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{le(r,o),o.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(r.data,i);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(o).then(a=>this._def.schema._parseAsync({data:a,path:r.path,parent:r})):this._def.schema._parseSync({data:o,path:r.path,parent:r})}if(s.type==="refinement"){const o=a=>{const c=s.refinement(a,i);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?Ce:(a.status==="dirty"&&n.dirty(),o(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>a.status==="aborted"?Ce:(a.status==="dirty"&&n.dirty(),o(a.value).then(()=>({status:n.value,value:a.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Oc(o))return o;const a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>Oc(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:n.value,value:a})):o);je.assertNever(s)}}xr.create=(t,e,n)=>new xr({schema:t,typeName:we.ZodEffects,effect:e,...Ae(n)});xr.createWithPreprocess=(t,e,n)=>new xr({schema:e,effect:{type:"preprocess",transform:t},typeName:we.ZodEffects,...Ae(n)});class Is extends xe{_parse(e){return this._getType(e)===ie.undefined?dn(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Is.create=(t,e)=>new Is({innerType:t,typeName:we.ZodOptional,...Ae(e)});class ho extends xe{_parse(e){return this._getType(e)===ie.null?dn(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ho.create=(t,e)=>new ho({innerType:t,typeName:we.ZodNullable,...Ae(e)});class Fc extends xe{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===ie.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Fc.create=(t,e)=>new Fc({innerType:t,typeName:we.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ae(e)});class od extends xe{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return nd(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Cr(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Cr(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}od.create=(t,e)=>new od({innerType:t,typeName:we.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ae(e)});class ad extends xe{_parse(e){if(this._getType(e)!==ie.nan){const r=this._getOrReturnCtx(e);return le(r,{code:Y.invalid_type,expected:ie.nan,received:r.parsedType}),Ce}return{status:"valid",value:e.data}}}ad.create=t=>new ad({typeName:we.ZodNaN,...Ae(t)});const bS=Symbol("zod_brand");class gE extends xe{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class _l extends xe{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?Ce:i.status==="dirty"?(n.dirty(),hE(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?Ce:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,n){return new _l({in:e,out:n,typeName:we.ZodPipeline})}}class cd extends xe{_parse(e){const n=this._def.innerType._parse(e);return Oc(n)&&(n.value=Object.freeze(n.value)),n}}cd.create=(t,e)=>new cd({innerType:t,typeName:we.ZodReadonly,...Ae(e)});const mE=(t,e={},n)=>t?ha.create().superRefine((r,s)=>{var i,o;if(!t(r)){const a=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,c=(o=(i=a.fatal)!==null&&i!==void 0?i:n)!==null&&o!==void 0?o:!0,l=typeof a=="string"?{message:a}:a;s.addIssue({code:"custom",...l,fatal:c})}}):ha.create(),wS={object:it.lazycreate};var we;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(we||(we={}));const ES=(t,e={message:`Input not instance of ${t.name}`})=>mE(n=>n instanceof t,e),yE=vr.create,bE=Ci.create,vS=ad.create,CS=_i.create,wE=Rc.create,_S=uo.create,AS=rd.create,IS=Pc.create,SS=kc.create,xS=ha.create,NS=io.create,TS=Rs.create,OS=sd.create,RS=_r.create,PS=it.create,kS=it.strictCreate,DS=Dc.create,$S=zd.create,US=$c.create,BS=Yr.create,LS=Uc.create,MS=id.create,FS=fo.create,jS=ta.create,HS=Bc.create,WS=Lc.create,zS=Ai.create,qS=Mc.create,VS=pa.create,Pm=xr.create,KS=Is.create,GS=ho.create,YS=xr.createWithPreprocess,ZS=_l.create,JS=()=>yE().optional(),XS=()=>bE().optional(),QS=()=>wE().optional(),e5={string:t=>vr.create({...t,coerce:!0}),number:t=>Ci.create({...t,coerce:!0}),boolean:t=>Rc.create({...t,coerce:!0}),bigint:t=>_i.create({...t,coerce:!0}),date:t=>uo.create({...t,coerce:!0})},t5=Ce;var v=Object.freeze({__proto__:null,defaultErrorMap:Tc,setErrorMap:iS,getErrorMap:ed,makeIssue:td,EMPTY_PATH:oS,addIssueToContext:le,ParseStatus:en,INVALID:Ce,DIRTY:hE,OK:dn,isAborted:pp,isDirty:gp,isValid:Oc,isAsync:nd,get util(){return je},get objectUtil(){return hp},ZodParsedType:ie,getParsedType:ci,ZodType:xe,ZodString:vr,ZodNumber:Ci,ZodBigInt:_i,ZodBoolean:Rc,ZodDate:uo,ZodSymbol:rd,ZodUndefined:Pc,ZodNull:kc,ZodAny:ha,ZodUnknown:io,ZodNever:Rs,ZodVoid:sd,ZodArray:_r,ZodObject:it,ZodUnion:Dc,ZodDiscriminatedUnion:zd,ZodIntersection:$c,ZodTuple:Yr,ZodRecord:Uc,ZodMap:id,ZodSet:fo,ZodFunction:ta,ZodLazy:Bc,ZodLiteral:Lc,ZodEnum:Ai,ZodNativeEnum:Mc,ZodPromise:pa,ZodEffects:xr,ZodTransformer:xr,ZodOptional:Is,ZodNullable:ho,ZodDefault:Fc,ZodCatch:od,ZodNaN:ad,BRAND:bS,ZodBranded:gE,ZodPipeline:_l,ZodReadonly:cd,custom:mE,Schema:xe,ZodSchema:xe,late:wS,get ZodFirstPartyTypeKind(){return we},coerce:e5,any:xS,array:RS,bigint:CS,boolean:wE,date:_S,discriminatedUnion:$S,effect:Pm,enum:zS,function:jS,instanceof:ES,intersection:US,lazy:HS,literal:WS,map:MS,nan:vS,nativeEnum:qS,never:TS,null:SS,nullable:GS,number:bE,object:PS,oboolean:QS,onumber:XS,optional:KS,ostring:JS,pipeline:ZS,preprocess:YS,promise:VS,record:LS,set:FS,strictObject:kS,string:yE,symbol:AS,transformer:Pm,tuple:BS,undefined:IS,union:DS,unknown:NS,void:OS,NEVER:t5,ZodIssueCode:Y,quotelessJson:sS,ZodError:Cr});const ot=v.object({message:v.string()});function oe(t){return v.literal(ue[t])}const qd=v.object({serializedMessage:v.string().optional(),accountAddress:v.string(),chainId:v.string(),notBefore:v.string().optional(),domain:v.string(),uri:v.string(),version:v.string(),nonce:v.string(),statement:v.string().optional(),resources:v.array(v.string()).optional(),requestId:v.string().optional(),issuedAt:v.string().optional(),expirationTime:v.string().optional()});v.object({accessList:v.array(v.string()),blockHash:v.string().nullable(),blockNumber:v.string().nullable(),chainId:v.string().or(v.number()),from:v.string(),gas:v.string(),hash:v.string(),input:v.string().nullable(),maxFeePerGas:v.string(),maxPriorityFeePerGas:v.string(),nonce:v.string(),r:v.string(),s:v.string(),to:v.string(),transactionIndex:v.string().nullable(),type:v.string(),v:v.string(),value:v.string()});const n5=v.object({chainId:v.string().or(v.number()),rpcUrl:v.optional(v.string())}),r5=v.object({email:v.string().email()}),s5=v.object({otp:v.string()}),i5=v.object({uri:v.string(),preferredAccountType:v.optional(v.string()),chainId:v.optional(v.string().or(v.number())),siwxMessage:v.optional(qd),rpcUrl:v.optional(v.string())}),o5=v.object({chainId:v.optional(v.string().or(v.number())),preferredAccountType:v.optional(v.string()),socialUri:v.optional(v.string()),siwxMessage:v.optional(qd),rpcUrl:v.optional(v.string())}),a5=v.object({provider:v.enum(["google","github","apple","facebook","x","discord"])}),c5=v.object({email:v.string().email()}),l5=v.object({otp:v.string()}),u5=v.object({otp:v.string()}),d5=v.object({themeMode:v.optional(v.enum(["light","dark"])),themeVariables:v.optional(v.record(v.string(),v.string().or(v.number()))),w3mThemeVariables:v.optional(v.record(v.string(),v.string()))}),f5=v.object({metadata:v.object({name:v.string(),description:v.string(),url:v.string(),icons:v.array(v.string())}).optional(),sdkVersion:v.string().optional(),sdkType:v.string().optional(),projectId:v.string()}),h5=v.object({type:v.string()}),p5=v.object({action:v.enum(["VERIFY_DEVICE","VERIFY_OTP","CONNECT"])}),g5=v.object({url:v.string()}),m5=v.object({userName:v.string()}),y5=v.object({email:v.string().optional().nullable(),address:v.string(),chainId:v.string().or(v.number()),accounts:v.array(v.object({address:v.string(),type:v.enum([ft.ACCOUNT_TYPES.EOA,ft.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),userName:v.string().optional().nullable(),preferredAccountType:v.optional(v.string()),signature:v.string().optional(),message:v.string().optional(),siwxMessage:v.optional(qd)}),b5=v.object({action:v.enum(["VERIFY_PRIMARY_OTP","VERIFY_SECONDARY_OTP"])}),w5=v.object({email:v.string().email().optional().nullable(),address:v.string(),chainId:v.string().or(v.number()),smartAccountDeployed:v.optional(v.boolean()),accounts:v.array(v.object({address:v.string(),type:v.enum([ft.ACCOUNT_TYPES.EOA,ft.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),preferredAccountType:v.optional(v.string()),signature:v.string().optional(),message:v.string().optional(),siwxMessage:v.optional(qd)}),E5=v.object({uri:v.string()}),v5=v.object({isConnected:v.boolean()}),C5=v.object({chainId:v.string().or(v.number())}),_5=v.object({chainId:v.string().or(v.number())}),A5=v.object({newEmail:v.string().email()}),I5=v.object({smartAccountEnabledNetworks:v.array(v.number())});v.object({address:v.string(),isDeployed:v.boolean()});const S5=v.object({version:v.string().optional()}),x5=v.object({type:v.string(),address:v.string()}),N5=v.any(),T5=v.object({method:v.literal("eth_accounts")}),O5=v.object({method:v.literal("eth_blockNumber")}),R5=v.object({method:v.literal("eth_call"),params:v.array(v.any())}),P5=v.object({method:v.literal("eth_chainId")}),k5=v.object({method:v.literal("eth_estimateGas"),params:v.array(v.any())}),D5=v.object({method:v.literal("eth_feeHistory"),params:v.array(v.any())}),$5=v.object({method:v.literal("eth_gasPrice")}),U5=v.object({method:v.literal("eth_getAccount"),params:v.array(v.any())}),B5=v.object({method:v.literal("eth_getBalance"),params:v.array(v.any())}),L5=v.object({method:v.literal("eth_getBlockByHash"),params:v.array(v.any())}),M5=v.object({method:v.literal("eth_getBlockByNumber"),params:v.array(v.any())}),F5=v.object({method:v.literal("eth_getBlockReceipts"),params:v.array(v.any())}),j5=v.object({method:v.literal("eth_getBlockTransactionCountByHash"),params:v.array(v.any())}),H5=v.object({method:v.literal("eth_getBlockTransactionCountByNumber"),params:v.array(v.any())}),W5=v.object({method:v.literal("eth_getCode"),params:v.array(v.any())}),z5=v.object({method:v.literal("eth_getFilterChanges"),params:v.array(v.any())}),q5=v.object({method:v.literal("eth_getFilterLogs"),params:v.array(v.any())}),V5=v.object({method:v.literal("eth_getLogs"),params:v.array(v.any())}),K5=v.object({method:v.literal("eth_getProof"),params:v.array(v.any())}),G5=v.object({method:v.literal("eth_getStorageAt"),params:v.array(v.any())}),Y5=v.object({method:v.literal("eth_getTransactionByBlockHashAndIndex"),params:v.array(v.any())}),Z5=v.object({method:v.literal("eth_getTransactionByBlockNumberAndIndex"),params:v.array(v.any())}),J5=v.object({method:v.literal("eth_getTransactionByHash"),params:v.array(v.any())}),X5=v.object({method:v.literal("eth_getTransactionCount"),params:v.array(v.any())}),Q5=v.object({method:v.literal("eth_getTransactionReceipt"),params:v.array(v.any())}),e6=v.object({method:v.literal("eth_getUncleCountByBlockHash"),params:v.array(v.any())}),t6=v.object({method:v.literal("eth_getUncleCountByBlockNumber"),params:v.array(v.any())}),n6=v.object({method:v.literal("eth_maxPriorityFeePerGas")}),r6=v.object({method:v.literal("eth_newBlockFilter")}),s6=v.object({method:v.literal("eth_newFilter"),params:v.array(v.any())}),i6=v.object({method:v.literal("eth_newPendingTransactionFilter")}),o6=v.object({method:v.literal("eth_sendRawTransaction"),params:v.array(v.any())}),a6=v.object({method:v.literal("eth_syncing"),params:v.array(v.any())}),c6=v.object({method:v.literal("eth_uninstallFilter"),params:v.array(v.any())}),km=v.object({method:v.literal("personal_sign"),params:v.array(v.any())}),l6=v.object({method:v.literal("eth_signTypedData_v4"),params:v.array(v.any())}),u6=v.object({method:v.literal("eth_sendTransaction"),params:v.array(v.any())}),d6=v.object({method:v.literal("solana_signMessage"),params:v.object({message:v.string(),pubkey:v.string()})}),f6=v.object({method:v.literal("solana_signTransaction"),params:v.object({transaction:v.string()})}),h6=v.object({method:v.literal("solana_signAllTransactions"),params:v.object({transactions:v.array(v.string())})}),p6=v.object({method:v.literal("solana_signAndSendTransaction"),params:v.object({transaction:v.string(),options:v.object({skipPreflight:v.boolean().optional(),preflightCommitment:v.enum(["processed","confirmed","finalized","recent","single","singleGossip","root","max"]).optional(),maxRetries:v.number().optional(),minContextSlot:v.number().optional()}).optional()})}),g6=v.object({method:v.literal("wallet_sendCalls"),params:v.array(v.object({chainId:v.string().or(v.number()).optional(),from:v.string().optional(),version:v.string().optional(),capabilities:v.any().optional(),calls:v.array(v.object({to:v.string().startsWith("0x"),data:v.string().startsWith("0x").optional(),value:v.string().optional()}))}))}),m6=v.object({method:v.literal("wallet_getCallsStatus"),params:v.array(v.string())}),y6=v.object({method:v.literal("wallet_getCapabilities"),params:v.array(v.string().or(v.number()).optional()).optional()}),b6=v.object({method:v.literal("wallet_grantPermissions"),params:v.array(v.any())}),w6=v.object({method:v.literal("wallet_revokePermissions"),params:v.any()}),E6=v.object({method:v.literal("wallet_getAssets"),params:v.any()}),Dm=v.object({token:v.string()}),ae=v.object({id:v.string().optional()}),Bf={appEvent:ae.extend({type:oe("APP_SWITCH_NETWORK"),payload:n5}).or(ae.extend({type:oe("APP_CONNECT_EMAIL"),payload:r5})).or(ae.extend({type:oe("APP_CONNECT_DEVICE")})).or(ae.extend({type:oe("APP_CONNECT_OTP"),payload:s5})).or(ae.extend({type:oe("APP_CONNECT_SOCIAL"),payload:i5})).or(ae.extend({type:oe("APP_GET_FARCASTER_URI")})).or(ae.extend({type:oe("APP_CONNECT_FARCASTER")})).or(ae.extend({type:oe("APP_GET_USER"),payload:v.optional(o5)})).or(ae.extend({type:oe("APP_GET_SOCIAL_REDIRECT_URI"),payload:a5})).or(ae.extend({type:oe("APP_SIGN_OUT")})).or(ae.extend({type:oe("APP_IS_CONNECTED"),payload:v.optional(Dm)})).or(ae.extend({type:oe("APP_GET_CHAIN_ID")})).or(ae.extend({type:oe("APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS")})).or(ae.extend({type:oe("APP_INIT_SMART_ACCOUNT")})).or(ae.extend({type:oe("APP_SET_PREFERRED_ACCOUNT"),payload:h5})).or(ae.extend({type:oe("APP_RPC_REQUEST"),payload:km.or(E6).or(T5).or(O5).or(R5).or(P5).or(k5).or(D5).or($5).or(U5).or(B5).or(L5).or(M5).or(F5).or(j5).or(H5).or(W5).or(z5).or(q5).or(V5).or(K5).or(G5).or(Y5).or(Z5).or(J5).or(X5).or(Q5).or(e6).or(t6).or(n6).or(r6).or(s6).or(i6).or(o6).or(a6).or(c6).or(km).or(l6).or(u6).or(d6).or(f6).or(h6).or(p6).or(m6).or(g6).or(y6).or(b6).or(w6).and(v.object({chainId:v.string().or(v.number()).optional(),chainNamespace:v.enum(["eip155","solana","polkadot","bip122","cosmos"]).optional(),rpcUrl:v.string().optional()}))})).or(ae.extend({type:oe("APP_UPDATE_EMAIL"),payload:c5})).or(ae.extend({type:oe("APP_UPDATE_EMAIL_PRIMARY_OTP"),payload:l5})).or(ae.extend({type:oe("APP_UPDATE_EMAIL_SECONDARY_OTP"),payload:u5})).or(ae.extend({type:oe("APP_SYNC_THEME"),payload:d5})).or(ae.extend({type:oe("APP_SYNC_DAPP_DATA"),payload:f5})).or(ae.extend({type:oe("APP_RELOAD")})).or(ae.extend({type:oe("APP_RPC_ABORT")})),frameEvent:ae.extend({type:oe("FRAME_SWITCH_NETWORK_ERROR"),payload:ot}).or(ae.extend({type:oe("FRAME_SWITCH_NETWORK_SUCCESS"),payload:_5})).or(ae.extend({type:oe("FRAME_CONNECT_EMAIL_SUCCESS"),payload:p5})).or(ae.extend({type:oe("FRAME_CONNECT_EMAIL_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_GET_FARCASTER_URI_SUCCESS"),payload:g5})).or(ae.extend({type:oe("FRAME_GET_FARCASTER_URI_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_CONNECT_FARCASTER_SUCCESS"),payload:m5})).or(ae.extend({type:oe("FRAME_CONNECT_FARCASTER_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_CONNECT_OTP_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_CONNECT_OTP_SUCCESS")})).or(ae.extend({type:oe("FRAME_CONNECT_DEVICE_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_CONNECT_DEVICE_SUCCESS")})).or(ae.extend({type:oe("FRAME_CONNECT_SOCIAL_SUCCESS"),payload:y5})).or(ae.extend({type:oe("FRAME_CONNECT_SOCIAL_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_GET_USER_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_GET_USER_SUCCESS"),payload:w5})).or(ae.extend({type:oe("FRAME_GET_SOCIAL_REDIRECT_URI_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS"),payload:E5})).or(ae.extend({type:oe("FRAME_SIGN_OUT_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_SIGN_OUT_SUCCESS")})).or(ae.extend({type:oe("FRAME_IS_CONNECTED_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_IS_CONNECTED_SUCCESS"),payload:v5})).or(ae.extend({type:oe("FRAME_GET_CHAIN_ID_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_GET_CHAIN_ID_SUCCESS"),payload:C5})).or(ae.extend({type:oe("FRAME_RPC_REQUEST_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_RPC_REQUEST_SUCCESS"),payload:N5})).or(ae.extend({type:oe("FRAME_SESSION_UPDATE"),payload:Dm})).or(ae.extend({type:oe("FRAME_UPDATE_EMAIL_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_UPDATE_EMAIL_SUCCESS"),payload:b5})).or(ae.extend({type:oe("FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS")})).or(ae.extend({type:oe("FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS"),payload:A5})).or(ae.extend({type:oe("FRAME_SYNC_THEME_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_SYNC_THEME_SUCCESS")})).or(ae.extend({type:oe("FRAME_SYNC_DAPP_DATA_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_SYNC_DAPP_DATA_SUCCESS")})).or(ae.extend({type:oe("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS"),payload:I5})).or(ae.extend({type:oe("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_INIT_SMART_ACCOUNT_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_SET_PREFERRED_ACCOUNT_SUCCESS"),payload:x5})).or(ae.extend({type:oe("FRAME_SET_PREFERRED_ACCOUNT_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_READY"),payload:S5})).or(ae.extend({type:oe("FRAME_RELOAD_ERROR"),payload:ot})).or(ae.extend({type:oe("FRAME_RELOAD_SUCCESS")}))};function Lf(t,e={}){var n;return typeof(e==null?void 0:e.type)=="string"&&((n=e==null?void 0:e.type)==null?void 0:n.includes(t))}function v6({projectId:t,chainId:e,enableLogger:n,rpcUrl:r=B.BLOCKCHAIN_API_RPC_URL,enableCloudAuthAccount:s=!1}){const i=new URL(tS);i.searchParams.set("projectId",t),i.searchParams.set("chainId",String(e)),i.searchParams.set("version",rS),i.searchParams.set("enableLogger",String(n)),i.searchParams.set("rpcUrl",r);const o=Ct.get("dapp_smart_account_version");return o&&(o==="v6"||o==="v7")&&(console.warn(">> AppKit - Forcing smart account version",o),i.searchParams.set("smartAccountVersion",o)),s&&i.searchParams.set("enableCloudAuthAccount","true"),i.toString()}class C6{constructor({projectId:e,isAppClient:n=!1,chainId:r="eip155:1",enableLogger:s=!0,enableCloudAuthAccount:i=!1,rpcUrl:o=B.BLOCKCHAIN_API_RPC_URL}){if(this.iframe=null,this.iframeIsReady=!1,this.initFrame=()=>{const a=document.getElementById("w3m-iframe");this.iframe&&!a&&document.body.appendChild(this.iframe)},this.events={registerFrameEventHandler:(a,c,l)=>{function u({data:d}){var h;if(!Lf(ue.FRAME_EVENT_KEY,d))return;const f=Bf.frameEvent.safeParse(d);if(!f.success){console.warn("W3mFrame: invalid frame event",f.error.message);return}((h=f.data)==null?void 0:h.id)===a&&(c(f.data),window.removeEventListener("message",u))}Hn.isClient&&(window.addEventListener("message",u),l.addEventListener("abort",()=>{window.removeEventListener("message",u)}))},onFrameEvent:a=>{Hn.isClient&&window.addEventListener("message",({data:c})=>{if(!Lf(ue.FRAME_EVENT_KEY,c))return;const l=Bf.frameEvent.safeParse(c);l.success?a(l.data):console.warn("W3mFrame: invalid frame event",l.error.message)})},onAppEvent:a=>{Hn.isClient&&window.addEventListener("message",({data:c})=>{if(!Lf(ue.APP_EVENT_KEY,c))return;const l=Bf.appEvent.safeParse(c);l.success||console.warn("W3mFrame: invalid app event",l.error.message),a(c)})},postAppEvent:a=>{var c;if(Hn.isClient){if(!((c=this.iframe)!=null&&c.contentWindow))throw new Error("W3mFrame: iframe is not set");this.iframe.contentWindow.postMessage(a,"*")}},postFrameEvent:a=>{if(Hn.isClient){if(!parent)throw new Error("W3mFrame: parent is not set");parent.postMessage(a,"*")}}},this.projectId=e,this.frameLoadPromise=new Promise((a,c)=>{this.frameLoadPromiseResolver={resolve:a,reject:c}}),this.rpcUrl=o,n&&(this.frameLoadPromise=new Promise((a,c)=>{this.frameLoadPromiseResolver={resolve:a,reject:c}}),Hn.isClient)){const a=document.createElement("iframe");a.id="w3m-iframe",a.src=v6({projectId:e,chainId:r,enableLogger:s,rpcUrl:this.rpcUrl,enableCloudAuthAccount:i}),a.name="w3m-secure-iframe",a.style.position="fixed",a.style.zIndex="999999",a.style.display="none",a.style.border="none",a.style.animationDelay="0s, 50ms",a.style.borderBottomLeftRadius="clamp(0px, var(--apkt-borderRadius-8), 44px)",a.style.borderBottomRightRadius="clamp(0px, var(--apkt-borderRadius-8), 44px)",this.iframe=a,this.iframe.onerror=()=>{var c;(c=this.frameLoadPromiseResolver)==null||c.reject("Unable to load email login dependency")},this.events.onFrameEvent(c=>{var l;c.type==="@w3m-frame/READY"&&(this.iframeIsReady=!0,(l=this.frameLoadPromiseResolver)==null||l.resolve(void 0))})}}get networks(){const e=["eip155:1","eip155:5","eip155:11155111","eip155:10","eip155:420","eip155:42161","eip155:421613","eip155:137","eip155:80001","eip155:42220","eip155:1313161554","eip155:1313161555","eip155:56","eip155:97","eip155:43114","eip155:43113","eip155:324","eip155:280","eip155:100","eip155:8453","eip155:84531","eip155:84532","eip155:7777777","eip155:999","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"].map(n=>({[n]:{rpcUrl:`${this.rpcUrl}/v1/?chainId=${n}&projectId=${this.projectId}`,chainId:n}}));return Object.assign({},...e)}}var Vd={exports:{}};function _6(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var A6=I6;function I6(t,e,n){var r=n&&n.stringify||_6,s=1;if(typeof t=="object"&&t!==null){var i=e.length+s;if(i===1)return t;var o=new Array(i);o[0]=r(t);for(var a=1;a<i;a++)o[a]=r(e[a]);return o.join(" ")}if(typeof t!="string")return t;var c=e.length;if(c===0)return t;for(var l="",u=1-s,d=-1,f=t&&t.length||0,h=0;h<f;){if(t.charCodeAt(h)===37&&h+1<f){switch(d=d>-1?d:0,t.charCodeAt(h+1)){case 100:case 102:if(u>=c||e[u]==null)break;d<h&&(l+=t.slice(d,h)),l+=Number(e[u]),d=h+2,h++;break;case 105:if(u>=c||e[u]==null)break;d<h&&(l+=t.slice(d,h)),l+=Math.floor(Number(e[u])),d=h+2,h++;break;case 79:case 111:case 106:if(u>=c||e[u]===void 0)break;d<h&&(l+=t.slice(d,h));var p=typeof e[u];if(p==="string"){l+="'"+e[u]+"'",d=h+2,h++;break}if(p==="function"){l+=e[u].name||"<anonymous>",d=h+2,h++;break}l+=r(e[u]),d=h+2,h++;break;case 115:if(u>=c)break;d<h&&(l+=t.slice(d,h)),l+=String(e[u]),d=h+2,h++;break;case 37:d<h&&(l+=t.slice(d,h)),l+="%",d=h+2,h++,u--;break}++u}++h}return d===-1?t:(d<f&&(l+=t.slice(d)),l)}const $m=A6;Vd.exports=Ps;const jc=F6().console||{},S6={mapHttpRequest:Yl,mapHttpResponse:Yl,wrapRequestSerializer:Mf,wrapResponseSerializer:Mf,wrapErrorSerializer:Mf,req:Yl,res:Yl,err:Bm,errWithCause:Bm};function pi(t,e){return t==="silent"?1/0:e.levels.values[t]}const z0=Symbol("pino.logFuncs"),yp=Symbol("pino.hierarchy"),x6={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function Um(t,e){const n={logger:e,parent:t[yp]};e[yp]=n}function N6(t,e,n){const r={};e.forEach(s=>{r[s]=n[s]?n[s]:jc[s]||jc[x6[s]||"log"]||na}),t[z0]=r}function T6(t,e){return Array.isArray(t)?t.filter(function(r){return r!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function Ps(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const n=t.browser.write||jc;t.browser.write&&(t.browser.asObject=!0);const r=t.serializers||{},s=T6(t.browser.serialize,r);let i=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(i=!1);const o=Object.keys(t.customLevels||{}),a=["error","fatal","warn","info","debug","trace"].concat(o);typeof n=="function"&&a.forEach(function(g){n[g]=n}),(t.enabled===!1||t.browser.disabled)&&(t.level="silent");const c=t.level||"info",l=Object.create(n);l.log||(l.log=na),N6(l,a,n),Um({},l),Object.defineProperty(l,"levelVal",{get:d}),Object.defineProperty(l,"level",{get:f,set:h});const u={transmit:e,serialize:s,asObject:t.browser.asObject,asObjectBindingsOnly:t.browser.asObjectBindingsOnly,formatters:t.browser.formatters,levels:a,timestamp:B6(t),messageKey:t.messageKey||"msg",onChild:t.onChild||na};l.levels=O6(t),l.level=c,l.isLevelEnabled=function(g){return this.levels.values[g]?this.levels.values[g]>=this.levels.values[this.level]:!1},l.setMaxListeners=l.getMaxListeners=l.emit=l.addListener=l.on=l.prependListener=l.once=l.prependOnceListener=l.removeListener=l.removeAllListeners=l.listeners=l.listenerCount=l.eventNames=l.write=l.flush=na,l.serializers=r,l._serialize=s,l._stdErrSerialize=i,l.child=function(...g){return p.call(this,u,...g)},e&&(l._logEvent=bp());function d(){return pi(this.level,this)}function f(){return this._level}function h(g){if(g!=="silent"&&!this.levels.values[g])throw Error("unknown level "+g);this._level=g,Di(this,u,l,"error"),Di(this,u,l,"fatal"),Di(this,u,l,"warn"),Di(this,u,l,"info"),Di(this,u,l,"debug"),Di(this,u,l,"trace"),o.forEach(m=>{Di(this,u,l,m)})}function p(g,m,E){if(!m)throw new Error("missing bindings for child Pino");E=E||{},s&&m.serializers&&(E.serializers=m.serializers);const A=E.serializers;if(s&&A){var b=Object.assign({},r,A),_=t.browser.serialize===!0?Object.keys(b):s;delete m.serializers,q0([m],_,b,this._stdErrSerialize)}function C(x){this._childLevel=(x._childLevel|0)+1,this.bindings=m,b&&(this.serializers=b,this._serialize=_),e&&(this._logEvent=bp([].concat(x._logEvent.bindings,m)))}C.prototype=this;const S=new C(this);return Um(this,S),S.child=function(...x){return p.call(this,g,...x)},S.level=E.level||this.level,g.onChild(S),S}return l}function O6(t){const e=t.customLevels||{},n=Object.assign({},Ps.levels.values,e),r=Object.assign({},Ps.levels.labels,R6(e));return{values:n,labels:r}}function R6(t){const e={};return Object.keys(t).forEach(function(n){e[t[n]]=n}),e}Ps.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};Ps.stdSerializers=S6;Ps.stdTimeFunctions=Object.assign({},{nullTime:EE,epochTime:vE,unixTime:L6,isoTime:M6});function P6(t){const e=[];t.bindings&&e.push(t.bindings);let n=t[yp];for(;n.parent;)n=n.parent,n.logger.bindings&&e.push(n.logger.bindings);return e.reverse()}function Di(t,e,n,r){if(Object.defineProperty(t,r,{value:pi(t.level,n)>pi(r,n)?na:n[z0][r],writable:!0,enumerable:!0,configurable:!0}),t[r]===na){if(!e.transmit)return;const i=e.transmit.level||t.level,o=pi(i,n);if(pi(r,n)<o)return}t[r]=D6(t,e,n,r);const s=P6(t);s.length!==0&&(t[r]=k6(s,t[r]))}function k6(t,e){return function(){return e.apply(this,[...t,...arguments])}}function D6(t,e,n,r){return function(s){return function(){const o=e.timestamp(),a=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===jc?jc:this;for(var l=0;l<a.length;l++)a[l]=arguments[l];var u=!1;if(e.serialize&&(q0(a,this._serialize,this.serializers,this._stdErrSerialize),u=!0),e.asObject||e.formatters?s.call(c,...$6(this,r,a,o,e)):s.apply(c,a),e.transmit){const d=e.transmit.level||t._level,f=pi(d,n),h=pi(r,n);if(h<f)return;U6(this,{ts:o,methodLevel:r,methodValue:h,transmitValue:n.levels.values[e.transmit.level||t._level],send:e.transmit.send,val:pi(t._level,n)},a,u)}}}(t[z0][r])}function $6(t,e,n,r,s){const{level:i,log:o=d=>d}=s.formatters||{},a=n.slice();let c=a[0];const l={};let u=(t._childLevel|0)+1;if(u<1&&(u=1),r&&(l.time=r),i){const d=i(e,t.levels.values[e]);Object.assign(l,d)}else l.level=t.levels.values[e];if(s.asObjectBindingsOnly){if(c!==null&&typeof c=="object")for(;u--&&typeof a[0]=="object";)Object.assign(l,a.shift());return[o(l),...a]}else{if(c!==null&&typeof c=="object"){for(;u--&&typeof a[0]=="object";)Object.assign(l,a.shift());c=a.length?$m(a.shift(),a):void 0}else typeof c=="string"&&(c=$m(a.shift(),a));return c!==void 0&&(l[s.messageKey]=c),[o(l)]}}function q0(t,e,n,r){for(const s in t)if(r&&t[s]instanceof Error)t[s]=Ps.stdSerializers.err(t[s]);else if(typeof t[s]=="object"&&!Array.isArray(t[s])&&e)for(const i in t[s])e.indexOf(i)>-1&&i in n&&(t[s][i]=n[i](t[s][i]))}function U6(t,e,n,r=!1){const s=e.send,i=e.ts,o=e.methodLevel,a=e.methodValue,c=e.val,l=t._logEvent.bindings;r||q0(n,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=i,t._logEvent.messages=n.filter(function(u){return l.indexOf(u)===-1}),t._logEvent.level.label=o,t._logEvent.level.value=a,s(o,t._logEvent,c),t._logEvent=bp(l)}function bp(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function Bm(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const n in t)e[n]===void 0&&(e[n]=t[n]);return e}function B6(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?EE:vE}function Yl(){return{}}function Mf(t){return t}function na(){}function EE(){return!1}function vE(){return Date.now()}function L6(){return Math.round(Date.now()/1e3)}function M6(){return new Date(Date.now()).toISOString()}function F6(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}Vd.exports.default=Ps;Vd.exports.pino=Ps;var Go=Vd.exports;const CE=Hd(Go),j6=t=>JSON.stringify(t,(e,n)=>typeof n=="bigint"?n.toString()+"n":n),H6=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,n=t.replace(e,'$1"$2n"$3');return JSON.parse(n,(r,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function po(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return H6(t)}catch{return t}}function ks(t){return typeof t=="string"?t:j6(t)||""}const W6={level:"info"},Kd="custom_context",V0=1e3*1024;var z6=Object.defineProperty,q6=(t,e,n)=>e in t?z6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,li=(t,e,n)=>q6(t,typeof e!="symbol"?e+"":e,n);let V6=class{constructor(e){li(this,"nodeValue"),li(this,"sizeInBytes"),li(this,"next"),this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},Lm=class{constructor(e){li(this,"lengthInNodes"),li(this,"sizeInBytes"),li(this,"head"),li(this,"tail"),li(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const n=new V6(e);if(n.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${n.size}`);for(;this.size+n.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=n),this.tail=n):(this.head=n,this.tail=n),this.lengthInNodes++,this.sizeInBytes+=n.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let n=this.head;for(;n!==null;)e.push(n.value),n=n.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const n=e.value;return e=e.next,{done:!1,value:n}}}}};var K6=Object.defineProperty,G6=(t,e,n)=>e in t?K6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Zl=(t,e,n)=>G6(t,typeof e!="symbol"?e+"":e,n);let _E=class{constructor(e,n=V0){Zl(this,"logs"),Zl(this,"level"),Zl(this,"levelValue"),Zl(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=e??"error",this.levelValue=Go.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=n,this.logs=new Lm(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,n){n===Go.levels.values.error?console.error(e):n===Go.levels.values.warn?console.warn(e):n===Go.levels.values.debug?console.debug(e):n===Go.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(ks({timestamp:new Date().toISOString(),log:e}));const n=typeof e=="string"?JSON.parse(e).level:e.level;n>=this.levelValue&&this.forwardToConsole(e,n)}getLogs(){return this.logs}clearLogs(){this.logs=new Lm(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const n=this.getLogArray();return n.push(ks({extraMetadata:e})),new Blob(n,{type:"application/json"})}};var Y6=Object.defineProperty,Z6=(t,e,n)=>e in t?Y6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,J6=(t,e,n)=>Z6(t,e+"",n);let X6=class{constructor(e,n=V0){J6(this,"baseChunkLogger"),this.baseChunkLogger=new _E(e,n)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const n=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=n,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}};var Q6=Object.defineProperty,ex=(t,e,n)=>e in t?Q6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,tx=(t,e,n)=>ex(t,e+"",n);let nx=class{constructor(e,n=V0){tx(this,"baseChunkLogger"),this.baseChunkLogger=new _E(e,n)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var rx=Object.defineProperty,sx=Object.defineProperties,ix=Object.getOwnPropertyDescriptors,Mm=Object.getOwnPropertySymbols,ox=Object.prototype.hasOwnProperty,ax=Object.prototype.propertyIsEnumerable,Fm=(t,e,n)=>e in t?rx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ld=(t,e)=>{for(var n in e||(e={}))ox.call(e,n)&&Fm(t,n,e[n]);if(Mm)for(var n of Mm(e))ax.call(e,n)&&Fm(t,n,e[n]);return t},ud=(t,e)=>sx(t,ix(e));function K0(t){return ud(ld({},t),{level:(t==null?void 0:t.level)||W6.level})}function cx(t,e,n=Kd){return t[n]=e,t}function Tn(t,e=Kd){return t[e]||""}function lx(t,e,n=Kd){const r=Tn(t,n);return r.trim()?`${r}/${e}`:e}function On(t,e,n=Kd){const r=lx(t,e,n),s=t.child({context:r});return cx(s,r,n)}function ux(t){var e,n;const r=new X6((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:CE(ud(ld({},t.opts),{level:"trace",browser:ud(ld({},(n=t.opts)==null?void 0:n.browser),{write:s=>r.write(s)})})),chunkLoggerController:r}}function dx(t){var e;const n=new nx((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:CE(ud(ld({},t.opts),{level:"trace"}),n),chunkLoggerController:n}}function Gd(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?ux(t):dx(t)}class fx{constructor(e){var i;const n=K0({level:nS}),{logger:r,chunkLoggerController:s}=Gd({opts:n});this.logger=On(r,this.constructor.name),this.chunkLoggerController=s,typeof window<"u"&&((i=this.chunkLoggerController)!=null&&i.downloadLogsBlobInBrowser)&&(window.downloadAppKitLogsBlob||(window.downloadAppKitLogsBlob={}),window.downloadAppKitLogsBlob.sdk=()=>{var o;(o=this.chunkLoggerController)!=null&&o.downloadLogsBlobInBrowser&&this.chunkLoggerController.downloadLogsBlobInBrowser({projectId:e})})}}class hx{constructor({projectId:e,chainId:n,enableLogger:r=!0,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a,enableCloudAuthAccount:c,metadata:l,sdkVersion:u,sdkType:d}){this.openRpcRequests=new Map,this.isInitialized=!1,r&&(this.w3mLogger=new fx(e)),this.abortController=i,this.getActiveCaipNetwork=o,this.getCaipNetworks=a;const f=this.getRpcUrl(n);this.projectId=e,this.sdkVersion=u,this.sdkType=d,this.metadata=l,this.w3mFrame=new C6({projectId:e,isAppClient:!0,chainId:n,enableLogger:r,rpcUrl:f,enableCloudAuthAccount:c}),this.onTimeout=s,this.getLoginEmailUsed()&&this.createFrame()}async createFrame(){this.w3mFrame.initFrame(),this.initPromise=new Promise(e=>{this.w3mFrame.events.onFrameEvent(n=>{n.type===ue.FRAME_READY&&setTimeout(()=>{e()},500)})}),await this.initPromise,await this.syncDappData({metadata:this.metadata,projectId:this.projectId,sdkVersion:this.sdkVersion,sdkType:this.sdkType}),await this.getSmartAccountEnabledNetworks(),this.isInitialized=!0,this.initPromise=void 0}async init(){if(!this.isInitialized){if(this.initPromise){await this.initPromise;return}await this.createFrame()}}getLoginEmailUsed(){return!!Ct.get(ue.EMAIL_LOGIN_USED_KEY)}getEmail(){return Ct.get(ue.EMAIL)}getUsername(){return Ct.get(ue.SOCIAL_USERNAME)}async reload(){var e;try{await this.appEvent({type:ue.APP_RELOAD})}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error reloading iframe"),n}}async connectEmail(e){var n;try{Hn.checkIfAllowedToTriggerEmail(),await this.init();const r=await this.appEvent({type:ue.APP_CONNECT_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),r}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error connecting email"),r}}async connectDevice(){var e;try{return this.appEvent({type:ue.APP_CONNECT_DEVICE})}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error connecting device"),n}}async connectOtp(e){var n;try{return this.appEvent({type:ue.APP_CONNECT_OTP,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error connecting otp"),r}}async isConnected(){var e;try{if(!this.getLoginEmailUsed())return{isConnected:!1};const n=await this.appEvent({type:ue.APP_IS_CONNECTED});return n!=null&&n.isConnected||this.deleteAuthLoginCache(),n}catch(n){throw this.deleteAuthLoginCache(),(e=this.w3mLogger)==null||e.logger.error({error:n},"Error checking connection"),n}}async getChainId(){var e;try{const n=await this.appEvent({type:ue.APP_GET_CHAIN_ID});return this.setLastUsedChainId(n.chainId),n}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error getting chain id"),n}}async getSocialRedirectUri(e){var n;try{return await this.init(),this.appEvent({type:ue.APP_GET_SOCIAL_REDIRECT_URI,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error getting social redirect uri"),r}}async updateEmail(e){var n;try{const r=await this.appEvent({type:ue.APP_UPDATE_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),r}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error updating email"),r}}async updateEmailPrimaryOtp(e){var n;try{return this.appEvent({type:ue.APP_UPDATE_EMAIL_PRIMARY_OTP,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error updating email primary otp"),r}}async updateEmailSecondaryOtp(e){var n;try{const r=await this.appEvent({type:ue.APP_UPDATE_EMAIL_SECONDARY_OTP,payload:e});return this.setLoginSuccess(r.newEmail),r}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error updating email secondary otp"),r}}async syncTheme(e){var n;try{return this.appEvent({type:ue.APP_SYNC_THEME,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error syncing theme"),r}}async syncDappData(e){var n;try{return this.appEvent({type:ue.APP_SYNC_DAPP_DATA,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error syncing dapp data"),r}}async getSmartAccountEnabledNetworks(){var e;try{const n=await this.appEvent({type:ue.APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS});return this.persistSmartAccountEnabledNetworks(n.smartAccountEnabledNetworks),n}catch(n){throw this.persistSmartAccountEnabledNetworks([]),(e=this.w3mLogger)==null||e.logger.error({error:n},"Error getting smart account enabled networks"),n}}async setPreferredAccount(e){var n;try{return this.appEvent({type:ue.APP_SET_PREFERRED_ACCOUNT,payload:{type:e}})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error setting preferred account"),r}}async connect(e){var n,r;if(e!=null&&e.socialUri)try{await this.init();const s=this.getRpcUrl(e.chainId),i=await this.appEvent({type:ue.APP_CONNECT_SOCIAL,payload:{uri:e.socialUri,preferredAccountType:e.preferredAccountType,chainId:e.chainId,siwxMessage:e.siwxMessage,rpcUrl:s}});return i.userName&&this.setSocialLoginSuccess(i.userName),this.setLoginSuccess(i.email),this.setLastUsedChainId(i.chainId),this.user=i,i}catch(s){throw(n=this.w3mLogger)==null||n.logger.error({error:s},"Error connecting social"),s}else try{const s=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,i=await this.getUser({chainId:s,preferredAccountType:e==null?void 0:e.preferredAccountType,siwxMessage:e==null?void 0:e.siwxMessage,rpcUrl:this.getRpcUrl(s)});return this.setLoginSuccess(i.email),this.setLastUsedChainId(i.chainId),this.user=i,i}catch(s){throw(r=this.w3mLogger)==null||r.logger.error({error:s},"Error connecting"),s}}async getUser(e){var n;try{await this.init();const r=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,s=await this.appEvent({type:ue.APP_GET_USER,payload:{...e,chainId:r,rpcUrl:this.getRpcUrl(r)}});return this.user=s,s}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error connecting"),r}}async connectSocial({uri:e,chainId:n,preferredAccountType:r}){var s;try{await this.init();const i=this.getRpcUrl(n),o=await this.appEvent({type:ue.APP_CONNECT_SOCIAL,payload:{uri:e,chainId:n,rpcUrl:i,preferredAccountType:r}});return o.userName&&this.setSocialLoginSuccess(o.userName),o}catch(i){throw(s=this.w3mLogger)==null||s.logger.error({error:i},"Error connecting social"),i}}async getFarcasterUri(){var e;try{return await this.init(),await this.appEvent({type:ue.APP_GET_FARCASTER_URI})}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error getting farcaster uri"),n}}async connectFarcaster(){var e;try{const n=await this.appEvent({type:ue.APP_CONNECT_FARCASTER});return n.userName&&this.setSocialLoginSuccess(n.userName),n}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error connecting farcaster"),n}}async switchNetwork({chainId:e}){var n;try{const r=this.getRpcUrl(e),s=await this.appEvent({type:ue.APP_SWITCH_NETWORK,payload:{chainId:e,rpcUrl:r}});return this.setLastUsedChainId(s.chainId),s}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error switching network"),r}}async disconnect(){var e;try{return this.deleteAuthLoginCache(),await new Promise(async r=>{const s=setTimeout(()=>{r()},3e3);await this.appEvent({type:ue.APP_SIGN_OUT}),clearTimeout(s),r()})}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error disconnecting"),n}}async request(e){var r,s,i,o,a;const n=e;try{if(ft.GET_CHAIN_ID===e.method)return this.getLastUsedChainId();const c=e.chainNamespace||"eip155",l=(r=this.getActiveCaipNetwork(c))==null?void 0:r.id;n.chainNamespace=c,n.chainId=l,n.rpcUrl=this.getRpcUrl(l),(s=this.rpcRequestHandler)==null||s.call(this,e);const u=await this.appEvent({type:ue.APP_RPC_REQUEST,payload:n});return(i=this.rpcSuccessHandler)==null||i.call(this,u,n),u}catch(c){throw(o=this.rpcErrorHandler)==null||o.call(this,c,n),(a=this.w3mLogger)==null||a.logger.error({error:c},"Error requesting"),c}}onRpcRequest(e){this.rpcRequestHandler=e}onRpcSuccess(e){this.rpcSuccessHandler=e}onRpcError(e){this.rpcErrorHandler=e}onIsConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===ue.FRAME_IS_CONNECTED_SUCCESS&&n.payload.isConnected&&e()})}onNotConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===ue.FRAME_IS_CONNECTED_ERROR&&e(),n.type===ue.FRAME_IS_CONNECTED_SUCCESS&&!n.payload.isConnected&&e()})}onConnect(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===ue.FRAME_GET_USER_SUCCESS&&e(n.payload)})}onSocialConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===ue.FRAME_CONNECT_SOCIAL_SUCCESS&&e(n.payload)})}async getCapabilities(){try{return await this.request({method:"wallet_getCapabilities"})||{}}catch{return{}}}onSetPreferredAccount(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===ue.FRAME_SET_PREFERRED_ACCOUNT_SUCCESS?e(n.payload):n.type===ue.FRAME_SET_PREFERRED_ACCOUNT_ERROR&&e({type:ft.ACCOUNT_TYPES.EOA})})}getAvailableChainIds(){return Object.keys(this.w3mFrame.networks)}async rejectRpcRequests(){var e;try{await Promise.all(Array.from(this.openRpcRequests.values()).map(async({abortController:n,method:r})=>{ft.SAFE_RPC_METHODS.includes(r)||n.abort(),await this.appEvent({type:ue.APP_RPC_ABORT})})),this.openRpcRequests.clear()}catch(n){(e=this.w3mLogger)==null||e.logger.error({error:n},"Error aborting RPC request")}}async appEvent(e){let n,r;function s(c){return c.replace("@w3m-app/","")}const i=[ue.APP_SYNC_DAPP_DATA,ue.APP_SYNC_THEME,ue.APP_SET_PREFERRED_ACCOUNT],o=s(e.type);return!this.w3mFrame.iframeIsReady&&!i.includes(e.type)&&(r=setTimeout(()=>{var c;(c=this.onTimeout)==null||c.call(this,"iframe_load_failed"),this.abortController.abort()},2e4)),await this.w3mFrame.frameLoadPromise,clearTimeout(r),[ue.APP_CONNECT_EMAIL,ue.APP_CONNECT_DEVICE,ue.APP_CONNECT_OTP,ue.APP_CONNECT_SOCIAL,ue.APP_GET_SOCIAL_REDIRECT_URI].map(s).includes(o)&&(n=setTimeout(()=>{var c;(c=this.onTimeout)==null||c.call(this,"iframe_request_timeout"),this.abortController.abort()},12e4)),new Promise((c,l)=>{var h,p,g;const u=Math.random().toString(36).substring(7);(g=(h=this.w3mLogger)==null?void 0:(p=h.logger).info)==null||g.call(p,{event:e,id:u},"Sending app event"),this.w3mFrame.events.postAppEvent({...e,id:u});const d=new AbortController;if(o==="RPC_REQUEST"){const m=e;this.openRpcRequests.set(u,{...m.payload,abortController:d})}d.signal.addEventListener("abort",()=>{o==="RPC_REQUEST"?l(new Error("Request was aborted")):o!=="GET_FARCASTER_URI"&&l(new Error("Something went wrong"))});const f=(m,E)=>{var A,b,_;m.id===u&&((b=E==null?void 0:(A=E.logger).info)==null||b.call(A,{framEvent:m,id:u},"Received frame response"),this.openRpcRequests.delete(m.id),m.type===`@w3m-frame/${o}_SUCCESS`?(n&&clearTimeout(n),r&&clearTimeout(r),"payload"in m&&c(m.payload),c(void 0)):m.type===`@w3m-frame/${o}_ERROR`&&(n&&clearTimeout(n),r&&clearTimeout(r),"payload"in m&&l(new Error(((_=m.payload)==null?void 0:_.message)||"An error occurred")),l(new Error("An error occurred"))))};this.w3mFrame.events.registerFrameEventHandler(u,m=>f(m,this.w3mLogger),this.abortController.signal)})}setNewLastEmailLoginTime(){Ct.set(ue.LAST_EMAIL_LOGIN_TIME,Date.now().toString())}setSocialLoginSuccess(e){Ct.set(ue.SOCIAL_USERNAME,e)}setLoginSuccess(e){e&&Ct.set(ue.EMAIL,e),Ct.set(ue.EMAIL_LOGIN_USED_KEY,"true"),Ct.delete(ue.LAST_EMAIL_LOGIN_TIME)}deleteAuthLoginCache(){Ct.delete(ue.EMAIL_LOGIN_USED_KEY),Ct.delete(ue.EMAIL),Ct.delete(ue.LAST_USED_CHAIN_KEY),Ct.delete(ue.SOCIAL_USERNAME)}setLastUsedChainId(e){e&&Ct.set(ue.LAST_USED_CHAIN_KEY,String(e))}getLastUsedChainId(){const e=Ct.get(ue.LAST_USED_CHAIN_KEY)??void 0,n=Number(e);return isNaN(n)?e:n}persistSmartAccountEnabledNetworks(e){Ct.set(ue.SMART_ACCOUNT_ENABLED_NETWORKS,e.join(","))}getRpcUrl(e){var i,o;let n=e===void 0?void 0:"eip155";typeof e=="string"&&(e.includes(":")?n=(i=It.parseCaipNetworkId(e))==null?void 0:i.chainNamespace:Number.isInteger(Number(e))?n="eip155":n="solana");const r=this.getCaipNetworks(n),s=e?r.find(a=>String(a.id)===String(e)||a.caipNetworkId===e):r[0];return(o=s==null?void 0:s.rpcUrls.default.http)==null?void 0:o[0]}}const px="1.2.3";let Rn=class wp extends Error{constructor(e,n={}){var o;const r=n.cause instanceof wp?n.cause.details:(o=n.cause)!=null&&o.message?n.cause.message:n.details,s=n.cause instanceof wp&&n.cause.docsPath||n.docsPath,i=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...s?[`Docs: https://abitype.dev${s}`]:[],...r?[`Details: ${r}`]:[],`Version: abitype@${px}`].join(`
`);super(i),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiTypeError"}),n.cause&&(this.cause=n.cause),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.shortMessage=e}};function $s(t,e){const n=t.exec(e);return n==null?void 0:n.groups}const AE=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,IE=/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/,SE=/^\(.+?\).*?$/,jm=/^tuple(?<array>(\[(\d*)\])*)$/;function Ep(t){let e=t.type;if(jm.test(t.type)&&"components"in t){e="(";const n=t.components.length;for(let s=0;s<n;s++){const i=t.components[s];e+=Ep(i),s<n-1&&(e+=", ")}const r=$s(jm,t.type);return e+=`)${(r==null?void 0:r.array)||""}`,Ep({...t,type:e})}return"indexed"in t&&t.indexed&&(e=`${e} indexed`),t.name?`${e} ${t.name}`:e}function Ba(t){let e="";const n=t.length;for(let r=0;r<n;r++){const s=t[r];e+=Ep(s),r!==n-1&&(e+=", ")}return e}function gx(t){var e;return t.type==="function"?`function ${t.name}(${Ba(t.inputs)})${t.stateMutability&&t.stateMutability!=="nonpayable"?` ${t.stateMutability}`:""}${(e=t.outputs)!=null&&e.length?` returns (${Ba(t.outputs)})`:""}`:t.type==="event"?`event ${t.name}(${Ba(t.inputs)})`:t.type==="error"?`error ${t.name}(${Ba(t.inputs)})`:t.type==="constructor"?`constructor(${Ba(t.inputs)})${t.stateMutability==="payable"?" payable":""}`:t.type==="fallback"?`fallback() external${t.stateMutability==="payable"?" payable":""}`:"receive() external payable"}const xE=/^error (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/;function mx(t){return xE.test(t)}function yx(t){return $s(xE,t)}const NE=/^event (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/;function bx(t){return NE.test(t)}function wx(t){return $s(NE,t)}const TE=/^function (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)(?: (?<scope>external|public{1}))?(?: (?<stateMutability>pure|view|nonpayable|payable{1}))?(?: returns\s?\((?<returns>.*?)\))?$/;function Ex(t){return TE.test(t)}function vx(t){return $s(TE,t)}const OE=/^struct (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*) \{(?<properties>.*?)\}$/;function RE(t){return OE.test(t)}function Cx(t){return $s(OE,t)}const PE=/^constructor\((?<parameters>.*?)\)(?:\s(?<stateMutability>payable{1}))?$/;function _x(t){return PE.test(t)}function Ax(t){return $s(PE,t)}const kE=/^fallback\(\) external(?:\s(?<stateMutability>payable{1}))?$/;function Ix(t){return kE.test(t)}function Sx(t){return $s(kE,t)}const xx=/^receive\(\) external payable$/;function Nx(t){return xx.test(t)}const DY=new Set(["memory","indexed","storage","calldata"]),Tx=new Set(["indexed"]),vp=new Set(["calldata","memory","storage"]);class $Y extends Rn{constructor({signature:e}){super("Failed to parse ABI item.",{details:`parseAbiItem(${JSON.stringify(e,null,2)})`,docsPath:"/api/human#parseabiitem-1"}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiItemError"})}}class Ox extends Rn{constructor({type:e}){super("Unknown type.",{metaMessages:[`Type "${e}" is not a valid ABI type. Perhaps you forgot to include a struct signature?`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownTypeError"})}}class Rx extends Rn{constructor({type:e}){super("Unknown type.",{metaMessages:[`Type "${e}" is not a valid ABI type.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSolidityTypeError"})}}class UY extends Rn{constructor({params:e}){super("Failed to parse ABI parameters.",{details:`parseAbiParameters(${JSON.stringify(e,null,2)})`,docsPath:"/api/human#parseabiparameters-1"}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiParametersError"})}}class Px extends Rn{constructor({param:e}){super("Invalid ABI parameter.",{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParameterError"})}}class kx extends Rn{constructor({param:e,name:n}){super("Invalid ABI parameter.",{details:e,metaMessages:[`"${n}" is a protected Solidity keyword. More info: https://docs.soliditylang.org/en/latest/cheatsheet.html`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SolidityProtectedKeywordError"})}}class Dx extends Rn{constructor({param:e,type:n,modifier:r}){super("Invalid ABI parameter.",{details:e,metaMessages:[`Modifier "${r}" not allowed${n?` in "${n}" type`:""}.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidModifierError"})}}class $x extends Rn{constructor({param:e,type:n,modifier:r}){super("Invalid ABI parameter.",{details:e,metaMessages:[`Modifier "${r}" not allowed${n?` in "${n}" type`:""}.`,`Data location can only be specified for array, struct, or mapping types, but "${r}" was given.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidFunctionModifierError"})}}class Ux extends Rn{constructor({abiParameter:e}){super("Invalid ABI parameter.",{details:JSON.stringify(e,null,2),metaMessages:["ABI parameter type is invalid."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiTypeParameterError"})}}class Ta extends Rn{constructor({signature:e,type:n}){super(`Invalid ${n} signature.`,{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidSignatureError"})}}class Bx extends Rn{constructor({signature:e}){super("Unknown signature.",{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSignatureError"})}}class Lx extends Rn{constructor({signature:e}){super("Invalid struct signature.",{details:e,metaMessages:["No properties exist."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidStructSignatureError"})}}class Mx extends Rn{constructor({type:e}){super("Circular reference detected.",{metaMessages:[`Struct "${e}" is a circular reference.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"CircularReferenceError"})}}class Fx extends Rn{constructor({current:e,depth:n}){super("Unbalanced parentheses.",{metaMessages:[`"${e.trim()}" has too many ${n>0?"opening":"closing"} parentheses.`],details:`Depth "${n}"`}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParenthesisError"})}}function jx(t,e,n){let r="";if(n)for(const s of Object.entries(n)){if(!s)continue;let i="";for(const o of s[1])i+=`[${o.type}${o.name?`:${o.name}`:""}]`;r+=`(${s[0]}{${i}})`}return e?`${e}:${t}${r}`:`${t}${r}`}const Ff=new Map([["address",{type:"address"}],["bool",{type:"bool"}],["bytes",{type:"bytes"}],["bytes32",{type:"bytes32"}],["int",{type:"int256"}],["int256",{type:"int256"}],["string",{type:"string"}],["uint",{type:"uint256"}],["uint8",{type:"uint8"}],["uint16",{type:"uint16"}],["uint24",{type:"uint24"}],["uint32",{type:"uint32"}],["uint64",{type:"uint64"}],["uint96",{type:"uint96"}],["uint112",{type:"uint112"}],["uint160",{type:"uint160"}],["uint192",{type:"uint192"}],["uint256",{type:"uint256"}],["address owner",{type:"address",name:"owner"}],["address to",{type:"address",name:"to"}],["bool approved",{type:"bool",name:"approved"}],["bytes _data",{type:"bytes",name:"_data"}],["bytes data",{type:"bytes",name:"data"}],["bytes signature",{type:"bytes",name:"signature"}],["bytes32 hash",{type:"bytes32",name:"hash"}],["bytes32 r",{type:"bytes32",name:"r"}],["bytes32 root",{type:"bytes32",name:"root"}],["bytes32 s",{type:"bytes32",name:"s"}],["string name",{type:"string",name:"name"}],["string symbol",{type:"string",name:"symbol"}],["string tokenURI",{type:"string",name:"tokenURI"}],["uint tokenId",{type:"uint256",name:"tokenId"}],["uint8 v",{type:"uint8",name:"v"}],["uint256 balance",{type:"uint256",name:"balance"}],["uint256 tokenId",{type:"uint256",name:"tokenId"}],["uint256 value",{type:"uint256",name:"value"}],["event:address indexed from",{type:"address",name:"from",indexed:!0}],["event:address indexed to",{type:"address",name:"to",indexed:!0}],["event:uint indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}],["event:uint256 indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}]]);function Hx(t,e={}){if(Ex(t))return Wx(t,e);if(bx(t))return zx(t,e);if(mx(t))return qx(t,e);if(_x(t))return Vx(t,e);if(Ix(t))return Kx(t);if(Nx(t))return{type:"receive",stateMutability:"payable"};throw new Bx({signature:t})}function Wx(t,e={}){const n=vx(t);if(!n)throw new Ta({signature:t,type:"function"});const r=wr(n.parameters),s=[],i=r.length;for(let a=0;a<i;a++)s.push(go(r[a],{modifiers:vp,structs:e,type:"function"}));const o=[];if(n.returns){const a=wr(n.returns),c=a.length;for(let l=0;l<c;l++)o.push(go(a[l],{modifiers:vp,structs:e,type:"function"}))}return{name:n.name,type:"function",stateMutability:n.stateMutability??"nonpayable",inputs:s,outputs:o}}function zx(t,e={}){const n=wx(t);if(!n)throw new Ta({signature:t,type:"event"});const r=wr(n.parameters),s=[],i=r.length;for(let o=0;o<i;o++)s.push(go(r[o],{modifiers:Tx,structs:e,type:"event"}));return{name:n.name,type:"event",inputs:s}}function qx(t,e={}){const n=yx(t);if(!n)throw new Ta({signature:t,type:"error"});const r=wr(n.parameters),s=[],i=r.length;for(let o=0;o<i;o++)s.push(go(r[o],{structs:e,type:"error"}));return{name:n.name,type:"error",inputs:s}}function Vx(t,e={}){const n=Ax(t);if(!n)throw new Ta({signature:t,type:"constructor"});const r=wr(n.parameters),s=[],i=r.length;for(let o=0;o<i;o++)s.push(go(r[o],{structs:e,type:"constructor"}));return{type:"constructor",stateMutability:n.stateMutability??"nonpayable",inputs:s}}function Kx(t){const e=Sx(t);if(!e)throw new Ta({signature:t,type:"fallback"});return{type:"fallback",stateMutability:e.stateMutability??"nonpayable"}}const Gx=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*(?:\spayable)?)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,Yx=/^\((?<type>.+?)\)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,Zx=/^u?int$/;function go(t,e){var d,f;const n=jx(t,e==null?void 0:e.type,e==null?void 0:e.structs);if(Ff.has(n))return Ff.get(n);const r=SE.test(t),s=$s(r?Yx:Gx,t);if(!s)throw new Px({param:t});if(s.name&&Xx(s.name))throw new kx({param:t,name:s.name});const i=s.name?{name:s.name}:{},o=s.modifier==="indexed"?{indexed:!0}:{},a=(e==null?void 0:e.structs)??{};let c,l={};if(r){c="tuple";const h=wr(s.type),p=[],g=h.length;for(let m=0;m<g;m++)p.push(go(h[m],{structs:a}));l={components:p}}else if(s.type in a)c="tuple",l={components:a[s.type]};else if(Zx.test(s.type))c=`${s.type}256`;else if(s.type==="address payable")c="address";else if(c=s.type,(e==null?void 0:e.type)!=="struct"&&!DE(c))throw new Rx({type:c});if(s.modifier){if(!((f=(d=e==null?void 0:e.modifiers)==null?void 0:d.has)!=null&&f.call(d,s.modifier)))throw new Dx({param:t,type:e==null?void 0:e.type,modifier:s.modifier});if(vp.has(s.modifier)&&!Qx(c,!!s.array))throw new $x({param:t,type:e==null?void 0:e.type,modifier:s.modifier})}const u={type:`${c}${s.array??""}`,...i,...o,...l};return Ff.set(n,u),u}function wr(t,e=[],n="",r=0){const s=t.trim().length;for(let i=0;i<s;i++){const o=t[i],a=t.slice(i+1);switch(o){case",":return r===0?wr(a,[...e,n.trim()]):wr(a,e,`${n}${o}`,r);case"(":return wr(a,e,`${n}${o}`,r+1);case")":return wr(a,e,`${n}${o}`,r-1);default:return wr(a,e,`${n}${o}`,r)}}if(n==="")return e;if(r!==0)throw new Fx({current:n,depth:r});return e.push(n.trim()),e}function DE(t){return t==="address"||t==="bool"||t==="function"||t==="string"||AE.test(t)||IE.test(t)}const Jx=/^(?:after|alias|anonymous|apply|auto|byte|calldata|case|catch|constant|copyof|default|defined|error|event|external|false|final|function|immutable|implements|in|indexed|inline|internal|let|mapping|match|memory|mutable|null|of|override|partial|private|promise|public|pure|reference|relocatable|return|returns|sizeof|static|storage|struct|super|supports|switch|this|true|try|typedef|typeof|var|view|virtual)$/;function Xx(t){return t==="address"||t==="bool"||t==="function"||t==="string"||t==="tuple"||AE.test(t)||IE.test(t)||Jx.test(t)}function Qx(t,e){return e||t==="bytes"||t==="string"||t==="tuple"}function eN(t){const e={},n=t.length;for(let o=0;o<n;o++){const a=t[o];if(!RE(a))continue;const c=Cx(a);if(!c)throw new Ta({signature:a,type:"struct"});const l=c.properties.split(";"),u=[],d=l.length;for(let f=0;f<d;f++){const p=l[f].trim();if(!p)continue;const g=go(p,{type:"struct"});u.push(g)}if(!u.length)throw new Lx({signature:a});e[c.name]=u}const r={},s=Object.entries(e),i=s.length;for(let o=0;o<i;o++){const[a,c]=s[o];r[a]=$E(c,e)}return r}const tN=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*)(?<array>(?:\[\d*?\])+?)?$/;function $E(t=[],e={},n=new Set){const r=[],s=t.length;for(let i=0;i<s;i++){const o=t[i];if(SE.test(o.type))r.push(o);else{const c=$s(tN,o.type);if(!(c!=null&&c.type))throw new Ux({abiParameter:o});const{array:l,type:u}=c;if(u in e){if(n.has(u))throw new Mx({type:u});r.push({...o,type:`tuple${l??""}`,components:$E(e[u],e,new Set([...n,u]))})}else if(DE(u))r.push(o);else throw new Ox({type:u})}}return r}function UE(t){const e=eN(t),n=[],r=t.length;for(let s=0;s<r;s++){const i=t[s];RE(i)||n.push(Hx(i,e))}return n}function Ze(t,e,n){const r=t[e.name];if(typeof r=="function")return r;const s=t[n];return typeof s=="function"?s:i=>e(t,i)}function Ii(t,{includeName:e=!1}={}){if(t.type!=="function"&&t.type!=="event"&&t.type!=="error")throw new gN(t.type);return`${t.name}(${Yd(t.inputs,{includeName:e})})`}function Yd(t,{includeName:e=!1}={}){return t?t.map(n=>nN(n,{includeName:e})).join(e?", ":","):""}function nN(t,{includeName:e}){return t.type.startsWith("tuple")?`(${Yd(t.components,{includeName:e})})${t.type.slice(5)}`:t.type+(e&&t.name?` ${t.name}`:"")}function Si(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function bt(t){return Si(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const BE="2.43.3";let La={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:n})=>e?`${t??"https://viem.sh"}${e}${n?`#${n}`:""}`:void 0,version:`viem@${BE}`},q=class Cp extends Error{constructor(e,n={}){var a;const r=(()=>{var c;return n.cause instanceof Cp?n.cause.details:(c=n.cause)!=null&&c.message?n.cause.message:n.details})(),s=n.cause instanceof Cp&&n.cause.docsPath||n.docsPath,i=(a=La.getDocsUrl)==null?void 0:a.call(La,{...n,docsPath:s}),o=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...La.version?[`Version: ${La.version}`]:[]].join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=e,this.version=BE}walk(e){return LE(this,e)}};function LE(t,e){return e!=null&&e(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?LE(t.cause,e):e?null:t}class rN extends q{constructor({docsPath:e}){super(["A constructor was not found on the ABI.","Make sure you are using the correct ABI and that the constructor exists on it."].join(`
`),{docsPath:e,name:"AbiConstructorNotFoundError"})}}class Hm extends q{constructor({docsPath:e}){super(["Constructor arguments were provided (`args`), but a constructor parameters (`inputs`) were not found on the ABI.","Make sure you are using the correct ABI, and that the `inputs` attribute on the constructor exists."].join(`
`),{docsPath:e,name:"AbiConstructorParamsNotFoundError"})}}class ME extends q{constructor({data:e,params:n,size:r}){super([`Data size of ${r} bytes is too small for given parameters.`].join(`
`),{metaMessages:[`Params: (${Yd(n,{includeName:!0})})`,`Data:   ${e} (${r} bytes)`],name:"AbiDecodingDataSizeTooSmallError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=e,this.params=n,this.size=r}}class G0 extends q{constructor(){super('Cannot decode zero data ("0x") with ABI parameters.',{name:"AbiDecodingZeroDataError"})}}class sN extends q{constructor({expectedLength:e,givenLength:n,type:r}){super([`ABI encoding array length mismatch for type ${r}.`,`Expected length: ${e}`,`Given length: ${n}`].join(`
`),{name:"AbiEncodingArrayLengthMismatchError"})}}class iN extends q{constructor({expectedSize:e,value:n}){super(`Size of bytes "${n}" (bytes${bt(n)}) does not match expected size (bytes${e}).`,{name:"AbiEncodingBytesSizeMismatchError"})}}class oN extends q{constructor({expectedLength:e,givenLength:n}){super(["ABI encoding params/values length mismatch.",`Expected length (params): ${e}`,`Given length (values): ${n}`].join(`
`),{name:"AbiEncodingLengthMismatchError"})}}class BY extends q{constructor(e,{docsPath:n}){super([`Arguments (\`args\`) were provided to "${e}", but "${e}" on the ABI does not contain any parameters (\`inputs\`).`,"Cannot encode error result without knowing what the parameter types are.","Make sure you are using the correct ABI and that the inputs exist on it."].join(`
`),{docsPath:n,name:"AbiErrorInputsNotFoundError"})}}class LY extends q{constructor(e,{docsPath:n}={}){super([`Error ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the error exists on it."].join(`
`),{docsPath:n,name:"AbiErrorNotFoundError"})}}class FE extends q{constructor(e,{docsPath:n}){super([`Encoded error signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:n,name:"AbiErrorSignatureNotFoundError"}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.signature=e}}class aN extends q{constructor({docsPath:e}){super("Cannot extract event signature from empty topics.",{docsPath:e,name:"AbiEventSignatureEmptyTopicsError"})}}class cN extends q{constructor(e,{docsPath:n}){super([`Encoded event signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the event exists on it.",`You can look up the signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:n,name:"AbiEventSignatureNotFoundError"})}}class MY extends q{constructor(e,{docsPath:n}={}){super([`Event ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the event exists on it."].join(`
`),{docsPath:n,name:"AbiEventNotFoundError"})}}class dd extends q{constructor(e,{docsPath:n}={}){super([`Function ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:n,name:"AbiFunctionNotFoundError"})}}class lN extends q{constructor(e,{docsPath:n}){super([`Function "${e}" does not contain any \`outputs\` on ABI.`,"Cannot decode function result without knowing what the parameter types are.","Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:n,name:"AbiFunctionOutputsNotFoundError"})}}class FY extends q{constructor(e,{docsPath:n}){super([`Encoded function signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it.",`You can look up the signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:n,name:"AbiFunctionSignatureNotFoundError"})}}class uN extends q{constructor(e,n){super("Found ambiguous types in overloaded ABI items.",{metaMessages:[`\`${e.type}\` in \`${Ii(e.abiItem)}\`, and`,`\`${n.type}\` in \`${Ii(n.abiItem)}\``,"","These types encode differently and cannot be distinguished at runtime.","Remove one of the ambiguous items in the ABI."],name:"AbiItemAmbiguityError"})}}class jY extends q{constructor({expectedSize:e,givenSize:n}){super(`Expected bytes${e}, got bytes${n}.`,{name:"BytesSizeMismatchError"})}}class Wm extends q{constructor({abiItem:e,data:n,params:r,size:s}){super([`Data size of ${s} bytes is too small for non-indexed event parameters.`].join(`
`),{metaMessages:[`Params: (${Yd(r,{includeName:!0})})`,`Data:   ${n} (${s} bytes)`],name:"DecodeLogDataMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=e,this.data=n,this.params=r,this.size=s}}class dN extends q{constructor({abiItem:e,param:n}){super([`Expected a topic for indexed event parameter${n.name?` "${n.name}"`:""} on event "${Ii(e,{includeName:!0})}".`].join(`
`),{name:"DecodeLogTopicsMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=e}}class fN extends q{constructor(e,{docsPath:n}){super([`Type "${e}" is not a valid encoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:n,name:"InvalidAbiEncodingType"})}}class hN extends q{constructor(e,{docsPath:n}){super([`Type "${e}" is not a valid decoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:n,name:"InvalidAbiDecodingType"})}}class pN extends q{constructor(e){super([`Value "${e}" is not a valid array.`].join(`
`),{name:"InvalidArrayError"})}}class gN extends q{constructor(e){super([`"${e}" is not a valid definition type.`,'Valid types: "function", "event", "error"'].join(`
`),{name:"InvalidDefinitionTypeError"})}}class HY extends q{constructor(e){super(`Type "${e}" is not supported for packed encoding.`,{name:"UnsupportedPackedAbiType"})}}let jE=class extends q{constructor({offset:e,position:n,size:r}){super(`Slice ${n==="start"?"starting":"ending"} at offset "${e}" is out-of-bounds (size: ${r}).`,{name:"SliceOffsetOutOfBoundsError"})}},HE=class extends q{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}};class zm extends q{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} is expected to be ${n} ${r} long, but is ${e} ${r} long.`,{name:"InvalidBytesLengthError"})}}function Oa(t,{dir:e,size:n=32}={}){return typeof t=="string"?yi(t,{dir:e,size:n}):mN(t,{dir:e,size:n})}function yi(t,{dir:e,size:n=32}={}){if(n===null)return t;const r=t.replace("0x","");if(r.length>n*2)throw new HE({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r[e==="right"?"padEnd":"padStart"](n*2,"0")}`}function mN(t,{dir:e,size:n=32}={}){if(n===null)return t;if(t.length>n)throw new HE({size:t.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const i=e==="right";r[i?s:n-s-1]=t[i?s:t.length-s-1]}return r}let WE=class extends q{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${n} to ${e})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}},yN=class extends q{constructor(e){super(`Bytes value "${e}" is not a valid boolean. The bytes array must contain a single byte of either a 0 or 1 value.`,{name:"InvalidBytesBooleanError"})}};class bN extends q{constructor(e){super(`Hex value "${e}" is not a valid boolean. The hex value must be "0x0" (false) or "0x1" (true).`,{name:"InvalidHexBooleanError"})}}let wN=class extends q{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}};function Ar(t,{dir:e="left"}={}){let n=typeof t=="string"?t.replace("0x",""):t,r=0;for(let s=0;s<n.length-1&&n[e==="left"?s:n.length-s-1].toString()==="0";s++)r++;return n=e==="left"?n.slice(r):n.slice(0,n.length-r),typeof t=="string"?(n.length===1&&e==="right"&&(n=`${n}0`),`0x${n.length%2===1?`0${n}`:n}`):n}function or(t,{size:e}){if(bt(t)>e)throw new wN({givenSize:bt(t),maxSize:e})}function Er(t,e={}){const{signed:n}=e;e.size&&or(t,{size:e.size});const r=BigInt(t);if(!n)return r;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return r<=i?r:r-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function GY(t,e={}){let n=t;if(e.size&&(or(n,{size:e.size}),n=Ar(n)),Ar(n)==="0x00")return!1;if(Ar(n)==="0x01")return!0;throw new bN(n)}function xi(t,e={}){return Number(Er(t,e))}function EN(t,e={}){let n=Zr(t);return e.size&&(or(n,{size:e.size}),n=Ar(n,{dir:"right"})),new TextDecoder().decode(n)}const vN=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function nr(t,e={}){return typeof t=="number"||typeof t=="bigint"?re(t,e):typeof t=="string"?Zd(t,e):typeof t=="boolean"?zE(t,e):fn(t,e)}function zE(t,e={}){const n=`0x${Number(t)}`;return typeof e.size=="number"?(or(n,{size:e.size}),Oa(n,{size:e.size})):n}function fn(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=vN[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(or(r,{size:e.size}),Oa(r,{dir:"right",size:e.size})):r}function re(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const c=typeof t=="bigint"?"n":"";throw new WE({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:n,size:r,value:`${t}${c}`})}const a=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?Oa(a,{size:r}):a}const CN=new TextEncoder;function Zd(t,e={}){const n=CN.encode(t);return fn(n,e)}const _N=new TextEncoder;function Jd(t,e={}){return typeof t=="number"||typeof t=="bigint"?IN(t,e):typeof t=="boolean"?AN(t,e):Si(t)?Zr(t,e):qE(t,e)}function AN(t,e={}){const n=new Uint8Array(1);return n[0]=Number(t),typeof e.size=="number"?(or(n,{size:e.size}),Oa(n,{size:e.size})):n}const es={zero:48,nine:57,A:65,F:70,a:97,f:102};function qm(t){if(t>=es.zero&&t<=es.nine)return t-es.zero;if(t>=es.A&&t<=es.F)return t-(es.A-10);if(t>=es.a&&t<=es.f)return t-(es.a-10)}function Zr(t,e={}){let n=t;e.size&&(or(n,{size:e.size}),n=Oa(n,{dir:"right",size:e.size}));let r=n.slice(2);r.length%2&&(r=`0${r}`);const s=r.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=qm(r.charCodeAt(a++)),l=qm(r.charCodeAt(a++));if(c===void 0||l===void 0)throw new q(`Invalid byte sequence ("${r[a-2]}${r[a-1]}" in "${r}").`);i[o]=c*16+l}return i}function IN(t,e){const n=re(t,e);return Zr(n)}function qE(t,e={}){const n=_N.encode(t);return typeof e.size=="number"?(or(n,{size:e.size}),Oa(n,{dir:"right",size:e.size})):n}const Jl=BigInt(2**32-1),Vm=BigInt(32);function SN(t,e=!1){return e?{h:Number(t&Jl),l:Number(t>>Vm&Jl)}:{h:Number(t>>Vm&Jl)|0,l:Number(t&Jl)|0}}function VE(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=SN(t[i],e);[r[i],s[i]]=[o,a]}return[r,s]}const Km=(t,e,n)=>t>>>n,Gm=(t,e,n)=>t<<32-n|e>>>n,Do=(t,e,n)=>t>>>n|e<<32-n,$o=(t,e,n)=>t<<32-n|e>>>n,Xl=(t,e,n)=>t<<64-n|e>>>n-32,Ql=(t,e,n)=>t>>>n-32|e<<64-n,xN=(t,e,n)=>t<<n|e>>>32-n,NN=(t,e,n)=>e<<n|t>>>32-n,TN=(t,e,n)=>e<<n-32|t>>>64-n,ON=(t,e,n)=>t<<n-32|e>>>64-n;function ts(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const RN=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),PN=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,kN=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),DN=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,$N=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),UN=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,Uo=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function BN(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function fd(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function ga(t,...e){if(!BN(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function YY(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");fd(t.outputLen),fd(t.blockLen)}function hd(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function KE(t,e){ga(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function LN(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function mo(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function jf(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Or(t,e){return t<<32-e|t>>>e}const MN=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function FN(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function jN(t){for(let e=0;e<t.length;e++)t[e]=FN(t[e]);return t}const Ym=MN?t=>t:jN;function HN(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function Y0(t){return typeof t=="string"&&(t=HN(t)),ga(t),t}function ZY(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];ga(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}let GE=class{};function Xd(t){const e=r=>t().update(Y0(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function XY(t=32){if(Uo&&typeof Uo.getRandomValues=="function")return Uo.getRandomValues(new Uint8Array(t));if(Uo&&typeof Uo.randomBytes=="function")return Uint8Array.from(Uo.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}const WN=BigInt(0),Ma=BigInt(1),zN=BigInt(2),qN=BigInt(7),VN=BigInt(256),KN=BigInt(113),YE=[],ZE=[],JE=[];for(let t=0,e=Ma,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],YE.push(2*(5*r+n)),ZE.push((t+1)*(t+2)/2%64);let s=WN;for(let i=0;i<7;i++)e=(e<<Ma^(e>>qN)*KN)%VN,e&zN&&(s^=Ma<<(Ma<<BigInt(i))-Ma);JE.push(s)}const XE=VE(JE,!0),GN=XE[0],YN=XE[1],Zm=(t,e,n)=>n>32?TN(t,e,n):xN(t,e,n),Jm=(t,e,n)=>n>32?ON(t,e,n):NN(t,e,n);function ZN(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=Zm(l,u,1)^n[a],f=Jm(l,u,1)^n[a+1];for(let h=0;h<50;h+=10)t[o+h]^=d,t[o+h+1]^=f}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=ZE[o],c=Zm(s,i,a),l=Jm(s,i,a),u=YE[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=GN[r],t[1]^=YN[r]}mo(n)}let JN=class QE extends GE{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,fd(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=LN(this.state)}clone(){return this._cloneInto()}keccak(){Ym(this.state32),ZN(this.state32,this.rounds),Ym(this.state32),this.posOut=0,this.pos=0}update(e){hd(this),e=Y0(e),ga(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,n&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){hd(this,!1),ga(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return fd(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(KE(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,mo(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new QE(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const XN=(t,e,n)=>Xd(()=>new JN(e,t,n)),QN=XN(1,136,256/8);function Al(t,e){const n=e||"hex",r=QN(Si(t,{strict:!1})?Jd(t):t);return n==="bytes"?r:nr(r)}const eT=t=>Al(Jd(t));function tT(t){return eT(t)}function nT(t){let e=!0,n="",r=0,s="",i=!1;for(let o=0;o<t.length;o++){const a=t[o];if(["(",")",","].includes(a)&&(e=!0),a==="("&&r++,a===")"&&r--,!!e){if(r===0){if(a===" "&&["event","function",""].includes(s))s="";else if(s+=a,a===")"){i=!0;break}continue}if(a===" "){t[o-1]!==","&&n!==","&&n!==",("&&(n="",e=!1);continue}s+=a,n+=a}}if(!i)throw new q("Unable to normalize signature.");return s}const rT=t=>{const e=typeof t=="string"?t:gx(t);return nT(e)};function ev(t){return tT(rT(t))}const Z0=ev;let Nn=class extends q{constructor({address:e}){super(`Address "${e}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}},Il=class extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&n!==void 0&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}};const Hf=new Il(8192);function Sl(t,e){if(Hf.has(`${t}.${e}`))return Hf.get(`${t}.${e}`);const n=e?`${e}${t.toLowerCase()}`:t.substring(2).toLowerCase(),r=Al(qE(n),"bytes"),s=(e?n.substring(`${e}0x`.length):n).split("");for(let o=0;o<40;o+=2)r[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(r[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return Hf.set(`${t}.${e}`,i),i}function Yi(t,e){if(!jt(t,{strict:!1}))throw new Nn({address:t});return Sl(t,e)}const sT=/^0x[a-fA-F0-9]{40}$/,Wf=new Il(8192);function jt(t,e){const{strict:n=!0}=e??{},r=`${t}.${n}`;if(Wf.has(r))return Wf.get(r);const s=sT.test(t)?t.toLowerCase()===t?!0:n?Sl(t)===t:!0:!1;return Wf.set(r,s),s}function ma(t){return typeof t[0]=="string"?Us(t):iT(t)}function iT(t){let e=0;for(const s of t)e+=s.length;const n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}function Us(t){return`0x${t.reduce((e,n)=>e+n.replace("0x",""),"")}`}function Hc(t,e,n,{strict:r}={}){return Si(t,{strict:!1})?oT(t,e,n,{strict:r}):rv(t,e,n,{strict:r})}function tv(t,e){if(typeof e=="number"&&e>0&&e>bt(t)-1)throw new jE({offset:e,position:"start",size:bt(t)})}function nv(t,e,n){if(typeof e=="number"&&typeof n=="number"&&bt(t)!==n-e)throw new jE({offset:n,position:"end",size:bt(t)})}function rv(t,e,n,{strict:r}={}){tv(t,e);const s=t.slice(e,n);return r&&nv(s,e,n),s}function oT(t,e,n,{strict:r}={}){tv(t,e);const s=`0x${t.replace("0x","").slice((e??0)*2,(n??t.length)*2)}`;return r&&nv(s,e,n),s}const tZ=/^(.*)\[([0-9]*)\]$/,nZ=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,aT=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function sv(t,e){if(t.length!==e.length)throw new oN({expectedLength:t.length,givenLength:e.length});const n=cT({params:t,values:e}),r=X0(n);return r.length===0?"0x":r}function cT({params:t,values:e}){const n=[];for(let r=0;r<t.length;r++)n.push(J0({param:t[r],value:e[r]}));return n}function J0({param:t,value:e}){const n=Q0(t.type);if(n){const[r,s]=n;return uT(e,{length:r,param:{...t,type:s}})}if(t.type==="tuple")return gT(e,{param:t});if(t.type==="address")return lT(e);if(t.type==="bool")return fT(e);if(t.type.startsWith("uint")||t.type.startsWith("int")){const r=t.type.startsWith("int"),[,,s="256"]=aT.exec(t.type)??[];return hT(e,{signed:r,size:Number(s)})}if(t.type.startsWith("bytes"))return dT(e,{param:t});if(t.type==="string")return pT(e);throw new fN(t.type,{docsPath:"/docs/contract/encodeAbiParameters"})}function X0(t){let e=0;for(let i=0;i<t.length;i++){const{dynamic:o,encoded:a}=t[i];o?e+=32:e+=bt(a)}const n=[],r=[];let s=0;for(let i=0;i<t.length;i++){const{dynamic:o,encoded:a}=t[i];o?(n.push(re(e+s,{size:32})),r.push(a),s+=bt(a)):n.push(a)}return ma([...n,...r])}function lT(t){if(!jt(t))throw new Nn({address:t});return{dynamic:!1,encoded:yi(t.toLowerCase())}}function uT(t,{length:e,param:n}){const r=e===null;if(!Array.isArray(t))throw new pN(t);if(!r&&t.length!==e)throw new sN({expectedLength:e,givenLength:t.length,type:`${n.type}[${e}]`});let s=!1;const i=[];for(let o=0;o<t.length;o++){const a=J0({param:n,value:t[o]});a.dynamic&&(s=!0),i.push(a)}if(r||s){const o=X0(i);if(r){const a=re(i.length,{size:32});return{dynamic:!0,encoded:i.length>0?ma([a,o]):a}}if(s)return{dynamic:!0,encoded:o}}return{dynamic:!1,encoded:ma(i.map(({encoded:o})=>o))}}function dT(t,{param:e}){const[,n]=e.type.split("bytes"),r=bt(t);if(!n){let s=t;return r%32!==0&&(s=yi(s,{dir:"right",size:Math.ceil((t.length-2)/2/32)*32})),{dynamic:!0,encoded:ma([yi(re(r,{size:32})),s])}}if(r!==Number.parseInt(n,10))throw new iN({expectedSize:Number.parseInt(n,10),value:t});return{dynamic:!1,encoded:yi(t,{dir:"right"})}}function fT(t){if(typeof t!="boolean")throw new q(`Invalid boolean value: "${t}" (type: ${typeof t}). Expected: \`true\` or \`false\`.`);return{dynamic:!1,encoded:yi(zE(t))}}function hT(t,{signed:e,size:n=256}){if(typeof n=="number"){const r=2n**(BigInt(n)-(e?1n:0n))-1n,s=e?-r-1n:0n;if(t>r||t<s)throw new WE({max:r.toString(),min:s.toString(),signed:e,size:n/8,value:t.toString()})}return{dynamic:!1,encoded:re(t,{size:32,signed:e})}}function pT(t){const e=Zd(t),n=Math.ceil(bt(e)/32),r=[];for(let s=0;s<n;s++)r.push(yi(Hc(e,s*32,(s+1)*32),{dir:"right"}));return{dynamic:!0,encoded:ma([yi(re(bt(e),{size:32})),...r])}}function gT(t,{param:e}){let n=!1;const r=[];for(let s=0;s<e.components.length;s++){const i=e.components[s],o=Array.isArray(t)?s:i.name,a=J0({param:i,value:t[o]});r.push(a),a.dynamic&&(n=!0)}return{dynamic:n,encoded:n?X0(r):ma(r.map(({encoded:s})=>s))}}function Q0(t){const e=t.match(/^(.*)\[(\d+)?\]$/);return e?[e[2]?Number(e[2]):null,e[1]]:void 0}const eg=t=>Hc(ev(t),0,4);function tg(t){const{abi:e,args:n=[],name:r}=t,s=Si(r,{strict:!1}),i=e.filter(a=>s?a.type==="function"?eg(a)===r:a.type==="event"?Z0(a)===r:!1:"name"in a&&a.name===r);if(i.length===0)return;if(i.length===1)return i[0];let o;for(const a of i){if(!("inputs"in a))continue;if(!n||n.length===0){if(!a.inputs||a.inputs.length===0)return a;continue}if(!a.inputs||a.inputs.length===0||a.inputs.length!==n.length)continue;if(n.every((l,u)=>{const d="inputs"in a&&a.inputs[u];return d?_p(l,d):!1})){if(o&&"inputs"in o&&o.inputs){const l=iv(a.inputs,o.inputs,n);if(l)throw new uN({abiItem:a,type:l[0]},{abiItem:o,type:l[1]})}o=a}}return o||i[0]}function _p(t,e){const n=typeof t,r=e.type;switch(r){case"address":return jt(t,{strict:!1});case"bool":return n==="boolean";case"function":return n==="string";case"string":return n==="string";default:return r==="tuple"&&"components"in e?Object.values(e.components).every((s,i)=>_p(Object.values(t)[i],s)):/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(r)?n==="number"||n==="bigint":/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(r)?n==="string"||t instanceof Uint8Array:/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(r)?Array.isArray(t)&&t.every(s=>_p(s,{...e,type:r.replace(/(\[[0-9]{0,}\])$/,"")})):!1}}function iv(t,e,n){for(const r in t){const s=t[r],i=e[r];if(s.type==="tuple"&&i.type==="tuple"&&"components"in s&&"components"in i)return iv(s.components,i.components,n[r]);const o=[s.type,i.type];if(o.includes("address")&&o.includes("bytes20")?!0:o.includes("address")&&o.includes("string")?jt(n[r],{strict:!1}):o.includes("address")&&o.includes("bytes")?jt(n[r],{strict:!1}):!1)return o}}function mT(t,{method:e}){var r,s;const n={};return t.transport.type==="fallback"&&((s=(r=t.transport).onResponse)==null||s.call(r,({method:i,response:o,status:a,transport:c})=>{a==="success"&&e===i&&(n[o]=c.request)})),i=>n[i]||t.request}function sr(t){return typeof t=="string"?{address:t,type:"json-rpc"}:t}const Xm="/docs/contract/encodeFunctionData";function yT(t){const{abi:e,args:n,functionName:r}=t;let s=e[0];if(r){const i=tg({abi:e,args:n,name:r});if(!i)throw new dd(r,{docsPath:Xm});s=i}if(s.type!=="function")throw new dd(void 0,{docsPath:Xm});return{abi:[s],functionName:eg(Ii(s))}}function ng(t){const{args:e}=t,{abi:n,functionName:r}=(()=>{var a;return t.abi.length===1&&((a=t.functionName)!=null&&a.startsWith("0x"))?t:yT(t)})(),s=n[0],i=r,o="inputs"in s&&s.inputs?sv(s.inputs,e??[]):void 0;return Us([i,o??"0x"])}const bT={1:"An `assert` condition failed.",17:"Arithmetic operation resulted in underflow or overflow.",18:"Division or modulo by zero (e.g. `5 / 0` or `23 % 0`).",33:"Attempted to convert to an invalid type.",34:"Attempted to access a storage byte array that is incorrectly encoded.",49:"Performed `.pop()` on an empty array",50:"Array index is out of bounds.",65:"Allocated too much memory or created an array which is too large.",81:"Attempted to call a zero-initialized variable of internal function type."},wT={inputs:[{name:"message",type:"string"}],name:"Error",type:"error"},ET={inputs:[{name:"reason",type:"uint256"}],name:"Panic",type:"error"};class Qm extends q{constructor({offset:e}){super(`Offset \`${e}\` cannot be negative.`,{name:"NegativeOffsetError"})}}class ov extends q{constructor({length:e,position:n}){super(`Position \`${n}\` is out of bounds (\`0 < position < ${e}\`).`,{name:"PositionOutOfBoundsError"})}}class vT extends q{constructor({count:e,limit:n}){super(`Recursive read limit of \`${n}\` exceeded (recursive read count: \`${e}\`).`,{name:"RecursiveReadLimitExceededError"})}}const CT={bytes:new Uint8Array,dataView:new DataView(new ArrayBuffer(0)),position:0,positionReadCount:new Map,recursiveReadCount:0,recursiveReadLimit:Number.POSITIVE_INFINITY,assertReadLimit(){if(this.recursiveReadCount>=this.recursiveReadLimit)throw new vT({count:this.recursiveReadCount+1,limit:this.recursiveReadLimit})},assertPosition(t){if(t<0||t>this.bytes.length-1)throw new ov({length:this.bytes.length,position:t})},decrementPosition(t){if(t<0)throw new Qm({offset:t});const e=this.position-t;this.assertPosition(e),this.position=e},getReadCount(t){return this.positionReadCount.get(t||this.position)||0},incrementPosition(t){if(t<0)throw new Qm({offset:t});const e=this.position+t;this.assertPosition(e),this.position=e},inspectByte(t){const e=t??this.position;return this.assertPosition(e),this.bytes[e]},inspectBytes(t,e){const n=e??this.position;return this.assertPosition(n+t-1),this.bytes.subarray(n,n+t)},inspectUint8(t){const e=t??this.position;return this.assertPosition(e),this.bytes[e]},inspectUint16(t){const e=t??this.position;return this.assertPosition(e+1),this.dataView.getUint16(e)},inspectUint24(t){const e=t??this.position;return this.assertPosition(e+2),(this.dataView.getUint16(e)<<8)+this.dataView.getUint8(e+2)},inspectUint32(t){const e=t??this.position;return this.assertPosition(e+3),this.dataView.getUint32(e)},pushByte(t){this.assertPosition(this.position),this.bytes[this.position]=t,this.position++},pushBytes(t){this.assertPosition(this.position+t.length-1),this.bytes.set(t,this.position),this.position+=t.length},pushUint8(t){this.assertPosition(this.position),this.bytes[this.position]=t,this.position++},pushUint16(t){this.assertPosition(this.position+1),this.dataView.setUint16(this.position,t),this.position+=2},pushUint24(t){this.assertPosition(this.position+2),this.dataView.setUint16(this.position,t>>8),this.dataView.setUint8(this.position+2,t&255),this.position+=3},pushUint32(t){this.assertPosition(this.position+3),this.dataView.setUint32(this.position,t),this.position+=4},readByte(){this.assertReadLimit(),this._touch();const t=this.inspectByte();return this.position++,t},readBytes(t,e){this.assertReadLimit(),this._touch();const n=this.inspectBytes(t);return this.position+=e??t,n},readUint8(){this.assertReadLimit(),this._touch();const t=this.inspectUint8();return this.position+=1,t},readUint16(){this.assertReadLimit(),this._touch();const t=this.inspectUint16();return this.position+=2,t},readUint24(){this.assertReadLimit(),this._touch();const t=this.inspectUint24();return this.position+=3,t},readUint32(){this.assertReadLimit(),this._touch();const t=this.inspectUint32();return this.position+=4,t},get remaining(){return this.bytes.length-this.position},setPosition(t){const e=this.position;return this.assertPosition(t),this.position=t,()=>this.position=e},_touch(){if(this.recursiveReadLimit===Number.POSITIVE_INFINITY)return;const t=this.getReadCount();this.positionReadCount.set(this.position,t+1),t>0&&this.recursiveReadCount++}};function rg(t,{recursiveReadLimit:e=8192}={}){const n=Object.create(CT);return n.bytes=t,n.dataView=new DataView(t.buffer??t,t.byteOffset,t.byteLength),n.positionReadCount=new Map,n.recursiveReadLimit=e,n}function _T(t,e={}){typeof e.size<"u"&&or(t,{size:e.size});const n=fn(t,e);return Er(n,e)}function AT(t,e={}){let n=t;if(typeof e.size<"u"&&(or(n,{size:e.size}),n=Ar(n)),n.length>1||n[0]>1)throw new yN(n);return!!n[0]}function Ss(t,e={}){typeof e.size<"u"&&or(t,{size:e.size});const n=fn(t,e);return xi(n,e)}function IT(t,e={}){let n=t;return typeof e.size<"u"&&(or(n,{size:e.size}),n=Ar(n,{dir:"right"})),new TextDecoder().decode(n)}function Qd(t,e){const n=typeof e=="string"?Zr(e):e,r=rg(n);if(bt(n)===0&&t.length>0)throw new G0;if(bt(e)&&bt(e)<32)throw new ME({data:typeof e=="string"?e:fn(e),params:t,size:bt(e)});let s=0;const i=[];for(let o=0;o<t.length;++o){const a=t[o];r.setPosition(s);const[c,l]=ra(r,a,{staticPosition:0});s+=l,i.push(c)}return i}function ra(t,e,{staticPosition:n}){const r=Q0(e.type);if(r){const[s,i]=r;return xT(t,{...e,type:i},{length:s,staticPosition:n})}if(e.type==="tuple")return RT(t,e,{staticPosition:n});if(e.type==="address")return ST(t);if(e.type==="bool")return NT(t);if(e.type.startsWith("bytes"))return TT(t,e,{staticPosition:n});if(e.type.startsWith("uint")||e.type.startsWith("int"))return OT(t,e);if(e.type==="string")return PT(t,{staticPosition:n});throw new hN(e.type,{docsPath:"/docs/contract/decodeAbiParameters"})}const ey=32,Ap=32;function ST(t){const e=t.readBytes(32);return[Sl(fn(rv(e,-20))),32]}function xT(t,e,{length:n,staticPosition:r}){if(!n){const o=Ss(t.readBytes(Ap)),a=r+o,c=a+ey;t.setPosition(a);const l=Ss(t.readBytes(ey)),u=Wc(e);let d=0;const f=[];for(let h=0;h<l;++h){t.setPosition(c+(u?h*32:d));const[p,g]=ra(t,e,{staticPosition:c});d+=g,f.push(p)}return t.setPosition(r+32),[f,32]}if(Wc(e)){const o=Ss(t.readBytes(Ap)),a=r+o,c=[];for(let l=0;l<n;++l){t.setPosition(a+l*32);const[u]=ra(t,e,{staticPosition:a});c.push(u)}return t.setPosition(r+32),[c,32]}let s=0;const i=[];for(let o=0;o<n;++o){const[a,c]=ra(t,e,{staticPosition:r+s});s+=c,i.push(a)}return[i,s]}function NT(t){return[AT(t.readBytes(32),{size:32}),32]}function TT(t,e,{staticPosition:n}){const[r,s]=e.type.split("bytes");if(!s){const o=Ss(t.readBytes(32));t.setPosition(n+o);const a=Ss(t.readBytes(32));if(a===0)return t.setPosition(n+32),["0x",32];const c=t.readBytes(a);return t.setPosition(n+32),[fn(c),32]}return[fn(t.readBytes(Number.parseInt(s,10),32)),32]}function OT(t,e){const n=e.type.startsWith("int"),r=Number.parseInt(e.type.split("int")[1]||"256",10),s=t.readBytes(32);return[r>48?_T(s,{signed:n}):Ss(s,{signed:n}),32]}function RT(t,e,{staticPosition:n}){const r=e.components.length===0||e.components.some(({name:o})=>!o),s=r?[]:{};let i=0;if(Wc(e)){const o=Ss(t.readBytes(Ap)),a=n+o;for(let c=0;c<e.components.length;++c){const l=e.components[c];t.setPosition(a+i);const[u,d]=ra(t,l,{staticPosition:a});i+=d,s[r?c:l==null?void 0:l.name]=u}return t.setPosition(n+32),[s,32]}for(let o=0;o<e.components.length;++o){const a=e.components[o],[c,l]=ra(t,a,{staticPosition:n});s[r?o:a==null?void 0:a.name]=c,i+=l}return[s,i]}function PT(t,{staticPosition:e}){const n=Ss(t.readBytes(32)),r=e+n;t.setPosition(r);const s=Ss(t.readBytes(32));if(s===0)return t.setPosition(e+32),["",32];const i=t.readBytes(s,32),o=IT(Ar(i));return t.setPosition(e+32),[o,32]}function Wc(t){var r;const{type:e}=t;if(e==="string"||e==="bytes"||e.endsWith("[]"))return!0;if(e==="tuple")return(r=t.components)==null?void 0:r.some(Wc);const n=Q0(t.type);return!!(n&&Wc({...t,type:n[1]}))}function kT(t){const{abi:e,data:n}=t,r=Hc(n,0,4);if(r==="0x")throw new G0;const i=[...e||[],wT,ET].find(o=>o.type==="error"&&r===eg(Ii(o)));if(!i)throw new FE(r,{docsPath:"/docs/contract/decodeErrorResult"});return{abiItem:i,args:"inputs"in i&&i.inputs&&i.inputs.length>0?Qd(i.inputs,Hc(n,4)):void 0,errorName:i.name}}const rr=(t,e,n)=>JSON.stringify(t,(r,s)=>typeof s=="bigint"?s.toString():s,n);function av({abiItem:t,args:e,includeFunctionName:n=!0,includeName:r=!1}){if("name"in t&&"inputs"in t&&t.inputs)return`${n?t.name:""}(${t.inputs.map((s,i)=>`${r&&s.name?`${s.name}: `:""}${typeof e[i]=="object"?rr(e[i]):e[i]}`).join(", ")})`}const DT={gwei:9,wei:18},$T={ether:-9,wei:9};function xl(t,e){let n=t.toString();const r=n.startsWith("-");r&&(n=n.slice(1)),n=n.padStart(e,"0");let[s,i]=[n.slice(0,n.length-e),n.slice(n.length-e)];return i=i.replace(/(0+)$/,""),`${r?"-":""}${s||"0"}${i?`.${i}`:""}`}function sg(t,e="wei"){return xl(t,DT[e])}function Sn(t,e="wei"){return xl(t,$T[e])}class UT extends q{constructor({address:e}){super(`State for account "${e}" is set multiple times.`,{name:"AccountStateConflictError"})}}class BT extends q{constructor(){super("state and stateDiff are set on the same account.",{name:"StateAssignmentConflictError"})}}function ty(t){return t.reduce((e,{slot:n,value:r})=>`${e}        ${n}: ${r}
`,"")}function LT(t){return t.reduce((e,{address:n,...r})=>{let s=`${e}    ${n}:
`;return r.nonce&&(s+=`      nonce: ${r.nonce}
`),r.balance&&(s+=`      balance: ${r.balance}
`),r.code&&(s+=`      code: ${r.code}
`),r.state&&(s+=`      state:
`,s+=ty(r.state)),r.stateDiff&&(s+=`      stateDiff:
`,s+=ty(r.stateDiff)),s},`  State Override:
`).slice(0,-1)}function Nl(t){const e=Object.entries(t).map(([r,s])=>s===void 0||s===!1?null:[r,s]).filter(Boolean),n=e.reduce((r,[s])=>Math.max(r,s.length),0);return e.map(([r,s])=>`  ${`${r}:`.padEnd(n+1)}  ${s}`).join(`
`)}class MT extends q{constructor({v:e}){super(`Invalid \`v\` value "${e}". Expected 27 or 28.`,{name:"InvalidLegacyVError"})}}class FT extends q{constructor({transaction:e}){super("Cannot infer a transaction type from provided transaction.",{metaMessages:["Provided Transaction:","{",Nl(e),"}","","To infer the type, either provide:","- a `type` to the Transaction, or","- an EIP-1559 Transaction with `maxFeePerGas`, or","- an EIP-2930 Transaction with `gasPrice` & `accessList`, or","- an EIP-4844 Transaction with `blobs`, `blobVersionedHashes`, `sidecars`, or","- an EIP-7702 Transaction with `authorizationList`, or","- a Legacy Transaction with `gasPrice`"],name:"InvalidSerializableTransactionError"})}}class jT extends q{constructor({storageKey:e}){super(`Size for storage key "${e}" is invalid. Expected 32 bytes. Got ${Math.floor((e.length-2)/2)} bytes.`,{name:"InvalidStorageKeySizeError"})}}class HT extends q{constructor(e,{account:n,docsPath:r,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:l,nonce:u,to:d,value:f}){var p;const h=Nl({chain:s&&`${s==null?void 0:s.name} (id: ${s==null?void 0:s.id})`,from:n==null?void 0:n.address,to:d,value:typeof f<"u"&&`${sg(f)} ${((p=s==null?void 0:s.nativeCurrency)==null?void 0:p.symbol)||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${Sn(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${Sn(c)} gwei`,maxPriorityFeePerGas:typeof l<"u"&&`${Sn(l)} gwei`,nonce:u});super(e.shortMessage,{cause:e,docsPath:r,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Request Arguments:",h].filter(Boolean),name:"TransactionExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class cv extends q{constructor({blockHash:e,blockNumber:n,blockTag:r,hash:s,index:i}){let o="Transaction";r&&i!==void 0&&(o=`Transaction at block time "${r}" at index "${i}"`),e&&i!==void 0&&(o=`Transaction at block hash "${e}" at index "${i}"`),n&&i!==void 0&&(o=`Transaction at block number "${n}" at index "${i}"`),s&&(o=`Transaction with hash "${s}"`),super(`${o} could not be found.`,{name:"TransactionNotFoundError"})}}class lv extends q{constructor({hash:e}){super(`Transaction receipt with hash "${e}" could not be found. The Transaction may not be processed on a block yet.`,{name:"TransactionReceiptNotFoundError"})}}class rZ extends q{constructor({receipt:e}){super(`Transaction with hash "${e.transactionHash}" reverted.`,{metaMessages:['The receipt marked the transaction as "reverted". This could mean that the function on the contract you are trying to call threw an error.'," ","You can attempt to extract the revert reason by:","- calling the `simulateContract` or `simulateCalls` Action with the `abi` and `functionName` of the contract","- using the `call` Action with raw `data`"],name:"TransactionReceiptRevertedError"}),Object.defineProperty(this,"receipt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.receipt=e}}class WT extends q{constructor({hash:e}){super(`Timed out while waiting for transaction with hash "${e}" to be confirmed.`,{name:"WaitForTransactionReceiptTimeoutError"})}}const zT=t=>t,ig=t=>t;class qT extends q{constructor(e,{account:n,docsPath:r,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:l,nonce:u,to:d,value:f,stateOverride:h}){var m;const p=n?sr(n):void 0;let g=Nl({from:p==null?void 0:p.address,to:d,value:typeof f<"u"&&`${sg(f)} ${((m=s==null?void 0:s.nativeCurrency)==null?void 0:m.symbol)||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${Sn(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${Sn(c)} gwei`,maxPriorityFeePerGas:typeof l<"u"&&`${Sn(l)} gwei`,nonce:u});h&&(g+=`
${LT(h)}`),super(e.shortMessage,{cause:e,docsPath:r,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Raw Call Arguments:",g].filter(Boolean),name:"CallExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class VT extends q{constructor(e,{abi:n,args:r,contractAddress:s,docsPath:i,functionName:o,sender:a}){const c=tg({abi:n,args:r,name:o}),l=c?av({abiItem:c,args:r,includeFunctionName:!1,includeName:!1}):void 0,u=c?Ii(c,{includeName:!0}):void 0,d=Nl({address:s&&zT(s),function:u,args:l&&l!=="()"&&`${[...Array((o==null?void 0:o.length)??0).keys()].map(()=>" ").join("")}${l}`,sender:a});super(e.shortMessage||`An unknown error occurred while executing the contract function "${o}".`,{cause:e,docsPath:i,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],d&&"Contract Call:",d].filter(Boolean),name:"ContractFunctionExecutionError"}),Object.defineProperty(this,"abi",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"args",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"contractAddress",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"formattedArgs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"functionName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sender",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abi=n,this.args=r,this.cause=e,this.contractAddress=s,this.functionName=o,this.sender=a}}class KT extends q{constructor({abi:e,data:n,functionName:r,message:s}){let i,o,a,c;if(n&&n!=="0x")try{o=kT({abi:e,data:n});const{abiItem:u,errorName:d,args:f}=o;if(d==="Error")c=f[0];else if(d==="Panic"){const[h]=f;c=bT[h]}else{const h=u?Ii(u,{includeName:!0}):void 0,p=u&&f?av({abiItem:u,args:f,includeFunctionName:!1,includeName:!1}):void 0;a=[h?`Error: ${h}`:"",p&&p!=="()"?`       ${[...Array((d==null?void 0:d.length)??0).keys()].map(()=>" ").join("")}${p}`:""]}}catch(u){i=u}else s&&(c=s);let l;i instanceof FE&&(l=i.signature,a=[`Unable to decode signature "${l}" as it was not found on the provided ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${l}.`]),super(c&&c!=="execution reverted"||l?[`The contract function "${r}" reverted with the following ${l?"signature":"reason"}:`,c||l].join(`
`):`The contract function "${r}" reverted.`,{cause:i,metaMessages:a,name:"ContractFunctionRevertedError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"raw",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reason",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=o,this.raw=n,this.reason=c,this.signature=l}}class GT extends q{constructor({functionName:e}){super(`The contract function "${e}" returned no data ("0x").`,{metaMessages:["This could be due to any of the following:",`  - The contract does not have the function "${e}",`,"  - The parameters passed to the contract function may be invalid, or","  - The address is not a contract."],name:"ContractFunctionZeroDataError"})}}class YT extends q{constructor({factory:e}){super(`Deployment for counterfactual contract call failed${e?` for factory "${e}".`:""}`,{metaMessages:["Please ensure:","- The `factory` is a valid contract deployment factory (ie. Create2 Factory, ERC-4337 Factory, etc).","- The `factoryData` is a valid encoded function call for contract deployment function on the factory."],name:"CounterfactualDeploymentFailedError"})}}class uv extends q{constructor({data:e,message:n}){super(n||"",{name:"RawContractError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=e}}class hc extends q{constructor({body:e,cause:n,details:r,headers:s,status:i,url:o}){super("HTTP request failed.",{cause:n,details:r,metaMessages:[i&&`Status: ${i}`,`URL: ${ig(o)}`,e&&`Request body: ${rr(e)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=e,this.headers=s,this.status=i,this.url=o}}class og extends q{constructor({body:e,error:n,url:r}){super("RPC Request failed.",{cause:n,details:n.message,metaMessages:[`URL: ${ig(r)}`,`Request body: ${rr(e)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=n.code,this.data=n.data,this.url=r}}class ny extends q{constructor({body:e,url:n}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${ig(n)}`,`Request body: ${rr(e)}`],name:"TimeoutError"}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.url=n}}const ZT=-1;class Pn extends q{constructor(e,{code:n,docsPath:r,metaMessages:s,name:i,shortMessage:o}){super(o,{cause:e,docsPath:r,metaMessages:s||(e==null?void 0:e.metaMessages),name:i||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=i||e.name,this.code=e instanceof og?e.code:n??ZT}}class qn extends Pn{constructor(e,n){super(e,n),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=n.data}}class zc extends Pn{constructor(e){super(e,{code:zc.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(zc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class qc extends Pn{constructor(e){super(e,{code:qc.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(qc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class Vc extends Pn{constructor(e,{method:n}={}){super(e,{code:Vc.code,name:"MethodNotFoundRpcError",shortMessage:`The method${n?` "${n}"`:""} does not exist / is not available.`})}}Object.defineProperty(Vc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class Kc extends Pn{constructor(e){super(e,{code:Kc.code,name:"InvalidParamsRpcError",shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(Kc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class yo extends Pn{constructor(e){super(e,{code:yo.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(yo,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class ya extends Pn{constructor(e){super(e,{code:ya.code,name:"InvalidInputRpcError",shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(ya,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class Gc extends Pn{constructor(e){super(e,{code:Gc.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(Gc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class bi extends Pn{constructor(e){super(e,{code:bi.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(bi,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class ba extends Pn{constructor(e){super(e,{code:ba.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(ba,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class Zi extends Pn{constructor(e,{method:n}={}){super(e,{code:Zi.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${n?` "${n}"`:""} is not supported.`})}}Object.defineProperty(Zi,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class wa extends Pn{constructor(e){super(e,{code:wa.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(wa,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class Yc extends Pn{constructor(e){super(e,{code:Yc.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(Yc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class lt extends qn{constructor(e){super(e,{code:lt.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(lt,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class Zc extends qn{constructor(e){super(e,{code:Zc.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(Zc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class Jc extends qn{constructor(e,{method:n}={}){super(e,{code:Jc.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${n?` " ${n}"`:""}.`})}}Object.defineProperty(Jc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class Xc extends qn{constructor(e){super(e,{code:Xc.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(Xc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class Qc extends qn{constructor(e){super(e,{code:Qc.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(Qc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class Jr extends qn{constructor(e){super(e,{code:Jr.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(Jr,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class el extends qn{constructor(e){super(e,{code:el.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty(el,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class tl extends qn{constructor(e){super(e,{code:tl.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(tl,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class nl extends qn{constructor(e){super(e,{code:nl.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(nl,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class rl extends qn{constructor(e){super(e,{code:rl.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(rl,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class sl extends qn{constructor(e){super(e,{code:sl.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(sl,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class il extends qn{constructor(e){super(e,{code:il.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(il,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class ol extends qn{constructor(e){super(e,{code:ol.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(ol,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class JT extends Pn{constructor(e){super(e,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}const XT=3;function dv(t,{abi:e,address:n,args:r,docsPath:s,functionName:i,sender:o}){const a=t instanceof uv?t:t instanceof q?t.walk(p=>"data"in p)||t.walk():{},{code:c,data:l,details:u,message:d,shortMessage:f}=a,h=t instanceof G0?new GT({functionName:i}):[XT,yo.code].includes(c)&&(l||u||d||f)||c===ya.code&&u==="execution reverted"&&l?new KT({abi:e,data:typeof l=="object"?l.data:l,functionName:i,message:a instanceof og?u:f??d}):t;return new VT(h,{abi:e,args:r,contractAddress:n,docsPath:s,functionName:i,sender:o})}function QT(t){const e=Al(`0x${t.substring(4)}`).substring(26);return Sl(`0x${e}`)}const e3="modulepreload",t3=function(t){return"/"+t},ry={},_t=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=t3(c),c in ry)return;ry[c]=!0;const l=c.endsWith(".css"),u=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const d=document.createElement("link");if(d.rel=l?"stylesheet":e3,l||(d.as="script"),d.crossOrigin="",d.href=c,a&&d.setAttribute("nonce",a),document.head.appendChild(d),l)return new Promise((f,h)=>{d.addEventListener("load",f),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};async function n3({hash:t,signature:e}){const n=Si(t)?t:nr(t),{secp256k1:r}=await _t(async()=>{const{secp256k1:o}=await import("./secp256k1-D7k8_PHw.js").then(a=>a.a);return{secp256k1:o}},[]);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:l,s:u,v:d,yParity:f}=e,h=Number(f??d),p=sy(h);return new r.Signature(Er(l),Er(u)).addRecoveryBit(p)}const o=Si(e)?e:nr(e);if(bt(o)!==65)throw new Error("invalid signature length");const a=xi(`0x${o.slice(130)}`),c=sy(a);return r.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(n.substring(2)).toHex(!1)}`}function sy(t){if(t===0||t===1)return t;if(t===27)return 0;if(t===28)return 1;throw new Error("Invalid yParityOrV value")}async function r3({hash:t,signature:e}){return QT(await n3({hash:t,signature:e}))}function Ni(t,e="hex"){const n=fv(t),r=rg(new Uint8Array(n.length));return n.encode(r),e==="hex"?fn(r.bytes):r.bytes}function fv(t){return Array.isArray(t)?s3(t.map(e=>fv(e))):i3(t)}function s3(t){const e=t.reduce((s,i)=>s+i.length,0),n=hv(e);return{length:e<=55?1+e:1+n+e,encode(s){e<=55?s.pushByte(192+e):(s.pushByte(247+n),n===1?s.pushUint8(e):n===2?s.pushUint16(e):n===3?s.pushUint24(e):s.pushUint32(e));for(const{encode:i}of t)i(s)}}}function i3(t){const e=typeof t=="string"?Zr(t):t,n=hv(e.length);return{length:e.length===1&&e[0]<128?1:e.length<=55?1+e.length:1+n+e.length,encode(s){e.length===1&&e[0]<128?s.pushBytes(e):e.length<=55?(s.pushByte(128+e.length),s.pushBytes(e)):(s.pushByte(183+n),n===1?s.pushUint8(e.length):n===2?s.pushUint16(e.length):n===3?s.pushUint24(e.length):s.pushUint32(e.length),s.pushBytes(e))}}}function hv(t){if(t<2**8)return 1;if(t<2**16)return 2;if(t<2**24)return 3;if(t<2**32)return 4;throw new q("Length is too large.")}function o3(t){const{chainId:e,nonce:n,to:r}=t,s=t.contractAddress??t.address,i=Al(Us(["0x05",Ni([e?re(e):"0x",s,n?re(n):"0x"])]));return r==="bytes"?Zr(i):i}async function pv(t){const{authorization:e,signature:n}=t;return r3({hash:o3(e),signature:n??e})}class a3 extends q{constructor(e,{account:n,docsPath:r,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:l,nonce:u,to:d,value:f}){var p;const h=Nl({from:n==null?void 0:n.address,to:d,value:typeof f<"u"&&`${sg(f)} ${((p=s==null?void 0:s.nativeCurrency)==null?void 0:p.symbol)||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${Sn(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${Sn(c)} gwei`,maxPriorityFeePerGas:typeof l<"u"&&`${Sn(l)} gwei`,nonce:u});super(e.shortMessage,{cause:e,docsPath:r,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Estimate Gas Arguments:",h].filter(Boolean),name:"EstimateGasExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class Ji extends q{constructor({cause:e,message:n}={}){var s;const r=(s=n==null?void 0:n.replace("execution reverted: ",""))==null?void 0:s.replace("execution reverted","");super(`Execution reverted ${r?`with reason: ${r}`:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}Object.defineProperty(Ji,"code",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(Ji,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted|gas required exceeds allowance/});class bo extends q{constructor({cause:e,maxFeePerGas:n}={}){super(`The fee cap (\`maxFeePerGas\`${n?` = ${Sn(n)} gwei`:""}) cannot be higher than the maximum allowed value (2^256-1).`,{cause:e,name:"FeeCapTooHighError"})}}Object.defineProperty(bo,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas higher than 2\^256-1|fee cap higher than 2\^256-1/});class Ip extends q{constructor({cause:e,maxFeePerGas:n}={}){super(`The fee cap (\`maxFeePerGas\`${n?` = ${Sn(n)}`:""} gwei) cannot be lower than the block base fee.`,{cause:e,name:"FeeCapTooLowError"})}}Object.defineProperty(Ip,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas less than block base fee|fee cap less than block base fee|transaction is outdated/});class Sp extends q{constructor({cause:e,nonce:n}={}){super(`Nonce provided for the transaction ${n?`(${n}) `:""}is higher than the next one expected.`,{cause:e,name:"NonceTooHighError"})}}Object.defineProperty(Sp,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too high/});class xp extends q{constructor({cause:e,nonce:n}={}){super([`Nonce provided for the transaction ${n?`(${n}) `:""}is lower than the current nonce of the account.`,"Try increasing the nonce or find the latest nonce with `getTransactionCount`."].join(`
`),{cause:e,name:"NonceTooLowError"})}}Object.defineProperty(xp,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too low|transaction already imported|already known/});class Np extends q{constructor({cause:e,nonce:n}={}){super(`Nonce provided for the transaction ${n?`(${n}) `:""}exceeds the maximum allowed nonce.`,{cause:e,name:"NonceMaxValueError"})}}Object.defineProperty(Np,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce has max value/});class Tp extends q{constructor({cause:e}={}){super(["The total cost (gas * gas fee + value) of executing this transaction exceeds the balance of the account."].join(`
`),{cause:e,metaMessages:["This error could arise when the account does not have enough funds to:"," - pay for the total gas fee,"," - pay for the value to send."," ","The cost of the transaction is calculated as `gas * gas fee + value`, where:"," - `gas` is the amount of gas needed for transaction to execute,"," - `gas fee` is the gas fee,"," - `value` is the amount of ether to send to the recipient."],name:"InsufficientFundsError"})}}Object.defineProperty(Tp,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/insufficient funds|exceeds transaction sender account balance/});class Op extends q{constructor({cause:e,gas:n}={}){super(`The amount of gas ${n?`(${n}) `:""}provided for the transaction exceeds the limit allowed for the block.`,{cause:e,name:"IntrinsicGasTooHighError"})}}Object.defineProperty(Op,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too high|gas limit reached/});class Rp extends q{constructor({cause:e,gas:n}={}){super(`The amount of gas ${n?`(${n}) `:""}provided for the transaction is too low.`,{cause:e,name:"IntrinsicGasTooLowError"})}}Object.defineProperty(Rp,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too low/});class Pp extends q{constructor({cause:e}){super("The transaction type is not supported for this chain.",{cause:e,name:"TransactionTypeNotSupportedError"})}}Object.defineProperty(Pp,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/transaction type not valid/});class al extends q{constructor({cause:e,maxPriorityFeePerGas:n,maxFeePerGas:r}={}){super([`The provided tip (\`maxPriorityFeePerGas\`${n?` = ${Sn(n)} gwei`:""}) cannot be higher than the fee cap (\`maxFeePerGas\`${r?` = ${Sn(r)} gwei`:""}).`].join(`
`),{cause:e,name:"TipAboveFeeCapError"})}}Object.defineProperty(al,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max priority fee per gas higher than max fee per gas|tip higher than fee cap/});class ef extends q{constructor({cause:e}){super(`An error occurred while executing: ${e==null?void 0:e.shortMessage}`,{cause:e,name:"UnknownNodeError"})}}function ag(t,e){const n=(t.details||"").toLowerCase(),r=t instanceof q?t.walk(s=>(s==null?void 0:s.code)===Ji.code):t;return r instanceof q?new Ji({cause:t,message:r.details}):Ji.nodeMessage.test(n)?new Ji({cause:t,message:t.details}):bo.nodeMessage.test(n)?new bo({cause:t,maxFeePerGas:e==null?void 0:e.maxFeePerGas}):Ip.nodeMessage.test(n)?new Ip({cause:t,maxFeePerGas:e==null?void 0:e.maxFeePerGas}):Sp.nodeMessage.test(n)?new Sp({cause:t,nonce:e==null?void 0:e.nonce}):xp.nodeMessage.test(n)?new xp({cause:t,nonce:e==null?void 0:e.nonce}):Np.nodeMessage.test(n)?new Np({cause:t,nonce:e==null?void 0:e.nonce}):Tp.nodeMessage.test(n)?new Tp({cause:t}):Op.nodeMessage.test(n)?new Op({cause:t,gas:e==null?void 0:e.gas}):Rp.nodeMessage.test(n)?new Rp({cause:t,gas:e==null?void 0:e.gas}):Pp.nodeMessage.test(n)?new Pp({cause:t}):al.nodeMessage.test(n)?new al({cause:t,maxFeePerGas:e==null?void 0:e.maxFeePerGas,maxPriorityFeePerGas:e==null?void 0:e.maxPriorityFeePerGas}):new ef({cause:t})}function c3(t,{docsPath:e,...n}){const r=(()=>{const s=ag(t,n);return s instanceof ef?t:s})();return new a3(r,{docsPath:e,...n})}function tf(t,{format:e}){if(!e)return{};const n={};function r(i){const o=Object.keys(i);for(const a of o)a in t&&(n[a]=t[a]),i[a]&&typeof i[a]=="object"&&!Array.isArray(i[a])&&r(i[a])}const s=e(t||{});return r(s),n}function nf(t,e){return({exclude:n,format:r})=>({exclude:n,format:(s,i)=>{const o=e(s,i);if(n)for(const a of n)delete o[a];return{...o,...r(s,i)}},type:t})}const l3={legacy:"0x0",eip2930:"0x1",eip1559:"0x2",eip4844:"0x3",eip7702:"0x4"};function Tl(t,e){const n={};return typeof t.authorizationList<"u"&&(n.authorizationList=u3(t.authorizationList)),typeof t.accessList<"u"&&(n.accessList=t.accessList),typeof t.blobVersionedHashes<"u"&&(n.blobVersionedHashes=t.blobVersionedHashes),typeof t.blobs<"u"&&(typeof t.blobs[0]!="string"?n.blobs=t.blobs.map(r=>fn(r)):n.blobs=t.blobs),typeof t.data<"u"&&(n.data=t.data),t.account&&(n.from=t.account.address),typeof t.from<"u"&&(n.from=t.from),typeof t.gas<"u"&&(n.gas=re(t.gas)),typeof t.gasPrice<"u"&&(n.gasPrice=re(t.gasPrice)),typeof t.maxFeePerBlobGas<"u"&&(n.maxFeePerBlobGas=re(t.maxFeePerBlobGas)),typeof t.maxFeePerGas<"u"&&(n.maxFeePerGas=re(t.maxFeePerGas)),typeof t.maxPriorityFeePerGas<"u"&&(n.maxPriorityFeePerGas=re(t.maxPriorityFeePerGas)),typeof t.nonce<"u"&&(n.nonce=re(t.nonce)),typeof t.to<"u"&&(n.to=t.to),typeof t.type<"u"&&(n.type=l3[t.type]),typeof t.value<"u"&&(n.value=re(t.value)),n}const sZ=nf("transactionRequest",Tl);function u3(t){return t.map(e=>({address:e.address,r:e.r?re(BigInt(e.r)):e.r,s:e.s?re(BigInt(e.s)):e.s,chainId:re(e.chainId),nonce:re(e.nonce),...typeof e.yParity<"u"?{yParity:re(e.yParity)}:{},...typeof e.v<"u"&&typeof e.yParity>"u"?{v:re(e.v)}:{}}))}function iy(t){if(!(!t||t.length===0))return t.reduce((e,{slot:n,value:r})=>{if(n.length!==66)throw new zm({size:n.length,targetSize:66,type:"hex"});if(r.length!==66)throw new zm({size:r.length,targetSize:66,type:"hex"});return e[n]=r,e},{})}function d3(t){const{balance:e,nonce:n,state:r,stateDiff:s,code:i}=t,o={};if(i!==void 0&&(o.code=i),e!==void 0&&(o.balance=re(e)),n!==void 0&&(o.nonce=re(n)),r!==void 0&&(o.state=iy(r)),s!==void 0){if(o.state)throw new BT;o.stateDiff=iy(s)}return o}function gv(t){if(!t)return;const e={};for(const{address:n,...r}of t){if(!jt(n,{strict:!1}))throw new Nn({address:n});if(e[n])throw new UT({address:n});e[n]=d3(r)}return e}const iZ=2n**16n-1n,rf=2n**256n-1n;function Ol(t){const{account:e,maxFeePerGas:n,maxPriorityFeePerGas:r,to:s}=t,i=e?sr(e):void 0;if(i&&!jt(i.address))throw new Nn({address:i.address});if(s&&!jt(s))throw new Nn({address:s});if(n&&n>rf)throw new bo({maxFeePerGas:n});if(r&&n&&r>n)throw new al({maxFeePerGas:n,maxPriorityFeePerGas:r})}class mv extends q{constructor(){super("`baseFeeMultiplier` must be greater than 1.",{name:"BaseFeeScalarError"})}}class cg extends q{constructor(){super("Chain does not support EIP-1559 fees.",{name:"Eip1559FeesNotSupportedError"})}}class f3 extends q{constructor({maxPriorityFeePerGas:e}){super(`\`maxFeePerGas\` cannot be less than the \`maxPriorityFeePerGas\` (${Sn(e)} gwei).`,{name:"MaxFeePerGasTooLowError"})}}class yv extends q{constructor({blockHash:e,blockNumber:n}){let r="Block";e&&(r=`Block at hash "${e}"`),n&&(r=`Block at number "${n}"`),super(`${r} could not be found.`,{name:"BlockNotFoundError"})}}const bv={"0x0":"legacy","0x1":"eip2930","0x2":"eip1559","0x3":"eip4844","0x4":"eip7702"};function Rl(t,e){const n={...t,blockHash:t.blockHash?t.blockHash:null,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,chainId:t.chainId?xi(t.chainId):void 0,gas:t.gas?BigInt(t.gas):void 0,gasPrice:t.gasPrice?BigInt(t.gasPrice):void 0,maxFeePerBlobGas:t.maxFeePerBlobGas?BigInt(t.maxFeePerBlobGas):void 0,maxFeePerGas:t.maxFeePerGas?BigInt(t.maxFeePerGas):void 0,maxPriorityFeePerGas:t.maxPriorityFeePerGas?BigInt(t.maxPriorityFeePerGas):void 0,nonce:t.nonce?xi(t.nonce):void 0,to:t.to?t.to:null,transactionIndex:t.transactionIndex?Number(t.transactionIndex):null,type:t.type?bv[t.type]:void 0,typeHex:t.type?t.type:void 0,value:t.value?BigInt(t.value):void 0,v:t.v?BigInt(t.v):void 0};return t.authorizationList&&(n.authorizationList=p3(t.authorizationList)),n.yParity=(()=>{if(t.yParity)return Number(t.yParity);if(typeof n.v=="bigint"){if(n.v===0n||n.v===27n)return 0;if(n.v===1n||n.v===28n)return 1;if(n.v>=35n)return n.v%2n===0n?1:0}})(),n.type==="legacy"&&(delete n.accessList,delete n.maxFeePerBlobGas,delete n.maxFeePerGas,delete n.maxPriorityFeePerGas,delete n.yParity),n.type==="eip2930"&&(delete n.maxFeePerBlobGas,delete n.maxFeePerGas,delete n.maxPriorityFeePerGas),n.type==="eip1559"&&delete n.maxFeePerBlobGas,n}const h3=nf("transaction",Rl);function p3(t){return t.map(e=>({address:e.address,chainId:Number(e.chainId),nonce:Number(e.nonce),r:e.r,s:e.s,yParity:Number(e.yParity)}))}function wv(t,e){const n=(t.transactions??[]).map(r=>typeof r=="string"?r:Rl(r));return{...t,baseFeePerGas:t.baseFeePerGas?BigInt(t.baseFeePerGas):null,blobGasUsed:t.blobGasUsed?BigInt(t.blobGasUsed):void 0,difficulty:t.difficulty?BigInt(t.difficulty):void 0,excessBlobGas:t.excessBlobGas?BigInt(t.excessBlobGas):void 0,gasLimit:t.gasLimit?BigInt(t.gasLimit):void 0,gasUsed:t.gasUsed?BigInt(t.gasUsed):void 0,hash:t.hash?t.hash:null,logsBloom:t.logsBloom?t.logsBloom:null,nonce:t.nonce?t.nonce:null,number:t.number?BigInt(t.number):null,size:t.size?BigInt(t.size):void 0,timestamp:t.timestamp?BigInt(t.timestamp):void 0,transactions:n,totalDifficulty:t.totalDifficulty?BigInt(t.totalDifficulty):null}}const g3=nf("block",wv);async function Ea(t,{blockHash:e,blockNumber:n,blockTag:r=t.experimental_blockTag??"latest",includeTransactions:s}={}){var l,u,d;const i=s??!1,o=n!==void 0?re(n):void 0;let a=null;if(e?a=await t.request({method:"eth_getBlockByHash",params:[e,i]},{dedupe:!0}):a=await t.request({method:"eth_getBlockByNumber",params:[o||r,i]},{dedupe:!!o}),!a)throw new yv({blockHash:e,blockNumber:n});return(((d=(u=(l=t.chain)==null?void 0:l.formatters)==null?void 0:u.block)==null?void 0:d.format)||wv)(a,"getBlock")}async function Ev(t){const e=await t.request({method:"eth_gasPrice"});return BigInt(e)}async function oZ(t,e){return vv(t,e)}async function vv(t,e){var i,o;const{block:n,chain:r=t.chain,request:s}=e||{};try{const a=((i=r==null?void 0:r.fees)==null?void 0:i.maxPriorityFeePerGas)??((o=r==null?void 0:r.fees)==null?void 0:o.defaultPriorityFee);if(typeof a=="function"){const l=n||await Ze(t,Ea,"getBlock")({}),u=await a({block:l,client:t,request:s});if(u===null)throw new Error;return u}if(typeof a<"u")return a;const c=await t.request({method:"eth_maxPriorityFeePerGas"});return Er(c)}catch{const[a,c]=await Promise.all([n?Promise.resolve(n):Ze(t,Ea,"getBlock")({}),Ze(t,Ev,"getGasPrice")({})]);if(typeof a.baseFeePerGas!="bigint")throw new cg;const l=c-a.baseFeePerGas;return l<0n?0n:l}}async function aZ(t,e){return kp(t,e)}async function kp(t,e){var f,h;const{block:n,chain:r=t.chain,request:s,type:i="eip1559"}=e||{},o=await(async()=>{var p,g;return typeof((p=r==null?void 0:r.fees)==null?void 0:p.baseFeeMultiplier)=="function"?r.fees.baseFeeMultiplier({block:n,client:t,request:s}):((g=r==null?void 0:r.fees)==null?void 0:g.baseFeeMultiplier)??1.2})();if(o<1)throw new mv;const c=10**(((f=o.toString().split(".")[1])==null?void 0:f.length)??0),l=p=>p*BigInt(Math.ceil(o*c))/BigInt(c),u=n||await Ze(t,Ea,"getBlock")({});if(typeof((h=r==null?void 0:r.fees)==null?void 0:h.estimateFeesPerGas)=="function"){const p=await r.fees.estimateFeesPerGas({block:n,client:t,multiply:l,request:s,type:i});if(p!==null)return p}if(i==="eip1559"){if(typeof u.baseFeePerGas!="bigint")throw new cg;const p=typeof(s==null?void 0:s.maxPriorityFeePerGas)=="bigint"?s.maxPriorityFeePerGas:await vv(t,{block:u,chain:r,request:s}),g=l(u.baseFeePerGas);return{maxFeePerGas:(s==null?void 0:s.maxFeePerGas)??g+p,maxPriorityFeePerGas:p}}return{gasPrice:(s==null?void 0:s.gasPrice)??l(await Ze(t,Ev,"getGasPrice")({}))}}async function m3(t,{address:e,blockTag:n="latest",blockNumber:r}){const s=await t.request({method:"eth_getTransactionCount",params:[e,typeof r=="bigint"?re(r):n]},{dedupe:!!r});return xi(s)}function lg(t){const{kzg:e}=t,n=t.to??(typeof t.blobs[0]=="string"?"hex":"bytes"),r=typeof t.blobs[0]=="string"?t.blobs.map(i=>Zr(i)):t.blobs,s=[];for(const i of r)s.push(Uint8Array.from(e.blobToKzgCommitment(i)));return n==="bytes"?s:s.map(i=>fn(i))}function ug(t){const{kzg:e}=t,n=t.to??(typeof t.blobs[0]=="string"?"hex":"bytes"),r=typeof t.blobs[0]=="string"?t.blobs.map(o=>Zr(o)):t.blobs,s=typeof t.commitments[0]=="string"?t.commitments.map(o=>Zr(o)):t.commitments,i=[];for(let o=0;o<r.length;o++){const a=r[o],c=s[o];i.push(Uint8Array.from(e.computeBlobKzgProof(a,c)))}return n==="bytes"?i:i.map(o=>fn(o))}function y3(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}function b3(t,e,n){return t&e^~t&n}function w3(t,e,n){return t&e^t&n^e&n}let Cv=class extends GE{constructor(e,n,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(e),this.view=jf(this.buffer)}update(e){hd(this),e=Y0(e),ga(e);const{view:n,buffer:r,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=jf(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){hd(this),KE(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,mo(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;y3(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=jf(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%n&&e.buffer.set(r),e}clone(){return this._cloneInto()}};const Ms=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),qt=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Vt=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),E3=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Fs=new Uint32Array(64);let v3=class extends Cv{constructor(e=32){super(64,e,8,!1),this.A=Ms[0]|0,this.B=Ms[1]|0,this.C=Ms[2]|0,this.D=Ms[3]|0,this.E=Ms[4]|0,this.F=Ms[5]|0,this.G=Ms[6]|0,this.H=Ms[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,n,r,s,i,o,a,c]}set(e,n,r,s,i,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)Fs[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const f=Fs[d-15],h=Fs[d-2],p=Or(f,7)^Or(f,18)^f>>>3,g=Or(h,17)^Or(h,19)^h>>>10;Fs[d]=g+Fs[d-7]+p+Fs[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const f=Or(a,6)^Or(a,11)^Or(a,25),h=u+f+b3(a,c,l)+E3[d]+Fs[d]|0,g=(Or(r,2)^Or(r,13)^Or(r,22))+w3(r,s,i)|0;u=l,l=c,c=a,a=o+h|0,o=i,i=s,s=r,r=h+g|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){mo(Fs)}destroy(){this.set(0,0,0,0,0,0,0,0),mo(this.buffer)}};const _v=VE(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),C3=_v[0],_3=_v[1],js=new Uint32Array(80),Hs=new Uint32Array(80);class Av extends Cv{constructor(e=64){super(128,e,16,!1),this.Ah=Vt[0]|0,this.Al=Vt[1]|0,this.Bh=Vt[2]|0,this.Bl=Vt[3]|0,this.Ch=Vt[4]|0,this.Cl=Vt[5]|0,this.Dh=Vt[6]|0,this.Dl=Vt[7]|0,this.Eh=Vt[8]|0,this.El=Vt[9]|0,this.Fh=Vt[10]|0,this.Fl=Vt[11]|0,this.Gh=Vt[12]|0,this.Gl=Vt[13]|0,this.Hh=Vt[14]|0,this.Hl=Vt[15]|0}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:f,Gh:h,Gl:p,Hh:g,Hl:m}=this;return[e,n,r,s,i,o,a,c,l,u,d,f,h,p,g,m]}set(e,n,r,s,i,o,a,c,l,u,d,f,h,p,g,m){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=f|0,this.Gh=h|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,n){for(let b=0;b<16;b++,n+=4)js[b]=e.getUint32(n),Hs[b]=e.getUint32(n+=4);for(let b=16;b<80;b++){const _=js[b-15]|0,C=Hs[b-15]|0,S=Do(_,C,1)^Do(_,C,8)^Km(_,C,7),x=$o(_,C,1)^$o(_,C,8)^Gm(_,C,7),P=js[b-2]|0,N=Hs[b-2]|0,L=Do(P,N,19)^Xl(P,N,61)^Km(P,N,6),M=$o(P,N,19)^Ql(P,N,61)^Gm(P,N,6),U=kN(x,M,Hs[b-7],Hs[b-16]),O=DN(U,S,L,js[b-7],js[b-16]);js[b]=O|0,Hs[b]=U|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:f,Fh:h,Fl:p,Gh:g,Gl:m,Hh:E,Hl:A}=this;for(let b=0;b<80;b++){const _=Do(d,f,14)^Do(d,f,18)^Xl(d,f,41),C=$o(d,f,14)^$o(d,f,18)^Ql(d,f,41),S=d&h^~d&g,x=f&p^~f&m,P=$N(A,C,x,_3[b],Hs[b]),N=UN(P,E,_,S,C3[b],js[b]),L=P|0,M=Do(r,s,28)^Xl(r,s,34)^Xl(r,s,39),U=$o(r,s,28)^Ql(r,s,34)^Ql(r,s,39),O=r&i^r&a^i&a,$=s&o^s&c^o&c;E=g|0,A=m|0,g=h|0,m=p|0,h=d|0,p=f|0,{h:d,l:f}=ts(l|0,u|0,N|0,L|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const y=RN(L,U,$);r=PN(y,N,M,O),s=y|0}({h:r,l:s}=ts(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=ts(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=ts(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=ts(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:f}=ts(this.Eh|0,this.El|0,d|0,f|0),{h,l:p}=ts(this.Fh|0,this.Fl|0,h|0,p|0),{h:g,l:m}=ts(this.Gh|0,this.Gl|0,g|0,m|0),{h:E,l:A}=ts(this.Hh|0,this.Hl|0,E|0,A|0),this.set(r,s,i,o,a,c,l,u,d,f,h,p,g,m,E,A)}roundClean(){mo(js,Hs)}destroy(){mo(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class A3 extends Av{constructor(){super(48),this.Ah=qt[0]|0,this.Al=qt[1]|0,this.Bh=qt[2]|0,this.Bl=qt[3]|0,this.Ch=qt[4]|0,this.Cl=qt[5]|0,this.Dh=qt[6]|0,this.Dl=qt[7]|0,this.Eh=qt[8]|0,this.El=qt[9]|0,this.Fh=qt[10]|0,this.Fl=qt[11]|0,this.Gh=qt[12]|0,this.Gl=qt[13]|0,this.Hh=qt[14]|0,this.Hl=qt[15]|0}}const I3=Xd(()=>new v3),uZ=Xd(()=>new Av),dZ=Xd(()=>new A3),S3=I3;function x3(t,e){const n=e||"hex",r=S3(Si(t,{strict:!1})?Jd(t):t);return n==="bytes"?r:nr(r)}function N3(t){const{commitment:e,version:n=1}=t,r=t.to??(typeof e=="string"?"hex":"bytes"),s=x3(e,"bytes");return s.set([n],0),r==="bytes"?s:fn(s)}function Iv(t){const{commitments:e,version:n}=t,r=t.to??(typeof e[0]=="string"?"hex":"bytes"),s=[];for(const i of e)s.push(N3({commitment:i,to:r,version:n}));return s}const oy=6,Sv=32,dg=4096,xv=Sv*dg,ay=xv*oy-1-1*dg*oy,Nv=1;class T3 extends q{constructor({maxSize:e,size:n}){super("Blob size is too large.",{metaMessages:[`Max: ${e} bytes`,`Given: ${n} bytes`],name:"BlobSizeTooLargeError"})}}class Tv extends q{constructor(){super("Blob data must not be empty.",{name:"EmptyBlobError"})}}class O3 extends q{constructor({hash:e,size:n}){super(`Versioned hash "${e}" size is invalid.`,{metaMessages:["Expected: 32",`Received: ${n}`],name:"InvalidVersionedHashSizeError"})}}class R3 extends q{constructor({hash:e,version:n}){super(`Versioned hash "${e}" version is invalid.`,{metaMessages:[`Expected: ${Nv}`,`Received: ${n}`],name:"InvalidVersionedHashVersionError"})}}function P3(t){const e=t.to??(typeof t.data=="string"?"hex":"bytes"),n=typeof t.data=="string"?Zr(t.data):t.data,r=bt(n);if(!r)throw new Tv;if(r>ay)throw new T3({maxSize:ay,size:r});const s=[];let i=!0,o=0;for(;i;){const a=rg(new Uint8Array(xv));let c=0;for(;c<dg;){const l=n.slice(o,o+(Sv-1));if(a.pushByte(0),a.pushBytes(l),l.length<31){a.pushByte(128),i=!1;break}c++,o+=31}s.push(a)}return e==="bytes"?s.map(a=>a.bytes):s.map(a=>fn(a.bytes))}function Ov(t){const{data:e,kzg:n,to:r}=t,s=t.blobs??P3({data:e,to:r}),i=t.commitments??lg({blobs:s,kzg:n,to:r}),o=t.proofs??ug({blobs:s,commitments:i,kzg:n,to:r}),a=[];for(let c=0;c<s.length;c++)a.push({blob:s[c],commitment:i[c],proof:o[c]});return a}function Rv(t){if(t.type)return t.type;if(typeof t.authorizationList<"u")return"eip7702";if(typeof t.blobs<"u"||typeof t.blobVersionedHashes<"u"||typeof t.maxFeePerBlobGas<"u"||typeof t.sidecars<"u")return"eip4844";if(typeof t.maxFeePerGas<"u"||typeof t.maxPriorityFeePerGas<"u")return"eip1559";if(typeof t.gasPrice<"u")return typeof t.accessList<"u"?"eip2930":"legacy";throw new FT({transaction:t})}function Pv(t,{docsPath:e,...n}){const r=(()=>{const s=ag(t,n);return s instanceof ef?t:s})();return new HT(r,{docsPath:e,...n})}async function fg(t){const e=await t.request({method:"eth_chainId"},{dedupe:!0});return xi(e)}async function k3(t,e){var P,N,L,M,U;const{account:n=t.account,accessList:r,authorizationList:s,chain:i=t.chain,blobVersionedHashes:o,blobs:a,data:c,gas:l,gasPrice:u,maxFeePerBlobGas:d,maxFeePerGas:f,maxPriorityFeePerGas:h,nonce:p,nonceManager:g,to:m,type:E,value:A,...b}=e,_=await(async()=>{if(!n||!g||typeof p<"u")return p;const O=sr(n),$=i?i.id:await Ze(t,fg,"getChainId")({});return await g.consume({address:O.address,chainId:$,client:t})})();Ol(e);const C=(N=(P=i==null?void 0:i.formatters)==null?void 0:P.transactionRequest)==null?void 0:N.format,x=(C||Tl)({...tf(b,{format:C}),account:n?sr(n):void 0,accessList:r,authorizationList:s,blobs:a,blobVersionedHashes:o,data:c,gas:l,gasPrice:u,maxFeePerBlobGas:d,maxFeePerGas:f,maxPriorityFeePerGas:h,nonce:_,to:m,type:E,value:A},"fillTransaction");try{const O=await t.request({method:"eth_fillTransaction",params:[x]}),y=(((M=(L=i==null?void 0:i.formatters)==null?void 0:L.transaction)==null?void 0:M.format)||Rl)(O.tx);delete y.blockHash,delete y.blockNumber,delete y.r,delete y.s,delete y.transactionIndex,delete y.v,delete y.yParity,y.data=y.input,y.gas&&(y.gas=e.gas??y.gas),y.gasPrice&&(y.gasPrice=e.gasPrice??y.gasPrice),y.maxFeePerBlobGas&&(y.maxFeePerBlobGas=e.maxFeePerBlobGas??y.maxFeePerBlobGas),y.maxFeePerGas&&(y.maxFeePerGas=e.maxFeePerGas??y.maxFeePerGas),y.maxPriorityFeePerGas&&(y.maxPriorityFeePerGas=e.maxPriorityFeePerGas??y.maxPriorityFeePerGas),y.nonce&&(y.nonce=e.nonce??y.nonce);const w=await(async()=>{var k,j;if(typeof((k=i==null?void 0:i.fees)==null?void 0:k.baseFeeMultiplier)=="function"){const H=await Ze(t,Ea,"getBlock")({});return i.fees.baseFeeMultiplier({block:H,client:t,request:e})}return((j=i==null?void 0:i.fees)==null?void 0:j.baseFeeMultiplier)??1.2})();if(w<1)throw new mv;const D=10**(((U=w.toString().split(".")[1])==null?void 0:U.length)??0),R=k=>k*BigInt(Math.ceil(w*D))/BigInt(D);return y.maxFeePerGas&&!e.maxFeePerGas&&(y.maxFeePerGas=R(y.maxFeePerGas)),y.gasPrice&&!e.gasPrice&&(y.gasPrice=R(y.gasPrice)),{raw:O.raw,transaction:{from:x.from,...y}}}catch(O){throw Pv(O,{...e,chain:t.chain})}}const kv=["blobVersionedHashes","chainId","fees","gas","nonce","type"],cy=new Map,zf=new Il(128);async function hg(t,e){var _,C,S;let n=e;n.account??(n.account=t.account),n.parameters??(n.parameters=kv);const{account:r,chain:s=t.chain,nonceManager:i,parameters:o}=n,a=(()=>{if(typeof(s==null?void 0:s.prepareTransactionRequest)=="function")return{fn:s.prepareTransactionRequest,runAt:["beforeFillTransaction"]};if(Array.isArray(s==null?void 0:s.prepareTransactionRequest))return{fn:s.prepareTransactionRequest[0],runAt:s.prepareTransactionRequest[1].runAt}})();let c;async function l(){return c||(typeof n.chainId<"u"?n.chainId:s?s.id:(c=await Ze(t,fg,"getChainId")({}),c))}const u=r&&sr(r);let d=n.nonce;if(o.includes("nonce")&&typeof d>"u"&&u&&i){const x=await l();d=await i.consume({address:u.address,chainId:x,client:t})}a!=null&&a.fn&&((_=a.runAt)!=null&&_.includes("beforeFillTransaction"))&&(n=await a.fn({...n,chain:s},{phase:"beforeFillTransaction"}),d??(d=n.nonce));const h=((o.includes("blobVersionedHashes")||o.includes("sidecars"))&&n.kzg&&n.blobs||zf.get(t.uid)===!1||!["fees","gas"].some(P=>o.includes(P))?!1:!!(o.includes("chainId")&&typeof n.chainId!="number"||o.includes("nonce")&&typeof d!="number"||o.includes("fees")&&typeof n.gasPrice!="bigint"&&(typeof n.maxFeePerGas!="bigint"||typeof n.maxPriorityFeePerGas!="bigint")||o.includes("gas")&&typeof n.gas!="bigint"))?await Ze(t,k3,"fillTransaction")({...n,nonce:d}).then(x=>{const{chainId:P,from:N,gas:L,gasPrice:M,nonce:U,maxFeePerBlobGas:O,maxFeePerGas:$,maxPriorityFeePerGas:y,type:w,...T}=x.transaction;return zf.set(t.uid,!0),{...n,...N?{from:N}:{},...w?{type:w}:{},...typeof P<"u"?{chainId:P}:{},...typeof L<"u"?{gas:L}:{},...typeof M<"u"?{gasPrice:M}:{},...typeof U<"u"?{nonce:U}:{},...typeof O<"u"?{maxFeePerBlobGas:O}:{},...typeof $<"u"?{maxFeePerGas:$}:{},...typeof y<"u"?{maxPriorityFeePerGas:y}:{},..."nonceKey"in T&&typeof T.nonceKey<"u"?{nonceKey:T.nonceKey}:{}}}).catch(x=>{var L;const P=x;return P.name!=="TransactionExecutionError"||((L=P.walk)==null?void 0:L.call(P,M=>{const U=M;return U.name==="MethodNotFoundRpcError"||U.name==="MethodNotSupportedRpcError"}))&&zf.set(t.uid,!1),n}):n;d??(d=h.nonce),n={...h,...u?{from:u==null?void 0:u.address}:{},...d?{nonce:d}:{}};const{blobs:p,gas:g,kzg:m,type:E}=n;a!=null&&a.fn&&((C=a.runAt)!=null&&C.includes("beforeFillParameters"))&&(n=await a.fn({...n,chain:s},{phase:"beforeFillParameters"}));let A;async function b(){return A||(A=await Ze(t,Ea,"getBlock")({blockTag:"latest"}),A)}if(o.includes("nonce")&&typeof d>"u"&&u&&!i&&(n.nonce=await Ze(t,m3,"getTransactionCount")({address:u.address,blockTag:"pending"})),(o.includes("blobVersionedHashes")||o.includes("sidecars"))&&p&&m){const x=lg({blobs:p,kzg:m});if(o.includes("blobVersionedHashes")){const P=Iv({commitments:x,to:"hex"});n.blobVersionedHashes=P}if(o.includes("sidecars")){const P=ug({blobs:p,commitments:x,kzg:m}),N=Ov({blobs:p,commitments:x,proofs:P,to:"hex"});n.sidecars=N}}if(o.includes("chainId")&&(n.chainId=await l()),(o.includes("fees")||o.includes("type"))&&typeof E>"u")try{n.type=Rv(n)}catch{let x=cy.get(t.uid);if(typeof x>"u"){const P=await b();x=typeof(P==null?void 0:P.baseFeePerGas)=="bigint",cy.set(t.uid,x)}n.type=x?"eip1559":"legacy"}if(o.includes("fees"))if(n.type!=="legacy"&&n.type!=="eip2930"){if(typeof n.maxFeePerGas>"u"||typeof n.maxPriorityFeePerGas>"u"){const x=await b(),{maxFeePerGas:P,maxPriorityFeePerGas:N}=await kp(t,{block:x,chain:s,request:n});if(typeof n.maxPriorityFeePerGas>"u"&&n.maxFeePerGas&&n.maxFeePerGas<N)throw new f3({maxPriorityFeePerGas:N});n.maxPriorityFeePerGas=N,n.maxFeePerGas=P}}else{if(typeof n.maxFeePerGas<"u"||typeof n.maxPriorityFeePerGas<"u")throw new cg;if(typeof n.gasPrice>"u"){const x=await b(),{gasPrice:P}=await kp(t,{block:x,chain:s,request:n,type:"legacy"});n.gasPrice=P}}return o.includes("gas")&&typeof g>"u"&&(n.gas=await Ze(t,Dv,"estimateGas")({...n,account:u,prepare:(u==null?void 0:u.type)==="local"?[]:["blobVersionedHashes"]})),a!=null&&a.fn&&((S=a.runAt)!=null&&S.includes("afterFillParameters"))&&(n=await a.fn({...n,chain:s},{phase:"afterFillParameters"})),Ol(n),delete n.parameters,n}async function Dv(t,e){var o,a,c;const{account:n=t.account,prepare:r=!0}=e,s=n?sr(n):void 0,i=(()=>{if(Array.isArray(r))return r;if((s==null?void 0:s.type)!=="local")return["blobVersionedHashes"]})();try{const l=await(async()=>{if(e.to)return e.to;if(e.authorizationList&&e.authorizationList.length>0)return await pv({authorization:e.authorizationList[0]}).catch(()=>{throw new q("`to` is required. Could not infer from `authorizationList`")})})(),{accessList:u,authorizationList:d,blobs:f,blobVersionedHashes:h,blockNumber:p,blockTag:g,data:m,gas:E,gasPrice:A,maxFeePerBlobGas:b,maxFeePerGas:_,maxPriorityFeePerGas:C,nonce:S,value:x,stateOverride:P,...N}=r?await hg(t,{...e,parameters:i,to:l}):e;if(E&&e.gas!==E)return E;const M=(typeof p=="bigint"?re(p):void 0)||g,U=gv(P);Ol(e);const O=(c=(a=(o=t.chain)==null?void 0:o.formatters)==null?void 0:a.transactionRequest)==null?void 0:c.format,y=(O||Tl)({...tf(N,{format:O}),account:s,accessList:u,authorizationList:d,blobs:f,blobVersionedHashes:h,data:m,gasPrice:A,maxFeePerBlobGas:b,maxFeePerGas:_,maxPriorityFeePerGas:C,nonce:S,to:l,value:x},"estimateGas");return BigInt(await t.request({method:"eth_estimateGas",params:U?[y,M??t.experimental_blockTag??"latest",U]:M?[y,M]:[y]}))}catch(l){throw c3(l,{...e,account:s,chain:t.chain})}}function D3(t,e){if(!jt(t,{strict:!1}))throw new Nn({address:t});if(!jt(e,{strict:!1}))throw new Nn({address:e});return t.toLowerCase()===e.toLowerCase()}const ly="/docs/contract/decodeEventLog";function uy(t){const{abi:e,data:n,strict:r,topics:s}=t,i=r??!0,[o,...a]=s;if(!o)throw new aN({docsPath:ly});const c=e.find(g=>g.type==="event"&&o===Z0(Ii(g)));if(!(c&&"name"in c)||c.type!=="event")throw new cN(o,{docsPath:ly});const{name:l,inputs:u}=c,d=u==null?void 0:u.some(g=>!("name"in g&&g.name)),f=d?[]:{},h=u.map((g,m)=>[g,m]).filter(([g])=>"indexed"in g&&g.indexed);for(let g=0;g<h.length;g++){const[m,E]=h[g],A=a[g];if(!A)throw new dN({abiItem:c,param:m});f[d?E:m.name||E]=$3({param:m,value:A})}const p=u.filter(g=>!("indexed"in g&&g.indexed));if(p.length>0){if(n&&n!=="0x")try{const g=Qd(p,n);if(g)if(d)for(let m=0;m<u.length;m++)f[m]=f[m]??g.shift();else for(let m=0;m<p.length;m++)f[p[m].name]=g[m]}catch(g){if(i)throw g instanceof ME||g instanceof ov?new Wm({abiItem:c,data:n,params:p,size:bt(n)}):g}else if(i)throw new Wm({abiItem:c,data:"0x",params:p,size:0})}return{eventName:l,args:Object.values(f).length>0?f:void 0}}function $3({param:t,value:e}){return t.type==="string"||t.type==="bytes"||t.type==="tuple"||t.type.match(/^(.*)\[(\d+)?\]$/)?e:(Qd([t],e)||[])[0]}function U3(t){const{abi:e,args:n,logs:r,strict:s=!0}=t,i=(()=>{if(t.eventName)return Array.isArray(t.eventName)?t.eventName:[t.eventName]})();return r.map(o=>{var u;const a=e.filter(d=>d.type==="event"&&o.topics[0]===Z0(d));if(a.length===0)return null;let c,l;for(const d of a)try{c=uy({...o,abi:[d],strict:!0}),l=d;break}catch{}if(!c&&!s){l=a[0];try{c=uy({...o,abi:[l],strict:!1})}catch{const d=(u=l.inputs)==null?void 0:u.some(f=>!("name"in f&&f.name));return{...o,args:d?[]:{},eventName:l.name}}}return!c||!l||i&&!i.includes(c.eventName)||!B3({args:c.args,inputs:l.inputs,matchArgs:n})?null:{...c,...o}}).filter(Boolean)}function B3(t){const{args:e,inputs:n,matchArgs:r}=t;if(!r)return!0;if(!e)return!1;function s(i,o,a){try{return i.type==="address"?D3(o,a):i.type==="string"||i.type==="bytes"?Al(Jd(o))===a:o===a}catch{return!1}}return Array.isArray(e)&&Array.isArray(r)?r.every((i,o)=>{if(i==null)return!0;const a=n[o];return a?(Array.isArray(i)?i:[i]).some(l=>s(a,l,e[o])):!1}):typeof e=="object"&&!Array.isArray(e)&&typeof r=="object"&&!Array.isArray(r)?Object.entries(r).every(([i,o])=>{if(o==null)return!0;const a=n.find(l=>l.name===i);return a?(Array.isArray(o)?o:[o]).some(l=>s(a,l,e[i])):!1}):!1}function $v(t,{args:e,eventName:n}={}){return{...t,blockHash:t.blockHash?t.blockHash:null,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,blockTimestamp:t.blockTimestamp?BigInt(t.blockTimestamp):t.blockTimestamp===null?null:void 0,logIndex:t.logIndex?Number(t.logIndex):null,transactionHash:t.transactionHash?t.transactionHash:null,transactionIndex:t.transactionIndex?Number(t.transactionIndex):null,...n?{args:e,eventName:n}:{}}}const qf="/docs/contract/decodeFunctionResult";function Uv(t){const{abi:e,args:n,functionName:r,data:s}=t;let i=e[0];if(r){const a=tg({abi:e,args:n,name:r});if(!a)throw new dd(r,{docsPath:qf});i=a}if(i.type!=="function")throw new dd(void 0,{docsPath:qf});if(!i.outputs)throw new lN(i.name,{docsPath:qf});const o=Qd(i.outputs,s);if(o&&o.length>1)return o;if(o&&o.length===1)return o[0]}const L3="0.1.1";function M3(){return L3}let hn=class ds extends Error{static setStaticOptions(e){ds.prototype.docsOrigin=e.docsOrigin,ds.prototype.showVersion=e.showVersion,ds.prototype.version=e.version}constructor(e,n={}){const r=(()=>{var u;if(n.cause instanceof ds){if(n.cause.details)return n.cause.details;if(n.cause.shortMessage)return n.cause.shortMessage}return n.cause&&"details"in n.cause&&typeof n.cause.details=="string"?n.cause.details:(u=n.cause)!=null&&u.message?n.cause.message:n.details})(),s=n.cause instanceof ds&&n.cause.docsPath||n.docsPath,i=n.docsOrigin??ds.prototype.docsOrigin,o=`${i}${s??""}`,a=!!(n.version??ds.prototype.showVersion),c=n.version??ds.prototype.version,l=[e||"An error occurred.",...n.metaMessages?["",...n.metaMessages]:[],...r||s||a?["",r?`Details: ${r}`:void 0,s?`See: ${o}`:void 0,a?`Version: ${c}`:void 0]:[]].filter(u=>typeof u=="string").join(`
`);super(l,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsOrigin",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"showVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.cause=n.cause,this.details=r,this.docs=o,this.docsOrigin=i,this.docsPath=s,this.shortMessage=e,this.showVersion=a,this.version=c}walk(e){return Bv(this,e)}};Object.defineProperty(hn,"defaultStaticOptions",{enumerable:!0,configurable:!0,writable:!0,value:{docsOrigin:"https://oxlib.sh",showVersion:!1,version:`ox@${M3()}`}});hn.setStaticOptions(hn.defaultStaticOptions);function Bv(t,e){return e!=null&&e(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause?Bv(t.cause,e):e?null:t}function Ra(t,e){if(fy(t)>e)throw new Q3({givenSize:fy(t),maxSize:e})}const ns={zero:48,nine:57,A:65,F:70,a:97,f:102};function dy(t){if(t>=ns.zero&&t<=ns.nine)return t-ns.zero;if(t>=ns.A&&t<=ns.F)return t-(ns.A-10);if(t>=ns.a&&t<=ns.f)return t-(ns.a-10)}function F3(t,e={}){const{dir:n,size:r=32}=e;if(r===0)return t;if(t.length>r)throw new eO({size:t.length,targetSize:r,type:"Bytes"});const s=new Uint8Array(r);for(let i=0;i<r;i++){const o=n==="right";s[o?i:r-i-1]=t[o?i:t.length-i-1]}return s}function Lv(t,e={}){const{dir:n="left"}=e;let r=t,s=0;for(let i=0;i<r.length-1&&r[n==="left"?i:r.length-i-1].toString()==="0";i++)s++;return r=n==="left"?r.slice(s):r.slice(0,r.length-s),r}function sf(t,e){if(Ca(t)>e)throw new oO({givenSize:Ca(t),maxSize:e})}function j3(t,e){if(typeof e=="number"&&e>0&&e>Ca(t)-1)throw new Vv({offset:e,position:"start",size:Ca(t)})}function H3(t,e,n){if(typeof e=="number"&&typeof n=="number"&&Ca(t)!==n-e)throw new Vv({offset:n,position:"end",size:Ca(t)})}function Mv(t,e={}){const{dir:n,size:r=32}=e;if(r===0)return t;const s=t.replace("0x","");if(s.length>r*2)throw new aO({size:Math.ceil(s.length/2),targetSize:r,type:"Hex"});return`0x${s[n==="right"?"padEnd":"padStart"](r*2,"0")}`}function W3(t,e={}){const{dir:n="left"}=e;let r=t.replace("0x",""),s=0;for(let i=0;i<r.length-1&&r[n==="left"?i:r.length-i-1].toString()==="0";i++)s++;return r=n==="left"?r.slice(s):r.slice(0,r.length-s),r==="0"?"0x":n==="right"&&r.length%2===1?`0x${r}0`:`0x${r}`}const z3="#__bigint";function Fv(t,e,n){return JSON.stringify(t,(r,s)=>typeof s=="bigint"?s.toString()+z3:s,n)}const q3=new TextDecoder,V3=new TextEncoder;function K3(t){if(!(t instanceof Uint8Array)){if(!t)throw new eu(t);if(typeof t!="object")throw new eu(t);if(!("BYTES_PER_ELEMENT"in t))throw new eu(t);if(t.BYTES_PER_ELEMENT!==1||t.constructor.name!=="Uint8Array")throw new eu(t)}}function fZ(...t){let e=0;for(const r of t)e+=r.length;const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}function hZ(t){return t instanceof Uint8Array?t:typeof t=="string"?jv(t):G3(t)}function G3(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function jv(t,e={}){const{size:n}=e;let r=t;n&&(sf(t,n),r=zv(t,n));let s=r.slice(2);s.length%2&&(s=`0${s}`);const i=s.length/2,o=new Uint8Array(i);for(let a=0,c=0;a<i;a++){const l=dy(s.charCodeAt(c++)),u=dy(s.charCodeAt(c++));if(l===void 0||u===void 0)throw new hn(`Invalid byte sequence ("${s[c-2]}${s[c-1]}" in "${s}").`);o[a]=l<<4|u}return o}function pZ(t,e={}){const{size:n}=e,r=V3.encode(t);return typeof n=="number"?(Ra(r,n),Y3(r,n)):r}function Y3(t,e){return F3(t,{dir:"right",size:e})}function Z3(t){return crypto.getRandomValues(new Uint8Array(t))}function fy(t){return t.length}function gZ(t,e,n,r={}){const{strict:s}=r;return t.slice(e,n)}function mZ(t,e={}){const{size:n}=e;typeof n<"u"&&Ra(t,n);const r=va(t,e);return qv(r,e)}function yZ(t,e={}){const{size:n}=e;let r=t;if(typeof n<"u"&&(Ra(r,n),r=J3(r)),r.length>1||r[0]>1)throw new X3(r);return!!r[0]}function bZ(t,e={}){const{size:n}=e;typeof n<"u"&&Ra(t,n);const r=va(t,e);return sO(r,e)}function wZ(t,e={}){const{size:n}=e;let r=t;return typeof n<"u"&&(Ra(r,n),r=Hv(r)),q3.decode(r)}function J3(t){return Lv(t,{dir:"left"})}function Hv(t){return Lv(t,{dir:"right"})}function EZ(t){try{return K3(t),!0}catch{return!1}}class X3 extends hn{constructor(e){super(`Bytes value \`${e}\` is not a valid boolean.`,{metaMessages:["The bytes array must contain a single byte of either a `0` or `1` value."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesBooleanError"})}}let eu=class extends hn{constructor(e){super(`Value \`${typeof e=="object"?Fv(e):e}\` of type \`${typeof e}\` is an invalid Bytes value.`,{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"})}},Q3=class extends hn{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}},eO=class extends hn{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}};const tO=new TextEncoder,nO=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function rO(t,e={}){const{strict:n=!1}=e;if(!t)throw new hy(t);if(typeof t!="string")throw new hy(t);if(n&&!/^0x[0-9a-fA-F]*$/.test(t))throw new py(t);if(!t.startsWith("0x"))throw new py(t)}function AZ(...t){return`0x${t.reduce((e,n)=>e+n.replace("0x",""),"")}`}function IZ(t){return t instanceof Uint8Array?va(t):Array.isArray(t)?va(new Uint8Array(t)):t}function SZ(t,e={}){const n=`0x${Number(t)}`;return typeof e.size=="number"?(sf(n,e.size),Wv(n,e.size)):n}function va(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=nO[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(sf(r,e.size),zv(r,e.size)):r}function bs(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const l=typeof t=="bigint"?"n":"";throw new iO({max:i?`${i}${l}`:void 0,min:`${o}${l}`,signed:n,size:r,value:`${t}${l}`})}const c=`0x${(n&&s<0?BigInt.asUintN(r*8,BigInt(s)):s).toString(16)}`;return r?Wv(c,r):c}function xZ(t,e={}){return va(tO.encode(t),e)}function Wv(t,e){return Mv(t,{dir:"left",size:e})}function zv(t,e){return Mv(t,{dir:"right",size:e})}function NZ(t){return va(Z3(t))}function TZ(t,e,n,r={}){const{strict:s}=r;j3(t,e);const i=`0x${t.replace("0x","").slice((e??0)*2,(n??t.length)*2)}`;return s&&H3(i,e,n),i}function Ca(t){return Math.ceil((t.length-2)/2)}function OZ(t){return W3(t,{dir:"left"})}function qv(t,e={}){const{signed:n}=e;e.size&&sf(t,e.size);const r=BigInt(t);if(!n)return r;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n)-1n,o=i>>1n;return r<=o?r:r-i-1n}function sO(t,e={}){const{signed:n,size:r}=e;return Number(!n&&!r?t:qv(t,e))}function RZ(t,e={}){const{size:n}=e;let r=jv(t);return n&&(Ra(r,n),r=Hv(r)),new TextDecoder().decode(r)}function PZ(t,e={}){const{strict:n=!1}=e;try{return rO(t,{strict:n}),!0}catch{return!1}}let iO=class extends hn{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number \`${i}\` is not in safe${s?` ${s*8}-bit`:""}${r?" signed":" unsigned"} integer range ${e?`(\`${n}\` to \`${e}\`)`:`(above \`${n}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}},hy=class extends hn{constructor(e){super(`Value \`${typeof e=="object"?Fv(e):e}\` of type \`${typeof e}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}},py=class extends hn{constructor(e){super(`Value \`${e}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}};class UZ extends hn{constructor(e){super(`Hex value \`"${e}"\` is an odd length (${e.length-2} nibbles).`,{metaMessages:["It must be an even length."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidLengthError"})}}let oO=class extends hn{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}},Vv=class extends hn{constructor({offset:e,position:n,size:r}){super(`Slice ${n==="start"?"starting":"ending"} at offset \`${e}\` is out-of-bounds (size: \`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}},aO=class extends hn{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}};function cO(t){return{address:t.address,amount:bs(t.amount),index:bs(t.index),validatorIndex:bs(t.validatorIndex)}}function lO(t){return{...typeof t.baseFeePerGas=="bigint"&&{baseFeePerGas:bs(t.baseFeePerGas)},...typeof t.blobBaseFee=="bigint"&&{blobBaseFee:bs(t.blobBaseFee)},...typeof t.feeRecipient=="string"&&{feeRecipient:t.feeRecipient},...typeof t.gasLimit=="bigint"&&{gasLimit:bs(t.gasLimit)},...typeof t.number=="bigint"&&{number:bs(t.number)},...typeof t.prevRandao=="bigint"&&{prevRandao:bs(t.prevRandao)},...typeof t.time=="bigint"&&{time:bs(t.time)},...t.withdrawals&&{withdrawals:t.withdrawals.map(cO)}}}const gy=[{inputs:[{components:[{name:"target",type:"address"},{name:"allowFailure",type:"bool"},{name:"callData",type:"bytes"}],name:"calls",type:"tuple[]"}],name:"aggregate3",outputs:[{components:[{name:"success",type:"bool"},{name:"returnData",type:"bytes"}],name:"returnData",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getCurrentBlockTimestamp",outputs:[{internalType:"uint256",name:"timestamp",type:"uint256"}],stateMutability:"view",type:"function"}],FZ=[{name:"query",type:"function",stateMutability:"view",inputs:[{type:"tuple[]",name:"queries",components:[{type:"address",name:"sender"},{type:"string[]",name:"urls"},{type:"bytes",name:"data"}]}],outputs:[{type:"bool[]",name:"failures"},{type:"bytes[]",name:"responses"}]},{name:"HttpError",type:"error",inputs:[{type:"uint16",name:"status"},{type:"string",name:"message"}]}],Kv=[{inputs:[{name:"dns",type:"bytes"}],name:"DNSDecodingFailed",type:"error"},{inputs:[{name:"ens",type:"string"}],name:"DNSEncodingFailed",type:"error"},{inputs:[],name:"EmptyAddress",type:"error"},{inputs:[{name:"status",type:"uint16"},{name:"message",type:"string"}],name:"HttpError",type:"error"},{inputs:[],name:"InvalidBatchGatewayResponse",type:"error"},{inputs:[{name:"errorData",type:"bytes"}],name:"ResolverError",type:"error"},{inputs:[{name:"name",type:"bytes"},{name:"resolver",type:"address"}],name:"ResolverNotContract",type:"error"},{inputs:[{name:"name",type:"bytes"}],name:"ResolverNotFound",type:"error"},{inputs:[{name:"primary",type:"string"},{name:"primaryAddress",type:"bytes"}],name:"ReverseAddressMismatch",type:"error"},{inputs:[{internalType:"bytes4",name:"selector",type:"bytes4"}],name:"UnsupportedResolverProfile",type:"error"}],jZ=[...Kv,{name:"resolveWithGateways",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes"},{name:"data",type:"bytes"},{name:"gateways",type:"string[]"}],outputs:[{name:"",type:"bytes"},{name:"address",type:"address"}]}],HZ=[...Kv,{name:"reverseWithGateways",type:"function",stateMutability:"view",inputs:[{type:"bytes",name:"reverseName"},{type:"uint256",name:"coinType"},{type:"string[]",name:"gateways"}],outputs:[{type:"string",name:"resolvedName"},{type:"address",name:"resolver"},{type:"address",name:"reverseResolver"}]}],WZ=[{name:"text",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"key",type:"string"}],outputs:[{name:"",type:"string"}]}],zZ=[{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"}],outputs:[{name:"",type:"address"}]},{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"coinType",type:"uint256"}],outputs:[{name:"",type:"bytes"}]}],qZ=[{name:"isValidSignature",type:"function",stateMutability:"view",inputs:[{name:"hash",type:"bytes32"},{name:"signature",type:"bytes"}],outputs:[{name:"",type:"bytes4"}]}],VZ=[{inputs:[{name:"_signer",type:"address"},{name:"_hash",type:"bytes32"},{name:"_signature",type:"bytes"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[{name:"_signer",type:"address"},{name:"_hash",type:"bytes32"},{name:"_signature",type:"bytes"}],outputs:[{type:"bool"}],stateMutability:"nonpayable",type:"function",name:"isValidSig"}],tu=[{type:"event",name:"Approval",inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}]},{type:"event",name:"Transfer",inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}]},{type:"function",name:"allowance",stateMutability:"view",inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]},{type:"function",name:"balanceOf",stateMutability:"view",inputs:[{name:"account",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"decimals",stateMutability:"view",inputs:[],outputs:[{type:"uint8"}]},{type:"function",name:"name",stateMutability:"view",inputs:[],outputs:[{type:"string"}]},{type:"function",name:"symbol",stateMutability:"view",inputs:[],outputs:[{type:"string"}]},{type:"function",name:"totalSupply",stateMutability:"view",inputs:[],outputs:[{type:"uint256"}]},{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],uO="0x82ad56cb",dO="0x608060405234801561001057600080fd5b5060405161018e38038061018e83398101604081905261002f91610124565b6000808351602085016000f59050803b61004857600080fd5b6000808351602085016000855af16040513d6000823e81610067573d81fd5b3d81f35b634e487b7160e01b600052604160045260246000fd5b600082601f83011261009257600080fd5b81516001600160401b038111156100ab576100ab61006b565b604051601f8201601f19908116603f011681016001600160401b03811182821017156100d9576100d961006b565b6040528181528382016020018510156100f157600080fd5b60005b82811015610110576020818601810151838301820152016100f4565b506000918101602001919091529392505050565b6000806040838503121561013757600080fd5b82516001600160401b0381111561014d57600080fd5b61015985828601610081565b602085015190935090506001600160401b0381111561017757600080fd5b61018385828601610081565b915050925092905056fe",fO="0x608060405234801561001057600080fd5b506040516102c03803806102c083398101604081905261002f916101e6565b836001600160a01b03163b6000036100e457600080836001600160a01b03168360405161005c9190610270565b6000604051808303816000865af19150503d8060008114610099576040519150601f19603f3d011682016040523d82523d6000602084013e61009e565b606091505b50915091508115806100b857506001600160a01b0386163b155b156100e1578060405163101bb98d60e01b81526004016100d8919061028c565b60405180910390fd5b50505b6000808451602086016000885af16040513d6000823e81610103573d81fd5b3d81f35b80516001600160a01b038116811461011e57600080fd5b919050565b634e487b7160e01b600052604160045260246000fd5b60005b8381101561015457818101518382015260200161013c565b50506000910152565b600082601f83011261016e57600080fd5b81516001600160401b0381111561018757610187610123565b604051601f8201601f19908116603f011681016001600160401b03811182821017156101b5576101b5610123565b6040528181528382016020018510156101cd57600080fd5b6101de826020830160208701610139565b949350505050565b600080600080608085870312156101fc57600080fd5b61020585610107565b60208601519094506001600160401b0381111561022157600080fd5b61022d8782880161015d565b93505061023c60408601610107565b60608601519092506001600160401b0381111561025857600080fd5b6102648782880161015d565b91505092959194509250565b60008251610282818460208701610139565b9190910192915050565b60208152600082518060208401526102ab816040850160208701610139565b601f01601f1916919091016040019291505056fe",KZ="0x608060405234801561001057600080fd5b5060405161069438038061069483398101604081905261002f9161051e565b600061003c848484610048565b9050806000526001601ff35b60007f64926492649264926492649264926492649264926492649264926492649264926100748361040c565b036101e7576000606080848060200190518101906100929190610577565b60405192955090935091506000906001600160a01b038516906100b69085906105dd565b6000604051808303816000865af19150503d80600081146100f3576040519150601f19603f3d011682016040523d82523d6000602084013e6100f8565b606091505b50509050876001600160a01b03163b60000361016057806101605760405162461bcd60e51b815260206004820152601e60248201527f5369676e617475726556616c696461746f723a206465706c6f796d656e74000060448201526064015b60405180910390fd5b604051630b135d3f60e11b808252906001600160a01b038a1690631626ba7e90610190908b9087906004016105f9565b602060405180830381865afa1580156101ad573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101d19190610633565b6001600160e01b03191614945050505050610405565b6001600160a01b0384163b1561027a57604051630b135d3f60e11b808252906001600160a01b03861690631626ba7e9061022790879087906004016105f9565b602060405180830381865afa158015610244573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906102689190610633565b6001600160e01b031916149050610405565b81516041146102df5760405162461bcd60e51b815260206004820152603a602482015260008051602061067483398151915260448201527f3a20696e76616c6964207369676e6174757265206c656e6774680000000000006064820152608401610157565b6102e7610425565b5060208201516040808401518451859392600091859190811061030c5761030c61065d565b016020015160f81c9050601b811480159061032b57508060ff16601c14155b1561038c5760405162461bcd60e51b815260206004820152603b602482015260008051602061067483398151915260448201527f3a20696e76616c6964207369676e617475726520762076616c756500000000006064820152608401610157565b60408051600081526020810180835289905260ff83169181019190915260608101849052608081018390526001600160a01b0389169060019060a0016020604051602081039080840390855afa1580156103ea573d6000803e3d6000fd5b505050602060405103516001600160a01b0316149450505050505b9392505050565b600060208251101561041d57600080fd5b508051015190565b60405180606001604052806003906020820280368337509192915050565b6001600160a01b038116811461045857600080fd5b50565b634e487b7160e01b600052604160045260246000fd5b60005b8381101561048c578181015183820152602001610474565b50506000910152565b600082601f8301126104a657600080fd5b81516001600160401b038111156104bf576104bf61045b565b604051601f8201601f19908116603f011681016001600160401b03811182821017156104ed576104ed61045b565b60405281815283820160200185101561050557600080fd5b610516826020830160208701610471565b949350505050565b60008060006060848603121561053357600080fd5b835161053e81610443565b6020850151604086015191945092506001600160401b0381111561056157600080fd5b61056d86828701610495565b9150509250925092565b60008060006060848603121561058c57600080fd5b835161059781610443565b60208501519093506001600160401b038111156105b357600080fd5b6105bf86828701610495565b604086015190935090506001600160401b0381111561056157600080fd5b600082516105ef818460208701610471565b9190910192915050565b828152604060208201526000825180604084015261061e816060850160208701610471565b601f01601f1916919091016060019392505050565b60006020828403121561064557600080fd5b81516001600160e01b03198116811461040557600080fd5b634e487b7160e01b600052603260045260246000fdfe5369676e617475726556616c696461746f72237265636f7665725369676e6572",hO="0x608060405234801561001057600080fd5b506115b9806100206000396000f3fe6080604052600436106100f35760003560e01c80634d2301cc1161008a578063a8b0574e11610059578063a8b0574e14610325578063bce38bd714610350578063c3077fa914610380578063ee82ac5e146103b2576100f3565b80634d2301cc1461026257806372425d9d1461029f57806382ad56cb146102ca57806386d516e8146102fa576100f3565b80633408e470116100c65780633408e470146101af578063399542e9146101da5780633e64a6961461020c57806342cbb15c14610237576100f3565b80630f28c97d146100f8578063174dea7114610123578063252dba421461015357806327e86d6e14610184575b600080fd5b34801561010457600080fd5b5061010d6103ef565b60405161011a9190610c0a565b60405180910390f35b61013d60048036038101906101389190610c94565b6103f7565b60405161014a9190610e94565b60405180910390f35b61016d60048036038101906101689190610f0c565b610615565b60405161017b92919061101b565b60405180910390f35b34801561019057600080fd5b506101996107ab565b6040516101a69190611064565b60405180910390f35b3480156101bb57600080fd5b506101c46107b7565b6040516101d19190610c0a565b60405180910390f35b6101f460048036038101906101ef91906110ab565b6107bf565b6040516102039392919061110b565b60405180910390f35b34801561021857600080fd5b506102216107e1565b60405161022e9190610c0a565b60405180910390f35b34801561024357600080fd5b5061024c6107e9565b6040516102599190610c0a565b60405180910390f35b34801561026e57600080fd5b50610289600480360381019061028491906111a7565b6107f1565b6040516102969190610c0a565b60405180910390f35b3480156102ab57600080fd5b506102b4610812565b6040516102c19190610c0a565b60405180910390f35b6102e460048036038101906102df919061122a565b61081a565b6040516102f19190610e94565b60405180910390f35b34801561030657600080fd5b5061030f6109e4565b60405161031c9190610c0a565b60405180910390f35b34801561033157600080fd5b5061033a6109ec565b6040516103479190611286565b60405180910390f35b61036a600480360381019061036591906110ab565b6109f4565b6040516103779190610e94565b60405180910390f35b61039a60048036038101906103959190610f0c565b610ba6565b6040516103a99392919061110b565b60405180910390f35b3480156103be57600080fd5b506103d960048036038101906103d491906112cd565b610bca565b6040516103e69190611064565b60405180910390f35b600042905090565b60606000808484905090508067ffffffffffffffff81111561041c5761041b6112fa565b5b60405190808252806020026020018201604052801561045557816020015b610442610bd5565b81526020019060019003908161043a5790505b5092503660005b828110156105c957600085828151811061047957610478611329565b5b6020026020010151905087878381811061049657610495611329565b5b90506020028101906104a89190611367565b925060008360400135905080860195508360000160208101906104cb91906111a7565b73ffffffffffffffffffffffffffffffffffffffff16818580606001906104f2919061138f565b604051610500929190611431565b60006040518083038185875af1925050503d806000811461053d576040519150601f19603f3d011682016040523d82523d6000602084013e610542565b606091505b5083600001846020018290528215151515815250505081516020850135176105bc577f08c379a000000000000000000000000000000000000000000000000000000000600052602060045260176024527f4d756c746963616c6c333a2063616c6c206661696c656400000000000000000060445260846000fd5b826001019250505061045c565b5082341461060c576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610603906114a7565b60405180910390fd5b50505092915050565b6000606043915060008484905090508067ffffffffffffffff81111561063e5761063d6112fa565b5b60405190808252806020026020018201604052801561067157816020015b606081526020019060019003908161065c5790505b5091503660005b828110156107a157600087878381811061069557610694611329565b5b90506020028101906106a791906114c7565b92508260000160208101906106bc91906111a7565b73ffffffffffffffffffffffffffffffffffffffff168380602001906106e2919061138f565b6040516106f0929190611431565b6000604051808303816000865af19150503d806000811461072d576040519150601f19603f3d011682016040523d82523d6000602084013e610732565b606091505b5086848151811061074657610745611329565b5b60200260200101819052819250505080610795576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161078c9061153b565b60405180910390fd5b81600101915050610678565b5050509250929050565b60006001430340905090565b600046905090565b6000806060439250434091506107d68686866109f4565b905093509350939050565b600048905090565b600043905090565b60008173ffffffffffffffffffffffffffffffffffffffff16319050919050565b600044905090565b606060008383905090508067ffffffffffffffff81111561083e5761083d6112fa565b5b60405190808252806020026020018201604052801561087757816020015b610864610bd5565b81526020019060019003908161085c5790505b5091503660005b828110156109db57600084828151811061089b5761089a611329565b5b602002602001015190508686838181106108b8576108b7611329565b5b90506020028101906108ca919061155b565b92508260000160208101906108df91906111a7565b73ffffffffffffffffffffffffffffffffffffffff16838060400190610905919061138f565b604051610913929190611431565b6000604051808303816000865af19150503d8060008114610950576040519150601f19603f3d011682016040523d82523d6000602084013e610955565b606091505b5082600001836020018290528215151515815250505080516020840135176109cf577f08c379a000000000000000000000000000000000000000000000000000000000600052602060045260176024527f4d756c746963616c6c333a2063616c6c206661696c656400000000000000000060445260646000fd5b8160010191505061087e565b50505092915050565b600045905090565b600041905090565b606060008383905090508067ffffffffffffffff811115610a1857610a176112fa565b5b604051908082528060200260200182016040528015610a5157816020015b610a3e610bd5565b815260200190600190039081610a365790505b5091503660005b82811015610b9c576000848281518110610a7557610a74611329565b5b60200260200101519050868683818110610a9257610a91611329565b5b9050602002810190610aa491906114c7565b9250826000016020810190610ab991906111a7565b73ffffffffffffffffffffffffffffffffffffffff16838060200190610adf919061138f565b604051610aed929190611431565b6000604051808303816000865af19150503d8060008114610b2a576040519150601f19603f3d011682016040523d82523d6000602084013e610b2f565b606091505b508260000183602001829052821515151581525050508715610b90578060000151610b8f576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610b869061153b565b60405180910390fd5b5b81600101915050610a58565b5050509392505050565b6000806060610bb7600186866107bf565b8093508194508295505050509250925092565b600081409050919050565b6040518060400160405280600015158152602001606081525090565b6000819050919050565b610c0481610bf1565b82525050565b6000602082019050610c1f6000830184610bfb565b92915050565b600080fd5b600080fd5b600080fd5b600080fd5b600080fd5b60008083601f840112610c5457610c53610c2f565b5b8235905067ffffffffffffffff811115610c7157610c70610c34565b5b602083019150836020820283011115610c8d57610c8c610c39565b5b9250929050565b60008060208385031215610cab57610caa610c25565b5b600083013567ffffffffffffffff811115610cc957610cc8610c2a565b5b610cd585828601610c3e565b92509250509250929050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b60008115159050919050565b610d2281610d0d565b82525050565b600081519050919050565b600082825260208201905092915050565b60005b83811015610d62578082015181840152602081019050610d47565b83811115610d71576000848401525b50505050565b6000601f19601f8301169050919050565b6000610d9382610d28565b610d9d8185610d33565b9350610dad818560208601610d44565b610db681610d77565b840191505092915050565b6000604083016000830151610dd96000860182610d19565b5060208301518482036020860152610df18282610d88565b9150508091505092915050565b6000610e0a8383610dc1565b905092915050565b6000602082019050919050565b6000610e2a82610ce1565b610e348185610cec565b935083602082028501610e4685610cfd565b8060005b85811015610e825784840389528151610e638582610dfe565b9450610e6e83610e12565b925060208a01995050600181019050610e4a565b50829750879550505050505092915050565b60006020820190508181036000830152610eae8184610e1f565b905092915050565b60008083601f840112610ecc57610ecb610c2f565b5b8235905067ffffffffffffffff811115610ee957610ee8610c34565b5b602083019150836020820283011115610f0557610f04610c39565b5b9250929050565b60008060208385031215610f2357610f22610c25565b5b600083013567ffffffffffffffff811115610f4157610f40610c2a565b5b610f4d85828601610eb6565b92509250509250929050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b6000610f918383610d88565b905092915050565b6000602082019050919050565b6000610fb182610f59565b610fbb8185610f64565b935083602082028501610fcd85610f75565b8060005b858110156110095784840389528151610fea8582610f85565b9450610ff583610f99565b925060208a01995050600181019050610fd1565b50829750879550505050505092915050565b60006040820190506110306000830185610bfb565b81810360208301526110428184610fa6565b90509392505050565b6000819050919050565b61105e8161104b565b82525050565b60006020820190506110796000830184611055565b92915050565b61108881610d0d565b811461109357600080fd5b50565b6000813590506110a58161107f565b92915050565b6000806000604084860312156110c4576110c3610c25565b5b60006110d286828701611096565b935050602084013567ffffffffffffffff8111156110f3576110f2610c2a565b5b6110ff86828701610eb6565b92509250509250925092565b60006060820190506111206000830186610bfb565b61112d6020830185611055565b818103604083015261113f8184610e1f565b9050949350505050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b600061117482611149565b9050919050565b61118481611169565b811461118f57600080fd5b50565b6000813590506111a18161117b565b92915050565b6000602082840312156111bd576111bc610c25565b5b60006111cb84828501611192565b91505092915050565b60008083601f8401126111ea576111e9610c2f565b5b8235905067ffffffffffffffff81111561120757611206610c34565b5b60208301915083602082028301111561122357611222610c39565b5b9250929050565b6000806020838503121561124157611240610c25565b5b600083013567ffffffffffffffff81111561125f5761125e610c2a565b5b61126b858286016111d4565b92509250509250929050565b61128081611169565b82525050565b600060208201905061129b6000830184611277565b92915050565b6112aa81610bf1565b81146112b557600080fd5b50565b6000813590506112c7816112a1565b92915050565b6000602082840312156112e3576112e2610c25565b5b60006112f1848285016112b8565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b600080fd5b600080fd5b600080fd5b60008235600160800383360303811261138357611382611358565b5b80830191505092915050565b600080833560016020038436030381126113ac576113ab611358565b5b80840192508235915067ffffffffffffffff8211156113ce576113cd61135d565b5b6020830192506001820236038313156113ea576113e9611362565b5b509250929050565b600081905092915050565b82818337600083830152505050565b600061141883856113f2565b93506114258385846113fd565b82840190509392505050565b600061143e82848661140c565b91508190509392505050565b600082825260208201905092915050565b7f4d756c746963616c6c333a2076616c7565206d69736d61746368000000000000600082015250565b6000611491601a8361144a565b915061149c8261145b565b602082019050919050565b600060208201905081810360008301526114c081611484565b9050919050565b6000823560016040038336030381126114e3576114e2611358565b5b80830191505092915050565b7f4d756c746963616c6c333a2063616c6c206661696c6564000000000000000000600082015250565b600061152560178361144a565b9150611530826114ef565b602082019050919050565b6000602082019050818103600083015261155481611518565b9050919050565b60008235600160600383360303811261157757611576611358565b5b8083019150509291505056fea264697066735822122020c1bc9aacf8e4a6507193432a895a8e77094f45a1395583f07b24e860ef06cd64736f6c634300080c0033";class Dp extends q{constructor({blockNumber:e,chain:n,contract:r}){super(`Chain "${n.name}" does not support contract "${r.name}".`,{metaMessages:["This could be due to any of the following:",...e&&r.blockCreated&&r.blockCreated>e?[`- The contract "${r.name}" was not deployed until block ${r.blockCreated} (current block ${e}).`]:[`- The chain does not have the contract "${r.name}" configured.`]],name:"ChainDoesNotSupportContract"})}}class pO extends q{constructor({chain:e,currentChainId:n}){super(`The current chain of the wallet (id: ${n}) does not match the target chain for the transaction (id: ${e.id} â€“ ${e.name}).`,{metaMessages:[`Current Chain ID:  ${n}`,`Expected Chain ID: ${e.id} â€“ ${e.name}`],name:"ChainMismatchError"})}}class gO extends q{constructor(){super(["No chain was provided to the request.","Please provide a chain with the `chain` argument on the Action, or by supplying a `chain` to WalletClient."].join(`
`),{name:"ChainNotFoundError"})}}class Gv extends q{constructor(){super("No chain was provided to the Client.",{name:"ClientChainNotConfiguredError"})}}class of extends q{constructor({chainId:e}){super(typeof e=="number"?`Chain ID "${e}" is invalid.`:"Chain ID is invalid.",{name:"InvalidChainIdError"})}}const Vf="/docs/contract/encodeDeployData";function Yv(t){const{abi:e,args:n,bytecode:r}=t;if(!n||n.length===0)return r;const s=e.find(o=>"type"in o&&o.type==="constructor");if(!s)throw new rN({docsPath:Vf});if(!("inputs"in s))throw new Hm({docsPath:Vf});if(!s.inputs||s.inputs.length===0)throw new Hm({docsPath:Vf});const i=sv(s.inputs,n);return Us([r,i])}function mO({blockNumber:t,chain:e,contract:n}){var s;const r=(s=e==null?void 0:e.contracts)==null?void 0:s[n];if(!r)throw new Dp({chain:e,contract:{name:n}});if(t&&r.blockCreated&&r.blockCreated>t)throw new Dp({blockNumber:t,chain:e,contract:{name:n,blockCreated:r.blockCreated}});return r.address}function yO(t,{docsPath:e,...n}){const r=(()=>{const s=ag(t,n);return s instanceof ef?t:s})();return new qT(r,{docsPath:e,...n})}function Zv(){let t=()=>{},e=()=>{};return{promise:new Promise((r,s)=>{t=r,e=s}),resolve:t,reject:e}}const Kf=new Map;function Jv({fn:t,id:e,shouldSplitBatch:n,wait:r=0,sort:s}){const i=async()=>{const u=c();o();const d=u.map(({args:f})=>f);d.length!==0&&t(d).then(f=>{s&&Array.isArray(f)&&f.sort(s);for(let h=0;h<u.length;h++){const{resolve:p}=u[h];p==null||p([f[h],f])}}).catch(f=>{for(let h=0;h<u.length;h++){const{reject:p}=u[h];p==null||p(f)}})},o=()=>Kf.delete(e),a=()=>c().map(({args:u})=>u),c=()=>Kf.get(e)||[],l=u=>Kf.set(e,[...c(),u]);return{flush:o,async schedule(u){const{promise:d,resolve:f,reject:h}=Zv();return(n==null?void 0:n([...a(),u]))&&i(),c().length>0?(l({args:u,resolve:f,reject:h}),d):(l({args:u,resolve:f,reject:h}),setTimeout(i,r),d)}}}async function Xv(t,e){var O,$,y,w;const{account:n=t.account,authorizationList:r,batch:s=!!((O=t.batch)!=null&&O.multicall),blockNumber:i,blockTag:o=t.experimental_blockTag??"latest",accessList:a,blobs:c,blockOverrides:l,code:u,data:d,factory:f,factoryData:h,gas:p,gasPrice:g,maxFeePerBlobGas:m,maxFeePerGas:E,maxPriorityFeePerGas:A,nonce:b,to:_,value:C,stateOverride:S,...x}=e,P=n?sr(n):void 0;if(u&&(f||h))throw new q("Cannot provide both `code` & `factory`/`factoryData` as parameters.");if(u&&_)throw new q("Cannot provide both `code` & `to` as parameters.");const N=u&&d,L=f&&h&&_&&d,M=N||L,U=N?Qv({code:u,data:d}):L?EO({data:d,factory:f,factoryData:h,to:_}):d;try{Ol(e);const D=(typeof i=="bigint"?re(i):void 0)||o,R=l?lO(l):void 0,k=gv(S),j=(w=(y=($=t.chain)==null?void 0:$.formatters)==null?void 0:y.transactionRequest)==null?void 0:w.format,ee=(j||Tl)({...tf(x,{format:j}),accessList:a,account:P,authorizationList:r,blobs:c,data:U,gas:p,gasPrice:g,maxFeePerBlobGas:m,maxFeePerGas:E,maxPriorityFeePerGas:A,nonce:b,to:M?void 0:_,value:C},"call");if(s&&bO({request:ee})&&!k&&!R)try{return await wO(t,{...ee,blockNumber:i,blockTag:o})}catch(ce){if(!(ce instanceof Gv)&&!(ce instanceof Dp))throw ce}const K=(()=>{const ce=[ee,D];return k&&R?[...ce,k,R]:k?[...ce,k]:R?[...ce,{},R]:ce})(),G=await t.request({method:"eth_call",params:K});return G==="0x"?{data:void 0}:{data:G}}catch(T){const D=vO(T),{offchainLookup:R,offchainLookupSignature:k}=await _t(async()=>{const{offchainLookup:j,offchainLookupSignature:H}=await import("./ccip-DQzBFxi6.js");return{offchainLookup:j,offchainLookupSignature:H}},__vite__mapDeps([0,1]));if(t.ccipRead!==!1&&(D==null?void 0:D.slice(0,10))===k&&_)return{data:await R(t,{data:D,to:_})};throw M&&(D==null?void 0:D.slice(0,10))==="0x101bb98d"?new YT({factory:f}):yO(T,{...e,account:P,chain:t.chain})}}function bO({request:t}){const{data:e,to:n,...r}=t;return!(!e||e.startsWith(uO)||!n||Object.values(r).filter(s=>typeof s<"u").length>0)}async function wO(t,e){var g;const{batchSize:n=1024,deployless:r=!1,wait:s=0}=typeof((g=t.batch)==null?void 0:g.multicall)=="object"?t.batch.multicall:{},{blockNumber:i,blockTag:o=t.experimental_blockTag??"latest",data:a,to:c}=e,l=(()=>{if(r)return null;if(e.multicallAddress)return e.multicallAddress;if(t.chain)return mO({blockNumber:i,chain:t.chain,contract:"multicall3"});throw new Gv})(),d=(typeof i=="bigint"?re(i):void 0)||o,{schedule:f}=Jv({id:`${t.uid}.${d}`,wait:s,shouldSplitBatch(m){return m.reduce((A,{data:b})=>A+(b.length-2),0)>n*2},fn:async m=>{const E=m.map(_=>({allowFailure:!0,callData:_.data,target:_.to})),A=ng({abi:gy,args:[E],functionName:"aggregate3"}),b=await t.request({method:"eth_call",params:[{...l===null?{data:Qv({code:hO,data:A})}:{to:l,data:A}},d]});return Uv({abi:gy,args:[E],functionName:"aggregate3",data:b||"0x"})}}),[{returnData:h,success:p}]=await f({data:a,to:c});if(!p)throw new uv({data:h});return h==="0x"?{data:void 0}:{data:h}}function Qv(t){const{code:e,data:n}=t;return Yv({abi:UE(["constructor(bytes, bytes)"]),bytecode:dO,args:[e,n]})}function EO(t){const{data:e,factory:n,factoryData:r,to:s}=t;return Yv({abi:UE(["constructor(address, bytes, address, bytes)"]),bytecode:fO,args:[s,e,n,r]})}function vO(t){var n;if(!(t instanceof q))return;const e=t.walk();return typeof(e==null?void 0:e.data)=="object"?(n=e.data)==null?void 0:n.data:e.data}async function CO(t,e){const{abi:n,address:r,args:s,functionName:i,...o}=e,a=ng({abi:n,args:s,functionName:i});try{const{data:c}=await Ze(t,Xv,"call")({...o,data:a,to:r});return Uv({abi:n,args:s,functionName:i,data:c||"0x"})}catch(c){throw dv(c,{abi:n,address:r,args:s,docsPath:"/docs/contract/readContract",functionName:i})}}const Gf=new Map,my=new Map;let _O=0;function pd(t,e,n){const r=++_O,s=()=>Gf.get(t)||[],i=()=>{const u=s();Gf.set(t,u.filter(d=>d.id!==r))},o=()=>{const u=s();if(!u.some(f=>f.id===r))return;const d=my.get(t);if(u.length===1&&d){const f=d();f instanceof Promise&&f.catch(()=>{})}i()},a=s();if(Gf.set(t,[...a,{id:r,fns:e}]),a&&a.length>0)return o;const c={};for(const u in e)c[u]=(...d)=>{var h,p;const f=s();if(f.length!==0)for(const g of f)(p=(h=g.fns)[u])==null||p.call(h,...d)};const l=n(c);return typeof l=="function"&&my.set(t,l),o}async function gd(t){return new Promise(e=>setTimeout(e,t))}function eC(t,{emitOnBegin:e,initialWaitTime:n,interval:r}){let s=!0;const i=()=>s=!1;return(async()=>{let a;e&&(a=await t({unpoll:i}));const c=await(n==null?void 0:n(a))??r;await gd(c);const l=async()=>{s&&(await t({unpoll:i}),await gd(r),l())};l()})(),i}const AO=new Map,IO=new Map;function SO(t){const e=(s,i)=>({clear:()=>i.delete(s),get:()=>i.get(s),set:o=>i.set(s,o)}),n=e(t,AO),r=e(t,IO);return{clear:()=>{n.clear(),r.clear()},promise:n,response:r}}async function xO(t,{cacheKey:e,cacheTime:n=Number.POSITIVE_INFINITY}){const r=SO(e),s=r.response.get();if(s&&n>0&&Date.now()-s.created.getTime()<n)return s.data;let i=r.promise.get();i||(i=t(),r.promise.set(i));try{const o=await i;return r.response.set({created:new Date,data:o}),o}finally{r.promise.clear()}}const NO=t=>`blockNumber.${t}`;async function TO(t,{cacheTime:e=t.cacheTime}={}){const n=await xO(()=>t.request({method:"eth_blockNumber"}),{cacheKey:NO(t.uid),cacheTime:e});return BigInt(n)}async function OO(t,{filter:e}){const n="strict"in e&&e.strict,r=await e.request({method:"eth_getFilterChanges",params:[e.id]});if(typeof r[0]=="string")return r;const s=r.map(i=>$v(i));return!("abi"in e)||!e.abi?s:U3({abi:e.abi,logs:s,strict:n})}async function RO(t,{filter:e}){return e.request({method:"eth_uninstallFilter",params:[e.id]})}class pg extends q{constructor({docsPath:e}={}){super(["Could not find an Account to execute with this Action.","Please provide an Account with the `account` argument on the Action, or by supplying an `account` to the Client."].join(`
`),{docsPath:e,docsSlug:"account",name:"AccountNotFoundError"})}}class Yf extends q{constructor({docsPath:e,metaMessages:n,type:r}){super(`Account type "${r}" is not supported.`,{docsPath:e,metaMessages:n,name:"AccountTypeNotSupportedError"})}}function PO({chain:t,currentChainId:e}){if(!t)throw new gO;if(e!==t.id)throw new pO({chain:t,currentChainId:e})}async function kO(t,{serializedTransaction:e}){return t.request({method:"eth_sendRawTransaction",params:[e]},{retryCount:0})}const Zf=new Il(128);async function tC(t,e){var A,b,_,C;const{account:n=t.account,chain:r=t.chain,accessList:s,authorizationList:i,blobs:o,data:a,gas:c,gasPrice:l,maxFeePerBlobGas:u,maxFeePerGas:d,maxPriorityFeePerGas:f,nonce:h,type:p,value:g,...m}=e;if(typeof n>"u")throw new pg({docsPath:"/docs/actions/wallet/sendTransaction"});const E=n?sr(n):null;try{Ol(e);const S=await(async()=>{if(e.to)return e.to;if(e.to!==null&&i&&i.length>0)return await pv({authorization:i[0]}).catch(()=>{throw new q("`to` is required. Could not infer from `authorizationList`.")})})();if((E==null?void 0:E.type)==="json-rpc"||E===null){let x;r!==null&&(x=await Ze(t,fg,"getChainId")({}),PO({currentChainId:x,chain:r}));const P=(_=(b=(A=t.chain)==null?void 0:A.formatters)==null?void 0:b.transactionRequest)==null?void 0:_.format,L=(P||Tl)({...tf(m,{format:P}),accessList:s,account:E,authorizationList:i,blobs:o,chainId:x,data:a,gas:c,gasPrice:l,maxFeePerBlobGas:u,maxFeePerGas:d,maxPriorityFeePerGas:f,nonce:h,to:S,type:p,value:g},"sendTransaction"),M=Zf.get(t.uid),U=M?"wallet_sendTransaction":"eth_sendTransaction";try{return await t.request({method:U,params:[L]},{retryCount:0})}catch(O){if(M===!1)throw O;const $=O;if($.name==="InvalidInputRpcError"||$.name==="InvalidParamsRpcError"||$.name==="MethodNotFoundRpcError"||$.name==="MethodNotSupportedRpcError")return await t.request({method:"wallet_sendTransaction",params:[L]},{retryCount:0}).then(y=>(Zf.set(t.uid,!0),y)).catch(y=>{const w=y;throw w.name==="MethodNotFoundRpcError"||w.name==="MethodNotSupportedRpcError"?(Zf.set(t.uid,!1),$):w});throw $}}if((E==null?void 0:E.type)==="local"){const x=await Ze(t,hg,"prepareTransactionRequest")({account:E,accessList:s,authorizationList:i,blobs:o,chain:r,data:a,gas:c,gasPrice:l,maxFeePerBlobGas:u,maxFeePerGas:d,maxPriorityFeePerGas:f,nonce:h,nonceManager:E.nonceManager,parameters:[...kv,"sidecars"],type:p,value:g,...m,to:S}),P=(C=r==null?void 0:r.serializers)==null?void 0:C.transaction,N=await E.signTransaction(x,{serializer:P});return await Ze(t,kO,"sendRawTransaction")({serializedTransaction:N})}throw(E==null?void 0:E.type)==="smart"?new Yf({metaMessages:["Consider using the `sendUserOperation` Action instead."],docsPath:"/docs/actions/bundler/sendUserOperation",type:"smart"}):new Yf({docsPath:"/docs/actions/wallet/sendTransaction",type:E==null?void 0:E.type})}catch(S){throw S instanceof Yf?S:Pv(S,{...e,account:E,chain:e.chain||void 0})}}async function md(t,e){return md.internal(t,tC,"sendTransaction",e)}(function(t){async function e(n,r,s,i){const{abi:o,account:a=n.account,address:c,args:l,dataSuffix:u,functionName:d,...f}=i;if(typeof a>"u")throw new pg({docsPath:"/docs/contract/writeContract"});const h=a?sr(a):null,p=ng({abi:o,args:l,functionName:d});try{return await Ze(n,r,s)({data:`${p}${u?u.replace("0x",""):""}`,to:c,account:h,...f})}catch(g){throw dv(g,{abi:o,address:c,args:l,docsPath:"/docs/contract/writeContract",functionName:d,sender:h==null?void 0:h.address})}}t.internal=e})(md||(md={}));function yd(t,{delay:e=100,retryCount:n=2,shouldRetry:r=()=>!0}={}){return new Promise((s,i)=>{const o=async({count:a=0}={})=>{const c=async({error:l})=>{const u=typeof e=="function"?e({count:a,error:l}):e;u&&await gd(u),o({count:a+1})};try{const l=await t();s(l)}catch(l){if(a<n&&await r({count:a,error:l}))return c({error:l});i(l)}};o()})}const DO={"0x0":"reverted","0x1":"success"};function nC(t,e){const n={...t,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,contractAddress:t.contractAddress?t.contractAddress:null,cumulativeGasUsed:t.cumulativeGasUsed?BigInt(t.cumulativeGasUsed):null,effectiveGasPrice:t.effectiveGasPrice?BigInt(t.effectiveGasPrice):null,gasUsed:t.gasUsed?BigInt(t.gasUsed):null,logs:t.logs?t.logs.map(r=>$v(r)):null,to:t.to?t.to:null,transactionIndex:t.transactionIndex?xi(t.transactionIndex):null,status:t.status?DO[t.status]:null,type:t.type?bv[t.type]||t.type:null};return t.blobGasPrice&&(n.blobGasPrice=BigInt(t.blobGasPrice)),t.blobGasUsed&&(n.blobGasUsed=BigInt(t.blobGasUsed)),n}const $O=nf("transactionReceipt",nC),$p=256;let nu=$p,ru;function rC(t=11){if(!ru||nu+t>$p*2){ru="",nu=0;for(let e=0;e<$p;e++)ru+=(256+Math.random()*256|0).toString(16).substring(1)}return ru.substring(nu,nu+++t)}function sC(t){const{batch:e,chain:n,ccipRead:r,key:s="base",name:i="Base Client",type:o="base"}=t,a=t.experimental_blockTag??(typeof(n==null?void 0:n.experimental_preconfirmationTime)=="number"?"pending":void 0),c=(n==null?void 0:n.blockTime)??12e3,l=Math.min(Math.max(Math.floor(c/2),500),4e3),u=t.pollingInterval??l,d=t.cacheTime??u,f=t.account?sr(t.account):void 0,{config:h,request:p,value:g}=t.transport({account:f,chain:n,pollingInterval:u}),m={...h,...g},E={account:f,batch:e,cacheTime:d,ccipRead:r,chain:n,key:s,name:i,pollingInterval:u,request:p,transport:m,type:o,uid:rC(),...a?{experimental_blockTag:a}:{}};function A(b){return _=>{const C=_(b);for(const x in E)delete C[x];const S={...b,...C};return Object.assign(S,{extend:A(S)})}}return Object.assign(E,{extend:A(E)})}async function UO(t){const e=mT(t,{method:"eth_newPendingTransactionFilter"}),n=await t.request({method:"eth_newPendingTransactionFilter"});return{id:n,request:e(n),type:"transaction"}}async function BO(t,{address:e,blockNumber:n,blockTag:r=t.experimental_blockTag??"latest"}){const s=typeof n=="bigint"?re(n):void 0,i=await t.request({method:"eth_getBalance",params:[e,s||r]});return BigInt(i)}function LO(t){const{authorizationList:e}=t;if(e)for(const n of e){const{chainId:r}=n,s=n.address;if(!jt(s))throw new Nn({address:s});if(r<0)throw new of({chainId:r})}gg(t)}function MO(t){const{blobVersionedHashes:e}=t;if(e){if(e.length===0)throw new Tv;for(const n of e){const r=bt(n),s=xi(Hc(n,0,1));if(r!==32)throw new O3({hash:n,size:r});if(s!==Nv)throw new R3({hash:n,version:s})}}gg(t)}function gg(t){const{chainId:e,maxPriorityFeePerGas:n,maxFeePerGas:r,to:s}=t;if(e<=0)throw new of({chainId:e});if(s&&!jt(s))throw new Nn({address:s});if(r&&r>rf)throw new bo({maxFeePerGas:r});if(n&&r&&n>r)throw new al({maxFeePerGas:r,maxPriorityFeePerGas:n})}function FO(t){const{chainId:e,maxPriorityFeePerGas:n,gasPrice:r,maxFeePerGas:s,to:i}=t;if(e<=0)throw new of({chainId:e});if(i&&!jt(i))throw new Nn({address:i});if(n||s)throw new q("`maxFeePerGas`/`maxPriorityFeePerGas` is not a valid EIP-2930 Transaction attribute.");if(r&&r>rf)throw new bo({maxFeePerGas:r})}function jO(t){const{chainId:e,maxPriorityFeePerGas:n,gasPrice:r,maxFeePerGas:s,to:i}=t;if(i&&!jt(i))throw new Nn({address:i});if(typeof e<"u"&&e<=0)throw new of({chainId:e});if(n||s)throw new q("`maxFeePerGas`/`maxPriorityFeePerGas` is not a valid Legacy Transaction attribute.");if(r&&r>rf)throw new bo({maxFeePerGas:r})}function af(t){if(!t||t.length===0)return[];const e=[];for(let n=0;n<t.length;n++){const{address:r,storageKeys:s}=t[n];for(let i=0;i<s.length;i++)if(s[i].length-2!==64)throw new jT({storageKey:s[i]});if(!jt(r,{strict:!1}))throw new Nn({address:r});e.push([r,s])}return e}function HO(t,e){const n=Rv(t);return n==="eip1559"?qO(t,e):n==="eip2930"?VO(t,e):n==="eip4844"?zO(t,e):n==="eip7702"?WO(t,e):KO(t,e)}function WO(t,e){const{authorizationList:n,chainId:r,gas:s,nonce:i,to:o,value:a,maxFeePerGas:c,maxPriorityFeePerGas:l,accessList:u,data:d}=t;LO(t);const f=af(u),h=GO(n);return Us(["0x04",Ni([re(r),i?re(i):"0x",l?re(l):"0x",c?re(c):"0x",s?re(s):"0x",o??"0x",a?re(a):"0x",d??"0x",f,h,...Pl(t,e)])])}function zO(t,e){const{chainId:n,gas:r,nonce:s,to:i,value:o,maxFeePerBlobGas:a,maxFeePerGas:c,maxPriorityFeePerGas:l,accessList:u,data:d}=t;MO(t);let f=t.blobVersionedHashes,h=t.sidecars;if(t.blobs&&(typeof f>"u"||typeof h>"u")){const b=typeof t.blobs[0]=="string"?t.blobs:t.blobs.map(S=>fn(S)),_=t.kzg,C=lg({blobs:b,kzg:_});if(typeof f>"u"&&(f=Iv({commitments:C})),typeof h>"u"){const S=ug({blobs:b,commitments:C,kzg:_});h=Ov({blobs:b,commitments:C,proofs:S})}}const p=af(u),g=[re(n),s?re(s):"0x",l?re(l):"0x",c?re(c):"0x",r?re(r):"0x",i??"0x",o?re(o):"0x",d??"0x",p,a?re(a):"0x",f??[],...Pl(t,e)],m=[],E=[],A=[];if(h)for(let b=0;b<h.length;b++){const{blob:_,commitment:C,proof:S}=h[b];m.push(_),E.push(C),A.push(S)}return Us(["0x03",Ni(h?[g,m,E,A]:g)])}function qO(t,e){const{chainId:n,gas:r,nonce:s,to:i,value:o,maxFeePerGas:a,maxPriorityFeePerGas:c,accessList:l,data:u}=t;gg(t);const d=af(l),f=[re(n),s?re(s):"0x",c?re(c):"0x",a?re(a):"0x",r?re(r):"0x",i??"0x",o?re(o):"0x",u??"0x",d,...Pl(t,e)];return Us(["0x02",Ni(f)])}function VO(t,e){const{chainId:n,gas:r,data:s,nonce:i,to:o,value:a,accessList:c,gasPrice:l}=t;FO(t);const u=af(c),d=[re(n),i?re(i):"0x",l?re(l):"0x",r?re(r):"0x",o??"0x",a?re(a):"0x",s??"0x",u,...Pl(t,e)];return Us(["0x01",Ni(d)])}function KO(t,e){const{chainId:n=0,gas:r,data:s,nonce:i,to:o,value:a,gasPrice:c}=t;jO(t);let l=[i?re(i):"0x",c?re(c):"0x",r?re(r):"0x",o??"0x",a?re(a):"0x",s??"0x"];if(e){const u=(()=>{if(e.v>=35n)return(e.v-35n)/2n>0?e.v:27n+(e.v===35n?0n:1n);if(n>0)return BigInt(n*2)+BigInt(35n+e.v-27n);const h=27n+(e.v===27n?0n:1n);if(e.v!==h)throw new MT({v:e.v});return h})(),d=Ar(e.r),f=Ar(e.s);l=[...l,re(u),d==="0x00"?"0x":d,f==="0x00"?"0x":f]}else n>0&&(l=[...l,re(n),"0x","0x"]);return Ni(l)}function Pl(t,e){const n=e??t,{v:r,yParity:s}=n;if(typeof n.r>"u")return[];if(typeof n.s>"u")return[];if(typeof r>"u"&&typeof s>"u")return[];const i=Ar(n.r),o=Ar(n.s);return[typeof s=="number"?s?re(1):"0x":r===0n?"0x":r===1n?re(1):r===27n?"0x":re(1),i==="0x00"?"0x":i,o==="0x00"?"0x":o]}function GO(t){if(!t||t.length===0)return[];const e=[];for(const n of t){const{chainId:r,nonce:s,...i}=n,o=n.address;e.push([r?nr(r):"0x",o,s?nr(s):"0x",...Pl({},i)])}return e}const su=new Il(8192);function YO(t,{enabled:e=!0,id:n}){if(!e||!n)return t();if(su.get(n))return su.get(n);const r=t().finally(()=>su.delete(n));return su.set(n,r),r}function ZO(t,e={}){return async(n,r={})=>{var d;const{dedupe:s=!1,methods:i,retryDelay:o=150,retryCount:a=3,uid:c}={...e,...r},{method:l}=n;if((d=i==null?void 0:i.exclude)!=null&&d.includes(l))throw new Zi(new Error("method not supported"),{method:l});if(i!=null&&i.include&&!i.include.includes(l))throw new Zi(new Error("method not supported"),{method:l});const u=s?Zd(`${c}.${rr(n)}`):void 0;return YO(()=>yd(async()=>{try{return await t(n)}catch(f){const h=f;switch(h.code){case zc.code:throw new zc(h);case qc.code:throw new qc(h);case Vc.code:throw new Vc(h,{method:n.method});case Kc.code:throw new Kc(h);case yo.code:throw new yo(h);case ya.code:throw new ya(h);case Gc.code:throw new Gc(h);case bi.code:throw new bi(h);case ba.code:throw new ba(h);case Zi.code:throw new Zi(h,{method:n.method});case wa.code:throw new wa(h);case Yc.code:throw new Yc(h);case lt.code:throw new lt(h);case Zc.code:throw new Zc(h);case Jc.code:throw new Jc(h);case Xc.code:throw new Xc(h);case Qc.code:throw new Qc(h);case Jr.code:throw new Jr(h);case el.code:throw new el(h);case tl.code:throw new tl(h);case nl.code:throw new nl(h);case rl.code:throw new rl(h);case sl.code:throw new sl(h);case il.code:throw new il(h);case ol.code:throw new ol(h);case 5e3:throw new lt(h);default:throw f instanceof q?f:new JT(h)}}},{delay:({count:f,error:h})=>{var p;if(h&&h instanceof hc){const g=(p=h==null?void 0:h.headers)==null?void 0:p.get("Retry-After");if(g!=null&&g.match(/\d/))return Number.parseInt(g,10)*1e3}return~~(1<<f)*o},retryCount:a,shouldRetry:({error:f})=>JO(f)}),{enabled:s,id:u})}}function JO(t){return"code"in t&&typeof t.code=="number"?t.code===-1||t.code===wa.code||t.code===yo.code:t instanceof hc&&t.status?t.status===403||t.status===408||t.status===413||t.status===429||t.status===500||t.status===502||t.status===503||t.status===504:!0}function iC(t){const e={formatters:void 0,fees:void 0,serializers:void 0,...t};function n(r){return s=>{const i=typeof s=="function"?s(r):s,o={...r,...i};return Object.assign(o,{extend:n(o)})}}return Object.assign(e,{extend:n(e)})}function GZ(){return{}}function oC(t,{errorInstance:e=new Error("timed out"),timeout:n,signal:r}){return new Promise((s,i)=>{(async()=>{let o;try{const a=new AbortController;n>0&&(o=setTimeout(()=>{r?a.abort():i(e)},n)),s(await t({signal:(a==null?void 0:a.signal)||null}))}catch(a){(a==null?void 0:a.name)==="AbortError"&&i(e),i(a)}finally{clearTimeout(o)}})()})}function XO(){return{current:0,take(){return this.current++},reset(){this.current=0}}}const yy=XO();function QO(t,e={}){return{async request(n){var f;const{body:r,fetchFn:s=e.fetchFn??fetch,onRequest:i=e.onRequest,onResponse:o=e.onResponse,timeout:a=e.timeout??1e4}=n,c={...e.fetchOptions??{},...n.fetchOptions??{}},{headers:l,method:u,signal:d}=c;try{const h=await oC(async({signal:g})=>{const m={...c,body:Array.isArray(r)?rr(r.map(_=>({jsonrpc:"2.0",id:_.id??yy.take(),..._}))):rr({jsonrpc:"2.0",id:r.id??yy.take(),...r}),headers:{"Content-Type":"application/json",...l},method:u||"POST",signal:d||(a>0?g:null)},E=new Request(t,m),A=await(i==null?void 0:i(E,m))??{...m,url:t};return await s(A.url??t,A)},{errorInstance:new ny({body:r,url:t}),timeout:a,signal:!0});o&&await o(h);let p;if((f=h.headers.get("Content-Type"))!=null&&f.startsWith("application/json"))p=await h.json();else{p=await h.text();try{p=JSON.parse(p||"{}")}catch(g){if(h.ok)throw g;p={error:p}}}if(!h.ok)throw new hc({body:r,details:rr(p.error)||h.statusText,headers:h.headers,status:h.status,url:t});return p}catch(h){throw h instanceof hc||h instanceof ny?h:new hc({body:r,cause:h,url:t})}}}}class e8 extends q{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function t8(t,e){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(t))throw new e8({value:t});let[n,r="0"]=t.split(".");const s=n.startsWith("-");if(s&&(n=n.slice(1)),r=r.replace(/(0+)$/,""),e===0)Math.round(+`.${r}`)===1&&(n=`${BigInt(n)+1n}`),r="";else if(r.length>e){const[i,o,a]=[r.slice(0,e-1),r.slice(e-1,e),r.slice(e)],c=Math.round(+`${o}.${a}`);c>9?r=`${BigInt(i)+BigInt(1)}0`.padStart(i.length+1,"0"):r=`${i}${c}`,r.length>e&&(r=r.slice(1),n=`${BigInt(n)+1n}`),r=r.slice(0,e)}else r=r.padEnd(e,"0");return BigInt(`${s?"-":""}${n}${r}`)}async function aC(t,{blockHash:e,blockNumber:n,blockTag:r,hash:s,index:i,sender:o,nonce:a}){var f,h,p;const c=r||"latest",l=n!==void 0?re(n):void 0;let u=null;if(s?u=await t.request({method:"eth_getTransactionByHash",params:[s]},{dedupe:!0}):e?u=await t.request({method:"eth_getTransactionByBlockHashAndIndex",params:[e,re(i)]},{dedupe:!0}):typeof i=="number"?u=await t.request({method:"eth_getTransactionByBlockNumberAndIndex",params:[l||c,re(i)]},{dedupe:!!l}):o&&typeof a=="number"&&(u=await t.request({method:"eth_getTransactionBySenderAndNonce",params:[o,re(a)]},{dedupe:!0})),!u)throw new cv({blockHash:e,blockNumber:n,blockTag:c,hash:s,index:i});return(((p=(h=(f=t.chain)==null?void 0:f.formatters)==null?void 0:h.transaction)==null?void 0:p.format)||Rl)(u,"getTransaction")}async function Jf(t,{hash:e}){var s,i,o;const n=await t.request({method:"eth_getTransactionReceipt",params:[e]},{dedupe:!0});if(!n)throw new lv({hash:e});return(((o=(i=(s=t.chain)==null?void 0:s.formatters)==null?void 0:i.transactionReceipt)==null?void 0:o.format)||nC)(n,"getTransactionReceipt")}function n8(t,{emitOnBegin:e=!1,emitMissed:n=!1,onBlockNumber:r,onError:s,poll:i,pollingInterval:o=t.pollingInterval}){const a=typeof i<"u"?i:!(t.transport.type==="webSocket"||t.transport.type==="ipc"||t.transport.type==="fallback"&&(t.transport.transports[0].config.type==="webSocket"||t.transport.transports[0].config.type==="ipc"));let c;return a?(()=>{const d=rr(["watchBlockNumber",t.uid,e,n,o]);return pd(d,{onBlockNumber:r,onError:s},f=>eC(async()=>{var h;try{const p=await Ze(t,TO,"getBlockNumber")({cacheTime:0});if(c!==void 0){if(p===c)return;if(p-c>1&&n)for(let g=c+1n;g<p;g++)f.onBlockNumber(g,c),c=g}(c===void 0||p>c)&&(f.onBlockNumber(p,c),c=p)}catch(p){(h=f.onError)==null||h.call(f,p)}},{emitOnBegin:e,interval:o}))})():(()=>{const d=rr(["watchBlockNumber",t.uid,e,n]);return pd(d,{onBlockNumber:r,onError:s},f=>{let h=!0,p=()=>h=!1;return(async()=>{try{const g=(()=>{if(t.transport.type==="fallback"){const E=t.transport.transports.find(A=>A.config.type==="webSocket"||A.config.type==="ipc");return E?E.value:t.transport}return t.transport})(),{unsubscribe:m}=await g.subscribe({params:["newHeads"],onData(E){var b;if(!h)return;const A=Er((b=E.result)==null?void 0:b.number);f.onBlockNumber(A,c),c=A},onError(E){var A;(A=f.onError)==null||A.call(f,E)}});p=m,h||p()}catch(g){s==null||s(g)}})(),()=>p()})})()}async function r8(t,e){const{checkReplacement:n=!0,confirmations:r=1,hash:s,onReplaced:i,retryCount:o=6,retryDelay:a=({count:C})=>~~(1<<C)*200,timeout:c=18e4}=e,l=rr(["waitForTransactionReceipt",t.uid,s]),u=(()=>{var C;return e.pollingInterval?e.pollingInterval:(C=t.chain)!=null&&C.experimental_preconfirmationTime?t.chain.experimental_preconfirmationTime:t.pollingInterval})();let d,f,h,p=!1,g,m;const{promise:E,resolve:A,reject:b}=Zv(),_=c?setTimeout(()=>{m==null||m(),g==null||g(),b(new WT({hash:s}))},c):void 0;return g=pd(l,{onReplaced:i,resolve:A,reject:b},async C=>{if(h=await Ze(t,Jf,"getTransactionReceipt")({hash:s}).catch(()=>{}),h&&r<=1){clearTimeout(_),C.resolve(h),g==null||g();return}m=Ze(t,n8,"watchBlockNumber")({emitMissed:!0,emitOnBegin:!0,poll:!0,pollingInterval:u,async onBlockNumber(S){const x=N=>{clearTimeout(_),m==null||m(),N(),g==null||g()};let P=S;if(!p)try{if(h){if(r>1&&(!h.blockNumber||P-h.blockNumber+1n<r))return;x(()=>C.resolve(h));return}if(n&&!d&&(p=!0,await yd(async()=>{d=await Ze(t,aC,"getTransaction")({hash:s}),d.blockNumber&&(P=d.blockNumber)},{delay:a,retryCount:o}),p=!1),h=await Ze(t,Jf,"getTransactionReceipt")({hash:s}),r>1&&(!h.blockNumber||P-h.blockNumber+1n<r))return;x(()=>C.resolve(h))}catch(N){if(N instanceof cv||N instanceof lv){if(!d){p=!1;return}try{f=d,p=!0;const L=await yd(()=>Ze(t,Ea,"getBlock")({blockNumber:P,includeTransactions:!0}),{delay:a,retryCount:o,shouldRetry:({error:O})=>O instanceof yv});p=!1;const M=L.transactions.find(({from:O,nonce:$})=>O===f.from&&$===f.nonce);if(!M||(h=await Ze(t,Jf,"getTransactionReceipt")({hash:M.hash}),r>1&&(!h.blockNumber||P-h.blockNumber+1n<r)))return;let U="replaced";M.to===f.to&&M.value===f.value&&M.input===f.input?U="repriced":M.from===M.to&&M.value===0n&&(U="cancelled"),x(()=>{var O;(O=C.onReplaced)==null||O.call(C,{reason:U,replacedTransaction:f,transaction:M,transactionReceipt:h}),C.resolve(h)})}catch(L){x(()=>C.reject(L))}}else x(()=>C.reject(N))}}})}),E}function s8(t,{batch:e=!0,onError:n,onTransactions:r,poll:s,pollingInterval:i=t.pollingInterval}){return(typeof s<"u"?s:t.transport.type!=="webSocket"&&t.transport.type!=="ipc")?(()=>{const l=rr(["watchPendingTransactions",t.uid,e,i]);return pd(l,{onTransactions:r,onError:n},u=>{let d;const f=eC(async()=>{var h;try{if(!d)try{d=await Ze(t,UO,"createPendingTransactionFilter")({});return}catch(g){throw f(),g}const p=await Ze(t,OO,"getFilterChanges")({filter:d});if(p.length===0)return;if(e)u.onTransactions(p);else for(const g of p)u.onTransactions([g])}catch(p){(h=u.onError)==null||h.call(u,p)}},{emitOnBegin:!0,interval:i});return async()=>{d&&await Ze(t,RO,"uninstallFilter")({filter:d}),f()}})})():(()=>{let l=!0,u=()=>l=!1;return(async()=>{try{const{unsubscribe:d}=await t.transport.subscribe({params:["newPendingTransactions"],onData(f){if(!l)return;const h=f.result;r([h])},onError(f){n==null||n(f)}});u=d,l||u()}catch(d){n==null||n(d)}})(),()=>u()})()}async function i8(t,{account:e=t.account,message:n}){if(!e)throw new pg({docsPath:"/docs/actions/wallet/signMessage"});const r=sr(e);if(r.signMessage)return r.signMessage({message:n});const s=typeof n=="string"?Zd(n):n.raw instanceof Uint8Array?nr(n.raw):n.raw;return t.request({method:"personal_sign",params:[s,r.address]},{retryCount:0})}function mg({key:t,methods:e,name:n,request:r,retryCount:s=3,retryDelay:i=150,timeout:o,type:a},c){const l=rC();return{config:{key:t,methods:e,name:n,request:r,retryCount:s,retryDelay:i,timeout:o,type:a},request:ZO(r,{methods:e,retryCount:s,retryDelay:i,uid:l}),value:c}}function o8(t,e={}){const{key:n="custom",methods:r,name:s="Custom Provider",retryDelay:i}=e;return({retryCount:o})=>mg({key:n,methods:r,name:s,request:t.request.bind(t),retryCount:e.retryCount??o,retryDelay:i,type:"custom"})}function by(t,e={}){const{key:n="fallback",name:r="Fallback",rank:s=!1,shouldThrow:i=a8,retryCount:o,retryDelay:a}=e;return({chain:c,pollingInterval:l=4e3,timeout:u,...d})=>{let f=t,h=()=>{};const p=mg({key:n,name:r,async request({method:g,params:m}){let E;const A=async(b=0)=>{const _=f[b]({...d,chain:c,retryCount:0,timeout:u});try{const C=await _.request({method:g,params:m});return h({method:g,params:m,response:C,transport:_,status:"success"}),C}catch(C){if(h({error:C,method:g,params:m,transport:_,status:"error"}),i(C)||b===f.length-1||(E??(E=f.slice(b+1).some(S=>{const{include:x,exclude:P}=S({chain:c}).config.methods||{};return x?x.includes(g):P?!P.includes(g):!0})),!E))throw C;return A(b+1)}};return A()},retryCount:o,retryDelay:a,type:"fallback"},{onResponse:g=>h=g,transports:f.map(g=>g({chain:c,retryCount:0}))});if(s){const g=typeof s=="object"?s:{};c8({chain:c,interval:g.interval??l,onTransports:m=>f=m,ping:g.ping,sampleCount:g.sampleCount,timeout:g.timeout,transports:f,weights:g.weights})}return p}}function a8(t){return!!("code"in t&&typeof t.code=="number"&&(t.code===ba.code||t.code===lt.code||Ji.nodeMessage.test(t.message)||t.code===5e3))}function c8({chain:t,interval:e=4e3,onTransports:n,ping:r,sampleCount:s=10,timeout:i=1e3,transports:o,weights:a={}}){const{stability:c=.7,latency:l=.3}=a,u=[],d=async()=>{const f=await Promise.all(o.map(async g=>{const m=g({chain:t,retryCount:0,timeout:i}),E=Date.now();let A,b;try{await(r?r({transport:m}):m.request({method:"net_listening"})),b=1}catch{b=0}finally{A=Date.now()}return{latency:A-E,success:b}}));u.push(f),u.length>s&&u.shift();const h=Math.max(...u.map(g=>Math.max(...g.map(({latency:m})=>m)))),p=o.map((g,m)=>{const E=u.map(S=>S[m].latency),b=1-E.reduce((S,x)=>S+x,0)/E.length/h,_=u.map(S=>S[m].success),C=_.reduce((S,x)=>S+x,0)/_.length;return C===0?[0,m]:[l*b+c*C,m]}).sort((g,m)=>m[0]-g[0]);n(p.map(([,g])=>o[g])),await gd(e),d()};d()}class l8 extends q{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}function iu(t,e={}){const{batch:n,fetchFn:r,fetchOptions:s,key:i="http",methods:o,name:a="HTTP JSON-RPC",onFetchRequest:c,onFetchResponse:l,retryDelay:u,raw:d}=e;return({chain:f,retryCount:h,timeout:p})=>{const{batchSize:g=1e3,wait:m=0}=typeof n=="object"?n:{},E=e.retryCount??h,A=p??e.timeout??1e4,b=t||(f==null?void 0:f.rpcUrls.default.http[0]);if(!b)throw new l8;const _=QO(b,{fetchFn:r,fetchOptions:s,onRequest:c,onResponse:l,timeout:A});return mg({key:i,methods:o,name:a,async request({method:C,params:S}){const x={method:C,params:S},{schedule:P}=Jv({id:b,wait:m,shouldSplitBatch(U){return U.length>g},fn:U=>_.request({body:U}),sort:(U,O)=>U.id-O.id}),N=async U=>n?P(U):[await _.request({body:U})],[{error:L,result:M}]=await N(x);if(d)return{error:L,result:M};if(L)throw new og({body:x,error:L,url:b});return M},retryCount:E,retryDelay:u,timeout:A,type:"http"},{fetchOptions:s,url:b})}}async function Fa(...t){const e=await fetch(...t);if(!e.ok)throw new Error(`HTTP status code: ${e.status}`,{cause:e});return e}class kl{constructor({baseUrl:e,clientId:n}){this.baseUrl=e,this.clientId=n}async get({headers:e,signal:n,cache:r,...s}){const i=this.createUrl(s);return(await Fa(i,{method:"GET",headers:e,signal:n,cache:r})).json()}async getBlob({headers:e,signal:n,...r}){const s=this.createUrl(r);return(await Fa(s,{method:"GET",headers:e,signal:n})).blob()}async post({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Fa(i,{method:"POST",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}async put({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Fa(i,{method:"PUT",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}async delete({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Fa(i,{method:"DELETE",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}createUrl({path:e,params:n}){const r=new URL(e,this.baseUrl);return n&&Object.entries(n).forEach(([s,i])=>{i&&r.searchParams.append(s,i)}),this.clientId&&r.searchParams.append("clientId",this.clientId),r}sendBeacon({body:e,...n}){const r=this.createUrl(n);return navigator.sendBeacon(r.toString(),e?JSON.stringify(e):void 0)}}const Up={getFeatureValue(t,e){const n=e==null?void 0:e[t];return n===void 0?Oe.DEFAULT_FEATURES[t]:n},filterSocialsByPlatform(t){if(!t||!t.length)return t;let e=t;return Q.isTelegram()&&(Q.isIos()&&(e=e.filter(n=>n!=="google")),Q.isMac()&&(e=e.filter(n=>n!=="x")),Q.isAndroid()&&(e=e.filter(n=>!["facebook","x"].includes(n)))),Q.isMobile()&&(e=e.filter(n=>n!=="facebook")),e},isSocialsEnabled(){var t,e,n,r;return Array.isArray((t=F.state.features)==null?void 0:t.socials)&&((e=F.state.features)==null?void 0:e.socials.length)>0||Array.isArray((n=F.state.remoteFeatures)==null?void 0:n.socials)&&((r=F.state.remoteFeatures)==null?void 0:r.socials.length)>0},isEmailEnabled(){var t,e;return!!((t=F.state.features)!=null&&t.email||(e=F.state.remoteFeatures)!=null&&e.email)}},he=Qe({features:Oe.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:Oe.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0,experimental_preferUniversalLinks:!1,remoteFeatures:{},enableMobileFullScreen:!1,coinbasePreference:"all"}),F={state:he,subscribeKey(t,e){return Dt(he,t,e)},setOptions(t){Object.assign(he,t)},setRemoteFeatures(t){var n,r;if(!t)return;const e={...he.remoteFeatures,...t};he.remoteFeatures=e,(n=he.remoteFeatures)!=null&&n.socials&&(he.remoteFeatures.socials=Up.filterSocialsByPlatform(he.remoteFeatures.socials)),(r=he.features)!=null&&r.pay&&(he.remoteFeatures.email=!1,he.remoteFeatures.socials=!1)},setFeatures(t){var n;if(!t)return;he.features||(he.features=Oe.DEFAULT_FEATURES);const e={...he.features,...t};he.features=e,(n=he.features)!=null&&n.pay&&he.remoteFeatures&&(he.remoteFeatures.email=!1,he.remoteFeatures.socials=!1)},setProjectId(t){he.projectId=t},setCustomRpcUrls(t){he.customRpcUrls=t},setAllWallets(t){he.allWallets=t},setIncludeWalletIds(t){he.includeWalletIds=t},setExcludeWalletIds(t){he.excludeWalletIds=t},setFeaturedWalletIds(t){he.featuredWalletIds=t},setTokens(t){he.tokens=t},setTermsConditionsUrl(t){he.termsConditionsUrl=t},setPrivacyPolicyUrl(t){he.privacyPolicyUrl=t},setCustomWallets(t){he.customWallets=t},setIsSiweEnabled(t){he.isSiweEnabled=t},setIsUniversalProvider(t){he.isUniversalProvider=t},setSdkVersion(t){he.sdkVersion=t},setMetadata(t){he.metadata=t},setDisableAppend(t){he.disableAppend=t},setEIP6963Enabled(t){he.enableEIP6963=t},setDebug(t){he.debug=t},setEnableWalletGuide(t){he.enableWalletGuide=t},setEnableAuthLogger(t){he.enableAuthLogger=t},setEnableWallets(t){he.enableWallets=t},setPreferUniversalLinks(t){he.experimental_preferUniversalLinks=t},setSIWX(t){if(t)for(const[e,n]of Object.entries(Oe.SIWX_DEFAULTS))t[e]??(t[e]=n);he.siwx=t},setConnectMethodsOrder(t){he.features={...he.features,connectMethodsOrder:t}},setWalletFeaturesOrder(t){he.features={...he.features,walletFeaturesOrder:t}},setSocialsOrder(t){he.remoteFeatures={...he.remoteFeatures,socials:t}},setCollapseWallets(t){he.features={...he.features,collapseWallets:t}},setEnableEmbedded(t){he.enableEmbedded=t},setAllowUnsupportedChain(t){he.allowUnsupportedChain=t},setManualWCControl(t){he.manualWCControl=t},setEnableNetworkSwitch(t){he.enableNetworkSwitch=t},setEnableMobileFullScreen(t){he.enableMobileFullScreen=Q.isMobile()&&t},setEnableReconnect(t){he.enableReconnect=t},setCoinbasePreference(t){he.coinbasePreference=t},setDefaultAccountTypes(t={}){Object.entries(t).forEach(([e,n])=>{n&&(he.defaultAccountTypes[e]=n)})},setUniversalProviderConfigOverride(t){he.universalProviderConfigOverride=t},getUniversalProviderConfigOverride(){return he.universalProviderConfigOverride},getSnapshot(){return Ic(he)}},Wi=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),Et=Qe({...Wi}),u8={state:Et,subscribeKey(t,e){return Dt(Et,t,e)},showLoading(t,e={}){this._showMessage({message:t,variant:"loading",...e})},showSuccess(t){this._showMessage({message:t,variant:"success"})},showSvg(t,e){this._showMessage({message:t,svg:e})},showError(t){const e=Q.parseError(t);this._showMessage({message:e,variant:"error"})},hide(){Et.message=Wi.message,Et.variant=Wi.variant,Et.svg=Wi.svg,Et.open=Wi.open,Et.autoClose=Wi.autoClose},_showMessage({message:t,svg:e,variant:n="success",autoClose:r=Wi.autoClose}){Et.open?(Et.open=!1,setTimeout(()=>{Et.message=t,Et.variant=n,Et.svg=e,Et.open=!0,Et.autoClose=r},150)):(Et.message=t,Et.variant=n,Et.svg=e,Et.open=!0,Et.autoClose=r)}},Hr=u8,d8={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},cC=Q.getBlockchainApiUrl(),nn=Qe({clientId:null,api:new kl({baseUrl:cC,clientId:null}),supportedChains:{http:[],ws:[]}}),be={state:nn,async get(t){const{st:e,sv:n}=be.getSdkProperties(),r=F.state.projectId,s={...t.params||{},st:e,sv:n,projectId:r};return nn.api.get({...t,params:s})},getSdkProperties(){const{sdkType:t,sdkVersion:e}=F.state;return{st:t||"unknown",sv:e||"unknown"}},async isNetworkSupported(t){if(!t)return!1;try{nn.supportedChains.http.length||await be.getSupportedNetworks()}catch{return!1}return nn.supportedChains.http.includes(t)},async getSupportedNetworks(){try{const t=await be.get({path:"v1/supported-chains"});return nn.supportedChains=t,t}catch{return nn.supportedChains}},async fetchIdentity({address:t}){const e=W.getIdentityFromCacheForAddress(t);if(e)return e;const n=await be.get({path:`/v1/identity/${t}`,params:{sender:I.state.activeCaipAddress?Q.getPlainAddress(I.state.activeCaipAddress):void 0}});return W.updateIdentityCache({address:t,identity:n,timestamp:Date.now()}),n},async fetchTransactions({account:t,cursor:e,signal:n,cache:r,chainId:s}){var c;if(!await be.isNetworkSupported((c=I.state.activeCaipNetwork)==null?void 0:c.caipNetworkId))return{data:[],next:void 0};const o=W.getTransactionsCacheForAddress({address:t,chainId:s});if(o)return o;const a=await be.get({path:`/v1/account/${t}/history`,params:{cursor:e,chainId:s},signal:n,cache:r});return W.updateTransactionsCache({address:t,chainId:s,timestamp:Date.now(),transactions:a}),a},async fetchSwapQuote({amount:t,userAddress:e,from:n,to:r,gasPrice:s}){var o;return await be.isNetworkSupported((o=I.state.activeCaipNetwork)==null?void 0:o.caipNetworkId)?be.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:t,userAddress:e,from:n,to:r,gasPrice:s}}):{quotes:[]}},async fetchSwapTokens({chainId:t}){var n;return await be.isNetworkSupported((n=I.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?be.get({path:"/v1/convert/tokens",params:{chainId:t}}):{tokens:[]}},async getAddressBalance({caipNetworkId:t,address:e}){return nn.api.post({path:`/v1?chainId=${t}&projectId=${F.state.projectId}`,body:{id:"1",jsonrpc:"2.0",method:"getAddressBalance",params:{address:e}}}).then(n=>n.result)},async fetchTokenPrice({addresses:t}){var s;if(!await be.isNetworkSupported((s=I.state.activeCaipNetwork)==null?void 0:s.caipNetworkId))return{fungibles:[]};const n=W.getTokenPriceCacheForAddresses(t);if(n)return n;const r=await nn.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:t,projectId:F.state.projectId},headers:{"Content-Type":"application/json"}});return W.updateTokenPriceCache({addresses:t,timestamp:Date.now(),tokenPrice:r}),r},async fetchSwapAllowance({tokenAddress:t,userAddress:e}){var r;return await be.isNetworkSupported((r=I.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)?be.get({path:"/v1/convert/allowance",params:{tokenAddress:t,userAddress:e},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:t}){var s;const{st:e,sv:n}=be.getSdkProperties();if(!await be.isNetworkSupported((s=I.state.activeCaipNetwork)==null?void 0:s.caipNetworkId))throw new Error("Network not supported for Gas Price");return be.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:t,st:e,sv:n}})},async generateSwapCalldata({amount:t,from:e,to:n,userAddress:r,disableEstimate:s}){var o;if(!await be.isNetworkSupported((o=I.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return nn.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:t,eip155:{slippage:Oe.CONVERT_SLIPPAGE_TOLERANCE},projectId:F.state.projectId,from:e,to:n,userAddress:r,disableEstimate:s}})},async generateApproveCalldata({from:t,to:e,userAddress:n}){var o;const{st:r,sv:s}=be.getSdkProperties();if(!await be.isNetworkSupported((o=I.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return be.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:n,from:t,to:e,st:r,sv:s}})},async getBalance(t,e,n){var l;const{st:r,sv:s}=be.getSdkProperties();if(!await be.isNetworkSupported((l=I.state.activeCaipNetwork)==null?void 0:l.caipNetworkId))return Hr.showError("Token Balance Unavailable"),{balances:[]};const o=`${e}:${t}`,a=W.getBalanceCacheForCaipAddress(o);if(a)return a;const c=await be.get({path:`/v1/account/${t}/balance`,params:{currency:"usd",chainId:e,forceUpdate:n,st:r,sv:s}});return W.updateBalanceCache({caipAddress:o,balance:c,timestamp:Date.now()}),c},async lookupEnsName(t){var n;return await be.isNetworkSupported((n=I.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?be.get({path:`/v1/profile/account/${t}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:t}){var r,s;if(!await be.isNetworkSupported((r=I.state.activeCaipNetwork)==null?void 0:r.caipNetworkId))return[];const n=(s=I.getAccountData())==null?void 0:s.address;return be.get({path:`/v1/profile/reverse/${t}`,params:{sender:n,apiVersion:"2"}})},async getEnsNameSuggestions(t){var n;return await be.isNetworkSupported((n=I.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?be.get({path:`/v1/profile/suggestions/${t}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:t,address:e,message:n,signature:r}){var i;return await be.isNetworkSupported((i=I.state.activeCaipNetwork)==null?void 0:i.caipNetworkId)?nn.api.post({path:"/v1/profile/account",body:{coin_type:t,address:e,message:n,signature:r},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:t,partnerUserId:e,defaultNetwork:n,purchaseAmount:r,paymentAmount:s}){var a;return await be.isNetworkSupported((a=I.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)?(await nn.api.post({path:"/v1/generators/onrampurl",params:{projectId:F.state.projectId},body:{destinationWallets:t,defaultNetwork:n,partnerUserId:e,defaultExperience:"buy",presetCryptoAmount:r,presetFiatAmount:s}})).url:""},async getOnrampOptions(){var e;if(!await be.isNetworkSupported((e=I.state.activeCaipNetwork)==null?void 0:e.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await be.get({path:"/v1/onramp/options"})}catch{return d8}},async getOnrampQuote({purchaseCurrency:t,paymentCurrency:e,amount:n,network:r}){var s;try{return await be.isNetworkSupported((s=I.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)?await nn.api.post({path:"/v1/onramp/quote",params:{projectId:F.state.projectId},body:{purchaseCurrency:t,paymentCurrency:e,amount:n,network:r}}):null}catch{return{networkFee:{amount:n,currency:e.id},paymentSubtotal:{amount:n,currency:e.id},paymentTotal:{amount:n,currency:e.id},purchaseAmount:{amount:n,currency:e.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(t){var n;return await be.isNetworkSupported((n=I.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?be.get({path:`/v1/sessions/${t}`}):[]},async revokeSmartSession(t,e,n){var s;return await be.isNetworkSupported((s=I.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)?nn.api.post({path:`/v1/sessions/${t}/revoke`,params:{projectId:F.state.projectId},body:{pci:e,signature:n}}):{success:!1}},setClientId(t){nn.clientId=t,nn.api=new kl({baseUrl:cC,clientId:t})}},Zn={PHANTOM:{id:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",url:"https://phantom.app"},SOLFLARE:{id:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",url:"https://solflare.com"},COINBASE:{id:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",url:"https://go.cb-w.com"},BINANCE:{id:"2fafea35bb471d22889ccb49c08d99dd0a18a37982602c33f696a5723934ba25",appId:"yFK5FCqYprrXDiVFbhyRx7",deeplink:"bnc://app.binance.com/mp/app",url:"https://app.binance.com/en/download"}},f8={handleMobileDeeplinkRedirect(t,e){const n=window.location.href,r=encodeURIComponent(n);if(t===Zn.PHANTOM.id&&!("phantom"in window)){const s=n.startsWith("https")?"https":"http",i=n.split("/")[2],o=encodeURIComponent(`${s}://${i}`);window.location.href=`${Zn.PHANTOM.url}/ul/browse/${r}?ref=${o}`}if(t===Zn.SOLFLARE.id&&!("solflare"in window)&&(window.location.href=`${Zn.SOLFLARE.url}/ul/v1/browse/${r}?ref=${r}`),e===B.CHAIN.SOLANA&&t===Zn.COINBASE.id&&!("coinbaseSolana"in window)&&(window.location.href=`${Zn.COINBASE.url}/dapp?cb_url=${r}`),e===B.CHAIN.BITCOIN&&t===Zn.BINANCE.id&&!("binancew3w"in window)){const s=I.state.activeCaipNetwork,i=window.btoa("/pages/browser/index"),o=window.btoa(`url=${r}&defaultChainId=${(s==null?void 0:s.id)??1}`),a=new URL(Zn.BINANCE.deeplink);a.searchParams.set("appId",Zn.BINANCE.appId),a.searchParams.set("startPagePath",i),a.searchParams.set("startPageQuery",o);const c=new URL(Zn.BINANCE.url);c.searchParams.set("_dp",window.btoa(a.toString())),window.location.href=c.toString()}}},h8=Object.freeze({enabled:!0,events:[]}),p8=new kl({baseUrl:Q.getAnalyticsUrl(),clientId:null}),g8=5,m8=60*1e3,Ws=Qe({...h8}),y8={state:Ws,subscribeKey(t,e){return Dt(Ws,t,e)},async sendError(t,e){if(!Ws.enabled)return;const n=Date.now();if(Ws.events.filter(i=>{const o=new Date(i.properties.timestamp||"").getTime();return n-o<m8}).length>=g8)return;const s={type:"error",event:e,properties:{errorType:t.name,errorMessage:t.message,stackTrace:t.stack,timestamp:new Date().toISOString()}};Ws.events.push(s);try{if(typeof window>"u")return;const{projectId:i,sdkType:o,sdkVersion:a}=F.state;await p8.post({path:"/e",params:{projectId:i,st:o,sv:a||"html-wagmi-4.2.2"},body:{eventId:Q.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:new Date().toISOString(),props:{type:"error",event:e,errorType:t.name,errorMessage:t.message,stackTrace:t.stack}}})}catch{}},enable(){Ws.enabled=!0},disable(){Ws.enabled=!1},clearEvents(){Ws.events=[]}};class wo extends Error{constructor(e,n,r){super(e),this.originalName="AppKitError",this.name="AppKitError",this.category=n,this.originalError=r,r&&r instanceof Error&&(this.originalName=r.name),Object.setPrototypeOf(this,wo.prototype);let s=!1;if(r instanceof Error&&typeof r.stack=="string"&&r.stack){const i=r.stack,o=i.indexOf(`
`);if(o>-1){const a=i.substring(o+1);this.stack=`${this.name}: ${this.message}
${a}`,s=!0}}s||(Error.captureStackTrace?Error.captureStackTrace(this,wo):this.stack||(this.stack=`${this.name}: ${this.message}`))}}function wy(t,e){let n="";try{t instanceof Error?n=t.message:typeof t=="string"?n=t:typeof t=="object"&&t!==null?Object.keys(t).length===0?n="Unknown error":n=(t==null?void 0:t.message)||JSON.stringify(t):n=String(t)}catch(s){n="Unknown error",console.error("Error parsing error message",s)}const r=t instanceof wo?t:new wo(n,e,t);throw y8.sendError(r,r.category),r}function ar(t,e="INTERNAL_SDK_ERROR"){const n={};return Object.keys(t).forEach(r=>{const s=t[r];if(typeof s=="function"){let i=s;s.constructor.name==="AsyncFunction"?i=async(...o)=>{try{return await s(...o)}catch(a){return wy(a,e)}}:i=(...o)=>{try{return s(...o)}catch(a){return wy(a,e)}},n[r]=i}else n[r]=s}),n}const kn=Qe({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),b8={state:kn,subscribeNetworkImages(t){return Ft(kn.networkImages,()=>t(kn.networkImages))},subscribeKey(t,e){return Dt(kn,t,e)},subscribe(t){return Ft(kn,()=>t(kn))},setWalletImage(t,e){kn.walletImages[t]=e},setNetworkImage(t,e){kn.networkImages[t]=e},setChainImage(t,e){kn.chainImages[t]=e},setConnectorImage(t,e){kn.connectorImages={...kn.connectorImages,[t]:e}},setTokenImage(t,e){kn.tokenImages[t]=e},setCurrencyImage(t,e){kn.currencyImages[t]=e}},Mn=ar(b8),Ey={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:"",sui:"",stacks:"",ton:"20f673c0-095e-49b2-07cf-eb5049dcf600"},Xf=Qe({networkImagePromises:{}}),lC={async fetchWalletImage(t){if(t)return await se._fetchWalletImage(t),this.getWalletImageById(t)},async fetchNetworkImage(t){if(!t)return;const e=this.getNetworkImageById(t);return e||(Xf.networkImagePromises[t]||(Xf.networkImagePromises[t]=se._fetchNetworkImage(t)),await Xf.networkImagePromises[t],this.getNetworkImageById(t))},getWalletImageById(t){if(t)return Mn.state.walletImages[t]},getWalletImage(t){if(t!=null&&t.image_url)return t==null?void 0:t.image_url;if(t!=null&&t.image_id)return Mn.state.walletImages[t.image_id]},getNetworkImage(t){var e,n,r;if((e=t==null?void 0:t.assets)!=null&&e.imageUrl)return(n=t==null?void 0:t.assets)==null?void 0:n.imageUrl;if((r=t==null?void 0:t.assets)!=null&&r.imageId)return Mn.state.networkImages[t.assets.imageId]},getNetworkImageById(t){if(t)return Mn.state.networkImages[t]},getConnectorImage(t){var e;if(t!=null&&t.imageUrl)return t.imageUrl;if((e=t==null?void 0:t.info)!=null&&e.icon)return t.info.icon;if(t!=null&&t.imageId)return Mn.state.connectorImages[t.imageId]},getChainImage(t){return Mn.state.networkImages[Ey[t]]},getTokenImage(t){if(t)return Mn.state.tokenImages[t]},getWalletImageUrl(t){if(!t)return"";const{projectId:e,sdkType:n,sdkVersion:r}=F.state,s=new URL(`${B.W3M_API_URL}/getWalletImage/${t}`);return s.searchParams.set("projectId",e),s.searchParams.set("st",n),s.searchParams.set("sv",r),s.toString()},getAssetImageUrl(t){if(!t)return"";const{projectId:e,sdkType:n,sdkVersion:r}=F.state,s=new URL(`${B.W3M_API_URL}/public/getAssetImage/${t}`);return s.searchParams.set("projectId",e),s.searchParams.set("st",n),s.searchParams.set("sv",r),s.toString()},getChainNamespaceImageUrl(t){return this.getAssetImageUrl(Ey[t])}},w8=Q.getAnalyticsUrl(),E8=new kl({baseUrl:w8,clientId:null}),v8=["MODAL_CREATED"],C8=45,vy=1e3*10,at=Qe({timestamp:Date.now(),lastFlush:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"},pendingEvents:[],subscribedToVisibilityChange:!1,walletImpressions:[]}),ve={state:at,subscribe(t){return Ft(at,()=>t(at))},getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:n}=F.state;return{projectId:t,st:e,sv:n||"html-wagmi-4.2.2"}},shouldFlushEvents(){const t=JSON.stringify(at.pendingEvents).length/1024>C8,e=at.lastFlush+vy<Date.now();return t||e},_setPendingEvent(t){var e,n;try{let r=(e=I.getAccountData())==null?void 0:e.address;if("address"in t.data&&t.data.address&&(r=t.data.address),v8.includes(t.data.event)||typeof window>"u")return;const s=(n=I.getActiveCaipNetwork())==null?void 0:n.caipNetworkId;this.state.pendingEvents.push({eventId:Q.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:t.timestamp,props:{...t.data,address:r,properties:{..."properties"in t.data?t.data.properties:{},caipNetworkId:s}}}),at.reportedErrors.FORBIDDEN=!1,ve.shouldFlushEvents()&&ve._submitPendingEvents()}catch(r){console.warn("_setPendingEvent",r)}},sendEvent(t){var n;at.timestamp=Date.now(),at.data=t;const e=["INITIALIZE","CONNECT_SUCCESS","SOCIAL_LOGIN_SUCCESS"];((n=F.state.features)!=null&&n.analytics||e.includes(t.event))&&ve._setPendingEvent(at),this.subscribeToFlushTriggers()},sendWalletImpressionEvent(t){at.walletImpressions.push(t)},_transformPendingEventsForBatch(t){try{return t.filter(e=>e.props.event!=="WALLET_IMPRESSION_V2")}catch{return t}},_submitPendingEvents(){if(at.lastFlush=Date.now(),!(at.pendingEvents.length===0&&at.walletImpressions.length===0))try{const t=ve._transformPendingEventsForBatch(at.pendingEvents);at.walletImpressions.length&&t.push({eventId:Q.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:Date.now(),props:{type:"track",event:"WALLET_IMPRESSION_V2",items:[...at.walletImpressions]}}),E8.sendBeacon({path:"/batch",params:ve.getSdkProperties(),body:t}),at.reportedErrors.FORBIDDEN=!1,at.pendingEvents=[],at.walletImpressions=[]}catch{at.reportedErrors.FORBIDDEN=!0}},subscribeToFlushTriggers(){var t,e,n;at.subscribedToVisibilityChange||typeof document>"u"||(at.subscribedToVisibilityChange=!0,(t=document==null?void 0:document.addEventListener)==null||t.call(document,"visibilitychange",()=>{document.visibilityState==="hidden"&&ve._submitPendingEvents()}),(e=document==null?void 0:document.addEventListener)==null||e.call(document,"freeze",()=>{ve._submitPendingEvents()}),(n=window==null?void 0:window.addEventListener)==null||n.call(window,"pagehide",()=>{ve._submitPendingEvents()}),setInterval(()=>{ve._submitPendingEvents()},vy))}},_8=Q.getApiUrl(),rn=new kl({baseUrl:_8,clientId:null}),A8=40,Cy=4,I8=20,Ee=Qe({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1,explorerWallets:[],explorerFilteredWallets:[],plan:{tier:"none",hasExceededUsageLimit:!1,limits:{isAboveRpcLimit:!1,isAboveMauLimit:!1}}}),se={state:Ee,subscribeKey(t,e){return Dt(Ee,t,e)},_getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:n}=F.state;return{projectId:t,st:e||"appkit",sv:n||"html-wagmi-4.2.2"}},_filterOutExtensions(t){return F.state.isUniversalProvider?t.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):t},async _fetchWalletImage(t){const e=`${rn.baseUrl}/getWalletImage/${t}`,n=await rn.getBlob({path:e,params:se._getSdkProperties()});Mn.setWalletImage(t,URL.createObjectURL(n))},async _fetchNetworkImage(t){const e=`${rn.baseUrl}/public/getAssetImage/${t}`,n=await rn.getBlob({path:e,params:se._getSdkProperties()});Mn.setNetworkImage(t,URL.createObjectURL(n))},async _fetchConnectorImage(t){const e=`${rn.baseUrl}/public/getAssetImage/${t}`,n=await rn.getBlob({path:e,params:se._getSdkProperties()});Mn.setConnectorImage(t,URL.createObjectURL(n))},async _fetchCurrencyImage(t){const e=`${rn.baseUrl}/public/getCurrencyImage/${t}`,n=await rn.getBlob({path:e,params:se._getSdkProperties()});Mn.setCurrencyImage(t,URL.createObjectURL(n))},async _fetchTokenImage(t){const e=`${rn.baseUrl}/public/getTokenImage/${t}`,n=await rn.getBlob({path:e,params:se._getSdkProperties()});Mn.setTokenImage(t,URL.createObjectURL(n))},_filterWalletsByPlatform(t){const e=t.length,n=Q.isMobile()?t==null?void 0:t.filter(s=>s.mobile_link||s.webapp_link?!0:Object.values(Zn).map(o=>o.id).includes(s.id)):t,r=e-n.length;return{filteredWallets:n,mobileFilteredOutWalletsLength:r}},async fetchProjectConfig(){return(await rn.get({path:"/appkit/v1/config",params:se._getSdkProperties()})).features},async fetchUsage(){try{const t=await rn.get({path:"/appkit/v1/project-limits",params:se._getSdkProperties()}),{tier:e,isAboveMauLimit:n,isAboveRpcLimit:r}=t.planLimits,s=e==="starter",i=n||r;se.state.plan={tier:e,hasExceededUsageLimit:s&&i,limits:{isAboveRpcLimit:r,isAboveMauLimit:n}}}catch(t){console.warn("Failed to fetch usage",t)}},async fetchAllowedOrigins(){try{const{allowedOrigins:t}=await rn.get({path:"/projects/v1/origins",params:se._getSdkProperties()});return t}catch(t){if(t instanceof Error&&t.cause instanceof Response){const e=t.cause.status;if(e===B.HTTP_STATUS_CODES.TOO_MANY_REQUESTS)throw new Error("RATE_LIMITED",{cause:t});if(e>=B.HTTP_STATUS_CODES.SERVER_ERROR&&e<600)throw new Error("SERVER_ERROR",{cause:t});return[]}return[]}},async fetchNetworkImages(){const t=I.getAllRequestedCaipNetworks(),e=t==null?void 0:t.map(({assets:n})=>n==null?void 0:n.imageId).filter(Boolean).filter(n=>!lC.getNetworkImageById(n));e&&await Promise.allSettled(e.map(n=>se._fetchNetworkImage(n)))},async fetchConnectorImages(){const{connectors:t}=V.state,e=t.map(({imageId:n})=>n).filter(Boolean);await Promise.allSettled(e.map(n=>se._fetchConnectorImage(n)))},async fetchCurrencyImages(t=[]){await Promise.allSettled(t.map(e=>se._fetchCurrencyImage(e)))},async fetchTokenImages(t=[]){await Promise.allSettled(t.map(e=>se._fetchTokenImage(e)))},async fetchWallets(t){var o;const e=t.exclude??[];se._getSdkProperties().sv.startsWith("html-core-")&&e.push(...Object.values(Zn).map(a=>a.id));const r=await rn.get({path:"/getWallets",params:{...se._getSdkProperties(),...t,page:String(t.page),entries:String(t.entries),include:(o=t.include)==null?void 0:o.join(","),exclude:e.join(",")}}),{filteredWallets:s,mobileFilteredOutWalletsLength:i}=se._filterWalletsByPlatform(r==null?void 0:r.data);return{data:s||[],count:r==null?void 0:r.count,mobileFilteredOutWalletsLength:i}},async prefetchWalletRanks(){const t=V.state.connectors;if(!(t!=null&&t.length))return;const e={page:1,entries:20,badge:"certified"};if(e.names=t.map(s=>s.name).join(","),I.state.activeChain===B.CHAIN.EVM){const s=[...t.flatMap(i=>{var o;return((o=i.connectors)==null?void 0:o.map(a=>{var c;return(c=a.info)==null?void 0:c.rdns}))||[]}),...t.map(i=>{var o;return(o=i.info)==null?void 0:o.rdns})].filter(i=>typeof i=="string"&&i.length>0);s.length&&(e.rdns=s.join(","))}const{data:n}=await se.fetchWallets(e);Ee.explorerWallets=n,V.extendConnectorsWithExplorerWallets(n);const r=I.getRequestedCaipNetworkIds().join(",");Ee.explorerFilteredWallets=n.filter(s=>{var i;return(i=s.chains)==null?void 0:i.some(o=>r.includes(o))})},async fetchFeaturedWallets(){const{featuredWalletIds:t}=F.state;if(t!=null&&t.length){const e={...se._getSdkProperties(),page:1,entries:(t==null?void 0:t.length)??Cy,include:t},{data:n}=await se.fetchWallets(e),r=[...n].sort((i,o)=>t.indexOf(i.id)-t.indexOf(o.id)),s=r.map(i=>i.image_id).filter(Boolean);await Promise.allSettled(s.map(i=>se._fetchWalletImage(i))),Ee.featured=r,Ee.allFeatured=r}},async fetchRecommendedWallets(){try{Ee.isFetchingRecommendedWallets=!0;const{includeWalletIds:t,excludeWalletIds:e,featuredWalletIds:n}=F.state,r=[...e??[],...n??[]].filter(Boolean),s=I.getRequestedCaipNetworkIds().join(","),i={page:1,entries:Cy,include:t,exclude:r,chains:s},{data:o,count:a}=await se.fetchWallets(i),c=W.getRecentWallets(),l=o.map(d=>d.image_id).filter(Boolean),u=c.map(d=>d.image_id).filter(Boolean);await Promise.allSettled([...l,...u].map(d=>se._fetchWalletImage(d))),Ee.recommended=o,Ee.allRecommended=o,Ee.count=a??0}catch{}finally{Ee.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:t}){const{includeWalletIds:e,excludeWalletIds:n,featuredWalletIds:r}=F.state,s=I.getRequestedCaipNetworkIds().join(","),i=[...Ee.recommended.map(({id:d})=>d),...n??[],...r??[]].filter(Boolean),o={page:t,entries:A8,include:e,exclude:i,chains:s},{data:a,count:c,mobileFilteredOutWalletsLength:l}=await se.fetchWallets(o);Ee.mobileFilteredOutWalletsLength=l+(Ee.mobileFilteredOutWalletsLength??0);const u=a.slice(0,I8).map(d=>d.image_id).filter(Boolean);await Promise.allSettled(u.map(d=>se._fetchWalletImage(d))),Ee.wallets=Q.uniqueBy([...Ee.wallets,...se._filterOutExtensions(a)],"id").filter(d=>{var f;return(f=d.chains)==null?void 0:f.some(h=>s.includes(h))}),Ee.count=c>Ee.count?c:Ee.count,Ee.page=t},async initializeExcludedWallets({ids:t}){const e={page:1,entries:t.length,include:t},{data:n}=await se.fetchWallets(e);n&&n.forEach(r=>{Ee.excludedWallets.push({rdns:r.rdns,name:r.name})})},async searchWallet({search:t,badge:e}){const{includeWalletIds:n,excludeWalletIds:r}=F.state,s=I.getRequestedCaipNetworkIds().join(",");Ee.search=[];const i={page:1,entries:100,search:t==null?void 0:t.trim(),badge_type:e,include:n,exclude:r,chains:s},{data:o}=await se.fetchWallets(i);ve.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:e??"",search:t??""}});const a=o.map(c=>c.image_id).filter(Boolean);await Promise.allSettled([...a.map(c=>se._fetchWalletImage(c)),Q.wait(300)]),Ee.search=se._filterOutExtensions(o)},initPromise(t,e){const n=Ee.promises[t];return n||(Ee.promises[t]=e())},prefetch({fetchConnectorImages:t=!0,fetchFeaturedWallets:e=!0,fetchRecommendedWallets:n=!0,fetchNetworkImages:r=!0,fetchWalletRanks:s=!0}={}){const i=[t&&se.initPromise("connectorImages",se.fetchConnectorImages),e&&se.initPromise("featuredWallets",se.fetchFeaturedWallets),n&&se.initPromise("recommendedWallets",se.fetchRecommendedWallets),r&&se.initPromise("networkImages",se.fetchNetworkImages),s&&se.initPromise("walletRanks",se.prefetchWalletRanks)].filter(Boolean);return Promise.allSettled(i)},prefetchAnalyticsConfig(){var t;(t=F.state.features)!=null&&t.analytics&&se.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:t}=await rn.get({path:"/getAnalyticsConfig",params:se._getSdkProperties()});F.setFeatures({analytics:t})}catch{F.setFeatures({analytics:!1})}},filterByNamespaces(t){if(!(t!=null&&t.length)){Ee.featured=Ee.allFeatured,Ee.recommended=Ee.allRecommended;return}const e=I.getRequestedCaipNetworkIds().join(",");Ee.featured=Ee.allFeatured.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))}),Ee.recommended=Ee.allRecommended.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))}),Ee.filteredWallets=Ee.wallets.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))})},clearFilterByNamespaces(){Ee.filteredWallets=[]},setFilterByNamespace(t){if(!t){Ee.featured=Ee.allFeatured,Ee.recommended=Ee.allRecommended;return}const e=I.getRequestedCaipNetworkIds().join(",");Ee.featured=Ee.allFeatured.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))}),Ee.recommended=Ee.allRecommended.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))}),Ee.filteredWallets=Ee.wallets.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))})}},S8=["ConnectingExternal","ConnectingMultiChain","ConnectingSocial","ConnectingFarcaster"],ze=Qe({view:"Connect",history:["Connect"],transactionStack:[]}),x8={state:ze,subscribeKey(t,e){return Dt(ze,t,e)},pushTransactionStack(t){ze.transactionStack.push(t)},popTransactionStack(t){const e=ze.transactionStack.pop();if(!e)return;const{onSuccess:n,onError:r,onCancel:s}=e;switch(t){case"success":n==null||n();break;case"error":r==null||r(),me.goBack();break;case"cancel":s==null||s(),me.goBack();break}},push(t,e){let n=t,r=e;se.state.plan.hasExceededUsageLimit&&S8.includes(t)&&(n="UsageExceeded",r=void 0),n!==ze.view&&(ze.view=n,ze.history.push(n),ze.data=r)},reset(t,e){ze.view=t,ze.history=[t],ze.data=e},replace(t,e){ze.history.at(-1)===t||(ze.view=t,ze.history[ze.history.length-1]=t,ze.data=e)},goBack(){var r,s;const t=I.state.activeCaipAddress,e=me.state.view==="ConnectingFarcaster",n=!t&&e;if(ze.history.length>1){ze.history.pop();const[i]=ze.history.slice(-1);i&&(t&&i==="Connect"?ze.view="Account":ze.view=i)}else Pe.close();(r=ze.data)!=null&&r.wallet&&(ze.data.wallet=void 0),(s=ze.data)!=null&&s.redirectView&&(ze.data.redirectView=void 0),setTimeout(()=>{var i,o,a;if(n){I.setAccountProp("farcasterUrl",void 0,I.state.activeChain);const c=V.getAuthConnector();(i=c==null?void 0:c.provider)==null||i.reload();const l=Ic(F.state);(a=(o=c==null?void 0:c.provider)==null?void 0:o.syncDappData)==null||a.call(o,{metadata:l.metadata,sdkVersion:l.sdkVersion,projectId:l.projectId,sdkType:l.sdkType})}},100)},goBackToIndex(t){if(ze.history.length>1){ze.history=ze.history.slice(0,t+1);const[e]=ze.history.slice(-1);e&&(ze.view=e)}},goBackOrCloseModal(){me.state.history.length>1?me.goBack():Pe.close()}},me=ar(x8),rs=Qe({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),Bp={state:rs,subscribe(t){return Ft(rs,()=>t(rs))},setThemeMode(t){rs.themeMode=t;try{const e=V.getAuthConnector();if(e){const n=Bp.getSnapshot().themeVariables;e.provider.syncTheme({themeMode:t,themeVariables:n,w3mThemeVariables:Nc(n,t)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(t){rs.themeVariables={...rs.themeVariables,...t};try{const e=V.getAuthConnector();if(e){const n=Bp.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:n,w3mThemeVariables:Nc(rs.themeVariables,rs.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot(){return Ic(rs)}},En=ar(Bp),uC=Object.fromEntries(cE.map(t=>[t,void 0])),N8=Object.fromEntries(cE.map(t=>[t,!0])),$e=Qe({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:uC,filterByNamespaceMap:N8}),T8={state:$e,subscribe(t){return Ft($e,()=>{t($e)})},subscribeKey(t,e){return Dt($e,t,e)},initialize(t){t.forEach(e=>{const n=W.getConnectedConnectorId(e);n&&V.setConnectorId(n,e)})},setActiveConnector(t){t&&($e.activeConnector=Sc(t))},setConnectors(t){t.filter(s=>!$e.allConnectors.some(i=>i.id===s.id&&V.getConnectorName(i.name)===V.getConnectorName(s.name)&&i.chain===s.chain)).forEach(s=>{s.type!=="MULTI_CHAIN"&&$e.allConnectors.push(Sc(s))});const n=V.getEnabledNamespaces(),r=V.getEnabledConnectors(n);$e.connectors=V.mergeMultiChainConnectors(r)},filterByNamespaces(t){Object.keys($e.filterByNamespaceMap).forEach(e=>{$e.filterByNamespaceMap[e]=!1}),t.forEach(e=>{$e.filterByNamespaceMap[e]=!0}),V.updateConnectorsForEnabledNamespaces()},filterByNamespace(t,e){$e.filterByNamespaceMap[t]=e,V.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const t=V.getEnabledNamespaces(),e=V.getEnabledConnectors(t),n=V.areAllNamespacesEnabled();$e.connectors=V.mergeMultiChainConnectors(e),n?se.clearFilterByNamespaces():se.filterByNamespaces(t)},getEnabledNamespaces(){return Object.entries($e.filterByNamespaceMap).filter(([t,e])=>e).map(([t])=>t)},getEnabledConnectors(t){return $e.allConnectors.filter(e=>t.includes(e.chain))},areAllNamespacesEnabled(){return Object.values($e.filterByNamespaceMap).every(t=>t)},mergeMultiChainConnectors(t){const e=V.generateConnectorMapByName(t),n=[];return e.forEach(r=>{const s=r[0],i=(s==null?void 0:s.id)===B.CONNECTOR_ID.AUTH;r.length>1&&s?n.push({name:s.name,imageUrl:s.imageUrl,imageId:s.imageId,connectors:[...r],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:(s==null?void 0:s.id)||""}):s&&n.push(s)}),n},generateConnectorMapByName(t){const e=new Map;return t.forEach(n=>{const{name:r}=n,s=V.getConnectorName(r);if(!s)return;const i=e.get(s)||[];i.find(a=>a.chain===n.chain)||i.push(n),e.set(s,i)}),e},getConnectorName(t){return t&&({"Trust Wallet":"Trust"}[t]||t)},getUniqueConnectorsByName(t){const e=[];return t.forEach(n=>{e.find(r=>r.chain===n.chain)||e.push(n)}),e},addConnector(t){var e,n,r;if(t.id===B.CONNECTOR_ID.AUTH){const s=t,i=Ic(F.state),o=En.getSnapshot().themeMode,a=En.getSnapshot().themeVariables;(n=(e=s==null?void 0:s.provider)==null?void 0:e.syncDappData)==null||n.call(e,{metadata:i.metadata,sdkVersion:i.sdkVersion,projectId:i.projectId,sdkType:i.sdkType}),(r=s==null?void 0:s.provider)==null||r.syncTheme({themeMode:o,themeVariables:a,w3mThemeVariables:Nc(a,o)}),V.setConnectors([t])}else V.setConnectors([t])},getAuthConnector(t){var r;const e=t||I.state.activeChain,n=$e.connectors.find(s=>s.id===B.CONNECTOR_ID.AUTH);if(n)return(r=n==null?void 0:n.connectors)!=null&&r.length?n.connectors.find(i=>i.chain===e):n},getAnnouncedConnectorRdns(){return $e.connectors.filter(t=>t.type==="ANNOUNCED").map(t=>{var e;return(e=t.info)==null?void 0:e.rdns})},getConnectorById(t){return $e.allConnectors.find(e=>e.id===t)},getConnector({id:t,namespace:e}){const n=e||I.state.activeChain;return $e.allConnectors.filter(i=>i.chain===n).find(i=>i.id===t||i.explorerId===t)},syncIfAuthConnector(t){var i,o;if(t.id!=="AUTH")return;const e=t,n=Ic(F.state),r=En.getSnapshot().themeMode,s=En.getSnapshot().themeVariables;(o=(i=e==null?void 0:e.provider)==null?void 0:i.syncDappData)==null||o.call(i,{metadata:n.metadata,sdkVersion:n.sdkVersion,sdkType:n.sdkType,projectId:n.projectId}),e.provider.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:Nc(s,r)})},getConnectorsByNamespace(t){const e=$e.allConnectors.filter(n=>n.chain===t);return V.mergeMultiChainConnectors(e)},canSwitchToSmartAccount(t){return I.checkIfSmartAccountEnabled()&&an(t)===ft.ACCOUNT_TYPES.EOA},selectWalletConnector(t){var s;const e=(s=me.state.data)==null?void 0:s.redirectView,n=I.state.activeChain,r=n?V.getConnector({id:t.id,namespace:n}):void 0;f8.handleMobileDeeplinkRedirect((r==null?void 0:r.explorerId)||t.id,I.state.activeChain),r?me.push("ConnectingExternal",{connector:r,wallet:t,redirectView:e}):me.push("ConnectingWalletConnect",{wallet:t,redirectView:e})},getConnectors(t){return t?V.getConnectorsByNamespace(t):V.mergeMultiChainConnectors($e.allConnectors)},setFilterByNamespace(t){$e.filterByNamespace=t,$e.connectors=V.getConnectors(t),se.setFilterByNamespace(t)},setConnectorId(t,e){t&&($e.activeConnectorIds={...$e.activeConnectorIds,[e]:t},W.setConnectedConnectorId(e,t))},removeConnectorId(t){$e.activeConnectorIds={...$e.activeConnectorIds,[t]:void 0},W.deleteConnectedConnectorId(t)},getConnectorId(t){if(t)return $e.activeConnectorIds[t]},isConnected(t){return t?!!$e.activeConnectorIds[t]:Object.values($e.activeConnectorIds).some(e=>!!e)},resetConnectorIds(){$e.activeConnectorIds={...uC}},extendConnectorsWithExplorerWallets(t){$e.allConnectors.forEach(r=>{const s=t.find(i=>{var o;return i.id===r.id||i.rdns&&i.rdns===((o=r.info)==null?void 0:o.rdns)});s&&(r.explorerWallet=s)});const e=V.getEnabledNamespaces(),n=V.getEnabledConnectors(e);$e.connectors=V.mergeMultiChainConnectors(n)}},V=ar(T8),O8=1e3,ja={checkNamespaceConnectorId(t,e){return V.getConnectorId(t)===e},isSocialProvider(t){return Oe.DEFAULT_REMOTE_FEATURES.socials.includes(t)},connectWalletConnect({walletConnect:t,connector:e,closeModalOnConnect:n=!0,redirectViewOnModalClose:r="Connect",onOpen:s,onConnect:i}){return new Promise((o,a)=>{if(t&&V.setActiveConnector(e),s==null||s(Q.isMobile()&&t),r){const l=Pe.subscribeKey("open",u=>{u||(me.state.view!==r&&me.replace(r),l(),a(new Error("Modal closed")))})}const c=I.subscribeKey("activeCaipAddress",l=>{l&&(i==null||i(),n&&Pe.close(),c(),o(It.parseCaipAddress(l)))})})},connectExternal(t){return new Promise((e,n)=>{const r=I.subscribeKey("activeCaipAddress",s=>{s&&(Pe.close(),r(),e(It.parseCaipAddress(s)))});Z.connectExternal(t,t.chain).catch(()=>{r(),n(new Error("Connection rejected"))})})},connectSocial({social:t,namespace:e,closeModalOnConnect:n=!0,onOpenFarcaster:r,onConnect:s}){let i,o=!1,a=null;const c=e||I.state.activeChain,l=I.subscribeKey("activeCaipAddress",u=>{u&&(n&&Pe.close(),l())});return new Promise((u,d)=>{async function f(p){var g;if((g=p.data)!=null&&g.resultUri)if(p.origin===B.SECURE_SITE_SDK_ORIGIN){window.removeEventListener("message",f,!1);try{const m=V.getAuthConnector(c);if(m&&!o){i&&i.close(),o=!0;const E=p.data.resultUri;ve.sendEvent({type:"track",event:"SOCIAL_LOGIN_REQUEST_USER_DATA",properties:{provider:t}}),W.setConnectedSocialProvider(t),await Z.connectExternal({id:m.id,type:m.type,socialUri:E},m.chain);const A=I.state.activeCaipAddress;if(!A){d(new Error("Failed to connect"));return}u(It.parseCaipAddress(A)),ve.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:t}})}}catch(m){ve.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:t,message:Q.parseError(m)}}),d(new Error("Failed to connect"))}}else ve.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:t,message:"Untrusted Origin"}})}async function h(){if(ve.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:t}}),t==="farcaster"){r==null||r();const p=Pe.subscribeKey("open",m=>{!m&&t==="farcaster"&&(d(new Error("Popup closed")),s==null||s(),p())}),g=V.getAuthConnector();if(g){const m=I.getAccountData(c);if(!(m!=null&&m.farcasterUrl))try{const{url:E}=await g.provider.getFarcasterUri();I.setAccountProp("farcasterUrl",E,c)}catch{d(new Error("Failed to connect to farcaster"))}}}else{const p=V.getAuthConnector();a=Q.returnOpenHref(`${B.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes");try{if(p){const{uri:g}=await p.provider.getSocialRedirectUri({provider:t});if(a&&g){a.location.href=g,i=a;const m=setInterval(()=>{i!=null&&i.closed&&!o&&(d(new Error("Popup closed")),clearInterval(m))},1e3);window.addEventListener("message",f,!1)}else a==null||a.close(),d(new Error("Failed to initiate social connection"))}}catch{d(new Error("Failed to initiate social connection")),a==null||a.close()}}}h()})},connectEmail({closeModalOnConnect:t=!0,redirectViewOnModalClose:e="Connect",onOpen:n,onConnect:r}){return new Promise((s,i)=>{if(n==null||n(),e){const a=Pe.subscribeKey("open",c=>{c||(me.state.view!==e&&me.replace(e),a(),i(new Error("Modal closed")))})}const o=I.subscribeKey("activeCaipAddress",a=>{a&&(r==null||r(),t&&Pe.close(),o(),s(It.parseCaipAddress(a)))})})},async updateEmail(){const t=W.getConnectedConnectorId(I.state.activeChain),e=V.getAuthConnector();if(!e)throw new Error("No auth connector found");if(t!==B.CONNECTOR_ID.AUTH)throw new Error("Not connected to email or social");const n=e.provider.getEmail()??"";return await Pe.open({view:"UpdateEmailWallet",data:{email:n,redirectView:void 0}}),new Promise((r,s)=>{const i=setInterval(()=>{const a=e.provider.getEmail()??"";a!==n&&(Pe.close(),clearInterval(i),o(),r({email:a}))},O8),o=Pe.subscribeKey("open",a=>{a||(me.state.view!=="Connect"&&me.push("Connect"),clearInterval(i),o(),s(new Error("Modal closed")))})})},canSwitchToSmartAccount(t){return I.checkIfSmartAccountEnabled()&&an(t)===ft.ACCOUNT_TYPES.EOA}};function dC(){var r,s;const t=((r=I.state.activeCaipNetwork)==null?void 0:r.chainNamespace)||"eip155",e=((s=I.state.activeCaipNetwork)==null?void 0:s.id)||1,n=Oe.NATIVE_TOKEN_ADDRESS[t];return`${t}:${e}:${n}`}function an(t){var n;return(n=I.getAccountData(t))==null?void 0:n.preferredAccountType}function Cs(t){var e,n;return t?(n=(e=I.state.chains.get(t))==null?void 0:e.networkState)==null?void 0:n.caipNetwork:I.state.activeCaipNetwork}const bd={getConnectionStatus(t,e){const n=V.state.activeConnectorIds[e],r=Z.getConnections(e);return!!n&&t.connectorId===n?"connected":r.some(o=>o.connectorId.toLowerCase()===t.connectorId.toLowerCase())?"active":"disconnected"},excludeConnectorAddressFromConnections({connections:t,connectorId:e,addresses:n}){return t.map(r=>{if((e?r.connectorId.toLowerCase()===e.toLowerCase():!1)&&n){const i=r.accounts.filter(o=>!n.some(c=>c.toLowerCase()===o.address.toLowerCase()));return{...r,accounts:i}}return r})},excludeExistingConnections(t,e){const n=new Set(t);return e.filter(r=>!n.has(r.connectorId))},getConnectionsByConnectorId(t,e){return t.filter(n=>n.connectorId.toLowerCase()===e.toLowerCase())},getConnectionsData(t){var a;const e=!!((a=F.state.remoteFeatures)!=null&&a.multiWallet),n=V.state.activeConnectorIds[t],r=Z.getConnections(t),i=(Z.state.recentConnections.get(t)??[]).filter(c=>V.getConnectorById(c.connectorId)),o=bd.excludeExistingConnections([...r.map(c=>c.connectorId),...n?[n]:[]],i);return e?{connections:r,recentConnections:o}:{connections:r.filter(c=>c.connectorId.toLowerCase()===(n==null?void 0:n.toLowerCase())),recentConnections:[]}},onConnectMobile(t){const e=Z.state.wcUri;if(t!=null&&t.mobile_link&&e)try{Z.setWcError(!1);const{mobile_link:n,link_mode:r,name:s}=t,{redirect:i,redirectUniversalLink:o,href:a}=Q.formatNativeUrl(n,e,r),c=i,l=o,u=Q.isIframe()?"_top":"_self";Z.setWcLinking({name:s,href:a}),Z.setRecentWallet(t),F.state.experimental_preferUniversalLinks&&l?Q.openHref(l,u):Q.openHref(c,u)}catch(n){ve.sendEvent({type:"track",event:"CONNECT_PROXY_ERROR",properties:{message:n instanceof Error?n.message:"Error parsing the deep link",uri:e,mobile_link:t.mobile_link,name:t.name}}),Z.setWcError(!0)}}},Bo=Qe({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1,connectingWallet:void 0}),Wn={state:Bo,subscribe(t){return Ft(Bo,()=>t(Bo))},subscribeOpen(t){return Dt(Bo,"open",t)},set(t){Object.assign(Bo,{...Bo,...t})}},tt=Qe({transactions:[],transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),R8={state:tt,subscribe(t){return Ft(tt,()=>t(tt))},setLastNetworkInView(t){tt.lastNetworkInView=t},async fetchTransactions(t){var e;if(!t)throw new Error("Transactions can't be fetched without an accountAddress");tt.loading=!0;try{const n=await be.fetchTransactions({account:t,cursor:tt.next,chainId:(e=I.state.activeCaipNetwork)==null?void 0:e.caipNetworkId}),r=Lu.filterSpamTransactions(n.data),s=Lu.filterByConnectedChain(r),i=[...tt.transactions,...s];tt.loading=!1,tt.transactions=i,tt.transactionsByYear=Lu.groupTransactionsByYearAndMonth(tt.transactionsByYear,s),tt.empty=i.length===0,tt.next=n.next?n.next:void 0}catch{const r=I.state.activeChain;ve.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:t,projectId:F.state.projectId,cursor:tt.next,isSmartAccount:an(r)===ft.ACCOUNT_TYPES.SMART_ACCOUNT}}),Hr.showError("Failed to fetch transactions"),tt.loading=!1,tt.empty=!0,tt.next=void 0}},groupTransactionsByYearAndMonth(t={},e=[]){const n=t;return e.forEach(r=>{const s=new Date(r.metadata.minedAt).getFullYear(),i=new Date(r.metadata.minedAt).getMonth(),o=n[s]??{},c=(o[i]??[]).filter(l=>l.id!==r.id);n[s]={...o,[i]:[...c,r].sort((l,u)=>new Date(u.metadata.minedAt).getTime()-new Date(l.metadata.minedAt).getTime())}}),n},filterSpamTransactions(t){return t.filter(e=>{var r;return!((r=e.transfers)==null?void 0:r.every(s=>{var i;return((i=s.nft_info)==null?void 0:i.flags.is_spam)===!0}))})},filterByConnectedChain(t){var r;const e=(r=I.state.activeCaipNetwork)==null?void 0:r.caipNetworkId;return t.filter(s=>s.metadata.chain===e)},clearCursor(){tt.next=void 0},resetTransactions(){tt.transactions=[],tt.transactionsByYear={},tt.lastNetworkInView=void 0,tt.loading=!1,tt.empty=!1,tt.next=void 0}},Lu=ar(R8,"API_ERROR"),Te=Qe({connections:new Map,recentConnections:new Map,isSwitchingConnection:!1,wcError:!1,wcFetchingUri:!1,buffering:!1,status:"disconnected"});let $i;const P8={state:Te,subscribe(t){return Ft(Te,()=>t(Te))},subscribeKey(t,e){return Dt(Te,t,e)},_getClient(){return Te._client},setClient(t){Te._client=Sc(t)},initialize(t){const e=t.filter(n=>!!n.namespace).map(n=>n.namespace);Z.syncStorageConnections(e)},syncStorageConnections(t){const e=W.getConnections(),n=t??Array.from(I.state.chains.keys());for(const r of n){const s=e[r]??[],i=new Map(Te.recentConnections);i.set(r,s),Te.recentConnections=i}},getConnections(t){return t?Te.connections.get(t)??[]:[]},hasAnyConnection(t){const e=Z.state.connections;return Array.from(e.values()).flatMap(n=>n).some(({connectorId:n})=>n===t)},async connectWalletConnect({cache:t="auto"}={}){var n,r,s,i;Te.wcFetchingUri=!0;const e=Q.isTelegram()||Q.isSafari()&&Q.isIos();if(t==="always"||t==="auto"&&e){if($i){await $i,$i=void 0;return}if(!Q.isPairingExpired(Te==null?void 0:Te.wcPairingExpiry)){const o=Te.wcUri;Te.wcUri=o;return}$i=(r=(n=Z._getClient())==null?void 0:n.connectWalletConnect)==null?void 0:r.call(n).catch(()=>{}),Z.state.status="connecting",await $i,$i=void 0,Te.wcPairingExpiry=void 0,Z.state.status="connected"}else await((i=(s=Z._getClient())==null?void 0:s.connectWalletConnect)==null?void 0:i.call(s))},async connectExternal(t,e,n=!0){var o,a,c;const r=await((a=(o=Z._getClient())==null?void 0:o.connectExternal)==null?void 0:a.call(o,t));n&&I.setActiveNamespace(e);const s=V.state.allConnectors.find(l=>l.id===(t==null?void 0:t.id)),i=t.type==="AUTH"?"email":"browser";return ve.sendEvent({type:"track",event:"CONNECT_SUCCESS",properties:{method:i,name:(s==null?void 0:s.name)||"Unknown",view:me.state.view,walletRank:(c=s==null?void 0:s.explorerWallet)==null?void 0:c.order}}),r},async reconnectExternal(t){var n,r;await((r=(n=Z._getClient())==null?void 0:n.reconnectExternal)==null?void 0:r.call(n,t));const e=t.chain||I.state.activeChain;e&&V.setConnectorId(t.id,e)},async setPreferredAccountType(t,e){var r;if(!e)return;Pe.setLoading(!0,I.state.activeChain);const n=V.getAuthConnector();n&&(I.setAccountProp("preferredAccountType",t,e),await n.provider.setPreferredAccount(t),W.setPreferredAccountTypes(Object.entries(I.state.chains).reduce((s,[i,o])=>{const a=i,c=an(a);return c!==void 0&&(s[a]=c),s},{})),await Z.reconnectExternal(n),Pe.setLoading(!1,I.state.activeChain),ve.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:t,network:((r=I.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)||""}}))},async signMessage(t){var e;return(e=Z._getClient())==null?void 0:e.signMessage(t)},parseUnits(t,e){var n;return(n=Z._getClient())==null?void 0:n.parseUnits(t,e)},formatUnits(t,e){var n;return(n=Z._getClient())==null?void 0:n.formatUnits(t,e)},updateBalance(t){var e;return(e=Z._getClient())==null?void 0:e.updateBalance(t)},async sendTransaction(t){var e;return(e=Z._getClient())==null?void 0:e.sendTransaction(t)},async getCapabilities(t){var e;return(e=Z._getClient())==null?void 0:e.getCapabilities(t)},async grantPermissions(t){var e;return(e=Z._getClient())==null?void 0:e.grantPermissions(t)},async walletGetAssets(t){var e;return((e=Z._getClient())==null?void 0:e.walletGetAssets(t))??{}},async estimateGas(t){var e;return(e=Z._getClient())==null?void 0:e.estimateGas(t)},async writeContract(t){var e;return(e=Z._getClient())==null?void 0:e.writeContract(t)},async getEnsAddress(t){var e;return(e=Z._getClient())==null?void 0:e.getEnsAddress(t)},async getEnsAvatar(t){var e;return(e=Z._getClient())==null?void 0:e.getEnsAvatar(t)},checkInstalled(t){var e,n;return((n=(e=Z._getClient())==null?void 0:e.checkInstalled)==null?void 0:n.call(e,t))||!1},resetWcConnection(){Te.wcUri=void 0,Te.wcPairingExpiry=void 0,Te.wcLinking=void 0,Te.recentWallet=void 0,Te.wcFetchingUri=!1,Te.status="disconnected",Lu.resetTransactions(),W.deleteWalletConnectDeepLink(),W.deleteRecentWallet(),Wn.set({connectingWallet:void 0})},resetUri(){Te.wcUri=void 0,Te.wcPairingExpiry=void 0,$i=void 0,Te.wcFetchingUri=!1,Wn.set({connectingWallet:void 0})},finalizeWcConnection(t){var r,s;const{wcLinking:e,recentWallet:n}=Z.state;e&&W.setWalletConnectDeepLink(e),n&&W.setAppKitRecent(n),t&&ve.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:t,properties:{method:e?"mobile":"qrcode",name:((s=(r=me.state.data)==null?void 0:r.wallet)==null?void 0:s.name)||"Unknown",view:me.state.view,walletRank:n==null?void 0:n.order}})},setWcBasic(t){Te.wcBasic=t},setUri(t){Te.wcUri=t,Te.wcFetchingUri=!1,Te.wcPairingExpiry=Q.getPairingExpiry()},setWcLinking(t){Te.wcLinking=t},setWcError(t){Te.wcError=t,Te.wcFetchingUri=!1,Te.buffering=!1},setRecentWallet(t){Te.recentWallet=t},setBuffering(t){Te.buffering=t},setStatus(t){Te.status=t},setIsSwitchingConnection(t){Te.isSwitchingConnection=t},async disconnect({id:t,namespace:e,initialDisconnect:n}={}){var r;try{await((r=Z._getClient())==null?void 0:r.disconnect({id:t,chainNamespace:e,initialDisconnect:n}))}catch(s){throw new wo("Failed to disconnect","INTERNAL_SDK_ERROR",s)}},async disconnectConnector({id:t,namespace:e}){var n;try{await((n=Z._getClient())==null?void 0:n.disconnectConnector({id:t,namespace:e}))}catch(r){throw new wo("Failed to disconnect connector","INTERNAL_SDK_ERROR",r)}},setConnections(t,e){const n=new Map(Te.connections);n.set(e,t),Te.connections=n},async handleAuthAccountSwitch({address:t,namespace:e}){var i,o;const n=I.getAccountData(e),r=(o=(i=n==null?void 0:n.user)==null?void 0:i.accounts)==null?void 0:o.find(a=>a.type==="smartAccount"),s=r&&r.address.toLowerCase()===t.toLowerCase()&&ja.canSwitchToSmartAccount(e)?"smartAccount":"eoa";await Z.setPreferredAccountType(s,e)},async handleActiveConnection({connection:t,namespace:e,address:n}){const r=V.getConnectorById(t.connectorId),s=t.connectorId===B.CONNECTOR_ID.AUTH;if(!r)throw new Error(`No connector found for connection: ${t.connectorId}`);if(s)n&&await Z.handleAuthAccountSwitch({address:n,namespace:e});else{const i=await Z.connectExternal({id:r.id,type:r.type,provider:r.provider,address:n,chain:e},e);return i==null?void 0:i.address}return n},async handleDisconnectedConnection({connection:t,namespace:e,address:n,closeModalOnConnect:r}){var l,u;const s=V.getConnectorById(t.connectorId),i=(u=(l=t.auth)==null?void 0:l.name)==null?void 0:u.toLowerCase(),o=t.connectorId===B.CONNECTOR_ID.AUTH,a=t.connectorId===B.CONNECTOR_ID.WALLET_CONNECT;if(!s)throw new Error(`No connector found for connection: ${t.connectorId}`);let c;if(o)if(i&&ja.isSocialProvider(i)){const{address:d}=await ja.connectSocial({social:i,closeModalOnConnect:r,onOpenFarcaster(){Pe.open({view:"ConnectingFarcaster"})},onConnect(){me.replace("ProfileWallets")}});c=d}else{const{address:d}=await ja.connectEmail({closeModalOnConnect:r,onOpen(){Pe.open({view:"EmailLogin"})},onConnect(){me.replace("ProfileWallets")}});c=d}else if(a){const{address:d}=await ja.connectWalletConnect({walletConnect:!0,connector:s,closeModalOnConnect:r,onOpen(f){const h=f?"AllWallets":"ConnectingWalletConnect";Pe.state.open?me.push(h):Pe.open({view:h})},onConnect(){me.replace("ProfileWallets")}});c=d}else{const d=await Z.connectExternal({id:s.id,type:s.type,provider:s.provider,chain:e},e);d&&(c=d.address)}return o&&n&&await Z.handleAuthAccountSwitch({address:n,namespace:e}),c},async switchConnection({connection:t,address:e,namespace:n,closeModalOnConnect:r,onChange:s}){var c;let i;const o=(c=I.getAccountData(n))==null?void 0:c.caipAddress;if(o){const{address:l}=It.parseCaipAddress(o);i=l}const a=bd.getConnectionStatus(t,n);switch(a){case"connected":case"active":{const l=await Z.handleActiveConnection({connection:t,namespace:n,address:e});if(i&&l){const u=l.toLowerCase()!==i.toLowerCase();s==null||s({address:l,namespace:n,hasSwitchedAccount:u,hasSwitchedWallet:a==="active"})}break}case"disconnected":{const l=await Z.handleDisconnectedConnection({connection:t,namespace:n,address:e,closeModalOnConnect:r});l&&(s==null||s({address:l,namespace:n,hasSwitchedAccount:!0,hasSwitchedWallet:!0}));break}default:throw new Error(`Invalid connection status: ${a}`)}}},Z=ar(P8),Qf={createBalance(t,e){const n={name:t.metadata.name||"",symbol:t.metadata.symbol||"",decimals:t.metadata.decimals||0,value:t.metadata.value||0,price:t.metadata.price||0,iconUrl:t.metadata.iconUrl||""};return{name:n.name,symbol:n.symbol,chainId:e,address:t.address==="native"?void 0:this.convertAddressToCAIP10Address(t.address,e),value:n.value,price:n.price,quantity:{decimals:n.decimals.toString(),numeric:this.convertHexToBalance({hex:t.balance,decimals:n.decimals})},iconUrl:n.iconUrl}},convertHexToBalance({hex:t,decimals:e}){return xl(BigInt(t),e)},convertAddressToCAIP10Address(t,e){return`${e}:${t}`},createCAIP2ChainId(t,e){return`${e}:${parseInt(t,16)}`},getChainIdHexFromCAIP2ChainId(t){const e=t.split(":");if(e.length<2||!e[1])return"0x0";const n=e[1],r=parseInt(n,10);return isNaN(r)?"0x0":`0x${r.toString(16)}`},isWalletGetAssetsResponse(t){return typeof t!="object"||t===null?!1:Object.values(t).every(e=>Array.isArray(e)&&e.every(n=>this.isValidAsset(n)))},isValidAsset(t){return typeof t=="object"&&t!==null&&typeof t.address=="string"&&typeof t.balance=="string"&&(t.type==="ERC20"||t.type==="NATIVE")&&typeof t.metadata=="object"&&t.metadata!==null&&typeof t.metadata.name=="string"&&typeof t.metadata.symbol=="string"&&typeof t.metadata.decimals=="number"&&typeof t.metadata.price=="number"&&typeof t.metadata.iconUrl=="string"}};let eh;async function _y(){if(!eh){const{createPublicClient:t,http:e,defineChain:n}=await _t(async()=>{const{createPublicClient:r,http:s,defineChain:i}=await import("./index-CrjlC3mJ.js");return{createPublicClient:r,http:s,defineChain:i}},__vite__mapDeps([2,3,1,4,5,0]));eh={createPublicClient:t,http:e,defineChain:n}}return eh}const Lp={getBlockchainApiRpcUrl(t,e){const n=new URL("https://rpc.walletconnect.org/v1/");return n.searchParams.set("chainId",t),n.searchParams.set("projectId",e),n.toString()},async getViemChain(t){const{defineChain:e}=await _y(),{chainId:n}=It.parseCaipNetworkId(t.caipNetworkId);return e({...t,id:Number(n)})},async createViemPublicClient(t){const{createPublicClient:e,http:n}=await _y(),r=F.state.projectId,s=await Lp.getViemChain(t);if(!s)throw new Error(`Chain ${t.caipNetworkId} not found in viem/chains`);return e({chain:s,transport:n(Lp.getBlockchainApiRpcUrl(t.caipNetworkId,r))})}},yg={async getMyTokensWithBalance(t){var a;const e=(a=I.getAccountData())==null?void 0:a.address,n=I.state.activeCaipNetwork,r=V.getConnectorId("eip155")===B.CONNECTOR_ID.AUTH;if(!e||!n)return[];const s=`${n.caipNetworkId}:${e}`,i=W.getBalanceCacheForCaipAddress(s);if(i)return i.balances;if(n.chainNamespace===B.CHAIN.EVM&&r){const c=await this.getEIP155Balances(e,n);if(c)return this.filterLowQualityTokens(c)}const o=await be.getBalance(e,n.caipNetworkId,t);return this.filterLowQualityTokens(o.balances)},async getEIP155Balances(t,e){var n,r;try{const s=Qf.getChainIdHexFromCAIP2ChainId(e.caipNetworkId),i=await Z.getCapabilities(t);if(!((r=(n=i==null?void 0:i[s])==null?void 0:n.assetDiscovery)!=null&&r.supported))return null;const o=await Z.walletGetAssets({account:t,chainFilter:[s]});if(!Qf.isWalletGetAssetsResponse(o))return null;const c=(o[s]||[]).map(l=>Qf.createBalance(l,e.caipNetworkId));return W.updateBalanceCache({caipAddress:`${e.caipNetworkId}:${t}`,balance:{balances:c},timestamp:Date.now()}),c}catch{return null}},filterLowQualityTokens(t){return t.filter(e=>e.quantity.decimals!=="0")},async fetchERC20Balance({caipAddress:t,assetAddress:e,caipNetwork:n}){const r=await Lp.createViemPublicClient(n),{address:s}=It.parseCaipAddress(t),[{result:i},{result:o},{result:a},{result:c}]=await r.multicall({contracts:[{address:e,functionName:"name",args:[],abi:tu},{address:e,functionName:"symbol",args:[],abi:tu},{address:e,functionName:"balanceOf",args:[s],abi:tu},{address:e,functionName:"decimals",args:[],abi:tu}]});return{name:i,symbol:o,decimals:c,balance:a&&c?xl(a,c):"0"}}},th={adapters:{}},fC={state:th,initialize(t){th.adapters={...t}},get(t){return th.adapters[t]}},wd={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0,sui:void 0,stacks:void 0,ton:void 0},pn=Qe({providers:{...wd},providerIds:{...wd}}),Ye={state:pn,subscribeKey(t,e){return Dt(pn,t,e)},subscribe(t){return Ft(pn,()=>{t(pn)})},subscribeProviders(t){return Ft(pn.providers,()=>t(pn.providers))},setProvider(t,e){t&&e&&(pn.providers[t]=Sc(e))},getProvider(t){if(t)return pn.providers[t]},setProviderId(t,e){e&&(pn.providerIds[t]=e)},getProviderId(t){if(t)return pn.providerIds[t]},reset(){pn.providers={...wd},pn.providerIds={...wd}},resetChain(t){pn.providers[t]=void 0,pn.providerIds[t]=void 0}},k8={async getTokenList(t){var r;const e=await be.fetchSwapTokens({chainId:t});return((r=e==null?void 0:e.tokens)==null?void 0:r.map(s=>({...s,eip2612:!1,quantity:{decimals:"0",numeric:"0"},price:0,value:0})))||[]},async fetchGasPrice(){var e;const t=I.state.activeCaipNetwork;if(!t)return null;try{switch(t.chainNamespace){case"solana":const n=(e=await(Z==null?void 0:Z.estimateGas({chainNamespace:"solana"})))==null?void 0:e.toString();return{standard:n,fast:n,instant:n};case"eip155":default:return await be.fetchGasPrice({chainId:t.caipNetworkId})}}catch{return null}},async fetchSwapAllowance({tokenAddress:t,userAddress:e,sourceTokenAmount:n,sourceTokenDecimals:r}){const s=await be.fetchSwapAllowance({tokenAddress:t,userAddress:e});if(s!=null&&s.allowance&&n&&r){const i=Z.parseUnits(n,r)||0;return BigInt(s.allowance)>=i}return!1},async getMyTokensWithBalance(t){const e=await yg.getMyTokensWithBalance(t);return I.setAccountProp("tokenBalance",e,I.state.activeChain),this.mapBalancesToSwapTokens(e)},mapBalancesToSwapTokens(t){return(t==null?void 0:t.map(e=>({...e,address:e!=null&&e.address?e.address:dC(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1})))||[]},async handleSwapError(t){var e,n;try{const r=t==null?void 0:t.cause;if(!(r!=null&&r.json))return;const s=await r.json(),i=(n=(e=s==null?void 0:s.reasons)==null?void 0:e[0])==null?void 0:n.description;return i!=null&&i.includes("insufficient liquidity")?"Insufficient liquidity":void 0}catch{return}}},Ue=Qe({tokenBalances:[],loading:!1}),D8={state:Ue,subscribe(t){return Ft(Ue,()=>t(Ue))},subscribeKey(t,e){return Dt(Ue,t,e)},setToken(t){t&&(Ue.token=Sc(t))},setTokenAmount(t){Ue.sendTokenAmount=t},setReceiverAddress(t){Ue.receiverAddress=t},setReceiverProfileImageUrl(t){Ue.receiverProfileImageUrl=t},setReceiverProfileName(t){Ue.receiverProfileName=t},setNetworkBalanceInUsd(t){Ue.networkBalanceInUSD=t},setLoading(t){Ue.loading=t},getSdkEventProperties(t){var e,n;return{message:Q.parseError(t),isSmartAccount:an(I.state.activeChain)===ft.ACCOUNT_TYPES.SMART_ACCOUNT,token:((e=Ue.token)==null?void 0:e.symbol)||"",amount:Ue.sendTokenAmount??0,network:((n=I.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)||""}},async sendToken(){var t;try{switch(Se.setLoading(!0),(t=I.state.activeCaipNetwork)==null?void 0:t.chainNamespace){case"eip155":await Se.sendEvmToken();return;case"solana":await Se.sendSolanaToken();return;default:throw new Error("Unsupported chain")}}catch(e){throw br.isUserRejectedRequestError(e)?new Zo(e):e}finally{Se.setLoading(!1)}},async sendEvmToken(){var n,r,s;const t=I.state.activeChain;if(!t)throw new Error("SendController:sendEvmToken - activeChainNamespace is required");const e=an(t);if(!Se.state.sendTokenAmount||!Se.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!Se.state.token)throw new Error("A token is required");if((n=Se.state.token)!=null&&n.address){ve.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===ft.ACCOUNT_TYPES.SMART_ACCOUNT,token:Se.state.token.address,amount:Se.state.sendTokenAmount,network:((r=I.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)||""}});const{hash:i}=await Se.sendERC20Token({receiverAddress:Se.state.receiverAddress,tokenAddress:Se.state.token.address,sendTokenAmount:Se.state.sendTokenAmount,decimals:Se.state.token.quantity.decimals});i&&(Ue.hash=i)}else{ve.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===ft.ACCOUNT_TYPES.SMART_ACCOUNT,token:Se.state.token.symbol||"",amount:Se.state.sendTokenAmount,network:((s=I.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)||""}});const{hash:i}=await Se.sendNativeToken({receiverAddress:Se.state.receiverAddress,sendTokenAmount:Se.state.sendTokenAmount,decimals:Se.state.token.quantity.decimals});i&&(Ue.hash=i)}},async fetchTokenBalance(t){var o,a,c;Ue.loading=!0;const e=I.state.activeChain,n=(o=I.state.activeCaipNetwork)==null?void 0:o.caipNetworkId,r=(a=I.state.activeCaipNetwork)==null?void 0:a.chainNamespace,s=((c=I.getAccountData(e))==null?void 0:c.caipAddress)??I.state.activeCaipAddress,i=s?Q.getPlainAddress(s):void 0;if(Ue.lastRetry&&!Q.isAllowedRetry(Ue.lastRetry,30*Oe.ONE_SEC_MS))return Ue.loading=!1,[];try{if(i&&n&&r){const l=await yg.getMyTokensWithBalance();return Ue.tokenBalances=l,Ue.lastRetry=void 0,l}}catch(l){Ue.lastRetry=Date.now(),t==null||t(l),Hr.showError("Token Balance Unavailable")}finally{Ue.loading=!1}return[]},fetchNetworkBalance(){if(Ue.tokenBalances.length===0)return;const t=k8.mapBalancesToSwapTokens(Ue.tokenBalances);if(!t)return;const e=t.find(n=>n.address===dC());e&&(Ue.networkBalanceInUSD=e?KI.multiply(e.quantity.numeric,e.price).toString():"0")},async sendNativeToken(t){var o,a,c,l;me.pushTransactionStack({});const e=t.receiverAddress,n=(o=I.getAccountData())==null?void 0:o.address,r=Z.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals)),i=await Z.sendTransaction({chainNamespace:B.CHAIN.EVM,to:e,address:n,data:"0x",value:r??BigInt(0)});return ve.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:an("eip155")===ft.ACCOUNT_TYPES.SMART_ACCOUNT,token:((a=Se.state.token)==null?void 0:a.symbol)||"",amount:t.sendTokenAmount,network:((c=I.state.activeCaipNetwork)==null?void 0:c.caipNetworkId)||"",hash:i||""}}),(l=Z._getClient())==null||l.updateBalance("eip155"),Se.resetSend(),{hash:i}},async sendERC20Token(t){var r,s,i;me.pushTransactionStack({onSuccess(){me.replace("Account")}});const e=Z.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals)),n=(r=I.getAccountData())==null?void 0:r.address;if(n&&t.sendTokenAmount&&t.receiverAddress&&t.tokenAddress){const o=Q.getPlainAddress(t.tokenAddress);if(!o)throw new Error("SendController:sendERC20Token - tokenAddress is required");const a=await Z.writeContract({fromAddress:n,tokenAddress:o,args:[t.receiverAddress,e??BigInt(0)],method:"transfer",abi:JI.getERC20Abi(o),chainNamespace:B.CHAIN.EVM});return ve.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:an("eip155")===ft.ACCOUNT_TYPES.SMART_ACCOUNT,token:((s=Se.state.token)==null?void 0:s.symbol)||"",amount:t.sendTokenAmount,network:((i=I.state.activeCaipNetwork)==null?void 0:i.caipNetworkId)||"",hash:a||""}}),Se.resetSend(),{hash:a}}return{hash:void 0}},async sendSolanaToken(){var n,r,s;if(!Se.state.sendTokenAmount||!Se.state.receiverAddress)throw new Error("An amount and receiver address are required");me.pushTransactionStack({onSuccess(){me.replace("Account")}});let t;Se.state.token&&Se.state.token.address!==Oe.SOLANA_NATIVE_TOKEN_ADDRESS&&(Q.isCaipAddress(Se.state.token.address)?t=Q.getPlainAddress(Se.state.token.address):t=Se.state.token.address);const e=await Z.sendTransaction({chainNamespace:"solana",tokenMint:t,to:Se.state.receiverAddress,value:Se.state.sendTokenAmount});e&&(Ue.hash=e),(n=Z._getClient())==null||n.updateBalance("solana"),ve.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:!1,token:((r=Se.state.token)==null?void 0:r.symbol)||"",amount:Se.state.sendTokenAmount,network:((s=I.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)||"",hash:e||""}}),Se.resetSend()},resetSend(){Ue.token=void 0,Ue.sendTokenAmount=void 0,Ue.receiverAddress=void 0,Ue.receiverProfileImageUrl=void 0,Ue.receiverProfileName=void 0,Ue.loading=!1,Ue.tokenBalances=[]}},Se=ar(D8),nh={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,user:void 0,preferredAccountType:void 0},ou={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},te=Qe({chains:BI(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{connectionControllerClient:void 0},isSwitchingNamespace:!1}),hC={state:te,subscribe(t){return Ft(te,()=>{t(te)})},subscribeKey(t,e){return Dt(te,t,e)},subscribeAccountStateProp(t,e,n){var s;const r=n||te.activeChain;return r?Dt(((s=te.chains.get(r))==null?void 0:s.accountState)||{},t,e):()=>{}},subscribeChainProp(t,e,n){let r;return Ft(te.chains,()=>{var i;const s=n||te.activeChain;if(s){const o=(i=te.chains.get(s))==null?void 0:i[t];r!==o&&(r=o,e(o))}})},initialize(t,e,n){const{chainId:r,namespace:s}=W.getActiveNetworkProps(),i=e==null?void 0:e.find(u=>u.id.toString()===(r==null?void 0:r.toString())),a=t.find(u=>(u==null?void 0:u.namespace)===s)||(t==null?void 0:t[0]),c=t.map(u=>u.namespace).filter(u=>u!==void 0),l=F.state.enableEmbedded?new Set([...c]):new Set([...(e==null?void 0:e.map(u=>u.chainNamespace))??[]]);((t==null?void 0:t.length)===0||!a)&&(te.noAdapters=!0),te.noAdapters||(te.activeChain=a==null?void 0:a.namespace,te.activeCaipNetwork=i,I.setChainNetworkData(a==null?void 0:a.namespace,{caipNetwork:i}),te.activeChain&&Wn.set({activeChain:a==null?void 0:a.namespace})),l.forEach(u=>{const d=e==null?void 0:e.filter(p=>p.chainNamespace===u),f=W.getPreferredAccountTypes()||{},h={...F.state.defaultAccountTypes,...f};I.state.chains.set(u,{namespace:u,networkState:Qe({...ou,caipNetwork:d==null?void 0:d[0]}),accountState:Qe({...nh,preferredAccountType:h[u]}),caipNetworks:d??[],...n}),I.setRequestedCaipNetworks(d??[],u)})},removeAdapter(t){var e,n;if(te.activeChain===t){const r=Array.from(te.chains.entries()).find(([s])=>s!==t);if(r){const s=(n=(e=r[1])==null?void 0:e.caipNetworks)==null?void 0:n[0];s&&I.setActiveCaipNetwork(s)}}te.chains.delete(t)},addAdapter(t,{connectionControllerClient:e},n){if(!t.namespace)throw new Error("ChainController:addAdapter - adapter must have a namespace");te.chains.set(t.namespace,{namespace:t.namespace,networkState:{...ou,caipNetwork:n[0]},accountState:{...nh},caipNetworks:n,connectionControllerClient:e}),I.setRequestedCaipNetworks((n==null?void 0:n.filter(r=>r.chainNamespace===t.namespace))??[],t.namespace)},addNetwork(t){var n;const e=te.chains.get(t.chainNamespace);if(e){const r=[...e.caipNetworks||[]];(n=e.caipNetworks)!=null&&n.find(s=>s.id===t.id)||r.push(t),te.chains.set(t.chainNamespace,{...e,caipNetworks:r}),I.setRequestedCaipNetworks(r,t.chainNamespace),V.filterByNamespace(t.chainNamespace,!0)}},removeNetwork(t,e){var r,s,i;const n=te.chains.get(t);if(n){const o=((r=te.activeCaipNetwork)==null?void 0:r.id)===e,a=[...((s=n.caipNetworks)==null?void 0:s.filter(c=>c.id!==e))||[]];o&&((i=n==null?void 0:n.caipNetworks)!=null&&i[0])&&I.setActiveCaipNetwork(n.caipNetworks[0]),te.chains.set(t,{...n,caipNetworks:a}),I.setRequestedCaipNetworks(a||[],t),a.length===0&&V.filterByNamespace(t,!1)}},setAdapterNetworkState(t,e){const n=te.chains.get(t);n&&(n.networkState={...n.networkState||ou,...e},te.chains.set(t,n))},setChainAccountData(t,e,n=!0){if(!t)throw new Error("Chain is required to update chain account data");const r=te.chains.get(t);if(r){const s={...r.accountState||nh,...e};te.chains.set(t,{...r,accountState:s}),(te.chains.size===1||te.activeChain===t)&&e.caipAddress&&(te.activeCaipAddress=e.caipAddress)}},setChainNetworkData(t,e){if(!t)return;const n=te.chains.get(t);if(n){const r={...n.networkState||ou,...e};te.chains.set(t,{...n,networkState:r})}},setAccountProp(t,e,n,r=!0){I.setChainAccountData(n,{[t]:e},r)},setActiveNamespace(t){var r,s;te.activeChain=t;const e=t?te.chains.get(t):void 0,n=(r=e==null?void 0:e.networkState)==null?void 0:r.caipNetwork;n!=null&&n.id&&t&&(te.activeCaipAddress=(s=e==null?void 0:e.accountState)==null?void 0:s.caipAddress,te.activeCaipNetwork=n,I.setChainNetworkData(t,{caipNetwork:n}),W.setActiveCaipNetworkId(n==null?void 0:n.caipNetworkId),Wn.set({activeChain:t,selectedNetworkId:n==null?void 0:n.caipNetworkId}))},setActiveCaipNetwork(t){var i,o;if(!t)return;const e=te.activeChain===t.chainNamespace;e||I.setIsSwitchingNamespace(!0);const n=te.chains.get(t.chainNamespace);te.activeChain=t.chainNamespace,te.activeCaipNetwork=t,I.setChainNetworkData(t.chainNamespace,{caipNetwork:t});let r=(i=n==null?void 0:n.accountState)==null?void 0:i.address;if(r)te.activeCaipAddress=`${t.chainNamespace}:${t.id}:${r}`;else if(e&&te.activeCaipAddress){const{address:a}=It.parseCaipAddress(te.activeCaipAddress);r=a,te.activeCaipAddress=`${t.caipNetworkId}:${r}`}else te.activeCaipAddress=void 0;I.setChainAccountData(t.chainNamespace,{address:r,caipAddress:te.activeCaipAddress}),Se.resetSend(),Wn.set({activeChain:te.activeChain,selectedNetworkId:(o=te.activeCaipNetwork)==null?void 0:o.caipNetworkId}),W.setActiveCaipNetworkId(t.caipNetworkId),!I.checkIfSupportedNetwork(t.chainNamespace)&&F.state.enableNetworkSwitch&&!F.state.allowUnsupportedChain&&!Z.state.wcBasic&&I.showUnsupportedChainUI()},addCaipNetwork(t){var n;if(!t)return;const e=te.chains.get(t.chainNamespace);e&&((n=e==null?void 0:e.caipNetworks)==null||n.push(t))},async switchActiveNamespace(t){var s;if(!t)return;const e=t!==I.state.activeChain,n=(s=I.getNetworkData(t))==null?void 0:s.caipNetwork,r=I.getCaipNetworkByNamespace(t,n==null?void 0:n.id);e&&r&&await I.switchActiveNetwork(r)},async switchActiveNetwork(t,{throwOnFailure:e=!1}={}){var o;const n=I.state.activeChain;if(!n)throw new Error("ChainController:switchActiveNetwork - namespace is required");const r=Ye.getProviderId(te.activeChain)==="AUTH",s=(o=I.getAccountData(n))==null?void 0:o.address,i=B.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(t.chainNamespace);try{if(s&&t.chainNamespace===n||r&&i){const a=fC.get(t.chainNamespace);if(!a)throw new Error("Adapter not found");await a.switchNetwork({caipNetwork:t})}I.setActiveCaipNetwork(t)}catch(a){if(e)throw a}ve.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:t.caipNetworkId}})},getConnectionControllerClient(t){const e=t||te.activeChain;if(!e)throw new Error("Chain is required to get connection controller client");const n=te.chains.get(e);if(!(n!=null&&n.connectionControllerClient))throw new Error("ConnectionController client not set");return n.connectionControllerClient},getNetworkProp(t,e){var r;const n=(r=te.chains.get(e))==null?void 0:r.networkState;if(n)return n[t]},getRequestedCaipNetworks(t){const e=te.chains.get(t),{approvedCaipNetworkIds:n=[],requestedCaipNetworks:r=[]}=(e==null?void 0:e.networkState)||{};return Q.sortRequestedNetworks(n,r).filter(o=>o==null?void 0:o.id)},getAllRequestedCaipNetworks(){const t=[];return te.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllRequestedCaipNetworks - chainAdapter must have a namespace");const n=I.getRequestedCaipNetworks(e.namespace);t.push(...n)}),t},setRequestedCaipNetworks(t,e){I.setAdapterNetworkState(e,{requestedCaipNetworks:t});const r=I.getAllRequestedCaipNetworks().map(i=>i.chainNamespace),s=Array.from(new Set(r));V.filterByNamespaces(s)},getAllApprovedCaipNetworkIds(){const t=[];return te.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllApprovedCaipNetworkIds - chainAdapter must have a namespace");const n=I.getApprovedCaipNetworkIds(e.namespace);t.push(...n)}),t},getActiveCaipNetwork(t){var e,n;return t?(n=(e=te.chains.get(t))==null?void 0:e.networkState)==null?void 0:n.caipNetwork:te.activeCaipNetwork},getActiveCaipAddress(){return te.activeCaipAddress},getApprovedCaipNetworkIds(t){var r;const e=te.chains.get(t);return((r=e==null?void 0:e.networkState)==null?void 0:r.approvedCaipNetworkIds)||[]},setApprovedCaipNetworksData(t,e){I.setAdapterNetworkState(t,e)},checkIfSupportedNetwork(t,e){var s;const n=e||((s=te.activeCaipNetwork)==null?void 0:s.caipNetworkId),r=I.getRequestedCaipNetworks(t);return r.length?r==null?void 0:r.some(i=>i.caipNetworkId===n):!0},checkIfSupportedChainId(t){if(!te.activeChain)return!0;const e=I.getRequestedCaipNetworks(te.activeChain);return e==null?void 0:e.some(n=>n.id===t)},checkIfSmartAccountEnabled(){var r,s;const t=xc.caipNetworkIdToNumber((r=te.activeCaipNetwork)==null?void 0:r.caipNetworkId);if(!te.activeChain||!t)return!1;const n=((s=Ct.get(ue.SMART_ACCOUNT_ENABLED_NETWORKS))==null?void 0:s.split(","))||[];return!!(n!=null&&n.includes(t.toString()))},showUnsupportedChainUI(){Pe.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const t=te.activeCaipNetwork;return!!(t!=null&&t.chainNamespace&&Oe.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(t.chainNamespace))},resetNetwork(t){I.setAdapterNetworkState(t,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0})},resetAccount(t){var s,i;const e=t;if(!e)throw new Error("Chain is required to set account prop");const n=(i=(s=I.state.chains.get(e))==null?void 0:s.accountState)==null?void 0:i.preferredAccountType,r=F.state.defaultAccountTypes[e];te.activeCaipAddress=void 0,I.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountType:r||n,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,user:void 0,status:"disconnected"}),V.removeConnectorId(e)},setIsSwitchingNamespace(t){te.isSwitchingNamespace=t},getFirstCaipNetworkSupportsAuthConnector(){var n,r;const t=[];let e;if(te.chains.forEach(s=>{B.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(i=>i===s.namespace)&&s.namespace&&t.push(s.namespace)}),t.length>0){const s=t[0];return e=s?(r=(n=te.chains.get(s))==null?void 0:n.caipNetworks)==null?void 0:r[0]:void 0,e}},getAccountData(t){var n;const e=t||te.activeChain;if(e)return(n=I.state.chains.get(e))==null?void 0:n.accountState},getNetworkData(t){var n;const e=t||te.activeChain;if(e)return(n=I.state.chains.get(e))==null?void 0:n.networkState},getCaipNetworkByNamespace(t,e){var s,i,o;if(!t)return;const n=I.state.chains.get(t),r=(s=n==null?void 0:n.caipNetworks)==null?void 0:s.find(a=>a.id.toString()===(e==null?void 0:e.toString()));return r||((i=n==null?void 0:n.networkState)==null?void 0:i.caipNetwork)||((o=n==null?void 0:n.caipNetworks)==null?void 0:o[0])},getRequestedCaipNetworkIds(){const t=V.state.filterByNamespace;return(t?[te.chains.get(t)]:Array.from(te.chains.values())).flatMap(n=>(n==null?void 0:n.caipNetworks)||[]).map(n=>n.caipNetworkId)},getCaipNetworks(t){return t?I.getRequestedCaipNetworks(t):I.getAllRequestedCaipNetworks()},getCaipNetworkById(t,e){return hC.getCaipNetworks(e).find(n=>n.id.toString()===t.toString()||n.caipNetworkId.toString()===t.toString())},setLastConnectedSIWECaipNetwork(t){te.lastConnectedSIWECaipNetwork=t},getLastConnectedSIWECaipNetwork(){return te.lastConnectedSIWECaipNetwork},async fetchTokenBalance(t){var o,a;const e=I.getAccountData();if(!e)return[];const n=(o=I.state.activeCaipNetwork)==null?void 0:o.caipNetworkId,r=(a=I.state.activeCaipNetwork)==null?void 0:a.chainNamespace,s=I.state.activeCaipAddress,i=s?Q.getPlainAddress(s):void 0;if(I.setAccountProp("balanceLoading",!0,r),e.lastRetry&&!Q.isAllowedRetry(e.lastRetry,30*Oe.ONE_SEC_MS))return I.setAccountProp("balanceLoading",!1,r),[];try{if(i&&n&&r){const c=await yg.getMyTokensWithBalance();return I.setAccountProp("tokenBalance",c,r),I.setAccountProp("lastRetry",void 0,r),I.setAccountProp("balanceLoading",!1,r),c}}catch(c){I.setAccountProp("lastRetry",Date.now(),r),t==null||t(c),Hr.showError("Token Balance Unavailable")}finally{I.setAccountProp("balanceLoading",!1,r)}return[]},isCaipNetworkDisabled(t){var c;const e=t.chainNamespace,n=!!((c=I.getAccountData(e))!=null&&c.caipAddress),r=I.getAllApprovedCaipNetworkIds(),s=I.getNetworkProp("supportsAllNetworks",e)!==!1,i=V.getConnectorId(e),o=V.getAuthConnector(),a=i===B.CONNECTOR_ID.AUTH&&o;return!n||s||a?!1:!(r!=null&&r.includes(t.caipNetworkId))}},I=ar(hC),$8={onSwitchNetwork({network:t,ignoreSwitchConfirmation:e=!1}){var f,h;const n=I.state.activeCaipNetwork,r=I.state.activeChain,s=me.state.data;if(t.id===(n==null?void 0:n.id))return;const o=!!((f=I.getAccountData(r))!=null&&f.address),a=!!((h=I.getAccountData(t.chainNamespace))!=null&&h.address),c=t.chainNamespace!==r,u=V.getConnectorId(r)===B.CONNECTOR_ID.AUTH,d=B.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(p=>p===t.chainNamespace);e||u&&d?me.push("SwitchNetwork",{...s,network:t}):o&&c&&!a?me.push("SwitchActiveChain",{switchToChain:t.chainNamespace,navigateTo:"Connect",navigateWithReplace:!0,network:t}):me.push("SwitchNetwork",{...s,network:t})}},gn=Qe({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),U8={state:gn,subscribe(t){return Ft(gn,()=>t(gn))},subscribeKey(t,e){return Dt(gn,t,e)},async open(t){var o,a;const e=t==null?void 0:t.namespace,n=I.state.activeChain,r=e&&e!==n,s=(o=I.getAccountData(t==null?void 0:t.namespace))==null?void 0:o.caipAddress,i=I.state.noAdapters;if(Z.state.wcBasic?se.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1,fetchWalletRanks:!1}):await se.prefetch(),V.setFilterByNamespace(t==null?void 0:t.namespace),Pe.setLoading(!0,e),e&&r){const c=((a=I.getNetworkData(e))==null?void 0:a.caipNetwork)||I.getRequestedCaipNetworks(e)[0];c&&(i?(await I.switchActiveNetwork(c),me.push("ConnectingWalletConnectBasic")):$8.onSwitchNetwork({network:c,ignoreSwitchConfirmation:!0}))}else F.state.manualWCControl||i&&!s?Q.isMobile()?me.reset("AllWallets"):me.reset("ConnectingWalletConnectBasic"):t!=null&&t.view?me.reset(t.view,t.data):s?me.reset("Account"):me.reset("Connect");gn.open=!0,Wn.set({open:!0}),ve.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!s}})},close(){const t=F.state.enableEmbedded,e=!!I.state.activeCaipAddress;gn.open&&ve.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:e}}),gn.open=!1,me.reset("Connect"),Pe.clearLoading(),t?e?me.replace("Account"):me.push("Connect"):Wn.set({open:!1}),Z.resetUri()},setLoading(t,e){e&&gn.loadingNamespaceMap.set(e,t),gn.loading=t,Wn.set({loading:t})},clearLoading(){gn.loadingNamespaceMap.clear(),gn.loading=!1,Wn.set({loading:!1})},shake(){gn.shake||(gn.shake=!0,setTimeout(()=>{gn.shake=!1},500))}},Pe=ar(U8),pc={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},Mp={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},B8={providers:dE,selectedProvider:null,error:null,purchaseCurrency:pc,paymentCurrency:Mp,purchaseCurrencies:[pc],paymentCurrencies:[],quotesLoading:!1},Be=Qe(B8),L8={state:Be,subscribe(t){return Ft(Be,()=>t(Be))},subscribeKey(t,e){return Dt(Be,t,e)},setSelectedProvider(t){var e,n;if(t&&t.name==="meld"){const r=I.state.activeChain,s=r===B.CHAIN.SOLANA?"SOL":"USDC",i=r?((n=(e=I.state.chains.get(r))==null?void 0:e.accountState)==null?void 0:n.address)??"":"",o=new URL(t.url);o.searchParams.append("publicKey",QI),o.searchParams.append("destinationCurrencyCode",s),o.searchParams.append("walletAddress",i),o.searchParams.append("externalCustomerId",F.state.projectId),Be.selectedProvider={...t,url:o.toString()}}else Be.selectedProvider=t},setOnrampProviders(t){if(Array.isArray(t)&&t.every(e=>typeof e=="string")){const e=t,n=dE.filter(r=>e.includes(r.name));Be.providers=n}else Be.providers=[]},setPurchaseCurrency(t){Be.purchaseCurrency=t},setPaymentCurrency(t){Be.paymentCurrency=t},setPurchaseAmount(t){Fp.state.purchaseAmount=t},setPaymentAmount(t){Fp.state.paymentAmount=t},async getAvailableCurrencies(){const t=await be.getOnrampOptions();Be.purchaseCurrencies=t.purchaseCurrencies,Be.paymentCurrencies=t.paymentCurrencies,Be.paymentCurrency=t.paymentCurrencies[0]||Mp,Be.purchaseCurrency=t.purchaseCurrencies[0]||pc,await se.fetchCurrencyImages(t.paymentCurrencies.map(e=>e.id)),await se.fetchTokenImages(t.purchaseCurrencies.map(e=>e.symbol))},async getQuote(){var t,e;Be.quotesLoading=!0;try{const n=await be.getOnrampQuote({purchaseCurrency:Be.purchaseCurrency,paymentCurrency:Be.paymentCurrency,amount:((t=Be.paymentAmount)==null?void 0:t.toString())||"0",network:(e=Be.purchaseCurrency)==null?void 0:e.symbol});return Be.quotesLoading=!1,Be.purchaseAmount=Number(n==null?void 0:n.purchaseAmount.amount),n}catch(n){return Be.error=n.message,Be.quotesLoading=!1,null}finally{Be.quotesLoading=!1}},resetState(){Be.selectedProvider=null,Be.error=null,Be.purchaseCurrency=pc,Be.paymentCurrency=Mp,Be.purchaseCurrencies=[pc],Be.paymentCurrencies=[],Be.paymentAmount=void 0,Be.purchaseAmount=void 0,Be.quotesLoading=!1}},Fp=ar(L8);var bg={exports:{}},sa=typeof Reflect=="object"?Reflect:null,Ay=sa&&typeof sa.apply=="function"?sa.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},Mu;sa&&typeof sa.ownKeys=="function"?Mu=sa.ownKeys:Object.getOwnPropertySymbols?Mu=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Mu=function(e){return Object.getOwnPropertyNames(e)};function M8(t){console&&console.warn&&console.warn(t)}var pC=Number.isNaN||function(e){return e!==e};function Ke(){Ke.init.call(this)}bg.exports=Ke;bg.exports.once=W8;Ke.EventEmitter=Ke;Ke.prototype._events=void 0;Ke.prototype._eventsCount=0;Ke.prototype._maxListeners=void 0;var Iy=10;function cf(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Ke,"defaultMaxListeners",{enumerable:!0,get:function(){return Iy},set:function(t){if(typeof t!="number"||t<0||pC(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Iy=t}});Ke.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ke.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||pC(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function gC(t){return t._maxListeners===void 0?Ke.defaultMaxListeners:t._maxListeners}Ke.prototype.getMaxListeners=function(){return gC(this)};Ke.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var s=e==="error",i=this._events;if(i!==void 0)s=s&&i.error===void 0;else if(!s)return!1;if(s){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=i[e];if(c===void 0)return!1;if(typeof c=="function")Ay(c,this,n);else for(var l=c.length,u=EC(c,l),r=0;r<l;++r)Ay(u[r],this,n);return!0};function mC(t,e,n,r){var s,i,o;if(cf(n),i=t._events,i===void 0?(i=t._events=Object.create(null),t._eventsCount=0):(i.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),i=t._events),o=i[e]),o===void 0)o=i[e]=n,++t._eventsCount;else if(typeof o=="function"?o=i[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),s=gC(t),s>0&&o.length>s&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,M8(a)}return t}Ke.prototype.addListener=function(e,n){return mC(this,e,n,!1)};Ke.prototype.on=Ke.prototype.addListener;Ke.prototype.prependListener=function(e,n){return mC(this,e,n,!0)};function F8(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function yC(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},s=F8.bind(r);return s.listener=n,r.wrapFn=s,s}Ke.prototype.once=function(e,n){return cf(n),this.on(e,yC(this,e,n)),this};Ke.prototype.prependOnceListener=function(e,n){return cf(n),this.prependListener(e,yC(this,e,n)),this};Ke.prototype.removeListener=function(e,n){var r,s,i,o,a;if(cf(n),s=this._events,s===void 0)return this;if(r=s[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===n||r[o].listener===n){a=r[o].listener,i=o;break}if(i<0)return this;i===0?r.shift():j8(r,i),r.length===1&&(s[e]=r[0]),s.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};Ke.prototype.off=Ke.prototype.removeListener;Ke.prototype.removeAllListeners=function(e){var n,r,s;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var i=Object.keys(r),o;for(s=0;s<i.length;++s)o=i[s],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(s=n.length-1;s>=0;s--)this.removeListener(e,n[s]);return this};function bC(t,e,n){var r=t._events;if(r===void 0)return[];var s=r[e];return s===void 0?[]:typeof s=="function"?n?[s.listener||s]:[s]:n?H8(s):EC(s,s.length)}Ke.prototype.listeners=function(e){return bC(this,e,!0)};Ke.prototype.rawListeners=function(e){return bC(this,e,!1)};Ke.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):wC.call(t,e)};Ke.prototype.listenerCount=wC;function wC(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}Ke.prototype.eventNames=function(){return this._eventsCount>0?Mu(this._events):[]};function EC(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function j8(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function H8(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function W8(t,e){return new Promise(function(n,r){function s(o){t.removeListener(e,i),r(o)}function i(){typeof t.removeListener=="function"&&t.removeListener("error",s),n([].slice.call(arguments))}vC(t,e,i,{once:!0}),e!=="error"&&z8(t,s,{once:!0})})}function z8(t,e,n){typeof t.on=="function"&&vC(t,"error",e,n)}function vC(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function s(i){r.once&&t.removeEventListener(e,s),n(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var cr=bg.exports;const wg=Hd(cr);var J={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var jp=function(t,e){return jp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},jp(t,e)};function q8(t,e){jp(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Hp=function(){return Hp=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Hp.apply(this,arguments)};function V8(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function K8(t,e,n,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(i=(s<3?o(i):s>3?o(e,n,i):o(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i}function G8(t,e){return function(n,r){e(n,r,t)}}function Y8(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Z8(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})}function J8(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,s=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){n.label=l[1];break}if(l[0]===6&&n.label<i[1]){n.label=i[1],i=l;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(l);break}i[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(u){l=[6,u],s=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function X8(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}function Q8(t,e){for(var n in t)n!=="default"&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function Wp(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function CC(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return i}function eR(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(CC(arguments[e]));return t}function tR(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),s=0,e=0;e<n;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)r[s]=i[o];return r}function cl(t){return this instanceof cl?(this.v=t,this):new cl(t)}function nR(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(f){r[f]&&(s[f]=function(h){return new Promise(function(p,g){i.push([f,h,p,g])>1||a(f,h)})})}function a(f,h){try{c(r[f](h))}catch(p){d(i[0][3],p)}}function c(f){f.value instanceof cl?Promise.resolve(f.value.v).then(l,u):d(i[0][2],f)}function l(f){a("next",f)}function u(f){a("throw",f)}function d(f,h){f(h),i.shift(),i.length&&a(i[0][0],i[0][1])}}function rR(t){var e,n;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=t[s]?function(o){return(n=!n)?{value:cl(t[s](o)),done:s==="return"}:i?i(o):o}:i}}function sR(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Wp=="function"?Wp(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function iR(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function oR(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function aR(t){return t&&t.__esModule?t:{default:t}}function cR(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function lR(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}const uR=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Hp},__asyncDelegator:rR,__asyncGenerator:nR,__asyncValues:sR,__await:cl,__awaiter:Z8,__classPrivateFieldGet:cR,__classPrivateFieldSet:lR,__createBinding:X8,__decorate:K8,__exportStar:Q8,__extends:q8,__generator:J8,__importDefault:aR,__importStar:oR,__makeTemplateObject:iR,__metadata:Y8,__param:G8,__read:CC,__rest:V8,__spread:eR,__spreadArrays:tR,__values:Wp},Symbol.toStringTag,{value:"Module"})),Dl=LI(uR);var rh={},Ha={},Sy;function dR(){if(Sy)return Ha;Sy=1,Object.defineProperty(Ha,"__esModule",{value:!0}),Ha.delay=void 0;function t(e){return new Promise(n=>{setTimeout(()=>{n(!0)},e)})}return Ha.delay=t,Ha}var Ui={},sh={},Bi={},xy;function fR(){return xy||(xy=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.ONE_THOUSAND=Bi.ONE_HUNDRED=void 0,Bi.ONE_HUNDRED=100,Bi.ONE_THOUSAND=1e3),Bi}var ih={},Ny;function hR(){return Ny||(Ny=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(ih)),ih}var Ty;function _C(){return Ty||(Ty=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Dl;e.__exportStar(fR(),t),e.__exportStar(hR(),t)}(sh)),sh}var Oy;function pR(){if(Oy)return Ui;Oy=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.fromMiliseconds=Ui.toMiliseconds=void 0;const t=_C();function e(r){return r*t.ONE_THOUSAND}Ui.toMiliseconds=e;function n(r){return Math.floor(r/t.ONE_THOUSAND)}return Ui.fromMiliseconds=n,Ui}var Ry;function gR(){return Ry||(Ry=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Dl;e.__exportStar(dR(),t),e.__exportStar(pR(),t)}(rh)),rh}var Lo={},Py;function mR(){if(Py)return Lo;Py=1,Object.defineProperty(Lo,"__esModule",{value:!0}),Lo.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(n){if(this.timestamps.has(n))throw new Error(`Watch already started for label: ${n}`);this.timestamps.set(n,{started:Date.now()})}stop(n){const r=this.get(n);if(typeof r.elapsed<"u")throw new Error(`Watch already stopped for label: ${n}`);const s=Date.now()-r.started;this.timestamps.set(n,{started:r.started,elapsed:s})}get(n){const r=this.timestamps.get(n);if(typeof r>"u")throw new Error(`No timestamp found for label: ${n}`);return r}elapsed(n){const r=this.get(n);return r.elapsed||Date.now()-r.started}}return Lo.Watch=t,Lo.default=t,Lo}var oh={},Wa={},ky;function yR(){if(ky)return Wa;ky=1,Object.defineProperty(Wa,"__esModule",{value:!0}),Wa.IWatch=void 0;class t{}return Wa.IWatch=t,Wa}var Dy;function bR(){return Dy||(Dy=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Dl.__exportStar(yR(),t)}(oh)),oh}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Dl;e.__exportStar(gR(),t),e.__exportStar(mR(),t),e.__exportStar(bR(),t),e.__exportStar(_C(),t)})(J);class No{}let wR=class extends No{constructor(e){super()}};const $y=J.FIVE_SECONDS,To={pulse:"heartbeat_pulse"};let ER=class AC extends wR{constructor(e){super(e),this.events=new cr.EventEmitter,this.interval=$y,this.interval=(e==null?void 0:e.interval)||$y}static async init(e){const n=new AC(e);return await n.init(),n}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),J.toMiliseconds(this.interval))}pulse(){this.events.emit(To.pulse)}};const vR=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,CR=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,_R=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function AR(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){IR(t);return}return e}function IR(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function au(t,e={}){if(typeof t!="string")return t;if(t[0]==='"'&&t[t.length-1]==='"'&&t.indexOf("\\")===-1)return t.slice(1,-1);const n=t.trim();if(n.length<=9)switch(n.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!_R.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(vR.test(t)||CR.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,AR)}return JSON.parse(t)}catch(r){if(e.strict)throw r;return t}}function SR(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function Tt(t,...e){try{return SR(t(...e))}catch(n){return Promise.reject(n)}}function xR(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function NR(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function Fu(t){if(xR(t))return String(t);if(NR(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return Fu(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const zp="base64:";function TR(t){return typeof t=="string"?t:zp+PR(t)}function OR(t){return typeof t!="string"||!t.startsWith(zp)?t:RR(t.slice(zp.length))}function RR(t){return globalThis.Buffer?Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function PR(t){return globalThis.Buffer?Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function bn(t){var e;return t&&((e=t.split("?")[0])==null?void 0:e.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function kR(...t){return bn(t.join(":"))}function cu(t){return t=bn(t),t?t+":":""}function DR(t,e){if(e===void 0)return!0;let n=0,r=t.indexOf(":");for(;r>-1;)n++,r=t.indexOf(":",r+1);return n<=e}function $R(t,e){return e?t.startsWith(e)&&t[t.length-1]!=="$":t[t.length-1]!=="$"}const UR="memory",BR=()=>{const t=new Map;return{name:UR,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,n){t.set(e,n)},setItemRaw(e,n){t.set(e,n)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function LR(t={}){const e={mounts:{"":t.driver||BR()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},n=l=>{for(const u of e.mountpoints)if(l.startsWith(u))return{base:u,relativeKey:l.slice(u.length),driver:e.mounts[u]};return{base:"",relativeKey:l,driver:e.mounts[""]}},r=(l,u)=>e.mountpoints.filter(d=>d.startsWith(l)||u&&l.startsWith(d)).map(d=>({relativeBase:l.length>d.length?l.slice(d.length):void 0,mountpoint:d,driver:e.mounts[d]})),s=(l,u)=>{if(e.watching){u=bn(u);for(const d of e.watchListeners)d(l,u)}},i=async()=>{if(!e.watching){e.watching=!0;for(const l in e.mounts)e.unwatch[l]=await Uy(e.mounts[l],s,l)}},o=async()=>{if(e.watching){for(const l in e.unwatch)await e.unwatch[l]();e.unwatch={},e.watching=!1}},a=(l,u,d)=>{const f=new Map,h=p=>{let g=f.get(p.base);return g||(g={driver:p.driver,base:p.base,items:[]},f.set(p.base,g)),g};for(const p of l){const g=typeof p=="string",m=bn(g?p:p.key),E=g?void 0:p.value,A=g||!p.options?u:{...u,...p.options},b=n(m);h(b).items.push({key:m,value:E,relativeKey:b.relativeKey,options:A})}return Promise.all([...f.values()].map(p=>d(p))).then(p=>p.flat())},c={hasItem(l,u={}){l=bn(l);const{relativeKey:d,driver:f}=n(l);return Tt(f.hasItem,d,u)},getItem(l,u={}){l=bn(l);const{relativeKey:d,driver:f}=n(l);return Tt(f.getItem,d,u).then(h=>au(h))},getItems(l,u={}){return a(l,u,d=>d.driver.getItems?Tt(d.driver.getItems,d.items.map(f=>({key:f.relativeKey,options:f.options})),u).then(f=>f.map(h=>({key:kR(d.base,h.key),value:au(h.value)}))):Promise.all(d.items.map(f=>Tt(d.driver.getItem,f.relativeKey,f.options).then(h=>({key:f.key,value:au(h)})))))},getItemRaw(l,u={}){l=bn(l);const{relativeKey:d,driver:f}=n(l);return f.getItemRaw?Tt(f.getItemRaw,d,u):Tt(f.getItem,d,u).then(h=>OR(h))},async setItem(l,u,d={}){if(u===void 0)return c.removeItem(l);l=bn(l);const{relativeKey:f,driver:h}=n(l);h.setItem&&(await Tt(h.setItem,f,Fu(u),d),h.watch||s("update",l))},async setItems(l,u){await a(l,u,async d=>{if(d.driver.setItems)return Tt(d.driver.setItems,d.items.map(f=>({key:f.relativeKey,value:Fu(f.value),options:f.options})),u);d.driver.setItem&&await Promise.all(d.items.map(f=>Tt(d.driver.setItem,f.relativeKey,Fu(f.value),f.options)))})},async setItemRaw(l,u,d={}){if(u===void 0)return c.removeItem(l,d);l=bn(l);const{relativeKey:f,driver:h}=n(l);if(h.setItemRaw)await Tt(h.setItemRaw,f,u,d);else if(h.setItem)await Tt(h.setItem,f,TR(u),d);else return;h.watch||s("update",l)},async removeItem(l,u={}){typeof u=="boolean"&&(u={removeMeta:u}),l=bn(l);const{relativeKey:d,driver:f}=n(l);f.removeItem&&(await Tt(f.removeItem,d,u),(u.removeMeta||u.removeMata)&&await Tt(f.removeItem,d+"$",u),f.watch||s("remove",l))},async getMeta(l,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),l=bn(l);const{relativeKey:d,driver:f}=n(l),h=Object.create(null);if(f.getMeta&&Object.assign(h,await Tt(f.getMeta,d,u)),!u.nativeOnly){const p=await Tt(f.getItem,d+"$",u).then(g=>au(g));p&&typeof p=="object"&&(typeof p.atime=="string"&&(p.atime=new Date(p.atime)),typeof p.mtime=="string"&&(p.mtime=new Date(p.mtime)),Object.assign(h,p))}return h},setMeta(l,u,d={}){return this.setItem(l+"$",u,d)},removeMeta(l,u={}){return this.removeItem(l+"$",u)},async getKeys(l,u={}){var m;l=cu(l);const d=r(l,!0);let f=[];const h=[];let p=!0;for(const E of d){(m=E.driver.flags)!=null&&m.maxDepth||(p=!1);const A=await Tt(E.driver.getKeys,E.relativeBase,u);for(const b of A){const _=E.mountpoint+bn(b);f.some(C=>_.startsWith(C))||h.push(_)}f=[E.mountpoint,...f.filter(b=>!b.startsWith(E.mountpoint))]}const g=u.maxDepth!==void 0&&!p;return h.filter(E=>(!g||DR(E,u.maxDepth))&&$R(E,l))},async clear(l,u={}){l=cu(l),await Promise.all(r(l,!1).map(async d=>{if(d.driver.clear)return Tt(d.driver.clear,d.relativeBase,u);if(d.driver.removeItem){const f=await d.driver.getKeys(d.relativeBase||"",u);return Promise.all(f.map(h=>d.driver.removeItem(h,u)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(l=>By(l)))},async watch(l){return await i(),e.watchListeners.push(l),async()=>{e.watchListeners=e.watchListeners.filter(u=>u!==l),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(l,u){if(l=cu(l),l&&e.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(e.mountpoints.push(l),e.mountpoints.sort((d,f)=>f.length-d.length)),e.mounts[l]=u,e.watching&&Promise.resolve(Uy(u,s,l)).then(d=>{e.unwatch[l]=d}).catch(console.error),c},async unmount(l,u=!0){var d,f;l=cu(l),!(!l||!e.mounts[l])&&(e.watching&&l in e.unwatch&&((f=(d=e.unwatch)[l])==null||f.call(d),delete e.unwatch[l]),u&&await By(e.mounts[l]),e.mountpoints=e.mountpoints.filter(h=>h!==l),delete e.mounts[l])},getMount(l=""){l=bn(l)+":";const u=n(l);return{driver:u.driver,base:u.base}},getMounts(l="",u={}){return l=bn(l),r(l,u.parents).map(f=>({driver:f.driver,base:f.mountpoint}))},keys:(l,u={})=>c.getKeys(l,u),get:(l,u={})=>c.getItem(l,u),set:(l,u,d={})=>c.setItem(l,u,d),has:(l,u={})=>c.hasItem(l,u),del:(l,u={})=>c.removeItem(l,u),remove:(l,u={})=>c.removeItem(l,u)};return c}function Uy(t,e,n){return t.watch?t.watch((r,s)=>e(r,n+s)):()=>{}}async function By(t){typeof t.dispose=="function"&&await Tt(t.dispose)}function Oo(t){return new Promise((e,n)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>n(t.error)})}function IC(t,e){const n=indexedDB.open(t);n.onupgradeneeded=()=>n.result.createObjectStore(e);const r=Oo(n);return(s,i)=>r.then(o=>i(o.transaction(e,s).objectStore(e)))}let ah;function $l(){return ah||(ah=IC("keyval-store","keyval")),ah}function Ly(t,e=$l()){return e("readonly",n=>Oo(n.get(t)))}function MR(t,e,n=$l()){return n("readwrite",r=>(r.put(e,t),Oo(r.transaction)))}function FR(t,e=$l()){return e("readwrite",n=>(n.delete(t),Oo(n.transaction)))}function jR(t=$l()){return t("readwrite",e=>(e.clear(),Oo(e.transaction)))}function HR(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Oo(t.transaction)}function WR(t=$l()){return t("readonly",e=>{if(e.getAllKeys)return Oo(e.getAllKeys());const n=[];return HR(e,r=>n.push(r.key)).then(()=>n)})}const zR="idb-keyval";var qR=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",n=s=>e+s;let r;return t.dbName&&t.storeName&&(r=IC(t.dbName,t.storeName)),{name:zR,options:t,async hasItem(s){return!(typeof await Ly(n(s),r)>"u")},async getItem(s){return await Ly(n(s),r)??null},setItem(s,i){return MR(n(s),i,r)},removeItem(s){return FR(n(s),r)},getKeys(){return WR(r)},clear(){return jR(r)}}};const VR="WALLET_CONNECT_V2_INDEXED_DB",KR="keyvaluestorage";let GR=class{constructor(){this.indexedDb=LR({driver:qR({dbName:VR,storeName:KR})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const n=await this.indexedDb.getItem(e);if(n!==null)return n}async setItem(e,n){await this.indexedDb.setItem(e,ks(n))}async removeItem(e){await this.indexedDb.removeItem(e)}};var ch=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ju={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(n){return this.hasOwnProperty(n)?String(this[n]):null},t.prototype.setItem=function(n,r){this[n]=String(r)},t.prototype.removeItem=function(n){delete this[n]},t.prototype.clear=function(){const n=this;Object.keys(n).forEach(function(r){n[r]=void 0,delete n[r]})},t.prototype.key=function(n){return n=n||0,Object.keys(this)[n]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof ch<"u"&&ch.localStorage?ju.exports=ch.localStorage:typeof window<"u"&&window.localStorage?ju.exports=window.localStorage:ju.exports=new e})();function YR(t){var e;return[t[0],po((e=t[1])!=null?e:"")]}let ZR=class{constructor(){this.localStorage=ju.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(YR)}async getItem(e){const n=this.localStorage.getItem(e);if(n!==null)return po(n)}async setItem(e,n){this.localStorage.setItem(e,ks(n))}async removeItem(e){this.localStorage.removeItem(e)}};const JR="wc_storage_version",My=1,XR=async(t,e,n)=>{const r=JR,s=await e.getItem(r);if(s&&s>=My){n(e);return}const i=await t.getKeys();if(!i.length){n(e);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const l=await t.getItem(a);await e.setItem(a,l),o.push(a)}}await e.setItem(r,My),n(e),QR(t,o)},QR=async(t,e)=>{e.length&&e.forEach(async n=>{await t.removeItem(n)})};let eP=class{constructor(){this.initialized=!1,this.setInitialized=n=>{this.storage=n,this.initialized=!0};const e=new ZR;this.storage=e;try{const n=new GR;XR(e,n,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,n){return await this.initialize(),this.storage.setItem(e,n)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const n=setInterval(()=>{this.initialized&&(clearInterval(n),e())},20)})}};var tP=Object.defineProperty,nP=(t,e,n)=>e in t?tP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Fy=(t,e,n)=>nP(t,typeof e!="symbol"?e+"":e,n);let rP=class extends No{constructor(e){super(),this.opts=e,Fy(this,"protocol","wc"),Fy(this,"version",2)}};var sP=Object.defineProperty,iP=(t,e,n)=>e in t?sP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,oP=(t,e,n)=>iP(t,e+"",n);let aP=class extends No{constructor(e,n){super(),this.core=e,this.logger=n,oP(this,"records",new Map)}},cP=class{constructor(e,n){this.logger=e,this.core=n}},lP=class extends No{constructor(e,n){super(),this.relayer=e,this.logger=n}},uP=class extends No{constructor(e){super()}},dP=class{constructor(e,n,r,s){this.core=e,this.logger=n,this.name=r}},fP=class extends No{constructor(e,n){super(),this.relayer=e,this.logger=n}},hP=class extends No{constructor(e,n){super(),this.core=e,this.logger=n}},pP=class{constructor(e,n,r){this.core=e,this.logger=n,this.store=r}},gP=class{constructor(e,n){this.projectId=e,this.logger=n}},mP=class{constructor(e,n,r){this.core=e,this.logger=n,this.telemetryEnabled=r}};var yP=Object.defineProperty,bP=(t,e,n)=>e in t?yP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,jy=(t,e,n)=>bP(t,typeof e!="symbol"?e+"":e,n);let wP=class{constructor(e){this.opts=e,jy(this,"protocol","wc"),jy(this,"version",2)}},EP=class{constructor(e){this.client=e}};function vP(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function SC(t,...e){if(!vP(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Hy(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function CP(t,e){SC(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const Mo=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const lh=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function _P(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function xC(t){return typeof t=="string"&&(t=_P(t)),SC(t),t}let AP=class{clone(){return this._cloneInto()}};function IP(t){const e=r=>t().update(xC(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function NC(t=32){if(Mo&&typeof Mo.getRandomValues=="function")return Mo.getRandomValues(new Uint8Array(t));if(Mo&&typeof Mo.randomBytes=="function")return Mo.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function SP(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}let xP=class extends AP{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=lh(this.buffer)}update(e){Hy(this);const{view:n,buffer:r,blockLen:s}=this;e=xC(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=lh(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Hy(this),CP(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;SP(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=lh(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%n&&e.buffer.set(r),e}};const lu=BigInt(2**32-1),qp=BigInt(32);function TC(t,e=!1){return e?{h:Number(t&lu),l:Number(t>>qp&lu)}:{h:Number(t>>qp&lu)|0,l:Number(t&lu)|0}}function NP(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=TC(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const TP=(t,e)=>BigInt(t>>>0)<<qp|BigInt(e>>>0),OP=(t,e,n)=>t>>>n,RP=(t,e,n)=>t<<32-n|e>>>n,PP=(t,e,n)=>t>>>n|e<<32-n,kP=(t,e,n)=>t<<32-n|e>>>n,DP=(t,e,n)=>t<<64-n|e>>>n-32,$P=(t,e,n)=>t>>>n-32|e<<64-n,UP=(t,e)=>e,BP=(t,e)=>t,LP=(t,e,n)=>t<<n|e>>>32-n,MP=(t,e,n)=>e<<n|t>>>32-n,FP=(t,e,n)=>e<<n-32|t>>>64-n,jP=(t,e,n)=>t<<n-32|e>>>64-n;function HP(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const WP=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),zP=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,qP=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),VP=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,KP=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),GP=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,Ie={fromBig:TC,split:NP,toBig:TP,shrSH:OP,shrSL:RP,rotrSH:PP,rotrSL:kP,rotrBH:DP,rotrBL:$P,rotr32H:UP,rotr32L:BP,rotlSH:LP,rotlSL:MP,rotlBH:FP,rotlBL:jP,add:HP,add3L:WP,add3H:zP,add4L:qP,add4H:VP,add5H:GP,add5L:KP},[YP,ZP]=Ie.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),zs=new Uint32Array(80),qs=new Uint32Array(80);let JP=class extends xP{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:f,Gh:h,Gl:p,Hh:g,Hl:m}=this;return[e,n,r,s,i,o,a,c,l,u,d,f,h,p,g,m]}set(e,n,r,s,i,o,a,c,l,u,d,f,h,p,g,m){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=f|0,this.Gh=h|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,n){for(let b=0;b<16;b++,n+=4)zs[b]=e.getUint32(n),qs[b]=e.getUint32(n+=4);for(let b=16;b<80;b++){const _=zs[b-15]|0,C=qs[b-15]|0,S=Ie.rotrSH(_,C,1)^Ie.rotrSH(_,C,8)^Ie.shrSH(_,C,7),x=Ie.rotrSL(_,C,1)^Ie.rotrSL(_,C,8)^Ie.shrSL(_,C,7),P=zs[b-2]|0,N=qs[b-2]|0,L=Ie.rotrSH(P,N,19)^Ie.rotrBH(P,N,61)^Ie.shrSH(P,N,6),M=Ie.rotrSL(P,N,19)^Ie.rotrBL(P,N,61)^Ie.shrSL(P,N,6),U=Ie.add4L(x,M,qs[b-7],qs[b-16]),O=Ie.add4H(U,S,L,zs[b-7],zs[b-16]);zs[b]=O|0,qs[b]=U|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:f,Fh:h,Fl:p,Gh:g,Gl:m,Hh:E,Hl:A}=this;for(let b=0;b<80;b++){const _=Ie.rotrSH(d,f,14)^Ie.rotrSH(d,f,18)^Ie.rotrBH(d,f,41),C=Ie.rotrSL(d,f,14)^Ie.rotrSL(d,f,18)^Ie.rotrBL(d,f,41),S=d&h^~d&g,x=f&p^~f&m,P=Ie.add5L(A,C,x,ZP[b],qs[b]),N=Ie.add5H(P,E,_,S,YP[b],zs[b]),L=P|0,M=Ie.rotrSH(r,s,28)^Ie.rotrBH(r,s,34)^Ie.rotrBH(r,s,39),U=Ie.rotrSL(r,s,28)^Ie.rotrBL(r,s,34)^Ie.rotrBL(r,s,39),O=r&i^r&a^i&a,$=s&o^s&c^o&c;E=g|0,A=m|0,g=h|0,m=p|0,h=d|0,p=f|0,{h:d,l:f}=Ie.add(l|0,u|0,N|0,L|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const y=Ie.add3L(L,U,$);r=Ie.add3H(y,N,M,O),s=y|0}({h:r,l:s}=Ie.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Ie.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Ie.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Ie.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:f}=Ie.add(this.Eh|0,this.El|0,d|0,f|0),{h,l:p}=Ie.add(this.Fh|0,this.Fl|0,h|0,p|0),{h:g,l:m}=Ie.add(this.Gh|0,this.Gl|0,g|0,m|0),{h:E,l:A}=Ie.add(this.Hh|0,this.Hl|0,E|0,A|0),this.set(r,s,i,o,a,c,l,u,d,f,h,p,g,m,E,A)}roundClean(){zs.fill(0),qs.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const XP=IP(()=>new JP);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Eg=BigInt(0),OC=BigInt(1),QP=BigInt(2);function vg(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Cg(t){if(!vg(t))throw new Error("Uint8Array expected")}function uh(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const e4=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function _g(t){Cg(t);let e="";for(let n=0;n<t.length;n++)e+=e4[t[n]];return e}function RC(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Eg:BigInt("0x"+t)}const ss={_0:48,_9:57,A:65,F:70,a:97,f:102};function Wy(t){if(t>=ss._0&&t<=ss._9)return t-ss._0;if(t>=ss.A&&t<=ss.F)return t-(ss.A-10);if(t>=ss.a&&t<=ss.f)return t-(ss.a-10)}function PC(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=Wy(t.charCodeAt(i)),a=Wy(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function t4(t){return RC(_g(t))}function Hu(t){return Cg(t),RC(_g(Uint8Array.from(t).reverse()))}function kC(t,e){return PC(t.toString(16).padStart(e*2,"0"))}function Vp(t,e){return kC(t,e).reverse()}function is(t,e,n){let r;if(typeof e=="string")try{r=PC(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(vg(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}function zy(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Cg(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}const dh=t=>typeof t=="bigint"&&Eg<=t;function n4(t,e,n){return dh(t)&&dh(e)&&dh(n)&&e<=t&&t<n}function za(t,e,n,r){if(!n4(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function r4(t){let e;for(e=0;t>Eg;t>>=OC,e+=1);return e}const s4=t=>(QP<<BigInt(t-1))-OC,i4={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||vg(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Ag(t,e,n={}){const r=(s,i,o)=>{const a=i4[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return t}function qy(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const kt=BigInt(0),dt=BigInt(1),qi=BigInt(2),o4=BigInt(3),Kp=BigInt(4),Vy=BigInt(5),Ky=BigInt(8);function At(t,e){const n=t%e;return n>=kt?n:e+n}function a4(t,e,n){if(e<kt)throw new Error("invalid exponent, negatives unsupported");if(n<=kt)throw new Error("invalid modulus");if(n===dt)return kt;let r=dt;for(;e>kt;)e&dt&&(r=r*t%n),t=t*t%n,e>>=dt;return r}function Rr(t,e,n){let r=t;for(;e-- >kt;)r*=r,r%=n;return r}function Gy(t,e){if(t===kt)throw new Error("invert: expected non-zero number");if(e<=kt)throw new Error("invert: expected positive modulus, got "+e);let n=At(t,e),r=e,s=kt,i=dt;for(;n!==kt;){const o=r/n,a=r%n,c=s-i*o;r=n,n=a,s=i,i=c}if(r!==dt)throw new Error("invert: does not exist");return At(s,e)}function c4(t){const e=(t-dt)/qi;let n,r,s;for(n=t-dt,r=0;n%qi===kt;n/=qi,r++);for(s=qi;s<t&&a4(s,e,t)!==t-dt;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){const o=(t+dt)/Kp;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const i=(n+dt)/qi;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=r,l=o.pow(o.mul(o.ONE,s),n),u=o.pow(a,i),d=o.pow(a,n);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let f=1;for(let p=o.sqr(d);f<c&&!o.eql(p,o.ONE);f++)p=o.sqr(p);const h=o.pow(l,dt<<BigInt(c-f-1));l=o.sqr(h),u=o.mul(u,h),d=o.mul(d,l),c=f}return u}}function l4(t){if(t%Kp===o4){const e=(t+dt)/Kp;return function(n,r){const s=n.pow(r,e);if(!n.eql(n.sqr(s),r))throw new Error("Cannot find square root");return s}}if(t%Ky===Vy){const e=(t-Vy)/Ky;return function(n,r){const s=n.mul(r,qi),i=n.pow(s,e),o=n.mul(r,i),a=n.mul(n.mul(o,qi),i),c=n.mul(o,n.sub(a,n.ONE));if(!n.eql(n.sqr(c),r))throw new Error("Cannot find square root");return c}}return c4(t)}const u4=(t,e)=>(At(t,e)&dt)===dt,d4=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function f4(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=d4.reduce((r,s)=>(r[s]="function",r),e);return Ag(t,n)}function h4(t,e,n){if(n<kt)throw new Error("invalid exponent, negatives unsupported");if(n===kt)return t.ONE;if(n===dt)return e;let r=t.ONE,s=e;for(;n>kt;)n&dt&&(r=t.mul(r,s)),s=t.sqr(s),n>>=dt;return r}function p4(t,e){const n=new Array(e.length),r=e.reduce((i,o,a)=>t.is0(o)?i:(n[a]=i,t.mul(i,o)),t.ONE),s=t.inv(r);return e.reduceRight((i,o,a)=>t.is0(o)?i:(n[a]=t.mul(i,n[a]),t.mul(i,o)),s),n}function DC(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function $C(t,e,n=!1,r={}){if(t<=kt)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=DC(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:n,BITS:s,BYTES:i,MASK:s4(s),ZERO:kt,ONE:dt,create:c=>At(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return kt<=c&&c<t},is0:c=>c===kt,isOdd:c=>(c&dt)===dt,neg:c=>At(-c,t),eql:(c,l)=>c===l,sqr:c=>At(c*c,t),add:(c,l)=>At(c+l,t),sub:(c,l)=>At(c-l,t),mul:(c,l)=>At(c*l,t),pow:(c,l)=>h4(a,c,l),div:(c,l)=>At(c*Gy(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Gy(c,t),sqrt:r.sqrt||(c=>(o||(o=l4(t)),o(a,c))),invertBatch:c=>p4(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>n?Vp(c,i):kC(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return n?Hu(c):t4(c)}});return Object.freeze(a)}const Yy=BigInt(0),uu=BigInt(1);function fh(t,e){const n=e.negate();return t?n:e}function UC(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function hh(t,e){UC(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1);return{windows:n,windowSize:r}}function g4(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function m4(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const ph=new WeakMap,BC=new WeakMap;function gh(t){return BC.get(t)||1}function y4(t,e){return{constTimeNegate:fh,hasPrecomputes(n){return gh(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>Yy;)r&uu&&(s=s.add(i)),i=i.double(),r>>=uu;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=hh(r,e),o=[];let a=n,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){const{windows:i,windowSize:o}=hh(n,e);let a=t.ZERO,c=t.BASE;const l=BigInt(2**n-1),u=2**n,d=BigInt(n);for(let f=0;f<i;f++){const h=f*o;let p=Number(s&l);s>>=d,p>o&&(p-=u,s+=uu);const g=h,m=h+Math.abs(p)-1,E=f%2!==0,A=p<0;p===0?c=c.add(fh(E,r[g])):a=a.add(fh(A,r[m]))}return{p:a,f:c}},wNAFUnsafe(n,r,s,i=t.ZERO){const{windows:o,windowSize:a}=hh(n,e),c=BigInt(2**n-1),l=2**n,u=BigInt(n);for(let d=0;d<o;d++){const f=d*a;if(s===Yy)break;let h=Number(s&c);if(s>>=u,h>a&&(h-=l,s+=uu),h===0)continue;let p=r[f+Math.abs(h)-1];h<0&&(p=p.negate()),i=i.add(p)}return i},getPrecomputes(n,r,s){let i=ph.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&ph.set(r,s(i))),i},wNAFCached(n,r,s){const i=gh(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=gh(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){UC(r,e),BC.set(n,r),ph.delete(n)}}}function b4(t,e,n,r){if(g4(n,t),m4(r,e),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,i=r4(BigInt(n.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((e.BITS-1)/o)*o;let u=s;for(let d=l;d>=0;d-=o){c.fill(s);for(let h=0;h<r.length;h++){const p=r[h],g=Number(p>>BigInt(d)&BigInt(a));c[g]=c[g].add(n[h])}let f=s;for(let h=c.length-1,p=s;h>0;h--)p=p.add(c[h]),f=f.add(p);if(u=u.add(f),d!==0)for(let h=0;h<o;h++)u=u.double()}return u}function w4(t){return f4(t.Fp),Ag(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...DC(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const lr=BigInt(0),mn=BigInt(1),du=BigInt(2),E4=BigInt(8),v4={zip215:!0};function C4(t){const e=w4(t);return Ag(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function _4(t){const e=C4(t),{Fp:n,n:r,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,l=du<<BigInt(a*8)-mn,u=n.create,d=$C(e.n,e.nBitLength),f=e.uvRatio||((y,w)=>{try{return{isValid:!0,value:n.sqrt(y*n.inv(w))}}catch{return{isValid:!1,value:lr}}}),h=e.adjustScalarBytes||(y=>y),p=e.domain||((y,w,T)=>{if(uh("phflag",T),w.length||T)throw new Error("Contexts/pre-hash are not supported");return y});function g(y,w){za("coordinate "+y,w,lr,l)}function m(y){if(!(y instanceof b))throw new Error("ExtendedPoint expected")}const E=qy((y,w)=>{const{ex:T,ey:D,ez:R}=y,k=y.is0();w==null&&(w=k?E4:n.inv(R));const j=u(T*w),H=u(D*w),ee=u(R*w);if(k)return{x:lr,y:mn};if(ee!==mn)throw new Error("invZ was invalid");return{x:j,y:H}}),A=qy(y=>{const{a:w,d:T}=e;if(y.is0())throw new Error("bad point: ZERO");const{ex:D,ey:R,ez:k,et:j}=y,H=u(D*D),ee=u(R*R),K=u(k*k),G=u(K*K),ce=u(H*w),ge=u(K*u(ce+ee)),Ne=u(G+u(T*u(H*ee)));if(ge!==Ne)throw new Error("bad point: equation left != right (1)");const pe=u(D*R),Re=u(k*j);if(pe!==Re)throw new Error("bad point: equation left != right (2)");return!0});class b{constructor(w,T,D,R){this.ex=w,this.ey=T,this.ez=D,this.et=R,g("x",w),g("y",T),g("z",D),g("t",R),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(w){if(w instanceof b)throw new Error("extended point not allowed");const{x:T,y:D}=w||{};return g("x",T),g("y",D),new b(T,D,mn,u(T*D))}static normalizeZ(w){const T=n.invertBatch(w.map(D=>D.ez));return w.map((D,R)=>D.toAffine(T[R])).map(b.fromAffine)}static msm(w,T){return b4(b,d,w,T)}_setWindowSize(w){S.setWindowSize(this,w)}assertValidity(){A(this)}equals(w){m(w);const{ex:T,ey:D,ez:R}=this,{ex:k,ey:j,ez:H}=w,ee=u(T*H),K=u(k*R),G=u(D*H),ce=u(j*R);return ee===K&&G===ce}is0(){return this.equals(b.ZERO)}negate(){return new b(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:w}=e,{ex:T,ey:D,ez:R}=this,k=u(T*T),j=u(D*D),H=u(du*u(R*R)),ee=u(w*k),K=T+D,G=u(u(K*K)-k-j),ce=ee+j,ge=ce-H,Ne=ee-j,pe=u(G*ge),Re=u(ce*Ne),st=u(G*Ne),wt=u(ge*ce);return new b(pe,Re,wt,st)}add(w){m(w);const{a:T,d:D}=e,{ex:R,ey:k,ez:j,et:H}=this,{ex:ee,ey:K,ez:G,et:ce}=w;if(T===BigInt(-1)){const ym=u((k-R)*(K+ee)),bm=u((k+R)*(K-ee)),kf=u(bm-ym);if(kf===lr)return this.double();const wm=u(j*du*ce),Em=u(H*du*G),vm=Em+wm,Cm=bm+ym,_m=Em-wm,vI=u(vm*kf),CI=u(Cm*_m),_I=u(vm*_m),AI=u(kf*Cm);return new b(vI,CI,AI,_I)}const ge=u(R*ee),Ne=u(k*K),pe=u(H*D*ce),Re=u(j*G),st=u((R+k)*(ee+K)-ge-Ne),wt=Re-pe,St=Re+pe,tn=u(Ne-T*ge),Qr=u(st*wt),Bs=u(St*tn),wI=u(st*tn),EI=u(wt*St);return new b(Qr,Bs,EI,wI)}subtract(w){return this.add(w.negate())}wNAF(w){return S.wNAFCached(this,w,b.normalizeZ)}multiply(w){const T=w;za("scalar",T,mn,r);const{p:D,f:R}=this.wNAF(T);return b.normalizeZ([D,R])[0]}multiplyUnsafe(w,T=b.ZERO){const D=w;return za("scalar",D,lr,r),D===lr?C:this.is0()||D===mn?this:S.wNAFCachedUnsafe(this,D,b.normalizeZ,T)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return S.unsafeLadder(this,r).is0()}toAffine(w){return E(this,w)}clearCofactor(){const{h:w}=e;return w===mn?this:this.multiplyUnsafe(w)}static fromHex(w,T=!1){const{d:D,a:R}=e,k=n.BYTES;w=is("pointHex",w,k),uh("zip215",T);const j=w.slice(),H=w[k-1];j[k-1]=H&-129;const ee=Hu(j),K=T?l:n.ORDER;za("pointHex.y",ee,lr,K);const G=u(ee*ee),ce=u(G-mn),ge=u(D*G-R);let{isValid:Ne,value:pe}=f(ce,ge);if(!Ne)throw new Error("Point.fromHex: invalid y coordinate");const Re=(pe&mn)===mn,st=(H&128)!==0;if(!T&&pe===lr&&st)throw new Error("Point.fromHex: x=0 and x_0=1");return st!==Re&&(pe=u(-pe)),b.fromAffine({x:pe,y:ee})}static fromPrivateKey(w){return N(w).point}toRawBytes(){const{x:w,y:T}=this.toAffine(),D=Vp(T,n.BYTES);return D[D.length-1]|=w&mn?128:0,D}toHex(){return _g(this.toRawBytes())}}b.BASE=new b(e.Gx,e.Gy,mn,u(e.Gx*e.Gy)),b.ZERO=new b(lr,mn,mn,lr);const{BASE:_,ZERO:C}=b,S=y4(b,a*8);function x(y){return At(y,r)}function P(y){return x(Hu(y))}function N(y){const w=n.BYTES;y=is("private key",y,w);const T=is("hashed private key",i(y),2*w),D=h(T.slice(0,w)),R=T.slice(w,2*w),k=P(D),j=_.multiply(k),H=j.toRawBytes();return{head:D,prefix:R,scalar:k,point:j,pointBytes:H}}function L(y){return N(y).pointBytes}function M(y=new Uint8Array,...w){const T=zy(...w);return P(i(p(T,is("context",y),!!s)))}function U(y,w,T={}){y=is("message",y),s&&(y=s(y));const{prefix:D,scalar:R,pointBytes:k}=N(w),j=M(T.context,D,y),H=_.multiply(j).toRawBytes(),ee=M(T.context,H,k,y),K=x(j+ee*R);za("signature.s",K,lr,r);const G=zy(H,Vp(K,n.BYTES));return is("result",G,n.BYTES*2)}const O=v4;function $(y,w,T,D=O){const{context:R,zip215:k}=D,j=n.BYTES;y=is("signature",y,2*j),w=is("message",w),T=is("publicKey",T,j),k!==void 0&&uh("zip215",k),s&&(w=s(w));const H=Hu(y.slice(j,2*j));let ee,K,G;try{ee=b.fromHex(T,k),K=b.fromHex(y.slice(0,j),k),G=_.multiplyUnsafe(H)}catch{return!1}if(!k&&ee.isSmallOrder())return!1;const ce=M(R,K.toRawBytes(),ee.toRawBytes(),w);return K.add(ee.multiplyUnsafe(ce)).subtract(G).clearCofactor().equals(b.ZERO)}return _._setWindowSize(8),{CURVE:e,getPublicKey:L,sign:U,verify:$,ExtendedPoint:b,utils:{getExtendedPublicKey:N,randomPrivateKey:()=>o(n.BYTES),precompute(y=8,w=b.BASE){return w._setWindowSize(y),w.multiply(BigInt(3)),w}}}}BigInt(0),BigInt(1);const Ig=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Zy=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const A4=BigInt(1),Jy=BigInt(2);BigInt(3);const I4=BigInt(5),S4=BigInt(8);function x4(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=Ig,o=t*t%i*t%i,a=Rr(o,Jy,i)*o%i,c=Rr(a,A4,i)*t%i,l=Rr(c,I4,i)*c%i,u=Rr(l,e,i)*l%i,d=Rr(u,n,i)*u%i,f=Rr(d,r,i)*d%i,h=Rr(f,s,i)*f%i,p=Rr(h,s,i)*f%i,g=Rr(p,e,i)*l%i;return{pow_p_5_8:Rr(g,Jy,i)*t%i,b2:o}}function N4(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function T4(t,e){const n=Ig,r=At(e*e*e,n),s=At(r*r*e,n),i=x4(t*s).pow_p_5_8;let o=At(t*r*i,n);const a=At(e*o*o,n),c=o,l=At(o*Zy,n),u=a===t,d=a===At(-t,n),f=a===At(-t*Zy,n);return u&&(o=c),(d||f)&&(o=l),u4(o,n)&&(o=At(-o,n)),{isValid:u||d,value:o}}const O4=$C(Ig,void 0,!0),R4={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:O4,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:S4,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:XP,randomBytes:NC,adjustScalarBytes:N4,uvRatio:T4},LC=_4(R4),P4="EdDSA",k4="JWT",Ed=".",lf="base64url",MC="utf8",FC="utf8",D4=":",$4="did",U4="key",Xy="base58btc",B4="z",L4="K36",M4=32;function Sg(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function jC(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Sg(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function HC(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const n=jC(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return Sg(n)}function F4(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,E=0,A=p.length;E!==A&&p[E]===0;)E++,g++;for(var b=(A-E)*u+1>>>0,_=new Uint8Array(b);E!==A;){for(var C=p[E],S=0,x=b-1;(C!==0||S<m)&&x!==-1;x--,S++)C+=256*_[x]>>>0,_[x]=C%a>>>0,C=C/a>>>0;if(C!==0)throw new Error("Non-zero carry");m=S,E++}for(var P=b-m;P!==b&&_[P]===0;)P++;for(var N=c.repeat(g);P<b;++P)N+=t.charAt(_[P]);return N}function f(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,E=0;p[g]===c;)m++,g++;for(var A=(p.length-g)*l+1>>>0,b=new Uint8Array(A);p[g];){var _=n[p.charCodeAt(g)];if(_===255)return;for(var C=0,S=A-1;(_!==0||C<E)&&S!==-1;S--,C++)_+=a*b[S]>>>0,b[S]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");E=C,g++}if(p[g]!==" "){for(var x=A-E;x!==A&&b[x]===0;)x++;for(var P=new Uint8Array(m+(A-x)),N=m;x!==A;)P[N++]=b[x++];return P}}}function h(p){var g=f(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:f,decode:h}}var j4=F4,H4=j4;const WC=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},W4=t=>new TextEncoder().encode(t),z4=t=>new TextDecoder().decode(t);let q4=class{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},V4=class{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return zC(this,e)}},K4=class{constructor(e){this.decoders=e}or(e){return zC(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const zC=(t,e)=>new K4({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let G4=class{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new q4(e,n,r),this.decoder=new V4(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const uf=({name:t,prefix:e,encode:n,decode:r})=>new G4(t,e,n,r),Ul=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=H4(n,e);return uf({prefix:t,name:e,encode:r,decode:i=>WC(s(i))})},Y4=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Z4=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},Ht=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>uf({prefix:e,name:t,encode(s){return Z4(s,r,n)},decode(s){return Y4(s,r,n,t)}}),J4=uf({prefix:"\0",name:"identity",encode:t=>z4(t),decode:t=>W4(t)});var X4=Object.freeze({__proto__:null,identity:J4});const Q4=Ht({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ek=Object.freeze({__proto__:null,base2:Q4});const tk=Ht({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var nk=Object.freeze({__proto__:null,base8:tk});const rk=Ul({prefix:"9",name:"base10",alphabet:"0123456789"});var sk=Object.freeze({__proto__:null,base10:rk});const ik=Ht({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ok=Ht({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var ak=Object.freeze({__proto__:null,base16:ik,base16upper:ok});const ck=Ht({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),lk=Ht({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),uk=Ht({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),dk=Ht({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),fk=Ht({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),hk=Ht({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),pk=Ht({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),gk=Ht({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),mk=Ht({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var yk=Object.freeze({__proto__:null,base32:ck,base32upper:lk,base32pad:uk,base32padupper:dk,base32hex:fk,base32hexupper:hk,base32hexpad:pk,base32hexpadupper:gk,base32z:mk});const bk=Ul({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),wk=Ul({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ek=Object.freeze({__proto__:null,base36:bk,base36upper:wk});const vk=Ul({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ck=Ul({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var _k=Object.freeze({__proto__:null,base58btc:vk,base58flickr:Ck});const Ak=Ht({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ik=Ht({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Sk=Ht({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),xk=Ht({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Nk=Object.freeze({__proto__:null,base64:Ak,base64pad:Ik,base64url:Sk,base64urlpad:xk});const qC=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),Tk=qC.reduce((t,e,n)=>(t[n]=e,t),[]),Ok=qC.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function Rk(t){return t.reduce((e,n)=>(e+=Tk[n],e),"")}function Pk(t){const e=[];for(const n of t){const r=Ok[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const kk=uf({prefix:"ðŸš€",name:"base256emoji",encode:Rk,decode:Pk});var Dk=Object.freeze({__proto__:null,base256emoji:kk}),$k=VC,Qy=128,Uk=-128,Bk=Math.pow(2,31);function VC(t,e,n){e=e||[],n=n||0;for(var r=n;t>=Bk;)e[n++]=t&255|Qy,t/=128;for(;t&Uk;)e[n++]=t&255|Qy,t>>>=7;return e[n]=t|0,VC.bytes=n-r+1,e}var Lk=Gp,Mk=128,eb=127;function Gp(t,r){var n=0,r=r||0,s=0,i=r,o,a=t.length;do{if(i>=a)throw Gp.bytes=0,new RangeError("Could not decode varint");o=t[i++],n+=s<28?(o&eb)<<s:(o&eb)*Math.pow(2,s),s+=7}while(o>=Mk);return Gp.bytes=i-r,n}var Fk=Math.pow(2,7),jk=Math.pow(2,14),Hk=Math.pow(2,21),Wk=Math.pow(2,28),zk=Math.pow(2,35),qk=Math.pow(2,42),Vk=Math.pow(2,49),Kk=Math.pow(2,56),Gk=Math.pow(2,63),Yk=function(t){return t<Fk?1:t<jk?2:t<Hk?3:t<Wk?4:t<zk?5:t<qk?6:t<Vk?7:t<Kk?8:t<Gk?9:10},Zk={encode:$k,decode:Lk,encodingLength:Yk},KC=Zk;const tb=(t,e,n=0)=>(KC.encode(t,e,n),e),nb=t=>KC.encodingLength(t),Yp=(t,e)=>{const n=e.byteLength,r=nb(t),s=r+nb(n),i=new Uint8Array(s+n);return tb(t,i,0),tb(n,i,r),i.set(e,s),new Jk(t,n,e,i)};let Jk=class{constructor(e,n,r,s){this.code=e,this.size=n,this.digest=r,this.bytes=s}};const GC=({name:t,code:e,encode:n})=>new Xk(t,e,n);let Xk=class{constructor(e,n,r){this.name=e,this.code=n,this.encode=r}digest(e){if(e instanceof Uint8Array){const n=this.encode(e);return n instanceof Uint8Array?Yp(this.code,n):n.then(r=>Yp(this.code,r))}else throw Error("Unknown type, must be binary type")}};const YC=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Qk=GC({name:"sha2-256",code:18,encode:YC("SHA-256")}),eD=GC({name:"sha2-512",code:19,encode:YC("SHA-512")});var tD=Object.freeze({__proto__:null,sha256:Qk,sha512:eD});const ZC=0,nD="identity",JC=WC,rD=t=>Yp(ZC,JC(t)),sD={code:ZC,name:nD,encode:JC,digest:rD};var iD=Object.freeze({__proto__:null,identity:sD});new TextEncoder,new TextDecoder;const rb={...X4,...ek,...nk,...sk,...ak,...yk,...Ek,..._k,...Nk,...Dk};({...tD,...iD});function XC(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const sb=XC("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),mh=XC("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=jC(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),QC={utf8:sb,"utf-8":sb,hex:rb.base16,latin1:mh,ascii:mh,binary:mh,...rb};function df(t,e="utf8"){const n=QC[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):n.encoder.encode(t).substring(1)}function Pa(t,e="utf8"){const n=QC[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Sg(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}function ib(t){return po(df(Pa(t,lf),MC))}function vd(t){return df(Pa(ks(t),MC),lf)}function e_(t){const e=Pa(L4,Xy),n=B4+df(HC([e,t]),Xy);return[$4,U4,n].join(D4)}function oD(t){return df(t,lf)}function aD(t){return Pa(t,lf)}function cD(t){return Pa([vd(t.header),vd(t.payload)].join(Ed),FC)}function lD(t){return[vd(t.header),vd(t.payload),oD(t.signature)].join(Ed)}function Zp(t){const e=t.split(Ed),n=ib(e[0]),r=ib(e[1]),s=aD(e[2]),i=Pa(e.slice(0,2).join(Ed),FC);return{header:n,payload:r,signature:s,data:i}}function ob(t=NC(M4)){const e=LC.getPublicKey(t);return{secretKey:HC([t,e]),publicKey:e}}async function uD(t,e,n,r,s=J.fromMiliseconds(Date.now())){const i={alg:P4,typ:k4},o=e_(r.publicKey),a=s+n,c={iss:o,sub:t,aud:e,iat:s,exp:a},l=cD({header:i,payload:c}),u=LC.sign(l,r.secretKey.slice(0,32));return lD({header:i,payload:c,signature:u})}var ab=function(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))},dD=function(){function t(e,n,r){this.name=e,this.version=n,this.os=r,this.type="browser"}return t}(),fD=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),hD=function(){function t(e,n,r,s){this.name=e,this.version=n,this.os=r,this.bot=s,this.type="bot-device"}return t}(),pD=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),gD=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),mD=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,yD=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,cb=3,bD=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",mD]],lb=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function wD(t){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new gD:typeof navigator<"u"?vD(navigator.userAgent):_D()}function ED(t){return t!==""&&bD.reduce(function(e,n){var r=n[0],s=n[1];if(e)return e;var i=s.exec(t);return!!i&&[r,i]},!1)}function vD(t){var e=ED(t);if(!e)return null;var n=e[0],r=e[1];if(n==="searchbot")return new pD;var s=r[1]&&r[1].split(".").join("_").split("_").slice(0,3);s?s.length<cb&&(s=ab(ab([],s,!0),AD(cb-s.length),!0)):s=[];var i=s.join("."),o=CD(t),a=yD.exec(t);return a&&a[1]?new hD(n,i,o,a[1]):new dD(n,i,o)}function CD(t){for(var e=0,n=lb.length;e<n;e++){var r=lb[e],s=r[0],i=r[1],o=i.exec(t);if(o)return s}return null}function _D(){var t=typeof process<"u"&&process.version;return t?new fD(process.version.slice(1)):null}function AD(t){for(var e=[],n=0;n<t;n++)e.push("0");return e}var Xe={};Object.defineProperty(Xe,"__esModule",{value:!0});Xe.getLocalStorage=Xe.getLocalStorageOrThrow=Xe.getCrypto=Xe.getCryptoOrThrow=t_=Xe.getLocation=Xe.getLocationOrThrow=xg=Xe.getNavigator=Xe.getNavigatorOrThrow=Eo=Xe.getDocument=Xe.getDocumentOrThrow=Xe.getFromWindowOrThrow=Xe.getFromWindow=void 0;function Ro(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Xe.getFromWindow=Ro;function ka(t){const e=Ro(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Xe.getFromWindowOrThrow=ka;function ID(){return ka("document")}Xe.getDocumentOrThrow=ID;function SD(){return Ro("document")}var Eo=Xe.getDocument=SD;function xD(){return ka("navigator")}Xe.getNavigatorOrThrow=xD;function ND(){return Ro("navigator")}var xg=Xe.getNavigator=ND;function TD(){return ka("location")}Xe.getLocationOrThrow=TD;function OD(){return Ro("location")}var t_=Xe.getLocation=OD;function RD(){return ka("crypto")}Xe.getCryptoOrThrow=RD;function PD(){return Ro("crypto")}Xe.getCrypto=PD;function kD(){return ka("localStorage")}Xe.getLocalStorageOrThrow=kD;function DD(){return Ro("localStorage")}Xe.getLocalStorage=DD;var Ng={};Object.defineProperty(Ng,"__esModule",{value:!0});var n_=Ng.getWindowMetadata=void 0;const ub=Xe;function $D(){let t,e;try{t=ub.getDocumentOrThrow(),e=ub.getLocationOrThrow()}catch{return null}function n(){const d=t.getElementsByTagName("link"),f=[];for(let h=0;h<d.length;h++){const p=d[h],g=p.getAttribute("rel");if(g&&g.toLowerCase().indexOf("icon")>-1){const m=p.getAttribute("href");if(m)if(m.toLowerCase().indexOf("https:")===-1&&m.toLowerCase().indexOf("http:")===-1&&m.indexOf("//")!==0){let E=e.protocol+"//"+e.host;if(m.indexOf("/")===0)E+=m;else{const A=e.pathname.split("/");A.pop();const b=A.join("/");E+=b+"/"+m}f.push(E)}else if(m.indexOf("//")===0){const E=e.protocol+m;f.push(E)}else f.push(m)}}return f}function r(...d){const f=t.getElementsByTagName("meta");for(let h=0;h<f.length;h++){const p=f[h],g=["itemprop","property","name"].map(m=>p.getAttribute(m)).filter(m=>m?d.includes(m):!1);if(g.length&&g){const m=p.getAttribute("content");if(m)return m}}return""}function s(){let d=r("name","og:site_name","og:title","twitter:title");return d||(d=t.title),d}function i(){return r("description","og:description","twitter:description","keywords")}const o=s(),a=i(),c=e.origin,l=n();return{description:a,url:c,icons:l,name:o}}n_=Ng.getWindowMetadata=$D;const UD="0.1.1";function BD(){return UD}let ht=class Jp extends Error{constructor(e,n={}){const r=(()=>{var c;if(n.cause instanceof Jp){if(n.cause.details)return n.cause.details;if(n.cause.shortMessage)return n.cause.shortMessage}return n.cause&&"details"in n.cause&&typeof n.cause.details=="string"?n.cause.details:(c=n.cause)!=null&&c.message?n.cause.message:n.details})(),s=n.cause instanceof Jp&&n.cause.docsPath||n.docsPath,o=`https://oxlib.sh${s??""}`,a=[e||"An error occurred.",...n.metaMessages?["",...n.metaMessages]:[],...r||s?["",r?`Details: ${r}`:void 0,s?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${BD()}`}),this.cause=n.cause,this.details=r,this.docs=o,this.docsPath=s,this.shortMessage=e}walk(e){return r_(this,e)}};function r_(t,e){return e!=null&&e(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause?r_(t.cause,e):e?null:t}const Fo=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function LD(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function ll(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function vo(t,...e){if(!LD(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function MD(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");ll(t.outputLen),ll(t.blockLen)}function _a(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function s_(t,e){vo(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function FD(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Aa(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function yh(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Pr(t,e){return t<<32-e|t>>>e}const jD=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function HD(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function WD(t){for(let e=0;e<t.length;e++)t[e]=HD(t[e]);return t}const db=jD?t=>t:WD;function zD(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function ff(t){return typeof t=="string"&&(t=zD(t)),vo(t),t}function qD(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];vo(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}class Tg{}function i_(t){const e=r=>t().update(ff(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function VD(t=32){if(Fo&&typeof Fo.getRandomValues=="function")return Fo.getRandomValues(new Uint8Array(t));if(Fo&&typeof Fo.randomBytes=="function")return Uint8Array.from(Fo.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function KD(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}function GD(t,e,n){return t&e^~t&n}function YD(t,e,n){return t&e^t&n^e&n}class ZD extends Tg{constructor(e,n,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(e),this.view=yh(this.buffer)}update(e){_a(this),e=ff(e),vo(e);const{view:n,buffer:r,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=yh(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){_a(this),s_(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,Aa(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;KD(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=yh(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%n&&e.buffer.set(r),e}clone(){return this._cloneInto()}}const Vs=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),fu=BigInt(2**32-1),fb=BigInt(32);function JD(t,e=!1){return e?{h:Number(t&fu),l:Number(t>>fb&fu)}:{h:Number(t>>fb&fu)|0,l:Number(t&fu)|0}}function XD(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=JD(t[i],e);[r[i],s[i]]=[o,a]}return[r,s]}const QD=(t,e,n)=>t<<n|e>>>32-n,e$=(t,e,n)=>e<<n|t>>>32-n,t$=(t,e,n)=>e<<n-32|t>>>64-n,n$=(t,e,n)=>t<<n-32|e>>>64-n,r$=BigInt(0),qa=BigInt(1),s$=BigInt(2),i$=BigInt(7),o$=BigInt(256),a$=BigInt(113),o_=[],a_=[],c_=[];for(let t=0,e=qa,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],o_.push(2*(5*r+n)),a_.push((t+1)*(t+2)/2%64);let s=r$;for(let i=0;i<7;i++)e=(e<<qa^(e>>i$)*a$)%o$,e&s$&&(s^=qa<<(qa<<BigInt(i))-qa);c_.push(s)}const l_=XD(c_,!0),c$=l_[0],l$=l_[1],hb=(t,e,n)=>n>32?t$(t,e,n):QD(t,e,n),pb=(t,e,n)=>n>32?n$(t,e,n):e$(t,e,n);function u$(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=hb(l,u,1)^n[a],f=pb(l,u,1)^n[a+1];for(let h=0;h<50;h+=10)t[o+h]^=d,t[o+h+1]^=f}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=a_[o],c=hb(s,i,a),l=pb(s,i,a),u=o_[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=c$[r],t[1]^=l$[r]}Aa(n)}class Og extends Tg{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,ll(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=FD(this.state)}clone(){return this._cloneInto()}keccak(){db(this.state32),u$(this.state32,this.rounds),db(this.state32),this.posOut=0,this.pos=0}update(e){_a(this),e=ff(e),vo(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,n&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){_a(this,!1),vo(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return ll(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(s_(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Aa(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new Og(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const d$=(t,e,n)=>i_(()=>new Og(e,t,n)),f$=d$(1,136,256/8),h$=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ks=new Uint32Array(64);class p$ extends ZD{constructor(e=32){super(64,e,8,!1),this.A=Vs[0]|0,this.B=Vs[1]|0,this.C=Vs[2]|0,this.D=Vs[3]|0,this.E=Vs[4]|0,this.F=Vs[5]|0,this.G=Vs[6]|0,this.H=Vs[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,n,r,s,i,o,a,c]}set(e,n,r,s,i,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)Ks[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const f=Ks[d-15],h=Ks[d-2],p=Pr(f,7)^Pr(f,18)^f>>>3,g=Pr(h,17)^Pr(h,19)^h>>>10;Ks[d]=g+Ks[d-7]+p+Ks[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const f=Pr(a,6)^Pr(a,11)^Pr(a,25),h=u+f+GD(a,c,l)+h$[d]+Ks[d]|0,g=(Pr(r,2)^Pr(r,13)^Pr(r,22))+YD(r,s,i)|0;u=l,l=c,c=a,a=o+h|0,o=i,i=s,s=r,r=h+g|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){Aa(Ks)}destroy(){this.set(0,0,0,0,0,0,0,0),Aa(this.buffer)}}const g$=i_(()=>new p$);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Rg=BigInt(0),Xp=BigInt(1);function Bl(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Pg(t){if(!Bl(t))throw new Error("Uint8Array expected")}function ul(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}function hu(t){const e=t.toString(16);return e.length&1?"0"+e:e}function u_(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Rg:BigInt("0x"+t)}const d_=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",m$=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function dl(t){if(Pg(t),d_)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=m$[t[n]];return e}const os={_0:48,_9:57,A:65,F:70,a:97,f:102};function gb(t){if(t>=os._0&&t<=os._9)return t-os._0;if(t>=os.A&&t<=os.F)return t-(os.A-10);if(t>=os.a&&t<=os.f)return t-(os.a-10)}function Cd(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(d_)return Uint8Array.fromHex(t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=gb(t.charCodeAt(i)),a=gb(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function oo(t){return u_(dl(t))}function f_(t){return Pg(t),u_(dl(Uint8Array.from(t).reverse()))}function Ll(t,e){return Cd(t.toString(16).padStart(e*2,"0"))}function h_(t,e){return Ll(t,e).reverse()}function Xn(t,e,n){let r;if(typeof e=="string")try{r=Cd(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(Bl(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}function _d(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Pg(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}const bh=t=>typeof t=="bigint"&&Rg<=t;function kg(t,e,n){return bh(t)&&bh(e)&&bh(n)&&e<=t&&t<n}function ia(t,e,n,r){if(!kg(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function y$(t){let e;for(e=0;t>Rg;t>>=Xp,e+=1);return e}const hf=t=>(Xp<<BigInt(t))-Xp,wh=t=>new Uint8Array(t),mb=t=>Uint8Array.from(t);function b$(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=wh(t),s=wh(t),i=0;const o=()=>{r.fill(1),s.fill(0),i=0},a=(...d)=>n(s,r,...d),c=(d=wh(0))=>{s=a(mb([0]),d),r=a(),d.length!==0&&(s=a(mb([1]),d),r=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const f=[];for(;d<e;){r=a();const h=r.slice();f.push(h),d+=r.length}return _d(...f)};return(d,f)=>{o(),c(d);let h;for(;!(h=f(l()));)c();return o(),h}}const w$={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Bl(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function pf(t,e,n={}){const r=(s,i,o)=>{const a=w$[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return t}function yb(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}function E$(t,e){if(vb(t)>e)throw new j$({givenSize:vb(t),maxSize:e})}const as={zero:48,nine:57,A:65,F:70,a:97,f:102};function bb(t){if(t>=as.zero&&t<=as.nine)return t-as.zero;if(t>=as.A&&t<=as.F)return t-(as.A-10);if(t>=as.a&&t<=as.f)return t-(as.a-10)}function v$(t,e={}){const{dir:n,size:r=32}=e;if(r===0)return t;if(t.length>r)throw new H$({size:t.length,targetSize:r,type:"Bytes"});const s=new Uint8Array(r);for(let i=0;i<r;i++){const o=n==="right";s[o?i:r-i-1]=t[o?i:t.length-i-1]}return s}function p_(t,e){if(Ti(t)>e)throw new R$({givenSize:Ti(t),maxSize:e})}function C$(t,e){if(typeof e=="number"&&e>0&&e>Ti(t)-1)throw new y_({offset:e,position:"start",size:Ti(t)})}function _$(t,e,n){if(typeof e=="number"&&typeof n=="number"&&Ti(t)!==n-e)throw new y_({offset:n,position:"end",size:Ti(t)})}function g_(t,e={}){const{dir:n,size:r=32}=e;if(r===0)return t;const s=t.replace("0x","");if(s.length>r*2)throw new P$({size:Math.ceil(s.length/2),targetSize:r,type:"Hex"});return`0x${s[n==="right"?"padEnd":"padStart"](r*2,"0")}`}const A$="#__bigint";function Dg(t,e,n){return JSON.stringify(t,(r,s)=>typeof s=="bigint"?s.toString()+A$:s,n)}const I$=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function S$(t,e={}){const{strict:n=!1}=e;if(!t)throw new wb(t);if(typeof t!="string")throw new wb(t);if(n&&!/^0x[0-9a-fA-F]*$/.test(t))throw new Eb(t);if(!t.startsWith("0x"))throw new Eb(t)}function x$(...t){return`0x${t.reduce((e,n)=>e+n.replace("0x",""),"")}`}function $g(t){return t instanceof Uint8Array?Ad(t):Array.isArray(t)?Ad(new Uint8Array(t)):t}function Ad(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=I$[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(p_(r,e.size),m_(r,e.size)):r}function Eh(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const l=typeof t=="bigint"?"n":"";throw new O$({max:i?`${i}${l}`:void 0,min:`${o}${l}`,signed:n,size:r,value:`${t}${l}`})}const c=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?N$(c,r):c}function N$(t,e){return g_(t,{dir:"left",size:e})}function m_(t,e){return g_(t,{dir:"right",size:e})}function ms(t,e,n,r={}){const{strict:s}=r;C$(t,e);const i=`0x${t.replace("0x","").slice((e??0)*2,(n??t.length)*2)}`;return s&&_$(i,e,n),i}function Ti(t){return Math.ceil((t.length-2)/2)}function T$(t,e={}){const{strict:n=!1}=e;try{return S$(t,{strict:n}),!0}catch{return!1}}class O$ extends ht{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number \`${i}\` is not in safe${s?` ${s*8}-bit`:""}${r?" signed":" unsigned"} integer range ${e?`(\`${n}\` to \`${e}\`)`:`(above \`${n}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class wb extends ht{constructor(e){super(`Value \`${typeof e=="object"?Dg(e):e}\` of type \`${typeof e}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}}class Eb extends ht{constructor(e){super(`Value \`${e}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}}let R$=class extends ht{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}};class y_ extends ht{constructor({offset:e,position:n,size:r}){super(`Slice ${n==="start"?"starting":"ending"} at offset \`${e}\` is out-of-bounds (size: \`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}}let P$=class extends ht{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}};const k$=new TextEncoder;function D$(t){if(!(t instanceof Uint8Array)){if(!t)throw new pu(t);if(typeof t!="object")throw new pu(t);if(!("BYTES_PER_ELEMENT"in t))throw new pu(t);if(t.BYTES_PER_ELEMENT!==1||t.constructor.name!=="Uint8Array")throw new pu(t)}}function $$(t){return t instanceof Uint8Array?t:typeof t=="string"?B$(t):U$(t)}function U$(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function B$(t,e={}){const{size:n}=e;let r=t;n&&(p_(t,n),r=m_(t,n));let s=r.slice(2);s.length%2&&(s=`0${s}`);const i=s.length/2,o=new Uint8Array(i);for(let a=0,c=0;a<i;a++){const l=bb(s.charCodeAt(c++)),u=bb(s.charCodeAt(c++));if(l===void 0||u===void 0)throw new ht(`Invalid byte sequence ("${s[c-2]}${s[c-1]}" in "${s}").`);o[a]=l*16+u}return o}function L$(t,e={}){const{size:n}=e,r=k$.encode(t);return typeof n=="number"?(E$(r,n),M$(r,n)):r}function M$(t,e){return v$(t,{dir:"right",size:e})}function vb(t){return t.length}function F$(t){try{return D$(t),!0}catch{return!1}}class pu extends ht{constructor(e){super(`Value \`${typeof e=="object"?Dg(e):e}\` of type \`${typeof e}\` is an invalid Bytes value.`,{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"})}}class j$ extends ht{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class H$ extends ht{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}function b_(t,e={}){const{as:n=typeof t=="string"?"Hex":"Bytes"}=e,r=f$($$(t));return n==="Bytes"?r:Ad(r)}class W$ extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&n!==void 0&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}}const z$={checksum:new W$(8192)},vh=z$.checksum;function w_(t,e={}){const{compressed:n}=e,{prefix:r,x:s,y:i}=t;if(n===!1||typeof s=="bigint"&&typeof i=="bigint"){if(r!==4)throw new Cb({prefix:r,cause:new Z$});return}if(n===!0||typeof s=="bigint"&&typeof i>"u"){if(r!==3&&r!==2)throw new Cb({prefix:r,cause:new Y$});return}throw new G$({publicKey:t})}function q$(t){const e=(()=>{if(T$(t))return E_(t);if(F$(t))return V$(t);const{prefix:n,x:r,y:s}=t;return typeof r=="bigint"&&typeof s=="bigint"?{prefix:n??4,x:r,y:s}:{prefix:n,x:r}})();return w_(e),e}function V$(t){return E_(Ad(t))}function E_(t){if(t.length!==132&&t.length!==130&&t.length!==68)throw new J$({publicKey:t});if(t.length===130){const r=BigInt(ms(t,0,32)),s=BigInt(ms(t,32,64));return{prefix:4,x:r,y:s}}if(t.length===132){const r=Number(ms(t,0,1)),s=BigInt(ms(t,1,33)),i=BigInt(ms(t,33,65));return{prefix:r,x:s,y:i}}const e=Number(ms(t,0,1)),n=BigInt(ms(t,1,33));return{prefix:e,x:n}}function K$(t,e={}){w_(t);const{prefix:n,x:r,y:s}=t,{includePrefix:i=!0}=e;return x$(i?Eh(n,{size:1}):"0x",Eh(r,{size:32}),typeof s=="bigint"?Eh(s,{size:32}):"0x")}class G$ extends ht{constructor({publicKey:e}){super(`Value \`${Dg(e)}\` is not a valid public key.`,{metaMessages:["Public key must contain:","- an `x` and `prefix` value (compressed)","- an `x`, `y`, and `prefix` value (uncompressed)"]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidError"})}}class Cb extends ht{constructor({prefix:e,cause:n}){super(`Prefix "${e}" is invalid.`,{cause:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidPrefixError"})}}class Y$ extends ht{constructor(){super("Prefix must be 2 or 3 for compressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidCompressedPrefixError"})}}class Z$ extends ht{constructor(){super("Prefix must be 4 for uncompressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidUncompressedPrefixError"})}}let J$=class extends ht{constructor({publicKey:e}){super(`Value \`${e}\` is an invalid public key size.`,{metaMessages:["Expected: 33 bytes (compressed + prefix), 64 bytes (uncompressed) or 65 bytes (uncompressed + prefix).",`Received ${Ti($g(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidSerializedSizeError"})}};const X$=/^0x[a-fA-F0-9]{40}$/;function v_(t,e={}){const{strict:n=!0}=e;if(!X$.test(t))throw new _b({address:t,cause:new tU});if(n){if(t.toLowerCase()===t)return;if(C_(t)!==t)throw new _b({address:t,cause:new nU})}}function C_(t){if(vh.has(t))return vh.get(t);v_(t,{strict:!1});const e=t.substring(2).toLowerCase(),n=b_(L$(e),{as:"Bytes"}),r=e.split("");for(let i=0;i<40;i+=2)n[i>>1]>>4>=8&&r[i]&&(r[i]=r[i].toUpperCase()),(n[i>>1]&15)>=8&&r[i+1]&&(r[i+1]=r[i+1].toUpperCase());const s=`0x${r.join("")}`;return vh.set(t,s),s}function Q$(t,e={}){const{checksum:n=!1}=e;return v_(t),n?C_(t):t}function eU(t,e={}){const n=b_(`0x${K$(t).slice(4)}`).substring(26);return Q$(`0x${n}`,e)}class _b extends ht{constructor({address:e,cause:n}){super(`Address "${e}" is invalid.`,{cause:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class tU extends ht{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class nU extends ht{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}class __ extends Tg{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,MD(e);const r=ff(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Aa(i)}update(e){return _a(this),this.iHash.update(e),this}digestInto(e){_a(this),vo(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const A_=(t,e,n)=>new __(t,e).update(n).digest();A_.create=(t,e)=>new __(t,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const An=BigInt(0),cn=BigInt(1),Xi=BigInt(2),rU=BigInt(3),I_=BigInt(4),S_=BigInt(5),x_=BigInt(8);function vn(t,e){const n=t%e;return n>=An?n:e+n}function Vn(t,e,n){let r=t;for(;e-- >An;)r*=r,r%=n;return r}function Qp(t,e){if(t===An)throw new Error("invert: expected non-zero number");if(e<=An)throw new Error("invert: expected positive modulus, got "+e);let n=vn(t,e),r=e,s=An,i=cn;for(;n!==An;){const a=r/n,c=r%n,l=s-i*a;r=n,n=c,s=i,i=l}if(r!==cn)throw new Error("invert: does not exist");return vn(s,e)}function N_(t,e){const n=(t.ORDER+cn)/I_,r=t.pow(e,n);if(!t.eql(t.sqr(r),e))throw new Error("Cannot find square root");return r}function sU(t,e){const n=(t.ORDER-S_)/x_,r=t.mul(e,Xi),s=t.pow(r,n),i=t.mul(e,s),o=t.mul(t.mul(i,Xi),s),a=t.mul(i,t.sub(o,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function iU(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-cn,n=0;for(;e%Xi===An;)e/=Xi,n++;let r=Xi;const s=Ug(t);for(;Ab(s,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return N_;let i=s.pow(r,e);const o=(e+cn)/Xi;return function(c,l){if(c.is0(l))return l;if(Ab(c,l)!==1)throw new Error("Cannot find square root");let u=n,d=c.mul(c.ONE,i),f=c.pow(l,e),h=c.pow(l,o);for(;!c.eql(f,c.ONE);){if(c.is0(f))return c.ZERO;let p=1,g=c.sqr(f);for(;!c.eql(g,c.ONE);)if(p++,g=c.sqr(g),p===u)throw new Error("Cannot find square root");const m=cn<<BigInt(u-p-1),E=c.pow(d,m);u=p,d=c.sqr(E),f=c.mul(f,d),h=c.mul(h,E)}return h}}function oU(t){return t%I_===rU?N_:t%x_===S_?sU:iU(t)}const aU=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function cU(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=aU.reduce((r,s)=>(r[s]="function",r),e);return pf(t,n)}function lU(t,e,n){if(n<An)throw new Error("invalid exponent, negatives unsupported");if(n===An)return t.ONE;if(n===cn)return e;let r=t.ONE,s=e;for(;n>An;)n&cn&&(r=t.mul(r,s)),s=t.sqr(s),n>>=cn;return r}function T_(t,e,n=!1){const r=new Array(e.length).fill(n?t.ZERO:void 0),s=e.reduce((o,a,c)=>t.is0(a)?o:(r[c]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,c)=>t.is0(a)?o:(r[c]=t.mul(o,r[c]),t.mul(o,a)),i),r}function Ab(t,e){const n=(t.ORDER-cn)/Xi,r=t.pow(e,n),s=t.eql(r,t.ONE),i=t.eql(r,t.ZERO),o=t.eql(r,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function O_(t,e){e!==void 0&&ll(e);const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Ug(t,e,n=!1,r={}){if(t<=An)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=O_(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:n,BITS:s,BYTES:i,MASK:hf(s),ZERO:An,ONE:cn,create:c=>vn(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return An<=c&&c<t},is0:c=>c===An,isOdd:c=>(c&cn)===cn,neg:c=>vn(-c,t),eql:(c,l)=>c===l,sqr:c=>vn(c*c,t),add:(c,l)=>vn(c+l,t),sub:(c,l)=>vn(c-l,t),mul:(c,l)=>vn(c*l,t),pow:(c,l)=>lU(a,c,l),div:(c,l)=>vn(c*Qp(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Qp(c,t),sqrt:r.sqrt||(c=>(o||(o=oU(t)),o(a,c))),toBytes:c=>n?h_(c,i):Ll(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return n?f_(c):oo(c)},invertBatch:c=>T_(a,c),cmov:(c,l,u)=>u?l:c});return Object.freeze(a)}function R_(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function P_(t){const e=R_(t);return e+Math.ceil(e/2)}function uU(t,e,n=!1){const r=t.length,s=R_(e),i=P_(e);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?f_(t):oo(t),a=vn(o,e-cn)+cn;return n?h_(a,s):Ll(a,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ib=BigInt(0),e0=BigInt(1);function Ch(t,e){const n=e.negate();return t?n:e}function k_(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function _h(t,e){k_(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1),s=2**t,i=hf(t),o=BigInt(t);return{windows:n,windowSize:r,mask:i,maxNumber:s,shiftBy:o}}function Sb(t,e,n){const{windowSize:r,mask:s,maxNumber:i,shiftBy:o}=n;let a=Number(t&s),c=t>>o;a>r&&(a-=i,c+=e0);const l=e*r,u=l+Math.abs(a)-1,d=a===0,f=a<0,h=e%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:f,isNegF:h,offsetF:l}}function dU(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function fU(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const Ah=new WeakMap,D_=new WeakMap;function Ih(t){return D_.get(t)||1}function hU(t,e){return{constTimeNegate:Ch,hasPrecomputes(n){return Ih(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>Ib;)r&e0&&(s=s.add(i)),i=i.double(),r>>=e0;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=_h(r,e),o=[];let a=n,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){let i=t.ZERO,o=t.BASE;const a=_h(n,e);for(let c=0;c<a.windows;c++){const{nextN:l,offset:u,isZero:d,isNeg:f,isNegF:h,offsetF:p}=Sb(s,c,a);s=l,d?o=o.add(Ch(h,r[p])):i=i.add(Ch(f,r[u]))}return{p:i,f:o}},wNAFUnsafe(n,r,s,i=t.ZERO){const o=_h(n,e);for(let a=0;a<o.windows&&s!==Ib;a++){const{nextN:c,offset:l,isZero:u,isNeg:d}=Sb(s,a,o);if(s=c,!u){const f=r[l];i=i.add(d?f.negate():f)}}return i},getPrecomputes(n,r,s){let i=Ah.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&Ah.set(r,s(i))),i},wNAFCached(n,r,s){const i=Ih(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=Ih(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){k_(r,e),D_.set(n,r),Ah.delete(n)}}}function pU(t,e,n,r){dU(n,t),fU(r,e);const s=n.length,i=r.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=y$(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=hf(c),u=new Array(Number(l)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c;let f=o;for(let h=d;h>=0;h-=c){u.fill(o);for(let g=0;g<i;g++){const m=r[g],E=Number(m>>BigInt(h)&l);u[E]=u[E].add(n[g])}let p=o;for(let g=u.length-1,m=o;g>0;g--)m=m.add(u[g]),p=p.add(m);if(f=f.add(p),h!==0)for(let g=0;g<c;g++)f=f.double()}return f}function $_(t){return cU(t.Fp),pf(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...O_(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function xb(t){t.lowS!==void 0&&ul("lowS",t.lowS),t.prehash!==void 0&&ul("prehash",t.prehash)}function gU(t){const e=$_(t);pf(e,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:n,Fp:r,a:s}=e;if(n){if(!r.eql(s,r.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...e})}class mU extends Error{constructor(e=""){super(e)}}const ws={Err:mU,_tlv:{encode:(t,e)=>{const{Err:n}=ws;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length&1)throw new n("tlv.encode: unpadded data");const r=e.length/2,s=hu(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?hu(s.length/2|128):"";return hu(t)+i+s+e},decode(t,e){const{Err:n}=ws;let r=0;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length<2||e[r++]!==t)throw new n("tlv.decode: wrong tlv");const s=e[r++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");const l=e.subarray(r,r+c);if(l.length!==c)throw new n("tlv.decode: length bytes not complete");if(l[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(r+=c,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=e.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:e.subarray(r+o)}}},_int:{encode(t){const{Err:e}=ws;if(t<vs)throw new e("integer: negative integers are not allowed");let n=hu(t);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return n},decode(t){const{Err:e}=ws;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return oo(t)}},toSig(t){const{Err:e,_int:n,_tlv:r}=ws,s=Xn("signature",t),{v:i,l:o}=r.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,i),{v:l,l:u}=r.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(l)}},hexFromSig(t){const{_tlv:e,_int:n}=ws,r=e.encode(2,n.encode(t.r)),s=e.encode(2,n.encode(t.s)),i=r+s;return e.encode(48,i)}};function Sh(t,e){return dl(Ll(t,e))}const vs=BigInt(0),Ot=BigInt(1);BigInt(2);const xh=BigInt(3),yU=BigInt(4);function bU(t){const e=gU(t),{Fp:n}=e,r=Ug(e.n,e.nBitLength),s=e.toBytes||((b,_,C)=>{const S=_.toAffine();return _d(Uint8Array.from([4]),n.toBytes(S.x),n.toBytes(S.y))}),i=e.fromBytes||(b=>{const _=b.subarray(1),C=n.fromBytes(_.subarray(0,n.BYTES)),S=n.fromBytes(_.subarray(n.BYTES,2*n.BYTES));return{x:C,y:S}});function o(b){const{a:_,b:C}=e,S=n.sqr(b),x=n.mul(S,b);return n.add(n.add(x,n.mul(b,_)),C)}function a(b,_){const C=n.sqr(_),S=o(b);return n.eql(C,S)}if(!a(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const c=n.mul(n.pow(e.a,xh),yU),l=n.mul(n.sqr(e.b),BigInt(27));if(n.is0(n.add(c,l)))throw new Error("bad curve params: a or b");function u(b){return kg(b,Ot,e.n)}function d(b){const{allowedPrivateKeyLengths:_,nByteLength:C,wrapPrivateKey:S,n:x}=e;if(_&&typeof b!="bigint"){if(Bl(b)&&(b=dl(b)),typeof b!="string"||!_.includes(b.length))throw new Error("invalid private key");b=b.padStart(C*2,"0")}let P;try{P=typeof b=="bigint"?b:oo(Xn("private key",b,C))}catch{throw new Error("invalid private key, expected hex or "+C+" bytes, got "+typeof b)}return S&&(P=vn(P,x)),ia("private key",P,Ot,x),P}function f(b){if(!(b instanceof g))throw new Error("ProjectivePoint expected")}const h=yb((b,_)=>{const{px:C,py:S,pz:x}=b;if(n.eql(x,n.ONE))return{x:C,y:S};const P=b.is0();_==null&&(_=P?n.ONE:n.inv(x));const N=n.mul(C,_),L=n.mul(S,_),M=n.mul(x,_);if(P)return{x:n.ZERO,y:n.ZERO};if(!n.eql(M,n.ONE))throw new Error("invZ was invalid");return{x:N,y:L}}),p=yb(b=>{if(b.is0()){if(e.allowInfinityPoint&&!n.is0(b.py))return;throw new Error("bad point: ZERO")}const{x:_,y:C}=b.toAffine();if(!n.isValid(_)||!n.isValid(C))throw new Error("bad point: x or y not FE");if(!a(_,C))throw new Error("bad point: equation left != right");if(!b.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class g{constructor(_,C,S){if(_==null||!n.isValid(_))throw new Error("x required");if(C==null||!n.isValid(C)||n.is0(C))throw new Error("y required");if(S==null||!n.isValid(S))throw new Error("z required");this.px=_,this.py=C,this.pz=S,Object.freeze(this)}static fromAffine(_){const{x:C,y:S}=_||{};if(!_||!n.isValid(C)||!n.isValid(S))throw new Error("invalid affine point");if(_ instanceof g)throw new Error("projective point not allowed");const x=P=>n.eql(P,n.ZERO);return x(C)&&x(S)?g.ZERO:new g(C,S,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(_){const C=T_(n,_.map(S=>S.pz));return _.map((S,x)=>S.toAffine(C[x])).map(g.fromAffine)}static fromHex(_){const C=g.fromAffine(i(Xn("pointHex",_)));return C.assertValidity(),C}static fromPrivateKey(_){return g.BASE.multiply(d(_))}static msm(_,C){return pU(g,r,_,C)}_setWindowSize(_){A.setWindowSize(this,_)}assertValidity(){p(this)}hasEvenY(){const{y:_}=this.toAffine();if(n.isOdd)return!n.isOdd(_);throw new Error("Field doesn't support isOdd")}equals(_){f(_);const{px:C,py:S,pz:x}=this,{px:P,py:N,pz:L}=_,M=n.eql(n.mul(C,L),n.mul(P,x)),U=n.eql(n.mul(S,L),n.mul(N,x));return M&&U}negate(){return new g(this.px,n.neg(this.py),this.pz)}double(){const{a:_,b:C}=e,S=n.mul(C,xh),{px:x,py:P,pz:N}=this;let L=n.ZERO,M=n.ZERO,U=n.ZERO,O=n.mul(x,x),$=n.mul(P,P),y=n.mul(N,N),w=n.mul(x,P);return w=n.add(w,w),U=n.mul(x,N),U=n.add(U,U),L=n.mul(_,U),M=n.mul(S,y),M=n.add(L,M),L=n.sub($,M),M=n.add($,M),M=n.mul(L,M),L=n.mul(w,L),U=n.mul(S,U),y=n.mul(_,y),w=n.sub(O,y),w=n.mul(_,w),w=n.add(w,U),U=n.add(O,O),O=n.add(U,O),O=n.add(O,y),O=n.mul(O,w),M=n.add(M,O),y=n.mul(P,N),y=n.add(y,y),O=n.mul(y,w),L=n.sub(L,O),U=n.mul(y,$),U=n.add(U,U),U=n.add(U,U),new g(L,M,U)}add(_){f(_);const{px:C,py:S,pz:x}=this,{px:P,py:N,pz:L}=_;let M=n.ZERO,U=n.ZERO,O=n.ZERO;const $=e.a,y=n.mul(e.b,xh);let w=n.mul(C,P),T=n.mul(S,N),D=n.mul(x,L),R=n.add(C,S),k=n.add(P,N);R=n.mul(R,k),k=n.add(w,T),R=n.sub(R,k),k=n.add(C,x);let j=n.add(P,L);return k=n.mul(k,j),j=n.add(w,D),k=n.sub(k,j),j=n.add(S,x),M=n.add(N,L),j=n.mul(j,M),M=n.add(T,D),j=n.sub(j,M),O=n.mul($,k),M=n.mul(y,D),O=n.add(M,O),M=n.sub(T,O),O=n.add(T,O),U=n.mul(M,O),T=n.add(w,w),T=n.add(T,w),D=n.mul($,D),k=n.mul(y,k),T=n.add(T,D),D=n.sub(w,D),D=n.mul($,D),k=n.add(k,D),w=n.mul(T,k),U=n.add(U,w),w=n.mul(j,k),M=n.mul(R,M),M=n.sub(M,w),w=n.mul(R,T),O=n.mul(j,O),O=n.add(O,w),new g(M,U,O)}subtract(_){return this.add(_.negate())}is0(){return this.equals(g.ZERO)}wNAF(_){return A.wNAFCached(this,_,g.normalizeZ)}multiplyUnsafe(_){const{endo:C,n:S}=e;ia("scalar",_,vs,S);const x=g.ZERO;if(_===vs)return x;if(this.is0()||_===Ot)return this;if(!C||A.hasPrecomputes(this))return A.wNAFCachedUnsafe(this,_,g.normalizeZ);let{k1neg:P,k1:N,k2neg:L,k2:M}=C.splitScalar(_),U=x,O=x,$=this;for(;N>vs||M>vs;)N&Ot&&(U=U.add($)),M&Ot&&(O=O.add($)),$=$.double(),N>>=Ot,M>>=Ot;return P&&(U=U.negate()),L&&(O=O.negate()),O=new g(n.mul(O.px,C.beta),O.py,O.pz),U.add(O)}multiply(_){const{endo:C,n:S}=e;ia("scalar",_,Ot,S);let x,P;if(C){const{k1neg:N,k1:L,k2neg:M,k2:U}=C.splitScalar(_);let{p:O,f:$}=this.wNAF(L),{p:y,f:w}=this.wNAF(U);O=A.constTimeNegate(N,O),y=A.constTimeNegate(M,y),y=new g(n.mul(y.px,C.beta),y.py,y.pz),x=O.add(y),P=$.add(w)}else{const{p:N,f:L}=this.wNAF(_);x=N,P=L}return g.normalizeZ([x,P])[0]}multiplyAndAddUnsafe(_,C,S){const x=g.BASE,P=(L,M)=>M===vs||M===Ot||!L.equals(x)?L.multiplyUnsafe(M):L.multiply(M),N=P(this,C).add(P(_,S));return N.is0()?void 0:N}toAffine(_){return h(this,_)}isTorsionFree(){const{h:_,isTorsionFree:C}=e;if(_===Ot)return!0;if(C)return C(g,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:_,clearCofactor:C}=e;return _===Ot?this:C?C(g,this):this.multiplyUnsafe(e.h)}toRawBytes(_=!0){return ul("isCompressed",_),this.assertValidity(),s(g,this,_)}toHex(_=!0){return ul("isCompressed",_),dl(this.toRawBytes(_))}}g.BASE=new g(e.Gx,e.Gy,n.ONE),g.ZERO=new g(n.ZERO,n.ONE,n.ZERO);const{endo:m,nBitLength:E}=e,A=hU(g,m?Math.ceil(E/2):E);return{CURVE:e,ProjectivePoint:g,normPrivateKeyToScalar:d,weierstrassEquation:o,isWithinCurveOrder:u}}function wU(t){const e=$_(t);return pf(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function EU(t){const e=wU(t),{Fp:n,n:r,nByteLength:s,nBitLength:i}=e,o=n.BYTES+1,a=2*n.BYTES+1;function c(y){return vn(y,r)}function l(y){return Qp(y,r)}const{ProjectivePoint:u,normPrivateKeyToScalar:d,weierstrassEquation:f,isWithinCurveOrder:h}=bU({...e,toBytes(y,w,T){const D=w.toAffine(),R=n.toBytes(D.x),k=_d;return ul("isCompressed",T),T?k(Uint8Array.from([w.hasEvenY()?2:3]),R):k(Uint8Array.from([4]),R,n.toBytes(D.y))},fromBytes(y){const w=y.length,T=y[0],D=y.subarray(1);if(w===o&&(T===2||T===3)){const R=oo(D);if(!kg(R,Ot,n.ORDER))throw new Error("Point is not on curve");const k=f(R);let j;try{j=n.sqrt(k)}catch(K){const G=K instanceof Error?": "+K.message:"";throw new Error("Point is not on curve"+G)}const H=(j&Ot)===Ot;return(T&1)===1!==H&&(j=n.neg(j)),{x:R,y:j}}else if(w===a&&T===4){const R=n.fromBytes(D.subarray(0,n.BYTES)),k=n.fromBytes(D.subarray(n.BYTES,2*n.BYTES));return{x:R,y:k}}else{const R=o,k=a;throw new Error("invalid Point, expected length of "+R+", or uncompressed "+k+", got "+w)}}});function p(y){const w=r>>Ot;return y>w}function g(y){return p(y)?c(-y):y}const m=(y,w,T)=>oo(y.slice(w,T));class E{constructor(w,T,D){ia("r",w,Ot,r),ia("s",T,Ot,r),this.r=w,this.s=T,D!=null&&(this.recovery=D),Object.freeze(this)}static fromCompact(w){const T=s;return w=Xn("compactSignature",w,T*2),new E(m(w,0,T),m(w,T,2*T))}static fromDER(w){const{r:T,s:D}=ws.toSig(Xn("DER",w));return new E(T,D)}assertValidity(){}addRecoveryBit(w){return new E(this.r,this.s,w)}recoverPublicKey(w){const{r:T,s:D,recovery:R}=this,k=x(Xn("msgHash",w));if(R==null||![0,1,2,3].includes(R))throw new Error("recovery id invalid");const j=R===2||R===3?T+e.n:T;if(j>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const H=R&1?"03":"02",ee=u.fromHex(H+Sh(j,n.BYTES)),K=l(j),G=c(-k*K),ce=c(D*K),ge=u.BASE.multiplyAndAddUnsafe(ee,G,ce);if(!ge)throw new Error("point at infinify");return ge.assertValidity(),ge}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new E(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return Cd(this.toDERHex())}toDERHex(){return ws.hexFromSig(this)}toCompactRawBytes(){return Cd(this.toCompactHex())}toCompactHex(){const w=s;return Sh(this.r,w)+Sh(this.s,w)}}const A={isValidPrivateKey(y){try{return d(y),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{const y=P_(e.n);return uU(e.randomBytes(y),e.n)},precompute(y=8,w=u.BASE){return w._setWindowSize(y),w.multiply(BigInt(3)),w}};function b(y,w=!0){return u.fromPrivateKey(y).toRawBytes(w)}function _(y){if(typeof y=="bigint")return!1;if(y instanceof u)return!0;const T=Xn("key",y).length,D=n.BYTES,R=D+1,k=2*D+1;if(!(e.allowedPrivateKeyLengths||s===R))return T===R||T===k}function C(y,w,T=!0){if(_(y)===!0)throw new Error("first arg must be private key");if(_(w)===!1)throw new Error("second arg must be public key");return u.fromHex(w).multiply(d(y)).toRawBytes(T)}const S=e.bits2int||function(y){if(y.length>8192)throw new Error("input is too large");const w=oo(y),T=y.length*8-i;return T>0?w>>BigInt(T):w},x=e.bits2int_modN||function(y){return c(S(y))},P=hf(i);function N(y){return ia("num < 2^"+i,y,vs,P),Ll(y,s)}function L(y,w,T=M){if(["recovered","canonical"].some(pe=>pe in T))throw new Error("sign() legacy options not supported");const{hash:D,randomBytes:R}=e;let{lowS:k,prehash:j,extraEntropy:H}=T;k==null&&(k=!0),y=Xn("msgHash",y),xb(T),j&&(y=Xn("prehashed msgHash",D(y)));const ee=x(y),K=d(w),G=[N(K),N(ee)];if(H!=null&&H!==!1){const pe=H===!0?R(n.BYTES):H;G.push(Xn("extraEntropy",pe))}const ce=_d(...G),ge=ee;function Ne(pe){const Re=S(pe);if(!h(Re))return;const st=l(Re),wt=u.BASE.multiply(Re).toAffine(),St=c(wt.x);if(St===vs)return;const tn=c(st*c(ge+St*K));if(tn===vs)return;let Qr=(wt.x===St?0:2)|Number(wt.y&Ot),Bs=tn;return k&&p(tn)&&(Bs=g(tn),Qr^=1),new E(St,Bs,Qr)}return{seed:ce,k2sig:Ne}}const M={lowS:e.lowS,prehash:!1},U={lowS:e.lowS,prehash:!1};function O(y,w,T=M){const{seed:D,k2sig:R}=L(y,w,T),k=e;return b$(k.hash.outputLen,k.nByteLength,k.hmac)(D,R)}u.BASE._setWindowSize(8);function $(y,w,T,D=U){var Qr;const R=y;w=Xn("msgHash",w),T=Xn("publicKey",T);const{lowS:k,prehash:j,format:H}=D;if(xb(D),"strict"in D)throw new Error("options.strict was renamed to lowS");if(H!==void 0&&H!=="compact"&&H!=="der")throw new Error("format must be compact or der");const ee=typeof R=="string"||Bl(R),K=!ee&&!H&&typeof R=="object"&&R!==null&&typeof R.r=="bigint"&&typeof R.s=="bigint";if(!ee&&!K)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let G,ce;try{if(K&&(G=new E(R.r,R.s)),ee){try{H!=="compact"&&(G=E.fromDER(R))}catch(Bs){if(!(Bs instanceof ws.Err))throw Bs}!G&&H!=="der"&&(G=E.fromCompact(R))}ce=u.fromHex(T)}catch{return!1}if(!G||k&&G.hasHighS())return!1;j&&(w=e.hash(w));const{r:ge,s:Ne}=G,pe=x(w),Re=l(Ne),st=c(pe*Re),wt=c(ge*Re),St=(Qr=u.BASE.multiplyAndAddUnsafe(ce,st,wt))==null?void 0:Qr.toAffine();return St?c(St.x)===ge:!1}return{CURVE:e,getPublicKey:b,getSharedSecret:C,sign:O,verify:$,ProjectivePoint:u,Signature:E,utils:A}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function vU(t){return{hash:t,hmac:(e,...n)=>A_(t,e,qD(...n)),randomBytes:VD}}function CU(t,e){const n=r=>EU({...t,...vU(r)});return{...n(e),create:n}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const U_=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Nb=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),_U=BigInt(0),AU=BigInt(1),t0=BigInt(2),Tb=(t,e)=>(t+e/t0)/e;function IU(t){const e=U_,n=BigInt(3),r=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=t*t*t%e,u=l*l*t%e,d=Vn(u,n,e)*u%e,f=Vn(d,n,e)*u%e,h=Vn(f,t0,e)*l%e,p=Vn(h,s,e)*h%e,g=Vn(p,i,e)*p%e,m=Vn(g,a,e)*g%e,E=Vn(m,c,e)*m%e,A=Vn(E,a,e)*g%e,b=Vn(A,n,e)*u%e,_=Vn(b,o,e)*p%e,C=Vn(_,r,e)*l%e,S=Vn(C,t0,e);if(!n0.eql(n0.sqr(S),t))throw new Error("Cannot find square root");return S}const n0=Ug(U_,void 0,void 0,{sqrt:IU}),SU=CU({a:_U,b:BigInt(7),Fp:n0,n:Nb,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=Nb,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-AU*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,o=BigInt("0x100000000000000000000000000000000"),a=Tb(i*t,e),c=Tb(-r*t,e);let l=vn(t-a*n-c*s,e),u=vn(-a*r-c*i,e);const d=l>o,f=u>o;if(d&&(l=e-l),f&&(u=e-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:d,k1:l,k2neg:f,k2:u}}}},g$);function xU(t){if(t.length!==130&&t.length!==132)throw new TU({signature:t});const e=BigInt(ms(t,0,32)),n=BigInt(ms(t,32,64)),r=(()=>{const s=+`0x${t.slice(130)}`;if(!Number.isNaN(s))try{return NU(s)}catch{throw new OU({value:s})}})();return typeof r>"u"?{r:e,s:n}:{r:e,s:n,yParity:r}}function NU(t){if(t===0||t===27)return 0;if(t===1||t===28)return 1;if(t>=35)return t%2===0?1:0;throw new RU({value:t})}class TU extends ht{constructor({signature:e}){super(`Value \`${e}\` is an invalid signature size.`,{metaMessages:["Expected: 64 bytes or 65 bytes.",`Received ${Ti($g(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"})}}class OU extends ht{constructor({value:e}){super(`Value \`${e}\` is an invalid y-parity value. Y-parity must be 0 or 1.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"})}}class RU extends ht{constructor({value:e}){super(`Value \`${e}\` is an invalid v value. v must be 27, 28 or >=35.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"})}}/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function PU(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function B_(t,e){return Array.isArray(e)?e.length===0?!0:t?e.every(n=>typeof n=="string"):e.every(n=>Number.isSafeInteger(n)):!1}function Id(t,e){if(typeof e!="string")throw new Error(`${t}: string expected`);return!0}function Bg(t){if(!Number.isSafeInteger(t))throw new Error(`invalid integer: ${t}`)}function r0(t){if(!Array.isArray(t))throw new Error("array expected")}function Sd(t,e){if(!B_(!0,e))throw new Error(`${t}: array of strings expected`)}function kU(t,e){if(!B_(!1,e))throw new Error(`${t}: array of numbers expected`)}function DU(...t){const e=i=>i,n=(i,o)=>a=>i(o(a)),r=t.map(i=>i.encode).reduceRight(n,e),s=t.map(i=>i.decode).reduce(n,e);return{encode:r,decode:s}}function $U(t){const e=typeof t=="string"?t.split(""):t,n=e.length;Sd("alphabet",e);const r=new Map(e.map((s,i)=>[s,i]));return{encode:s=>(r0(s),s.map(i=>{if(!Number.isSafeInteger(i)||i<0||i>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${i}". Allowed: ${t}`);return e[i]})),decode:s=>(r0(s),s.map(i=>{Id("alphabet.decode",i);const o=r.get(i);if(o===void 0)throw new Error(`Unknown letter: "${i}". Allowed: ${t}`);return o}))}}function UU(t=""){return Id("join",t),{encode:e=>(Sd("join.decode",e),e.join(t)),decode:e=>(Id("join.decode",e),e.split(t))}}function BU(t,e="="){return Bg(t),Id("padding",e),{encode(n){for(Sd("padding.encode",n);n.length*t%8;)n.push(e);return n},decode(n){Sd("padding.decode",n);let r=n.length;if(r*t%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&n[r-1]===e;r--)if((r-1)*t%8===0)throw new Error("padding: invalid, string has too much padding");return n.slice(0,r)}}}const L_=(t,e)=>e===0?t:L_(e,t%e),xd=(t,e)=>t+(e-L_(t,e)),Nh=(()=>{let t=[];for(let e=0;e<40;e++)t.push(2**e);return t})();function Ob(t,e,n,r){if(r0(t),e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(xd(e,n)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${n} carryBits=${xd(e,n)}`);let s=0,i=0;const o=Nh[e],a=Nh[n]-1,c=[];for(const l of t){if(Bg(l),l>=o)throw new Error(`convertRadix2: invalid data word=${l} from=${e}`);if(s=s<<e|l,i+e>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${e}`);for(i+=e;i>=n;i-=n)c.push((s>>i-n&a)>>>0);const u=Nh[i];if(u===void 0)throw new Error("invalid carry");s&=u-1}if(s=s<<n-i&a,!r&&i>=e)throw new Error("Excess padding");if(!r&&s>0)throw new Error(`Non-zero padding: ${s}`);return r&&i>0&&c.push(s>>>0),c}function LU(t,e=!1){if(Bg(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(xd(8,t)>32||xd(t,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!PU(n))throw new Error("radix2.encode input should be Uint8Array");return Ob(Array.from(n),8,t,!e)},decode:n=>(kU("radix2.decode",n),Uint8Array.from(Ob(n,t,8,e)))}}const MU=DU(LU(5),$U("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),BU(5),UU(""));function FU(t){return eU(jU(t))}function jU(t){const{payload:e,signature:n}=t,{r,s,yParity:i}=n,a=new SU.Signature(BigInt(r),BigInt(s)).addRecoveryBit(i).recoverPublicKey($g(e).substring(2));return q$(a)}var M_={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function i(c,l,u,d,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new s(u,d||c,f),p=n?n+l:l;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],h]:c._events[p].push(h):(c._events[p]=h,c._eventsCount++),c}function o(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,d;if(this._eventsCount===0)return l;for(d in u=this._events)e.call(u,d)&&l.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=n?n+l:l,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,h=d.length,p=new Array(h);f<h;f++)p[f]=d[f].fn;return p},a.prototype.listenerCount=function(l){var u=n?n+l:l,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(l,u,d,f,h,p){var g=n?n+l:l;if(!this._events[g])return!1;var m=this._events[g],E=arguments.length,A,b;if(m.fn){switch(m.once&&this.removeListener(l,m.fn,void 0,!0),E){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,u),!0;case 3:return m.fn.call(m.context,u,d),!0;case 4:return m.fn.call(m.context,u,d,f),!0;case 5:return m.fn.call(m.context,u,d,f,h),!0;case 6:return m.fn.call(m.context,u,d,f,h,p),!0}for(b=1,A=new Array(E-1);b<E;b++)A[b-1]=arguments[b];m.fn.apply(m.context,A)}else{var _=m.length,C;for(b=0;b<_;b++)switch(m[b].once&&this.removeListener(l,m[b].fn,void 0,!0),E){case 1:m[b].fn.call(m[b].context);break;case 2:m[b].fn.call(m[b].context,u);break;case 3:m[b].fn.call(m[b].context,u,d);break;case 4:m[b].fn.call(m[b].context,u,d,f);break;default:if(!A)for(C=1,A=new Array(E-1);C<E;C++)A[C-1]=arguments[C];m[b].fn.apply(m[b].context,A)}}return!0},a.prototype.on=function(l,u,d){return i(this,l,u,d,!1)},a.prototype.once=function(l,u,d){return i(this,l,u,d,!0)},a.prototype.removeListener=function(l,u,d,f){var h=n?n+l:l;if(!this._events[h])return this;if(!u)return o(this,h),this;var p=this._events[h];if(p.fn)p.fn===u&&(!f||p.once)&&(!d||p.context===d)&&o(this,h);else{for(var g=0,m=[],E=p.length;g<E;g++)(p[g].fn!==u||f&&!p[g].once||d&&p[g].context!==d)&&m.push(p[g]);m.length?this._events[h]=m.length===1?m[0]:m:o(this,h)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=n?n+l:l,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(M_);var HU=M_.exports;const WU=Hd(HU);function zU(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<t.length;l++){const u=t.charAt(l),d=u.charCodeAt(0);if(e[d]!==255)throw new TypeError(u+" is ambiguous");e[d]=l}const n=t.length,r=t.charAt(0),s=Math.log(n)/Math.log(256),i=Math.log(256)/Math.log(n);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,d=0,f=0;const h=l.length;for(;f!==h&&l[f]===0;)f++,u++;const p=(h-f)*i+1>>>0,g=new Uint8Array(p);for(;f!==h;){let A=l[f],b=0;for(let _=p-1;(A!==0||b<d)&&_!==-1;_--,b++)A+=256*g[_]>>>0,g[_]=A%n>>>0,A=A/n>>>0;if(A!==0)throw new Error("Non-zero carry");d=b,f++}let m=p-d;for(;m!==p&&g[m]===0;)m++;let E=r.repeat(u);for(;m<p;++m)E+=t.charAt(g[m]);return E}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,d=0,f=0;for(;l[u]===r;)d++,u++;const h=(l.length-u)*s+1>>>0,p=new Uint8Array(h);for(;u<l.length;){const A=l.charCodeAt(u);if(A>255)return;let b=e[A];if(b===255)return;let _=0;for(let C=h-1;(b!==0||_<f)&&C!==-1;C--,_++)b+=n*p[C]>>>0,p[C]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");f=_,u++}let g=h-f;for(;g!==h&&p[g]===0;)g++;const m=new Uint8Array(d+(h-g));let E=d;for(;g!==h;)m[E++]=p[g++];return m}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+n+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var qU="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const Da=zU(qU);function VU(t){const e=t.length;let n=0,r=0;for(;r<e;){let s=t.charCodeAt(r++);if(s&4294967168)if(!(s&4294965248))n+=2;else{if(s>=55296&&s<=56319&&r<e){const i=t.charCodeAt(r);(i&64512)===56320&&(++r,s=((s&1023)<<10)+(i&1023)+65536)}s&4294901760?n+=4:n+=3}else{n++;continue}}return n}function KU(t,e,n){const r=t.length;let s=n,i=0;for(;i<r;){let o=t.charCodeAt(i++);if(o&4294967168)if(!(o&4294965248))e[s++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<r){const a=t.charCodeAt(i);(a&64512)===56320&&(++i,o=((o&1023)<<10)+(a&1023)+65536)}o&4294901760?(e[s++]=o>>18&7|240,e[s++]=o>>12&63|128,e[s++]=o>>6&63|128):(e[s++]=o>>12&15|224,e[s++]=o>>6&63|128)}else{e[s++]=o;continue}e[s++]=o&63|128}}const GU=new TextEncoder,YU=50;function ZU(t,e,n){GU.encodeInto(t,e.subarray(n))}function JU(t,e,n){t.length>YU?ZU(t,e,n):KU(t,e,n)}const XU=4096;function F_(t,e,n){let r=e;const s=r+n,i=[];let o="";for(;r<s;){const a=t[r++];if(!(a&128))i.push(a);else if((a&224)===192){const c=t[r++]&63;i.push((a&31)<<6|c)}else if((a&240)===224){const c=t[r++]&63,l=t[r++]&63;i.push((a&31)<<12|c<<6|l)}else if((a&248)===240){const c=t[r++]&63,l=t[r++]&63,u=t[r++]&63;let d=(a&7)<<18|c<<12|l<<6|u;d>65535&&(d-=65536,i.push(d>>>10&1023|55296),d=56320|d&1023),i.push(d)}else i.push(a);i.length>=XU&&(o+=String.fromCharCode(...i),i.length=0)}return i.length>0&&(o+=String.fromCharCode(...i)),o}const QU=new TextDecoder,e9=200;function t9(t,e,n){const r=t.subarray(e,e+n);return QU.decode(r)}function n9(t,e,n){return n>e9?t9(t,e,n):F_(t,e,n)}class gu{constructor(e,n){this.type=e,this.data=n}}class Bn extends Error{constructor(e){super(e);const n=Object.create(Bn.prototype);Object.setPrototypeOf(this,n),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:Bn.name})}}const Va=4294967295;function r9(t,e,n){const r=n/4294967296,s=n;t.setUint32(e,r),t.setUint32(e+4,s)}function j_(t,e,n){const r=Math.floor(n/4294967296),s=n;t.setUint32(e,r),t.setUint32(e+4,s)}function H_(t,e){const n=t.getInt32(e),r=t.getUint32(e+4);return n*4294967296+r}function s9(t,e){const n=t.getUint32(e),r=t.getUint32(e+4);return n*4294967296+r}const i9=-1,o9=4294967296-1,a9=17179869184-1;function c9({sec:t,nsec:e}){if(t>=0&&e>=0&&t<=a9)if(e===0&&t<=o9){const n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),n}else{const n=t/4294967296,r=t&4294967295,s=new Uint8Array(8),i=new DataView(s.buffer);return i.setUint32(0,e<<2|n&3),i.setUint32(4,r),s}else{const n=new Uint8Array(12),r=new DataView(n.buffer);return r.setUint32(0,e),j_(r,4,t),n}}function l9(t){const e=t.getTime(),n=Math.floor(e/1e3),r=(e-n*1e3)*1e6,s=Math.floor(r/1e9);return{sec:n+s,nsec:r-s*1e9}}function u9(t){if(t instanceof Date){const e=l9(t);return c9(e)}else return null}function d9(t){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const n=e.getUint32(0),r=e.getUint32(4),s=(n&3)*4294967296+r,i=n>>>2;return{sec:s,nsec:i}}case 12:{const n=H_(e,4),r=e.getUint32(0);return{sec:n,nsec:r}}default:throw new Bn(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function f9(t){const e=d9(t);return new Date(e.sec*1e3+e.nsec/1e6)}const h9={type:i9,encode:u9,decode:f9};class Nd{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(h9)}register({type:e,encode:n,decode:r}){if(e>=0)this.encoders[e]=n,this.decoders[e]=r;else{const s=-1-e;this.builtInEncoders[s]=n,this.builtInDecoders[s]=r}}tryToEncode(e,n){for(let r=0;r<this.builtInEncoders.length;r++){const s=this.builtInEncoders[r];if(s!=null){const i=s(e,n);if(i!=null){const o=-1-r;return new gu(o,i)}}}for(let r=0;r<this.encoders.length;r++){const s=this.encoders[r];if(s!=null){const i=s(e,n);if(i!=null){const o=r;return new gu(o,i)}}}return e instanceof gu?e:null}decode(e,n,r){const s=n<0?this.builtInDecoders[-1-n]:this.decoders[n];return s?s(e,n,r):new gu(n,e)}}Nd.defaultCodec=new Nd;function p9(t){return t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}function s0(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):p9(t)?new Uint8Array(t):Uint8Array.from(t)}const g9=100,m9=2048;let y9=class W_{constructor(e){this.entered=!1,this.extensionCodec=(e==null?void 0:e.extensionCodec)??Nd.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(e==null?void 0:e.useBigInt64)??!1,this.maxDepth=(e==null?void 0:e.maxDepth)??g9,this.initialBufferSize=(e==null?void 0:e.initialBufferSize)??m9,this.sortKeys=(e==null?void 0:e.sortKeys)??!1,this.forceFloat32=(e==null?void 0:e.forceFloat32)??!1,this.ignoreUndefined=(e==null?void 0:e.ignoreUndefined)??!1,this.forceIntegerToFloat=(e==null?void 0:e.forceIntegerToFloat)??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new W_({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,n){if(n>this.maxDepth)throw new Error(`Too deep objects in depth ${n}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,n)}ensureBufferSizeToWrite(e){const n=this.pos+e;this.view.byteLength<n&&this.resizeBuffer(n*2)}resizeBuffer(e){const n=new ArrayBuffer(e),r=new Uint8Array(n),s=new DataView(n);r.set(this.bytes),this.view=s,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const r=VU(e);this.ensureBufferSizeToWrite(5+r),this.writeStringHeader(r),JU(e,this.bytes,this.pos),this.pos+=r}encodeObject(e,n){const r=this.extensionCodec.tryToEncode(e,this.context);if(r!=null)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,n);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,n);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const n=e.byteLength;if(n<256)this.writeU8(196),this.writeU8(n);else if(n<65536)this.writeU8(197),this.writeU16(n);else if(n<4294967296)this.writeU8(198),this.writeU32(n);else throw new Error(`Too large binary: ${n}`);const r=s0(e);this.writeU8a(r)}encodeArray(e,n){const r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else if(r<4294967296)this.writeU8(221),this.writeU32(r);else throw new Error(`Too large array: ${r}`);for(const s of e)this.doEncode(s,n+1)}countWithoutUndefined(e,n){let r=0;for(const s of n)e[s]!==void 0&&r++;return r}encodeMap(e,n){const r=Object.keys(e);this.sortKeys&&r.sort();const s=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(s<16)this.writeU8(128+s);else if(s<65536)this.writeU8(222),this.writeU16(s);else if(s<4294967296)this.writeU8(223),this.writeU32(s);else throw new Error(`Too large map object: ${s}`);for(const i of r){const o=e[i];this.ignoreUndefined&&o===void 0||(this.encodeString(i),this.doEncode(o,n+1))}}encodeExtension(e){if(typeof e.data=="function"){const r=e.data(this.pos+6),s=r.length;if(s>=4294967296)throw new Error(`Too large extension object: ${s}`);this.writeU8(201),this.writeU32(s),this.writeI8(e.type),this.writeU8a(r);return}const n=e.data.length;if(n===1)this.writeU8(212);else if(n===2)this.writeU8(213);else if(n===4)this.writeU8(214);else if(n===8)this.writeU8(215);else if(n===16)this.writeU8(216);else if(n<256)this.writeU8(199),this.writeU8(n);else if(n<65536)this.writeU8(200),this.writeU16(n);else if(n<4294967296)this.writeU8(201),this.writeU32(n);else throw new Error(`Too large extension object: ${n}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const n=e.length;this.ensureBufferSizeToWrite(n),this.bytes.set(e,this.pos),this.pos+=n}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),r9(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),j_(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}};function b9(t,e){return new y9(e).encodeSharedRef(t)}function Th(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}const w9=16,E9=16;class v9{constructor(e=w9,n=E9){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=n,this.caches=[];for(let r=0;r<this.maxKeyLength;r++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,n,r){const s=this.caches[r-1];e:for(const i of s){const o=i.bytes;for(let a=0;a<r;a++)if(o[a]!==e[n+a])continue e;return i.str}return null}store(e,n){const r=this.caches[e.length-1],s={bytes:e,str:n};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=s:r.push(s)}decode(e,n,r){const s=this.find(e,n,r);if(s!=null)return this.hit++,s;this.miss++;const i=F_(e,n,r),o=Uint8Array.prototype.slice.call(e,n,n+r);return this.store(o,i),i}}const i0="array",gc="map_key",z_="map_value",C9=t=>{if(typeof t=="string"||typeof t=="number")return t;throw new Bn("The type of key must be string or number but "+typeof t)};class _9{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const n=this.getUninitializedStateFromPool();n.type=i0,n.position=0,n.size=e,n.array=new Array(e)}pushMapState(e){const n=this.getUninitializedStateFromPool();n.type=gc,n.readCount=0,n.size=e,n.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===i0){const r=e;r.size=0,r.array=void 0,r.position=0,r.type=void 0}if(e.type===gc||e.type===z_){const r=e;r.size=0,r.map=void 0,r.readCount=0,r.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const Ka=-1,Lg=new DataView(new ArrayBuffer(0)),A9=new Uint8Array(Lg.buffer);try{Lg.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const Rb=new RangeError("Insufficient data"),I9=new v9;let S9=class q_{constructor(e){this.totalPos=0,this.pos=0,this.view=Lg,this.bytes=A9,this.headByte=Ka,this.stack=new _9,this.entered=!1,this.extensionCodec=(e==null?void 0:e.extensionCodec)??Nd.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(e==null?void 0:e.useBigInt64)??!1,this.rawStrings=(e==null?void 0:e.rawStrings)??!1,this.maxStrLength=(e==null?void 0:e.maxStrLength)??Va,this.maxBinLength=(e==null?void 0:e.maxBinLength)??Va,this.maxArrayLength=(e==null?void 0:e.maxArrayLength)??Va,this.maxMapLength=(e==null?void 0:e.maxMapLength)??Va,this.maxExtLength=(e==null?void 0:e.maxExtLength)??Va,this.keyDecoder=(e==null?void 0:e.keyDecoder)!==void 0?e.keyDecoder:I9,this.mapKeyConverter=(e==null?void 0:e.mapKeyConverter)??C9}clone(){return new q_({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=Ka,this.stack.reset()}setBuffer(e){const n=s0(e);this.bytes=n,this.view=new DataView(n.buffer,n.byteOffset,n.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===Ka&&!this.hasRemaining(1))this.setBuffer(e);else{const n=this.bytes.subarray(this.pos),r=s0(e),s=new Uint8Array(n.length+r.length);s.set(n),s.set(r,n.length),this.setBuffer(s)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:n,pos:r}=this;return new RangeError(`Extra ${n.byteLength-r} of ${n.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const n=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return n}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let n=!1,r;for await(const a of e){if(n)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{r=this.doDecodeSync(),n=!0}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}if(n){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return r}const{headByte:s,pos:i,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${Th(s)} at ${o} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,n){if(this.entered){yield*this.clone().decodeMultiAsync(e,n);return}try{this.entered=!0;let r=n,s=-1;for await(const i of e){if(n&&s===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),r&&(s=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),--s!==0;);}catch(o){if(!(o instanceof RangeError))throw o}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let n;if(e>=224)n=e-256;else if(e<192)if(e<128)n=e;else if(e<144){const s=e-128;if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e<160){const s=e-144;if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else{const s=e-160;n=this.decodeString(s,0)}else if(e===192)n=null;else if(e===194)n=!1;else if(e===195)n=!0;else if(e===202)n=this.readF32();else if(e===203)n=this.readF64();else if(e===204)n=this.readU8();else if(e===205)n=this.readU16();else if(e===206)n=this.readU32();else if(e===207)this.useBigInt64?n=this.readU64AsBigInt():n=this.readU64();else if(e===208)n=this.readI8();else if(e===209)n=this.readI16();else if(e===210)n=this.readI32();else if(e===211)this.useBigInt64?n=this.readI64AsBigInt():n=this.readI64();else if(e===217){const s=this.lookU8();n=this.decodeString(s,1)}else if(e===218){const s=this.lookU16();n=this.decodeString(s,2)}else if(e===219){const s=this.lookU32();n=this.decodeString(s,4)}else if(e===220){const s=this.readU16();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(e===221){const s=this.readU32();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(e===222){const s=this.readU16();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e===223){const s=this.readU32();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e===196){const s=this.lookU8();n=this.decodeBinary(s,1)}else if(e===197){const s=this.lookU16();n=this.decodeBinary(s,2)}else if(e===198){const s=this.lookU32();n=this.decodeBinary(s,4)}else if(e===212)n=this.decodeExtension(1,0);else if(e===213)n=this.decodeExtension(2,0);else if(e===214)n=this.decodeExtension(4,0);else if(e===215)n=this.decodeExtension(8,0);else if(e===216)n=this.decodeExtension(16,0);else if(e===199){const s=this.lookU8();n=this.decodeExtension(s,1)}else if(e===200){const s=this.lookU16();n=this.decodeExtension(s,2)}else if(e===201){const s=this.lookU32();n=this.decodeExtension(s,4)}else throw new Bn(`Unrecognized type byte: ${Th(e)}`);this.complete();const r=this.stack;for(;r.length>0;){const s=r.top();if(s.type===i0)if(s.array[s.position]=n,s.position++,s.position===s.size)n=s.array,r.release(s);else continue e;else if(s.type===gc){if(n==="__proto__")throw new Bn("The key __proto__ is not allowed");s.key=this.mapKeyConverter(n),s.type=z_;continue e}else if(s.map[s.key]=n,s.readCount++,s.readCount===s.size)n=s.map,r.release(s);else{s.key=null,s.type=gc;continue e}}return n}}readHeadByte(){return this.headByte===Ka&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=Ka}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new Bn(`Unrecognized array type byte: ${Th(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new Bn(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new Bn(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,n){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,n):this.decodeBinary(e,n)}decodeUtf8String(e,n){var i;if(e>this.maxStrLength)throw new Bn(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+n+e)throw Rb;const r=this.pos+n;let s;return this.stateIsMapKey()&&((i=this.keyDecoder)!=null&&i.canBeCached(e))?s=this.keyDecoder.decode(this.bytes,r,e):s=n9(this.bytes,r,e),this.pos+=n+e,s}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===gc:!1}decodeBinary(e,n){if(e>this.maxBinLength)throw new Bn(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+n))throw Rb;const r=this.pos+n,s=this.bytes.subarray(r,r+e);return this.pos+=n+e,s}decodeExtension(e,n){if(e>this.maxExtLength)throw new Bn(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+n),s=this.decodeBinary(e,n+1);return this.extensionCodec.decode(s,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=s9(this.view,this.pos);return this.pos+=8,e}readI64(){const e=H_(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}};function x9(t,e){return new S9(e).decode(t)}function Mg(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function V_(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Mg(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function mc(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const n=V_(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return Mg(n)}function N9(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,E=0,A=p.length;E!==A&&p[E]===0;)E++,g++;for(var b=(A-E)*u+1>>>0,_=new Uint8Array(b);E!==A;){for(var C=p[E],S=0,x=b-1;(C!==0||S<m)&&x!==-1;x--,S++)C+=256*_[x]>>>0,_[x]=C%a>>>0,C=C/a>>>0;if(C!==0)throw new Error("Non-zero carry");m=S,E++}for(var P=b-m;P!==b&&_[P]===0;)P++;for(var N=c.repeat(g);P<b;++P)N+=t.charAt(_[P]);return N}function f(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,E=0;p[g]===c;)m++,g++;for(var A=(p.length-g)*l+1>>>0,b=new Uint8Array(A);p[g];){var _=n[p.charCodeAt(g)];if(_===255)return;for(var C=0,S=A-1;(_!==0||C<E)&&S!==-1;S--,C++)_+=a*b[S]>>>0,b[S]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");E=C,g++}if(p[g]!==" "){for(var x=A-E;x!==A&&b[x]===0;)x++;for(var P=new Uint8Array(m+(A-x)),N=m;x!==A;)P[N++]=b[x++];return P}}}function h(p){var g=f(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:f,decode:h}}var T9=N9,O9=T9;const R9=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},P9=t=>new TextEncoder().encode(t),k9=t=>new TextDecoder().decode(t);class D9{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class $9{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return K_(this,e)}}class U9{constructor(e){this.decoders=e}or(e){return K_(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const K_=(t,e)=>new U9({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class B9{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new D9(e,n,r),this.decoder=new $9(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const gf=({name:t,prefix:e,encode:n,decode:r})=>new B9(t,e,n,r),Ml=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=O9(n,e);return gf({prefix:t,name:e,encode:r,decode:i=>R9(s(i))})},L9=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},M9=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},Wt=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>gf({prefix:e,name:t,encode(s){return M9(s,r,n)},decode(s){return L9(s,r,n,t)}}),F9=gf({prefix:"\0",name:"identity",encode:t=>k9(t),decode:t=>P9(t)}),j9=Object.freeze(Object.defineProperty({__proto__:null,identity:F9},Symbol.toStringTag,{value:"Module"})),H9=Wt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),W9=Object.freeze(Object.defineProperty({__proto__:null,base2:H9},Symbol.toStringTag,{value:"Module"})),z9=Wt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),q9=Object.freeze(Object.defineProperty({__proto__:null,base8:z9},Symbol.toStringTag,{value:"Module"})),V9=Ml({prefix:"9",name:"base10",alphabet:"0123456789"}),K9=Object.freeze(Object.defineProperty({__proto__:null,base10:V9},Symbol.toStringTag,{value:"Module"})),G9=Wt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Y9=Wt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Z9=Object.freeze(Object.defineProperty({__proto__:null,base16:G9,base16upper:Y9},Symbol.toStringTag,{value:"Module"})),J9=Wt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),X9=Wt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Q9=Wt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),eB=Wt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),tB=Wt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),nB=Wt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),rB=Wt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),sB=Wt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),iB=Wt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),oB=Object.freeze(Object.defineProperty({__proto__:null,base32:J9,base32hex:tB,base32hexpad:rB,base32hexpadupper:sB,base32hexupper:nB,base32pad:Q9,base32padupper:eB,base32upper:X9,base32z:iB},Symbol.toStringTag,{value:"Module"})),aB=Ml({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),cB=Ml({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),lB=Object.freeze(Object.defineProperty({__proto__:null,base36:aB,base36upper:cB},Symbol.toStringTag,{value:"Module"})),uB=Ml({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),dB=Ml({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),fB=Object.freeze(Object.defineProperty({__proto__:null,base58btc:uB,base58flickr:dB},Symbol.toStringTag,{value:"Module"})),hB=Wt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),pB=Wt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),gB=Wt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),mB=Wt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),yB=Object.freeze(Object.defineProperty({__proto__:null,base64:hB,base64pad:pB,base64url:gB,base64urlpad:mB},Symbol.toStringTag,{value:"Module"})),G_=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),bB=G_.reduce((t,e,n)=>(t[n]=e,t),[]),wB=G_.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function EB(t){return t.reduce((e,n)=>(e+=bB[n],e),"")}function vB(t){const e=[];for(const n of t){const r=wB[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const CB=gf({prefix:"ðŸš€",name:"base256emoji",encode:EB,decode:vB}),_B=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:CB},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Pb={...j9,...W9,...q9,...K9,...Z9,...oB,...lB,...fB,...yB,..._B};function Y_(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const kb=Y_("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Oh=Y_("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=V_(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),Z_={utf8:kb,"utf-8":kb,hex:Pb.base16,latin1:Oh,ascii:Oh,binary:Oh,...Pb};function tr(t,e="utf8"){const n=Z_[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Mg(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}function xn(t,e="utf8"){const n=Z_[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):n.encoder.encode(t).substring(1)}const AB={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}},IB="Input must be an string, Buffer or Uint8Array";function SB(t){let e;if(t instanceof Uint8Array)e=t;else if(typeof t=="string")e=new TextEncoder().encode(t);else throw new Error(IB);return e}function xB(t){return Array.prototype.map.call(t,function(e){return(e<16?"0":"")+e.toString(16)}).join("")}function mu(t){return(4294967296+t).toString(16).substring(1)}function NB(t,e,n){let r=`
`+t+" = ";for(let s=0;s<e.length;s+=2){if(n===32)r+=mu(e[s]).toUpperCase(),r+=" ",r+=mu(e[s+1]).toUpperCase();else if(n===64)r+=mu(e[s+1]).toUpperCase(),r+=mu(e[s]).toUpperCase();else throw new Error("Invalid size "+n);s%6===4?r+=`
`+new Array(t.length+4).join(" "):s<e.length-2&&(r+=" ")}console.log(r)}function TB(t,e,n){let r=new Date().getTime();const s=new Uint8Array(e);for(let o=0;o<e;o++)s[o]=o%256;const i=new Date().getTime();console.log("Generated random input in "+(i-r)+"ms"),r=i;for(let o=0;o<n;o++){const a=t(s),c=new Date().getTime(),l=c-r;r=c,console.log("Hashed in "+l+"ms: "+a.substring(0,20)+"..."),console.log(Math.round(e/(1<<20)/(l/1e3)*100)/100+" MB PER SECOND")}}var J_={normalizeInput:SB,toHex:xB,debugPrint:NB,testSpeed:TB};const Wu=J_;function yu(t,e,n){const r=t[e]+t[n];let s=t[e+1]+t[n+1];r>=4294967296&&s++,t[e]=r,t[e+1]=s}function Db(t,e,n,r){let s=t[e]+n;n<0&&(s+=4294967296);let i=t[e+1]+r;s>=4294967296&&i++,t[e]=s,t[e+1]=i}function X_(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function Gs(t,e,n,r,s,i){const o=cc[s],a=cc[s+1],c=cc[i],l=cc[i+1];yu(_e,t,e),Db(_e,t,o,a);let u=_e[r]^_e[t],d=_e[r+1]^_e[t+1];_e[r]=d,_e[r+1]=u,yu(_e,n,r),u=_e[e]^_e[n],d=_e[e+1]^_e[n+1],_e[e]=u>>>24^d<<8,_e[e+1]=d>>>24^u<<8,yu(_e,t,e),Db(_e,t,c,l),u=_e[r]^_e[t],d=_e[r+1]^_e[t+1],_e[r]=u>>>16^d<<16,_e[r+1]=d>>>16^u<<16,yu(_e,n,r),u=_e[e]^_e[n],d=_e[e+1]^_e[n+1],_e[e]=d>>>31^u<<1,_e[e+1]=u>>>31^d<<1}const Q_=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),OB=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],Kt=new Uint8Array(OB.map(function(t){return t*2})),_e=new Uint32Array(32),cc=new Uint32Array(32);function eA(t,e){let n=0;for(n=0;n<16;n++)_e[n]=t.h[n],_e[n+16]=Q_[n];for(_e[24]=_e[24]^t.t,_e[25]=_e[25]^t.t/4294967296,e&&(_e[28]=~_e[28],_e[29]=~_e[29]),n=0;n<32;n++)cc[n]=X_(t.b,4*n);for(n=0;n<12;n++)Gs(0,8,16,24,Kt[n*16+0],Kt[n*16+1]),Gs(2,10,18,26,Kt[n*16+2],Kt[n*16+3]),Gs(4,12,20,28,Kt[n*16+4],Kt[n*16+5]),Gs(6,14,22,30,Kt[n*16+6],Kt[n*16+7]),Gs(0,10,20,30,Kt[n*16+8],Kt[n*16+9]),Gs(2,12,22,24,Kt[n*16+10],Kt[n*16+11]),Gs(4,14,16,26,Kt[n*16+12],Kt[n*16+13]),Gs(6,8,18,28,Kt[n*16+14],Kt[n*16+15]);for(n=0;n<16;n++)t.h[n]=t.h[n]^_e[n]^_e[n+16]}const Ys=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function tA(t,e,n,r){if(t===0||t>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(e&&e.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(n&&n.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(r&&r.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const s={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:t};Ys.fill(0),Ys[0]=t,e&&(Ys[1]=e.length),Ys[2]=1,Ys[3]=1,n&&Ys.set(n,32),r&&Ys.set(r,48);for(let i=0;i<16;i++)s.h[i]=Q_[i]^X_(Ys,i*4);return e&&(Fg(s,e),s.c=128),s}function Fg(t,e){for(let n=0;n<e.length;n++)t.c===128&&(t.t+=t.c,eA(t,!1),t.c=0),t.b[t.c++]=e[n]}function nA(t){for(t.t+=t.c;t.c<128;)t.b[t.c++]=0;eA(t,!0);const e=new Uint8Array(t.outlen);for(let n=0;n<t.outlen;n++)e[n]=t.h[n>>2]>>8*(n&3);return e}function rA(t,e,n,r,s){n=n||64,t=Wu.normalizeInput(t),r&&(r=Wu.normalizeInput(r)),s&&(s=Wu.normalizeInput(s));const i=tA(n,e,r,s);return Fg(i,t),nA(i)}function RB(t,e,n,r,s){const i=rA(t,e,n,r,s);return Wu.toHex(i)}var PB={blake2b:rA,blake2bHex:RB,blake2bInit:tA,blake2bUpdate:Fg,blake2bFinal:nA};const sA=J_;function kB(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function Zs(t,e,n,r,s,i){Fe[t]=Fe[t]+Fe[e]+s,Fe[r]=bu(Fe[r]^Fe[t],16),Fe[n]=Fe[n]+Fe[r],Fe[e]=bu(Fe[e]^Fe[n],12),Fe[t]=Fe[t]+Fe[e]+i,Fe[r]=bu(Fe[r]^Fe[t],8),Fe[n]=Fe[n]+Fe[r],Fe[e]=bu(Fe[e]^Fe[n],7)}function bu(t,e){return t>>>e^t<<32-e}const iA=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Gt=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),Fe=new Uint32Array(16),$t=new Uint32Array(16);function oA(t,e){let n=0;for(n=0;n<8;n++)Fe[n]=t.h[n],Fe[n+8]=iA[n];for(Fe[12]^=t.t,Fe[13]^=t.t/4294967296,e&&(Fe[14]=~Fe[14]),n=0;n<16;n++)$t[n]=kB(t.b,4*n);for(n=0;n<10;n++)Zs(0,4,8,12,$t[Gt[n*16+0]],$t[Gt[n*16+1]]),Zs(1,5,9,13,$t[Gt[n*16+2]],$t[Gt[n*16+3]]),Zs(2,6,10,14,$t[Gt[n*16+4]],$t[Gt[n*16+5]]),Zs(3,7,11,15,$t[Gt[n*16+6]],$t[Gt[n*16+7]]),Zs(0,5,10,15,$t[Gt[n*16+8]],$t[Gt[n*16+9]]),Zs(1,6,11,12,$t[Gt[n*16+10]],$t[Gt[n*16+11]]),Zs(2,7,8,13,$t[Gt[n*16+12]],$t[Gt[n*16+13]]),Zs(3,4,9,14,$t[Gt[n*16+14]],$t[Gt[n*16+15]]);for(n=0;n<8;n++)t.h[n]^=Fe[n]^Fe[n+8]}function aA(t,e){if(!(t>0&&t<=32))throw new Error("Incorrect output length, should be in [1, 32]");const n=e?e.length:0;if(e&&!(n>0&&n<=32))throw new Error("Incorrect key length, should be in [1, 32]");const r={h:new Uint32Array(iA),b:new Uint8Array(64),c:0,t:0,outlen:t};return r.h[0]^=16842752^n<<8^t,n>0&&(jg(r,e),r.c=64),r}function jg(t,e){for(let n=0;n<e.length;n++)t.c===64&&(t.t+=t.c,oA(t,!1),t.c=0),t.b[t.c++]=e[n]}function cA(t){for(t.t+=t.c;t.c<64;)t.b[t.c++]=0;oA(t,!0);const e=new Uint8Array(t.outlen);for(let n=0;n<t.outlen;n++)e[n]=t.h[n>>2]>>8*(n&3)&255;return e}function lA(t,e,n){n=n||32,t=sA.normalizeInput(t);const r=aA(n,e);return jg(r,t),cA(r)}function DB(t,e,n){const r=lA(t,e,n);return sA.toHex(r)}var $B={blake2s:lA,blake2sHex:DB,blake2sInit:aA,blake2sUpdate:jg,blake2sFinal:cA};const Ga=PB,Ya=$B;var UB={blake2b:Ga.blake2b,blake2bHex:Ga.blake2bHex,blake2bInit:Ga.blake2bInit,blake2bUpdate:Ga.blake2bUpdate,blake2bFinal:Ga.blake2bFinal,blake2s:Ya.blake2s,blake2sHex:Ya.blake2sHex,blake2sInit:Ya.blake2sInit,blake2sUpdate:Ya.blake2sUpdate,blake2sFinal:Ya.blake2sFinal},BB={};const LB=":";function xs(t){const[e,n]=t.split(LB);return{namespace:e,reference:n}}function uA(t,e){return t.includes(":")?[t]:e.chains||[]}var MB=Object.defineProperty,FB=Object.defineProperties,jB=Object.getOwnPropertyDescriptors,$b=Object.getOwnPropertySymbols,HB=Object.prototype.hasOwnProperty,WB=Object.prototype.propertyIsEnumerable,o0=(t,e,n)=>e in t?MB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ub=(t,e)=>{for(var n in e||(e={}))HB.call(e,n)&&o0(t,n,e[n]);if($b)for(var n of $b(e))WB.call(e,n)&&o0(t,n,e[n]);return t},zB=(t,e)=>FB(t,jB(e)),Bb=(t,e,n)=>o0(t,typeof e!="symbol"?e+"":e,n);const qB="ReactNative",zn={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},VB="js";function Td(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Ri(){return!Eo()&&!!xg()&&navigator.product===qB}function KB(){return Ri()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function GB(){return Ri()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function $a(){return!Td()&&!!xg()&&!!Eo()}function Fl(){return Ri()?zn.reactNative:Td()?zn.node:$a()?zn.browser:zn.unknown}function Lb(){var t;try{return Ri()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function YB(t,e){const n=new URLSearchParams(t);return Object.entries(e).sort(([r],[s])=>r.localeCompare(s)).forEach(([r,s])=>{s!=null&&n.set(r,String(s))}),n.toString()}function ZB(t){var e,n;const r=dA();try{return t!=null&&t.url&&r.url&&new URL(t.url).host!==new URL(r.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${t.url} differs from the actual page url:${r.url}. This is probably unintended and can lead to issues.`),t.url=r.url),(e=t==null?void 0:t.icons)!=null&&e.length&&t.icons.length>0&&(t.icons=t.icons.filter(s=>s!=="")),zB(Ub(Ub({},r),t),{url:(t==null?void 0:t.url)||r.url,name:(t==null?void 0:t.name)||r.name,description:(t==null?void 0:t.description)||r.description,icons:(n=t==null?void 0:t.icons)!=null&&n.length&&t.icons.length>0?t.icons:r.icons})}catch(s){return console.warn("Error populating app metadata",s),t||r}}function dA(){return n_()||{name:"",description:"",url:"",icons:[""]}}function JB(){if(Fl()===zn.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:n,Version:r}=global.Platform;return[n,r].join("-")}const t=wD();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function XB(){var t;const e=Fl();return e===zn.browser?[e,((t=t_())==null?void 0:t.host)||"unknown"].join(":"):e}function fA(t,e,n){const r=JB(),s=XB();return[[t,e].join("-"),[VB,n].join("-"),r,s].join("/")}function QB({protocol:t,version:e,relayUrl:n,sdkVersion:r,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=n.split("?"),u=fA(t,e,r),d={auth:s,ua:u,projectId:i,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},f=YB(l[1]||"",d);return l[0]+"?"+f}function Qi(t,e){return t.filter(n=>e.includes(n)).length===t.length}function a0(t){return Object.fromEntries(t.entries())}function c0(t){return new Map(Object.entries(t))}function zi(t=J.FIVE_MINUTES,e){const n=J.toMiliseconds(t||J.FIVE_MINUTES);let r,s,i,o;return{resolve:a=>{i&&r&&(clearTimeout(i),r(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const l=new Error(e);o=Promise.reject(l),c(l)},n),r=a,s=c})}}function Wr(t,e,n){return new Promise(async(r,s)=>{const i=setTimeout(()=>s(new Error(n)),e);try{const o=await t;r(o)}catch(o){s(o)}clearTimeout(i)})}function hA(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function eL(t){return hA("topic",t)}function tL(t){return hA("id",t)}function pA(t){const[e,n]=t.split(":"),r={id:void 0,topic:void 0};if(e==="topic"&&typeof n=="string")r.topic=n;else if(e==="id"&&Number.isInteger(Number(n)))r.id=Number(n);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${n}`);return r}function gt(t,e){return J.fromMiliseconds(Date.now()+J.toMiliseconds(t))}function Fr(t){return Date.now()>=J.toMiliseconds(t)}function qe(t,e){return`${t}${e?`:${e}`:""}`}function Vr(t=[],e=[]){return[...new Set([...t,...e])]}async function nL({id:t,topic:e,wcDeepLink:n}){var r;try{if(!n)return;const s=typeof n=="string"?JSON.parse(n):n,i=s==null?void 0:s.href;if(typeof i!="string")return;const o=rL(i,t,e),a=Fl();if(a===zn.browser){if(!((r=Eo())!=null&&r.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}sL(o)}else a===zn.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(s){console.error(s)}}function rL(t,e,n){const r=`requestId=${e}&sessionTopic=${n}`;t.endsWith("/")&&(t=t.slice(0,-1));let s=`${t}`;if(t.startsWith("https://t.me")){const i=t.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${cL(r,!0)}`}else s=`${s}/wc?${r}`;return s}function sL(t){let e="_self";aL()?e="_top":(oL()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function iL(t,e){let n="";try{if($a()&&(n=localStorage.getItem(e),n))return n;n=await t.getItem(e)}catch(r){console.error(r)}return n}function Mb(t,e){if(!t.includes(e))return null;const n=t.split(/([&,?,=])/),r=n.indexOf(e);return n[r+2]}function Fb(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function Hg(){return typeof process<"u"&&BB.IS_VITEST==="true"}function oL(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function aL(){try{return window.self!==window.top}catch{return!1}}function cL(t,e=!1){const n=Buffer.from(t).toString("base64");return e?n.replace(/[=]/g,""):n}function gA(t){return Buffer.from(t,"base64").toString("utf-8")}function lL(t){return new Promise(e=>setTimeout(e,t))}let uL=class{constructor({limit:e}){Bb(this,"limit"),Bb(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){const n=this.set.values().next().value;n&&this.set.delete(n)}this.set.add(e)}}has(e){return this.set.has(e)}};const wu=BigInt(2**32-1),jb=BigInt(32);function mA(t,e=!1){return e?{h:Number(t&wu),l:Number(t>>jb&wu)}:{h:Number(t>>jb&wu)|0,l:Number(t&wu)|0}}function yA(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=mA(t[i],e);[r[i],s[i]]=[o,a]}return[r,s]}const Hb=(t,e,n)=>t>>>n,Wb=(t,e,n)=>t<<32-n|e>>>n,si=(t,e,n)=>t>>>n|e<<32-n,ii=(t,e,n)=>t<<32-n|e>>>n,lc=(t,e,n)=>t<<64-n|e>>>n-32,uc=(t,e,n)=>t>>>n-32|e<<64-n,dL=(t,e)=>e,fL=(t,e)=>t,hL=(t,e,n)=>t<<n|e>>>32-n,pL=(t,e,n)=>e<<n|t>>>32-n,gL=(t,e,n)=>e<<n-32|t>>>64-n,mL=(t,e,n)=>t<<n-32|e>>>64-n;function pr(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const Wg=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),zg=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,yL=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),bL=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,wL=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),EL=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,jo=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function mf(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Ds(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Nr(t,...e){if(!mf(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function yf(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Ds(t.outputLen),Ds(t.blockLen)}function Oi(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function qg(t,e){Nr(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function fl(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function ir(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Rh(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function kr(t,e){return t<<32-e|t>>>e}const bA=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function wA(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const fs=bA?t=>t:t=>wA(t);function vL(t){for(let e=0;e<t.length;e++)t[e]=wA(t[e]);return t}const oi=bA?t=>t:vL,EA=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",CL=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function oa(t){if(Nr(t),EA)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=CL[t[n]];return e}const cs={_0:48,_9:57,A:65,F:70,a:97,f:102};function zb(t){if(t>=cs._0&&t<=cs._9)return t-cs._0;if(t>=cs.A&&t<=cs.F)return t-(cs.A-10);if(t>=cs.a&&t<=cs.f)return t-(cs.a-10)}function Od(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(EA)return Uint8Array.fromHex(t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=zb(t.charCodeAt(i)),a=zb(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function vA(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function Ir(t){return typeof t=="string"&&(t=vA(t)),Nr(t),t}function ui(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Nr(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}let bf=class{};function jl(t){const e=r=>t().update(Ir(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function _L(t){const e=(r,s)=>t(s).update(Ir(r)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}function Po(t=32){if(jo&&typeof jo.getRandomValues=="function")return jo.getRandomValues(new Uint8Array(t));if(jo&&typeof jo.randomBytes=="function")return Uint8Array.from(jo.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}const AL=BigInt(0),Za=BigInt(1),IL=BigInt(2),SL=BigInt(7),xL=BigInt(256),NL=BigInt(113),CA=[],_A=[],AA=[];for(let t=0,e=Za,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],CA.push(2*(5*r+n)),_A.push((t+1)*(t+2)/2%64);let s=AL;for(let i=0;i<7;i++)e=(e<<Za^(e>>SL)*NL)%xL,e&IL&&(s^=Za<<(Za<<BigInt(i))-Za);AA.push(s)}const IA=yA(AA,!0),TL=IA[0],OL=IA[1],qb=(t,e,n)=>n>32?gL(t,e,n):hL(t,e,n),Vb=(t,e,n)=>n>32?mL(t,e,n):pL(t,e,n);function RL(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=qb(l,u,1)^n[a],f=Vb(l,u,1)^n[a+1];for(let h=0;h<50;h+=10)t[o+h]^=d,t[o+h+1]^=f}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=_A[o],c=qb(s,i,a),l=Vb(s,i,a),u=CA[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=TL[r],t[1]^=OL[r]}ir(n)}let PL=class SA extends bf{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,Ds(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=fl(this.state)}clone(){return this._cloneInto()}keccak(){oi(this.state32),RL(this.state32,this.rounds),oi(this.state32),this.posOut=0,this.pos=0}update(e){Oi(this),e=Ir(e),Nr(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,n&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Oi(this,!1),Nr(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Ds(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(qg(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,ir(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new SA(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const kL=(t,e,n)=>jl(()=>new PL(e,t,n)),DL=kL(1,136,256/8);function $L(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}function UL(t,e,n){return t&e^~t&n}function BL(t,e,n){return t&e^t&n^e&n}let xA=class extends bf{constructor(e,n,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(e),this.view=Rh(this.buffer)}update(e){Oi(this),e=Ir(e),Nr(e);const{view:n,buffer:r,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Rh(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Oi(this),qg(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,ir(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;$L(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=Rh(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%n&&e.buffer.set(r),e}clone(){return this._cloneInto()}};const Js=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Yt=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Zt=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),LL=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Xs=new Uint32Array(64);class ML extends xA{constructor(e=32){super(64,e,8,!1),this.A=Js[0]|0,this.B=Js[1]|0,this.C=Js[2]|0,this.D=Js[3]|0,this.E=Js[4]|0,this.F=Js[5]|0,this.G=Js[6]|0,this.H=Js[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,n,r,s,i,o,a,c]}set(e,n,r,s,i,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)Xs[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const f=Xs[d-15],h=Xs[d-2],p=kr(f,7)^kr(f,18)^f>>>3,g=kr(h,17)^kr(h,19)^h>>>10;Xs[d]=g+Xs[d-7]+p+Xs[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const f=kr(a,6)^kr(a,11)^kr(a,25),h=u+f+UL(a,c,l)+LL[d]+Xs[d]|0,p=(kr(r,2)^kr(r,13)^kr(r,22))+BL(r,s,i)|0;u=l,l=c,c=a,a=o+h|0,o=i,i=s,s=r,r=h+p|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){ir(Xs)}destroy(){this.set(0,0,0,0,0,0,0,0),ir(this.buffer)}}const NA=yA(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),FL=NA[0],jL=NA[1],Qs=new Uint32Array(80),ei=new Uint32Array(80);let Vg=class extends xA{constructor(e=64){super(128,e,16,!1),this.Ah=Zt[0]|0,this.Al=Zt[1]|0,this.Bh=Zt[2]|0,this.Bl=Zt[3]|0,this.Ch=Zt[4]|0,this.Cl=Zt[5]|0,this.Dh=Zt[6]|0,this.Dl=Zt[7]|0,this.Eh=Zt[8]|0,this.El=Zt[9]|0,this.Fh=Zt[10]|0,this.Fl=Zt[11]|0,this.Gh=Zt[12]|0,this.Gl=Zt[13]|0,this.Hh=Zt[14]|0,this.Hl=Zt[15]|0}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:f,Gh:h,Gl:p,Hh:g,Hl:m}=this;return[e,n,r,s,i,o,a,c,l,u,d,f,h,p,g,m]}set(e,n,r,s,i,o,a,c,l,u,d,f,h,p,g,m){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=f|0,this.Gh=h|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,n){for(let b=0;b<16;b++,n+=4)Qs[b]=e.getUint32(n),ei[b]=e.getUint32(n+=4);for(let b=16;b<80;b++){const _=Qs[b-15]|0,C=ei[b-15]|0,S=si(_,C,1)^si(_,C,8)^Hb(_,C,7),x=ii(_,C,1)^ii(_,C,8)^Wb(_,C,7),P=Qs[b-2]|0,N=ei[b-2]|0,L=si(P,N,19)^lc(P,N,61)^Hb(P,N,6),M=ii(P,N,19)^uc(P,N,61)^Wb(P,N,6),U=yL(x,M,ei[b-7],ei[b-16]),O=bL(U,S,L,Qs[b-7],Qs[b-16]);Qs[b]=O|0,ei[b]=U|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:f,Fh:h,Fl:p,Gh:g,Gl:m,Hh:E,Hl:A}=this;for(let b=0;b<80;b++){const _=si(d,f,14)^si(d,f,18)^lc(d,f,41),C=ii(d,f,14)^ii(d,f,18)^uc(d,f,41),S=d&h^~d&g,x=f&p^~f&m,P=wL(A,C,x,jL[b],ei[b]),N=EL(P,E,_,S,FL[b],Qs[b]),L=P|0,M=si(r,s,28)^lc(r,s,34)^lc(r,s,39),U=ii(r,s,28)^uc(r,s,34)^uc(r,s,39),O=r&i^r&a^i&a,$=s&o^s&c^o&c;E=g|0,A=m|0,g=h|0,m=p|0,h=d|0,p=f|0,{h:d,l:f}=pr(l|0,u|0,N|0,L|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const y=Wg(L,U,$);r=zg(y,N,M,O),s=y|0}({h:r,l:s}=pr(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=pr(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=pr(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=pr(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:f}=pr(this.Eh|0,this.El|0,d|0,f|0),{h,l:p}=pr(this.Fh|0,this.Fl|0,h|0,p|0),{h:g,l:m}=pr(this.Gh|0,this.Gl|0,g|0,m|0),{h:E,l:A}=pr(this.Hh|0,this.Hl|0,E|0,A|0),this.set(r,s,i,o,a,c,l,u,d,f,h,p,g,m,E,A)}roundClean(){ir(Qs,ei)}destroy(){ir(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};class HL extends Vg{constructor(){super(48),this.Ah=Yt[0]|0,this.Al=Yt[1]|0,this.Bh=Yt[2]|0,this.Bl=Yt[3]|0,this.Ch=Yt[4]|0,this.Cl=Yt[5]|0,this.Dh=Yt[6]|0,this.Dl=Yt[7]|0,this.Eh=Yt[8]|0,this.El=Yt[9]|0,this.Fh=Yt[10]|0,this.Fl=Yt[11]|0,this.Gh=Yt[12]|0,this.Gl=Yt[13]|0,this.Hh=Yt[14]|0,this.Hl=Yt[15]|0}}const Jt=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class WL extends Vg{constructor(){super(32),this.Ah=Jt[0]|0,this.Al=Jt[1]|0,this.Bh=Jt[2]|0,this.Bl=Jt[3]|0,this.Ch=Jt[4]|0,this.Cl=Jt[5]|0,this.Dh=Jt[6]|0,this.Dl=Jt[7]|0,this.Eh=Jt[8]|0,this.El=Jt[9]|0,this.Fh=Jt[10]|0,this.Fl=Jt[11]|0,this.Gh=Jt[12]|0,this.Gl=Jt[13]|0,this.Hh=Jt[14]|0,this.Hl=Jt[15]|0}}const wf=jl(()=>new ML),zL=jl(()=>new Vg),qL=jl(()=>new HL),VL=jl(()=>new WL),KL=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),vt=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),ne=new Uint32Array(32);function ti(t,e,n,r,s,i){const o=s[i],a=s[i+1];let c=ne[2*t],l=ne[2*t+1],u=ne[2*e],d=ne[2*e+1],f=ne[2*n],h=ne[2*n+1],p=ne[2*r],g=ne[2*r+1],m=Wg(c,u,o);l=zg(m,l,d,a),c=m|0,{Dh:g,Dl:p}={Dh:g^l,Dl:p^c},{Dh:g,Dl:p}={Dh:dL(g,p),Dl:fL(g)},{h,l:f}=pr(h,f,g,p),{Bh:d,Bl:u}={Bh:d^h,Bl:u^f},{Bh:d,Bl:u}={Bh:si(d,u,24),Bl:ii(d,u,24)},ne[2*t]=c,ne[2*t+1]=l,ne[2*e]=u,ne[2*e+1]=d,ne[2*n]=f,ne[2*n+1]=h,ne[2*r]=p,ne[2*r+1]=g}function ni(t,e,n,r,s,i){const o=s[i],a=s[i+1];let c=ne[2*t],l=ne[2*t+1],u=ne[2*e],d=ne[2*e+1],f=ne[2*n],h=ne[2*n+1],p=ne[2*r],g=ne[2*r+1],m=Wg(c,u,o);l=zg(m,l,d,a),c=m|0,{Dh:g,Dl:p}={Dh:g^l,Dl:p^c},{Dh:g,Dl:p}={Dh:si(g,p,16),Dl:ii(g,p,16)},{h,l:f}=pr(h,f,g,p),{Bh:d,Bl:u}={Bh:d^h,Bl:u^f},{Bh:d,Bl:u}={Bh:lc(d,u,63),Bl:uc(d,u,63)},ne[2*t]=c,ne[2*t+1]=l,ne[2*e]=u,ne[2*e+1]=d,ne[2*n]=f,ne[2*n+1]=h,ne[2*r]=p,ne[2*r+1]=g}function GL(t,e={},n,r,s){if(Ds(n),t<0||t>n)throw new Error("outputLen bigger than keyLen");const{key:i,salt:o,personalization:a}=e;if(i!==void 0&&(i.length<1||i.length>n))throw new Error("key length must be undefined or 1.."+n);if(o!==void 0&&o.length!==r)throw new Error("salt must be undefined or "+r);if(a!==void 0&&a.length!==s)throw new Error("personalization must be undefined or "+s)}class YL extends bf{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,Ds(e),Ds(n),this.blockLen=e,this.outputLen=n,this.buffer=new Uint8Array(e),this.buffer32=fl(this.buffer)}update(e){Oi(this),e=Ir(e),Nr(e);const{blockLen:n,buffer:r,buffer32:s}=this,i=e.length,o=e.byteOffset,a=e.buffer;for(let c=0;c<i;){this.pos===n&&(oi(s),this.compress(s,0,!1),oi(s),this.pos=0);const l=Math.min(n-this.pos,i-c),u=o+c;if(l===n&&!(u%4)&&c+l<i){const d=new Uint32Array(a,u,Math.floor((i-c)/4));oi(d);for(let f=0;c+n<i;f+=s.length,c+=n)this.length+=n,this.compress(d,f,!1);oi(d);continue}r.set(e.subarray(c,c+l),this.pos),this.pos+=l,this.length+=l,c+=l}return this}digestInto(e){Oi(this),qg(e,this);const{pos:n,buffer32:r}=this;this.finished=!0,ir(this.buffer.subarray(n)),oi(r),this.compress(r,0,!0),oi(r);const s=fl(e);this.get().forEach((i,o)=>s[o]=fs(i))}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){const{buffer:n,length:r,finished:s,destroyed:i,outputLen:o,pos:a}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(n),e.destroyed=i,e.finished=s,e.length=r,e.pos=a,e.outputLen=o,e}clone(){return this._cloneInto()}}class ZL extends YL{constructor(e={}){const n=e.dkLen===void 0?64:e.dkLen;super(128,n),this.v0l=vt[0]|0,this.v0h=vt[1]|0,this.v1l=vt[2]|0,this.v1h=vt[3]|0,this.v2l=vt[4]|0,this.v2h=vt[5]|0,this.v3l=vt[6]|0,this.v3h=vt[7]|0,this.v4l=vt[8]|0,this.v4h=vt[9]|0,this.v5l=vt[10]|0,this.v5h=vt[11]|0,this.v6l=vt[12]|0,this.v6h=vt[13]|0,this.v7l=vt[14]|0,this.v7h=vt[15]|0,GL(n,e,64,16,16);let{key:r,personalization:s,salt:i}=e,o=0;if(r!==void 0&&(r=Ir(r),o=r.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,i!==void 0){i=Ir(i);const a=fl(i);this.v4l^=fs(a[0]),this.v4h^=fs(a[1]),this.v5l^=fs(a[2]),this.v5h^=fs(a[3])}if(s!==void 0){s=Ir(s);const a=fl(s);this.v6l^=fs(a[0]),this.v6h^=fs(a[1]),this.v7l^=fs(a[2]),this.v7h^=fs(a[3])}if(r!==void 0){const a=new Uint8Array(this.blockLen);a.set(r),this.update(a)}}get(){let{v0l:e,v0h:n,v1l:r,v1h:s,v2l:i,v2h:o,v3l:a,v3h:c,v4l:l,v4h:u,v5l:d,v5h:f,v6l:h,v6h:p,v7l:g,v7h:m}=this;return[e,n,r,s,i,o,a,c,l,u,d,f,h,p,g,m]}set(e,n,r,s,i,o,a,c,l,u,d,f,h,p,g,m){this.v0l=e|0,this.v0h=n|0,this.v1l=r|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=l|0,this.v4h=u|0,this.v5l=d|0,this.v5h=f|0,this.v6l=h|0,this.v6h=p|0,this.v7l=g|0,this.v7h=m|0}compress(e,n,r){this.get().forEach((c,l)=>ne[l]=c),ne.set(vt,16);let{h:s,l:i}=mA(BigInt(this.length));ne[24]=vt[8]^i,ne[25]=vt[9]^s,r&&(ne[28]=~ne[28],ne[29]=~ne[29]);let o=0;const a=KL;for(let c=0;c<12;c++)ti(0,4,8,12,e,n+2*a[o++]),ni(0,4,8,12,e,n+2*a[o++]),ti(1,5,9,13,e,n+2*a[o++]),ni(1,5,9,13,e,n+2*a[o++]),ti(2,6,10,14,e,n+2*a[o++]),ni(2,6,10,14,e,n+2*a[o++]),ti(3,7,11,15,e,n+2*a[o++]),ni(3,7,11,15,e,n+2*a[o++]),ti(0,5,10,15,e,n+2*a[o++]),ni(0,5,10,15,e,n+2*a[o++]),ti(1,6,11,12,e,n+2*a[o++]),ni(1,6,11,12,e,n+2*a[o++]),ti(2,7,8,13,e,n+2*a[o++]),ni(2,7,8,13,e,n+2*a[o++]),ti(3,4,9,14,e,n+2*a[o++]),ni(3,4,9,14,e,n+2*a[o++]);this.v0l^=ne[0]^ne[16],this.v0h^=ne[1]^ne[17],this.v1l^=ne[2]^ne[18],this.v1h^=ne[3]^ne[19],this.v2l^=ne[4]^ne[20],this.v2h^=ne[5]^ne[21],this.v3l^=ne[6]^ne[22],this.v3h^=ne[7]^ne[23],this.v4l^=ne[8]^ne[24],this.v4h^=ne[9]^ne[25],this.v5l^=ne[10]^ne[26],this.v5h^=ne[11]^ne[27],this.v6l^=ne[12]^ne[28],this.v6h^=ne[13]^ne[29],this.v7l^=ne[14]^ne[30],this.v7h^=ne[15]^ne[31],ir(ne)}destroy(){this.destroyed=!0,ir(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const JL=_L(t=>new ZL(t)),XL="https://rpc.walletconnect.org/v1";function TA(t){const e=`Ethereum Signed Message:
${t.length}`,n=new TextEncoder().encode(e+t);return"0x"+Buffer.from(DL(n)).toString("hex")}async function QL(t,e,n,r,s,i){switch(n.t){case"eip191":return await eM(t,e,n.s);case"eip1271":return await tM(t,e,n.s,r,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${n.t}`)}}function eM(t,e,n){const r=xU(n);return FU({payload:TA(e),signature:r}).toLowerCase()===t.toLowerCase()}async function tM(t,e,n,r,s,i){const o=xs(r);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${r}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l=n.substring(2),u=(l.length/2).toString(16).padStart(64,"0"),d=(e.startsWith("0x")?e:TA(e)).substring(2),f=a+d+c+u+l,h=await fetch(`${i||XL}/?chainId=${r}&projectId=${s}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:nM(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:f},"latest"]})}),{result:p}=await h.json();return p?p.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function nM(){return Date.now()+Math.floor(Math.random()*1e3)}function rM(t){const e=atob(t),n=new Uint8Array(e.length);for(let o=0;o<e.length;o++)n[o]=e.charCodeAt(o);const r=n[0];if(r===0)throw new Error("No signatures found");const s=1+r*64;if(n.length<s)throw new Error("Transaction data too short for claimed signature count");if(n.length<100)throw new Error("Transaction too short");const i=Buffer.from(t,"base64").slice(1,65);return Da.encode(i)}function sM(t){const e=new Uint8Array(Buffer.from(t,"base64")),n=Array.from("TransactionData::").map(i=>i.charCodeAt(0)),r=new Uint8Array(n.length+e.length);r.set(n),r.set(e,n.length);const s=JL(r,{dkLen:32});return Da.encode(s)}function Kb(t){const e=new Uint8Array(wf(iM(t)));return Da.encode(e)}function iM(t){if(t instanceof Uint8Array)return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="object"&&t!=null&&t.data)return new Uint8Array(Object.values(t.data));if(typeof t=="object"&&t)return new Uint8Array(Object.values(t));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function Gb(t){const e=Buffer.from(t,"base64"),n=x9(e).txn;if(!n)throw new Error("Invalid signed transaction: missing 'txn' field");const r=b9(n),s=Buffer.from("TX"),i=Buffer.concat([s,Buffer.from(r)]),o=VL(i);return MU.encode(o).replace(/=+$/,"")}function Ph(t){const e=[];let n=BigInt(t);for(;n>=BigInt(128);)e.push(Number(n&BigInt(127)|BigInt(128))),n>>=BigInt(7);return e.push(Number(n)),Buffer.from(e)}function oM(t){const e=Buffer.from(t.signed.bodyBytes,"base64"),n=Buffer.from(t.signed.authInfoBytes,"base64"),r=Buffer.from(t.signature.signature,"base64"),s=[];s.push(Buffer.from([10])),s.push(Ph(e.length)),s.push(e),s.push(Buffer.from([18])),s.push(Ph(n.length)),s.push(n),s.push(Buffer.from([26])),s.push(Ph(r.length)),s.push(r);const i=Buffer.concat(s),o=wf(i);return Buffer.from(o).toString("hex").toUpperCase()}function aM(t){var e,n;const r=[];try{if(typeof t=="string")return r.push(t),r;if(typeof t!="object")return r;t!=null&&t.id&&r.push(t.id);const s=(n=(e=t==null?void 0:t.capabilities)==null?void 0:e.caip345)==null?void 0:n.transactionHashes;s&&r.push(...s)}catch(s){console.warn("getWalletSendCallsHashes failed: ",s)}return r}var cM=Object.defineProperty,lM=Object.defineProperties,uM=Object.getOwnPropertyDescriptors,Yb=Object.getOwnPropertySymbols,dM=Object.prototype.hasOwnProperty,fM=Object.prototype.propertyIsEnumerable,Zb=(t,e,n)=>e in t?cM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,hM=(t,e)=>{for(var n in e||(e={}))dM.call(e,n)&&Zb(t,n,e[n]);if(Yb)for(var n of Yb(e))fM.call(e,n)&&Zb(t,n,e[n]);return t},pM=(t,e)=>lM(t,uM(e));const OA="did:pkh:",gM={eip155:"Ethereum",solana:"Solana",bip122:"Bitcoin"},mM=t=>t?gM[t]||t:"",Ef=t=>t==null?void 0:t.split(":"),yM=t=>{const e=t&&Ef(t);if(e)return t.includes(OA)?e[3]:e[1]},bM=t=>{const e=t&&Ef(t);if(e)return t.includes(OA)?e[2]:e[0]},l0=t=>{const e=t&&Ef(t);if(e)return e[2]+":"+e[3]},Rd=t=>{const e=t&&Ef(t);if(e)return e.pop()};async function Jb(t){const{cacao:e,projectId:n}=t,{s:r,p:s}=e,i=RA(s,s.iss),o=Rd(s.iss);return await QL(o,i,r,l0(s.iss),n)}const RA=(t,e)=>{const n=bM(e);if(!n)throw new Error("Invalid issuer: "+e);const r=`${t.domain} wants you to sign in with your ${mM(n)} account:`,s=Rd(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let i=t.statement||void 0;const o=`URI: ${t.aud||t.uri}`,a=`Version: ${t.version}`,c=`Chain ID: ${yM(e)}`,l=`Nonce: ${t.nonce}`,u=`Issued At: ${t.iat}`,d=t.exp?`Expiration Time: ${t.exp}`:void 0,f=t.nbf?`Not Before: ${t.nbf}`:void 0,h=t.requestId?`Request ID: ${t.requestId}`:void 0,p=t.resources?`Resources:${t.resources.map(m=>`
- ${m}`).join("")}`:void 0,g=zu(t.resources);if(g){const m=hl(g);i=xM(i,m)}return[r,s,"",i,"",o,a,c,l,u,d,f,h,p].filter(m=>m!=null).join(`
`)};function wM(t){return Buffer.from(JSON.stringify(t)).toString("base64")}function EM(t){return JSON.parse(Buffer.from(t,"base64").toString("utf-8"))}function Co(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(n=>{const r=t.att[n];if(Array.isArray(r))throw new Error(`Resource must be an object: ${n}`);if(typeof r!="object")throw new Error(`Resource must be an object: ${n}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${n}`);Object.keys(r).forEach(s=>{const i=r[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function vM(t,e,n,r={}){return n==null||n.sort((s,i)=>s.localeCompare(i)),{att:{[t]:CM(e,n,r)}}}function CM(t,e,n={}){e=e==null?void 0:e.sort((s,i)=>s.localeCompare(i));const r=e.map(s=>({[`${t}/${s}`]:[n]}));return Object.assign({},...r)}function PA(t){return Co(t),`urn:recap:${wM(t).replace(/=/g,"")}`}function hl(t){const e=EM(t.replace("urn:recap:",""));return Co(e),e}function _M(t,e,n){const r=vM(t,e,n);return PA(r)}function AM(t){return t&&t.includes("urn:recap:")}function IM(t,e){const n=hl(t),r=hl(e),s=SM(n,r);return PA(s)}function SM(t,e){Co(t),Co(e);const n=Object.keys(t.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),r={att:{}};return n.forEach(s=>{var i,o;Object.keys(((i=t.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;r.att[s]=pM(hM({},r.att[s]),{[a]:((c=t.att[s])==null?void 0:c[a])||((l=e.att[s])==null?void 0:l[a])})})}),r}function xM(t="",e){Co(e);const n="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(n))return t;const r=[];let s=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(d=>({ability:d.split("/")[0],action:d.split("/")[1]}));c.sort((d,f)=>d.action.localeCompare(f.action));const l={};c.forEach(d=>{l[d.ability]||(l[d.ability]=[]),l[d.ability].push(d.action)});const u=Object.keys(l).map(d=>(s++,`(${s}) '${d}': '${l[d].join("', '")}' for '${a}'.`));r.push(u.join(", ").replace(".,","."))});const i=r.join(" "),o=`${n}${i}`;return`${t?t+" ":""}${o}`}function Xb(t){var e;const n=hl(t);Co(n);const r=(e=n.att)==null?void 0:e.eip155;return r?Object.keys(r).map(s=>s.split("/")[1]):[]}function Qb(t){const e=hl(t);Co(e);const n=[];return Object.values(e.att).forEach(r=>{Object.values(r).forEach(s=>{var i;(i=s==null?void 0:s[0])!=null&&i.chains&&n.push(s[0].chains)})}),[...new Set(n.flat())]}function zu(t){if(!t)return;const e=t==null?void 0:t[t.length-1];return AM(e)?e:void 0}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function kA(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function u0(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function kh(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Cn(t,...e){if(!kA(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function ew(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function NM(t,e){Cn(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function wi(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Ia(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function TM(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}const OM=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function RM(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function d0(t){if(typeof t=="string")t=RM(t);else if(kA(t))t=f0(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function PM(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function kM(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return n===0}const DM=(t,e)=>{function n(r,...s){if(Cn(r),!OM)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){const l=s[0];if(!l)throw new Error("nonce / iv required");t.varSizeNonce?Cn(l):Cn(l,t.nonceLength)}const i=t.tagLength;i&&s[1]!==void 0&&Cn(s[1]);const o=e(r,...s),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");Cn(u)}};let c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,Cn(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(Cn(l),i&&l.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(n,t),n};function tw(t,e,n=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(n&&!UM(e))throw new Error("invalid output, must be aligned");return e}function nw(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i);t.setUint32(e+4,o,r),t.setUint32(e+0,a,r)}function $M(t,e,n){u0(n);const r=new Uint8Array(16),s=TM(r);return nw(s,0,BigInt(e),n),nw(s,8,BigInt(t),n),r}function UM(t){return t.byteOffset%4===0}function f0(t){return Uint8Array.from(t)}const DA=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),BM=DA("expand 16-byte k"),LM=DA("expand 32-byte k"),MM=wi(BM),FM=wi(LM);function Le(t,e){return t<<e|t>>>32-e}function h0(t){return t.byteOffset%4===0}const Eu=64,jM=16,$A=2**32-1,rw=new Uint32Array;function HM(t,e,n,r,s,i,o,a){const c=s.length,l=new Uint8Array(Eu),u=wi(l),d=h0(s)&&h0(i),f=d?wi(s):rw,h=d?wi(i):rw;for(let p=0;p<c;o++){if(t(e,n,r,u,o,a),o>=$A)throw new Error("arx: counter overflow");const g=Math.min(Eu,c-p);if(d&&g===Eu){const m=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let E=0,A;E<jM;E++)A=m+E,h[A]=f[A]^u[E];p+=Eu;continue}for(let m=0,E;m<g;m++)E=p+m,i[E]=s[E]^l[m];p+=g}}function WM(t,e){const{allowShortKeys:n,extendNonceFn:r,counterLength:s,counterRight:i,rounds:o}=PM({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return kh(s),kh(o),u0(i),u0(n),(a,c,l,u,d=0)=>{Cn(a),Cn(c),Cn(l);const f=l.length;if(u===void 0&&(u=new Uint8Array(f)),Cn(u),kh(d),d<0||d>=$A)throw new Error("arx: counter overflow");if(u.length<f)throw new Error(`arx: output (${u.length}) is shorter than data (${f})`);const h=[];let p=a.length,g,m;if(p===32)h.push(g=f0(a)),m=FM;else if(p===16&&n)g=new Uint8Array(32),g.set(a),g.set(a,16),m=MM,h.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);h0(c)||h.push(c=f0(c));const E=wi(g);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(m,E,wi(c.subarray(0,16)),E),c=c.subarray(16)}const A=16-s;if(A!==c.length)throw new Error(`arx: nonce must be ${A} or 16 bytes`);if(A!==12){const _=new Uint8Array(12);_.set(c,i?0:12-c.length),c=_,h.push(c)}const b=wi(c);return HM(t,m,E,b,l,u,d,o),Ia(...h),u}}const Ut=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class zM{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=d0(e),Cn(e,32);const n=Ut(e,0),r=Ut(e,2),s=Ut(e,4),i=Ut(e,6),o=Ut(e,8),a=Ut(e,10),c=Ut(e,12),l=Ut(e,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=Ut(e,16+2*u)}process(e,n,r=!1){const s=r?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],d=o[4],f=o[5],h=o[6],p=o[7],g=o[8],m=o[9],E=Ut(e,n+0),A=Ut(e,n+2),b=Ut(e,n+4),_=Ut(e,n+6),C=Ut(e,n+8),S=Ut(e,n+10),x=Ut(e,n+12),P=Ut(e,n+14);let N=i[0]+(E&8191),L=i[1]+((E>>>13|A<<3)&8191),M=i[2]+((A>>>10|b<<6)&8191),U=i[3]+((b>>>7|_<<9)&8191),O=i[4]+((_>>>4|C<<12)&8191),$=i[5]+(C>>>1&8191),y=i[6]+((C>>>14|S<<2)&8191),w=i[7]+((S>>>11|x<<5)&8191),T=i[8]+((x>>>8|P<<8)&8191),D=i[9]+(P>>>5|s),R=0,k=R+N*a+L*(5*m)+M*(5*g)+U*(5*p)+O*(5*h);R=k>>>13,k&=8191,k+=$*(5*f)+y*(5*d)+w*(5*u)+T*(5*l)+D*(5*c),R+=k>>>13,k&=8191;let j=R+N*c+L*a+M*(5*m)+U*(5*g)+O*(5*p);R=j>>>13,j&=8191,j+=$*(5*h)+y*(5*f)+w*(5*d)+T*(5*u)+D*(5*l),R+=j>>>13,j&=8191;let H=R+N*l+L*c+M*a+U*(5*m)+O*(5*g);R=H>>>13,H&=8191,H+=$*(5*p)+y*(5*h)+w*(5*f)+T*(5*d)+D*(5*u),R+=H>>>13,H&=8191;let ee=R+N*u+L*l+M*c+U*a+O*(5*m);R=ee>>>13,ee&=8191,ee+=$*(5*g)+y*(5*p)+w*(5*h)+T*(5*f)+D*(5*d),R+=ee>>>13,ee&=8191;let K=R+N*d+L*u+M*l+U*c+O*a;R=K>>>13,K&=8191,K+=$*(5*m)+y*(5*g)+w*(5*p)+T*(5*h)+D*(5*f),R+=K>>>13,K&=8191;let G=R+N*f+L*d+M*u+U*l+O*c;R=G>>>13,G&=8191,G+=$*a+y*(5*m)+w*(5*g)+T*(5*p)+D*(5*h),R+=G>>>13,G&=8191;let ce=R+N*h+L*f+M*d+U*u+O*l;R=ce>>>13,ce&=8191,ce+=$*c+y*a+w*(5*m)+T*(5*g)+D*(5*p),R+=ce>>>13,ce&=8191;let ge=R+N*p+L*h+M*f+U*d+O*u;R=ge>>>13,ge&=8191,ge+=$*l+y*c+w*a+T*(5*m)+D*(5*g),R+=ge>>>13,ge&=8191;let Ne=R+N*g+L*p+M*h+U*f+O*d;R=Ne>>>13,Ne&=8191,Ne+=$*u+y*l+w*c+T*a+D*(5*m),R+=Ne>>>13,Ne&=8191;let pe=R+N*m+L*g+M*p+U*h+O*f;R=pe>>>13,pe&=8191,pe+=$*d+y*u+w*l+T*c+D*a,R+=pe>>>13,pe&=8191,R=(R<<2)+R|0,R=R+k|0,k=R&8191,R=R>>>13,j+=R,i[0]=k,i[1]=j,i[2]=H,i[3]=ee,i[4]=K,i[5]=G,i[6]=ce,i[7]=ge,i[8]=Ne,i[9]=pe}finalize(){const{h:e,pad:n}=this,r=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,r[0]=e[0]+5,s=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=e[a]+s,s=r[a]>>>13,r[a]&=8191;r[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)r[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|r[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+n[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+n[a]|0)+(o>>>16)|0,e[a]=o&65535;Ia(r)}update(e){ew(this),e=d0(e),Cn(e);const{buffer:n,blockLen:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);if(o===r){for(;r<=s-i;i+=r)this.process(e,i);continue}n.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){Ia(this.h,this.r,this.buffer,this.pad)}digestInto(e){ew(this),NM(e,this),this.finished=!0;const{buffer:n,h:r}=this;let{pos:s}=this;if(s){for(n[s++]=1;s<16;s++)n[s]=0;this.process(n,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=r[o]>>>0,e[i++]=r[o]>>>8;return e}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}}function qM(t){const e=(r,s)=>t(s).update(d0(r)).digest(),n=t(new Uint8Array(32));return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}const VM=qM(t=>new zM(t));function KM(t,e,n,r,s,i=20){let o=t[0],a=t[1],c=t[2],l=t[3],u=e[0],d=e[1],f=e[2],h=e[3],p=e[4],g=e[5],m=e[6],E=e[7],A=s,b=n[0],_=n[1],C=n[2],S=o,x=a,P=c,N=l,L=u,M=d,U=f,O=h,$=p,y=g,w=m,T=E,D=A,R=b,k=_,j=C;for(let ee=0;ee<i;ee+=2)S=S+L|0,D=Le(D^S,16),$=$+D|0,L=Le(L^$,12),S=S+L|0,D=Le(D^S,8),$=$+D|0,L=Le(L^$,7),x=x+M|0,R=Le(R^x,16),y=y+R|0,M=Le(M^y,12),x=x+M|0,R=Le(R^x,8),y=y+R|0,M=Le(M^y,7),P=P+U|0,k=Le(k^P,16),w=w+k|0,U=Le(U^w,12),P=P+U|0,k=Le(k^P,8),w=w+k|0,U=Le(U^w,7),N=N+O|0,j=Le(j^N,16),T=T+j|0,O=Le(O^T,12),N=N+O|0,j=Le(j^N,8),T=T+j|0,O=Le(O^T,7),S=S+M|0,j=Le(j^S,16),w=w+j|0,M=Le(M^w,12),S=S+M|0,j=Le(j^S,8),w=w+j|0,M=Le(M^w,7),x=x+U|0,D=Le(D^x,16),T=T+D|0,U=Le(U^T,12),x=x+U|0,D=Le(D^x,8),T=T+D|0,U=Le(U^T,7),P=P+O|0,R=Le(R^P,16),$=$+R|0,O=Le(O^$,12),P=P+O|0,R=Le(R^P,8),$=$+R|0,O=Le(O^$,7),N=N+L|0,k=Le(k^N,16),y=y+k|0,L=Le(L^y,12),N=N+L|0,k=Le(k^N,8),y=y+k|0,L=Le(L^y,7);let H=0;r[H++]=o+S|0,r[H++]=a+x|0,r[H++]=c+P|0,r[H++]=l+N|0,r[H++]=u+L|0,r[H++]=d+M|0,r[H++]=f+U|0,r[H++]=h+O|0,r[H++]=p+$|0,r[H++]=g+y|0,r[H++]=m+w|0,r[H++]=E+T|0,r[H++]=A+D|0,r[H++]=b+R|0,r[H++]=_+k|0,r[H++]=C+j|0}const GM=WM(KM,{counterRight:!1,counterLength:4,allowShortKeys:!1}),YM=new Uint8Array(16),sw=(t,e)=>{t.update(e);const n=e.length%16;n&&t.update(YM.subarray(n))},ZM=new Uint8Array(32);function iw(t,e,n,r,s){const i=t(e,n,ZM),o=VM.create(i);s&&sw(o,s),sw(o,r);const a=$M(r.length,s?s.length:0,!0);o.update(a);const c=o.digest();return Ia(i,a),c}const JM=t=>(e,n,r)=>({encrypt(s,i){const o=s.length;i=tw(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);t(e,n,a,a,1);const c=iw(t,e,n,a,r);return i.set(c,o),Ia(c),i},decrypt(s,i){i=tw(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=iw(t,e,n,o,r);if(!kM(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),t(e,n,i,i,1),Ia(c),i}}),UA=DM({blockSize:64,nonceLength:12,tagLength:16},JM(GM));let BA=class extends bf{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,yf(e);const r=Ir(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),ir(i)}update(e){return Oi(this),this.iHash.update(e),this}digestInto(e){Oi(this),Nr(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const vf=(t,e,n)=>new BA(t,e).update(n).digest();vf.create=(t,e)=>new BA(t,e);function XM(t,e,n){return yf(t),n===void 0&&(n=new Uint8Array(t.outputLen)),vf(t,Ir(n),Ir(e))}const Dh=Uint8Array.from([0]),ow=Uint8Array.of();function QM(t,e,n,r=32){yf(t),Ds(r);const s=t.outputLen;if(r>255*s)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(r/s);n===void 0&&(n=ow);const o=new Uint8Array(i*s),a=vf.create(t,e),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<i;u++)Dh[0]=u+1,c.update(u===0?ow:l).update(n).update(Dh).digestInto(l),o.set(l,s*u),a._cloneInto(c);return a.destroy(),c.destroy(),ir(l,Dh),o.slice(0,r)}const eF=(t,e,n,r,s)=>QM(t,XM(t,e,n),r,s),Cf=wf,Kg=BigInt(0),p0=BigInt(1);function Pd(t,e=""){if(typeof t!="boolean"){const n=e&&`"${e}"`;throw new Error(n+"expected boolean, got type="+typeof t)}return t}function eo(t,e,n=""){const r=mf(t),s=t==null?void 0:t.length,i=e!==void 0;if(!r||i&&s!==e){const o=n&&`"${n}" `,a=i?` of length ${e}`:"",c=r?`length=${s}`:`type=${typeof t}`;throw new Error(o+"expected Uint8Array"+a+", got "+c)}return t}function vu(t){const e=t.toString(16);return e.length&1?"0"+e:e}function LA(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Kg:BigInt("0x"+t)}function _f(t){return LA(oa(t))}function kd(t){return Nr(t),LA(oa(Uint8Array.from(t).reverse()))}function Gg(t,e){return Od(t.toString(16).padStart(e*2,"0"))}function Yg(t,e){return Gg(t,e).reverse()}function Qt(t,e,n){let r;if(typeof e=="string")try{r=Od(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(mf(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}const $h=t=>typeof t=="bigint"&&Kg<=t;function tF(t,e,n){return $h(t)&&$h(e)&&$h(n)&&e<=t&&t<n}function g0(t,e,n,r){if(!tF(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function MA(t){let e;for(e=0;t>Kg;t>>=p0,e+=1);return e}const Hl=t=>(p0<<BigInt(t))-p0;function nF(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");const r=f=>new Uint8Array(f),s=f=>Uint8Array.of(f);let i=r(t),o=r(t),a=0;const c=()=>{i.fill(1),o.fill(0),a=0},l=(...f)=>n(o,i,...f),u=(f=r(0))=>{o=l(s(0),f),i=l(),f.length!==0&&(o=l(s(1),f),i=l())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let f=0;const h=[];for(;f<e;){i=l();const p=i.slice();h.push(p),f+=i.length}return ui(...h)};return(f,h)=>{c(),u(f);let p;for(;!(p=h(d()));)u();return c(),p}}function Af(t,e,n={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function r(s,i,o){const a=t[s];if(o&&a===void 0)return;const c=typeof a;if(c!==i||a===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${c}`)}Object.entries(e).forEach(([s,i])=>r(s,i,!1)),Object.entries(n).forEach(([s,i])=>r(s,i,!0))}function aw(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const In=BigInt(0),ln=BigInt(1),to=BigInt(2),FA=BigInt(3),jA=BigInt(4),HA=BigInt(5),rF=BigInt(7),WA=BigInt(8),sF=BigInt(9),zA=BigInt(16);function Ln(t,e){const n=t%e;return n>=In?n:e+n}function hr(t,e,n){let r=t;for(;e-- >In;)r*=r,r%=n;return r}function cw(t,e){if(t===In)throw new Error("invert: expected non-zero number");if(e<=In)throw new Error("invert: expected positive modulus, got "+e);let n=Ln(t,e),r=e,s=In,i=ln;for(;n!==In;){const o=r/n,a=r%n,c=s-i*o;r=n,n=a,s=i,i=c}if(r!==ln)throw new Error("invert: does not exist");return Ln(s,e)}function Zg(t,e,n){if(!t.eql(t.sqr(e),n))throw new Error("Cannot find square root")}function qA(t,e){const n=(t.ORDER+ln)/jA,r=t.pow(e,n);return Zg(t,r,e),r}function iF(t,e){const n=(t.ORDER-HA)/WA,r=t.mul(e,to),s=t.pow(r,n),i=t.mul(e,s),o=t.mul(t.mul(i,to),s),a=t.mul(i,t.sub(o,t.ONE));return Zg(t,a,e),a}function oF(t){const e=Pi(t),n=VA(t),r=n(e,e.neg(e.ONE)),s=n(e,r),i=n(e,e.neg(r)),o=(t+rF)/zA;return(a,c)=>{let l=a.pow(c,o),u=a.mul(l,r);const d=a.mul(l,s),f=a.mul(l,i),h=a.eql(a.sqr(u),c),p=a.eql(a.sqr(d),c);l=a.cmov(l,u,h),u=a.cmov(f,d,p);const g=a.eql(a.sqr(u),c),m=a.cmov(l,u,g);return Zg(a,m,c),m}}function VA(t){if(t<FA)throw new Error("sqrt is not defined for small field");let e=t-ln,n=0;for(;e%to===In;)e/=to,n++;let r=to;const s=Pi(t);for(;lw(s,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return qA;let i=s.pow(r,e);const o=(e+ln)/to;return function(a,c){if(a.is0(c))return c;if(lw(a,c)!==1)throw new Error("Cannot find square root");let l=n,u=a.mul(a.ONE,i),d=a.pow(c,e),f=a.pow(c,o);for(;!a.eql(d,a.ONE);){if(a.is0(d))return a.ZERO;let h=1,p=a.sqr(d);for(;!a.eql(p,a.ONE);)if(h++,p=a.sqr(p),h===l)throw new Error("Cannot find square root");const g=ln<<BigInt(l-h-1),m=a.pow(u,g);l=h,u=a.sqr(m),d=a.mul(d,u),f=a.mul(f,m)}return f}}function aF(t){return t%jA===FA?qA:t%WA===HA?iF:t%zA===sF?oF(t):VA(t)}const cF=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function lF(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=cF.reduce((r,s)=>(r[s]="function",r),e);return Af(t,n),t}function uF(t,e,n){if(n<In)throw new Error("invalid exponent, negatives unsupported");if(n===In)return t.ONE;if(n===ln)return e;let r=t.ONE,s=e;for(;n>In;)n&ln&&(r=t.mul(r,s)),s=t.sqr(s),n>>=ln;return r}function KA(t,e,n=!1){const r=new Array(e.length).fill(n?t.ZERO:void 0),s=e.reduce((o,a,c)=>t.is0(a)?o:(r[c]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,c)=>t.is0(a)?o:(r[c]=t.mul(o,r[c]),t.mul(o,a)),i),r}function lw(t,e){const n=(t.ORDER-ln)/to,r=t.pow(e,n),s=t.eql(r,t.ONE),i=t.eql(r,t.ZERO),o=t.eql(r,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function GA(t,e){e!==void 0&&Ds(e);const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Pi(t,e,n=!1,r={}){if(t<=In)throw new Error("invalid field: expected ORDER > 0, got "+t);let s,i,o=!1,a;if(typeof e=="object"&&e!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const f=e;f.BITS&&(s=f.BITS),f.sqrt&&(i=f.sqrt),typeof f.isLE=="boolean"&&(n=f.isLE),typeof f.modFromBytes=="boolean"&&(o=f.modFromBytes),a=f.allowedLengths}else typeof e=="number"&&(s=e),r.sqrt&&(i=r.sqrt);const{nBitLength:c,nByteLength:l}=GA(t,s);if(l>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let u;const d=Object.freeze({ORDER:t,isLE:n,BITS:c,BYTES:l,MASK:Hl(c),ZERO:In,ONE:ln,allowedLengths:a,create:f=>Ln(f,t),isValid:f=>{if(typeof f!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof f);return In<=f&&f<t},is0:f=>f===In,isValidNot0:f=>!d.is0(f)&&d.isValid(f),isOdd:f=>(f&ln)===ln,neg:f=>Ln(-f,t),eql:(f,h)=>f===h,sqr:f=>Ln(f*f,t),add:(f,h)=>Ln(f+h,t),sub:(f,h)=>Ln(f-h,t),mul:(f,h)=>Ln(f*h,t),pow:(f,h)=>uF(d,f,h),div:(f,h)=>Ln(f*cw(h,t),t),sqrN:f=>f*f,addN:(f,h)=>f+h,subN:(f,h)=>f-h,mulN:(f,h)=>f*h,inv:f=>cw(f,t),sqrt:i||(f=>(u||(u=aF(t)),u(d,f))),toBytes:f=>n?Yg(f,l):Gg(f,l),fromBytes:(f,h=!0)=>{if(a){if(!a.includes(f.length)||f.length>l)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+f.length);const g=new Uint8Array(l);g.set(f,n?0:g.length-f.length),f=g}if(f.length!==l)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+f.length);let p=n?kd(f):_f(f);if(o&&(p=Ln(p,t)),!h&&!d.isValid(p))throw new Error("invalid field element: outside of range 0..ORDER");return p},invertBatch:f=>KA(d,f),cmov:(f,h,p)=>p?h:f});return Object.freeze(d)}function YA(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function ZA(t){const e=YA(t);return e+Math.ceil(e/2)}function dF(t,e,n=!1){const r=t.length,s=YA(e),i=ZA(e);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?kd(t):_f(t),a=Ln(o,e-ln)+ln;return n?Yg(a,s):Gg(a,s)}const Sa=BigInt(0),no=BigInt(1);function Dd(t,e){const n=e.negate();return t?n:e}function Uh(t,e){const n=KA(t.Fp,e.map(r=>r.Z));return e.map((r,s)=>t.fromAffine(r.toAffine(n[s])))}function JA(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Bh(t,e){JA(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1),s=2**t,i=Hl(t),o=BigInt(t);return{windows:n,windowSize:r,mask:i,maxNumber:s,shiftBy:o}}function uw(t,e,n){const{windowSize:r,mask:s,maxNumber:i,shiftBy:o}=n;let a=Number(t&s),c=t>>o;a>r&&(a-=i,c+=no);const l=e*r,u=l+Math.abs(a)-1,d=a===0,f=a<0,h=e%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:f,isNegF:h,offsetF:l}}function fF(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function hF(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const Lh=new WeakMap,XA=new WeakMap;function Mh(t){return XA.get(t)||1}function dw(t){if(t!==Sa)throw new Error("invalid wNAF")}class pF{constructor(e,n){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=n}_unsafeLadder(e,n,r=this.ZERO){let s=e;for(;n>Sa;)n&no&&(r=r.add(s)),s=s.double(),n>>=no;return r}precomputeWindow(e,n){const{windows:r,windowSize:s}=Bh(n,this.bits),i=[];let o=e,a=o;for(let c=0;c<r;c++){a=o,i.push(a);for(let l=1;l<s;l++)a=a.add(o),i.push(a);o=a.double()}return i}wNAF(e,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let s=this.ZERO,i=this.BASE;const o=Bh(e,this.bits);for(let a=0;a<o.windows;a++){const{nextN:c,offset:l,isZero:u,isNeg:d,isNegF:f,offsetF:h}=uw(r,a,o);r=c,u?i=i.add(Dd(f,n[h])):s=s.add(Dd(d,n[l]))}return dw(r),{p:s,f:i}}wNAFUnsafe(e,n,r,s=this.ZERO){const i=Bh(e,this.bits);for(let o=0;o<i.windows&&r!==Sa;o++){const{nextN:a,offset:c,isZero:l,isNeg:u}=uw(r,o,i);if(r=a,!l){const d=n[c];s=s.add(u?d.negate():d)}}return dw(r),s}getPrecomputes(e,n,r){let s=Lh.get(n);return s||(s=this.precomputeWindow(n,e),e!==1&&(typeof r=="function"&&(s=r(s)),Lh.set(n,s))),s}cached(e,n,r){const s=Mh(e);return this.wNAF(s,this.getPrecomputes(s,e,r),n)}unsafe(e,n,r,s){const i=Mh(e);return i===1?this._unsafeLadder(e,n,s):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),n,s)}createCache(e,n){JA(n,this.bits),XA.set(e,n),Lh.delete(e)}hasCache(e){return Mh(e)!==1}}function gF(t,e,n,r){let s=e,i=t.ZERO,o=t.ZERO;for(;n>Sa||r>Sa;)n&no&&(i=i.add(s)),r&no&&(o=o.add(s)),s=s.double(),n>>=no,r>>=no;return{p1:i,p2:o}}function mF(t,e,n,r){fF(n,t),hF(r,e);const s=n.length,i=r.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=MA(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=Hl(c),u=new Array(Number(l)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c;let f=o;for(let h=d;h>=0;h-=c){u.fill(o);for(let g=0;g<i;g++){const m=r[g],E=Number(m>>BigInt(h)&l);u[E]=u[E].add(n[g])}let p=o;for(let g=u.length-1,m=o;g>0;g--)m=m.add(u[g]),p=p.add(m);if(f=f.add(p),h!==0)for(let g=0;g<c;g++)f=f.double()}return f}function fw(t,e,n){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return lF(e),e}else return Pi(t,{isLE:n})}function yF(t,e,n={},r){if(r===void 0&&(r=t==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const a of["p","n","h"]){const c=e[a];if(!(typeof c=="bigint"&&c>Sa))throw new Error(`CURVE.${a} must be positive bigint`)}const s=fw(e.p,n.Fp,r),i=fw(e.n,n.Fn,r),o=["Gx","Gy","a","b"];for(const a of o)if(!s.isValid(e[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:s,Fn:i}}BigInt(0),BigInt(1),BigInt(2),BigInt(8),vA("HashToScalar-");const Ja=BigInt(0),Ho=BigInt(1),Cu=BigInt(2);function bF(t){return Af(t,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...t})}function wF(t){const e=bF(t),{P:n,type:r,adjustScalarBytes:s,powPminus2:i,randomBytes:o}=e,a=r==="x25519";if(!a&&r!=="x448")throw new Error("invalid type");const c=o||Po,l=a?255:448,u=a?32:56,d=BigInt(a?9:5),f=BigInt(a?121665:39081),h=a?Cu**BigInt(254):Cu**BigInt(447),p=a?BigInt(8)*Cu**BigInt(251)-Ho:BigInt(4)*Cu**BigInt(445)-Ho,g=h+p+Ho,m=U=>Ln(U,n),E=A(d);function A(U){return Yg(m(U),u)}function b(U){const O=Qt("u coordinate",U,u);return a&&(O[31]&=127),m(kd(O))}function _(U){return kd(s(Qt("scalar",U,u)))}function C(U,O){const $=P(b(O),_(U));if($===Ja)throw new Error("invalid private or public key received");return A($)}function S(U){return C(U,E)}function x(U,O,$){const y=m(U*(O-$));return O=m(O-y),$=m($+y),{x_2:O,x_3:$}}function P(U,O){g0("u",U,Ja,n),g0("scalar",O,h,g);const $=O,y=U;let w=Ho,T=Ja,D=U,R=Ho,k=Ja;for(let H=BigInt(l-1);H>=Ja;H--){const ee=$>>H&Ho;k^=ee,{x_2:w,x_3:D}=x(k,w,D),{x_2:T,x_3:R}=x(k,T,R),k=ee;const K=w+T,G=m(K*K),ce=w-T,ge=m(ce*ce),Ne=G-ge,pe=D+R,Re=D-R,st=m(Re*K),wt=m(pe*ce),St=st+wt,tn=st-wt;D=m(St*St),R=m(y*m(tn*tn)),w=m(G*ge),T=m(Ne*(G+m(f*Ne)))}({x_2:w,x_3:D}=x(k,w,D)),{x_2:T,x_3:R}=x(k,T,R);const j=i(T);return m(w*j)}const N={secretKey:u,publicKey:u,seed:u},L=(U=c(u))=>(Nr(U,N.seed),U);function M(U){const O=L(U);return{secretKey:O,publicKey:S(O)}}return{keygen:M,getSharedSecret:(U,O)=>C(U,O),getPublicKey:U=>S(U),scalarMult:C,scalarMultBase:S,utils:{randomSecretKey:L,randomPrivateKey:L},GuBytes:E.slice(),lengths:N}}const EF=BigInt(1),hw=BigInt(2),vF=BigInt(3),CF=BigInt(5);BigInt(8);const QA=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),_F={p:QA,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function AF(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=QA,o=t*t%i*t%i,a=hr(o,hw,i)*o%i,c=hr(a,EF,i)*t%i,l=hr(c,CF,i)*c%i,u=hr(l,e,i)*l%i,d=hr(u,n,i)*u%i,f=hr(d,r,i)*d%i,h=hr(f,s,i)*f%i,p=hr(h,s,i)*f%i,g=hr(p,e,i)*l%i;return{pow_p_5_8:hr(g,hw,i)*t%i,b2:o}}function IF(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const SF=Pi(_F.p,{isLE:!0}),m0=(()=>{const t=SF.ORDER;return wF({P:t,type:"x25519",powPminus2:e=>{const{pow_p_5_8:n,b2:r}=AF(e);return Ln(hr(n,vF,t)*r,t)},adjustScalarBytes:IF})})(),pw=(t,e)=>(t+(t>=0?e:-e)/e2)/e;function xF(t,e,n){const[[r,s],[i,o]]=e,a=pw(o*t,n),c=pw(-s*t,n);let l=t-a*r-c*i,u=-a*s-c*o;const d=l<_s,f=u<_s;d&&(l=-l),f&&(u=-u);const h=Hl(Math.ceil(MA(n)/2))+aa;if(l<_s||l>=h||u<_s||u>=h)throw new Error("splitScalar (endomorphism): failed, k="+t);return{k1neg:d,k1:l,k2neg:f,k2:u}}function y0(t){if(!["compact","recovered","der"].includes(t))throw new Error('Signature format must be "compact", "recovered", or "der"');return t}function Fh(t,e){const n={};for(let r of Object.keys(e))n[r]=t[r]===void 0?e[r]:t[r];return Pd(n.lowS,"lowS"),Pd(n.prehash,"prehash"),n.format!==void 0&&y0(n.format),n}class NF extends Error{constructor(e=""){super(e)}}const Es={Err:NF,_tlv:{encode:(t,e)=>{const{Err:n}=Es;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length&1)throw new n("tlv.encode: unpadded data");const r=e.length/2,s=vu(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?vu(s.length/2|128):"";return vu(t)+i+s+e},decode(t,e){const{Err:n}=Es;let r=0;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length<2||e[r++]!==t)throw new n("tlv.decode: wrong tlv");const s=e[r++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");const l=e.subarray(r,r+c);if(l.length!==c)throw new n("tlv.decode: length bytes not complete");if(l[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(r+=c,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=e.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:e.subarray(r+o)}}},_int:{encode(t){const{Err:e}=Es;if(t<_s)throw new e("integer: negative integers are not allowed");let n=vu(t);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return n},decode(t){const{Err:e}=Es;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return _f(t)}},toSig(t){const{Err:e,_int:n,_tlv:r}=Es,s=Qt("signature",t),{v:i,l:o}=r.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,i),{v:l,l:u}=r.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(l)}},hexFromSig(t){const{_tlv:e,_int:n}=Es,r=e.encode(2,n.encode(t.r)),s=e.encode(2,n.encode(t.s)),i=r+s;return e.encode(48,i)}},_s=BigInt(0),aa=BigInt(1),e2=BigInt(2),_u=BigInt(3),TF=BigInt(4);function Jo(t,e){const{BYTES:n}=t;let r;if(typeof e=="bigint")r=e;else{let s=Qt("private key",e);try{r=t.fromBytes(s)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof e}`)}}if(!t.isValidNot0(r))throw new Error("invalid private key: out of range [1..N-1]");return r}function OF(t,e={}){const n=yF("weierstrass",t,e),{Fp:r,Fn:s}=n;let i=n.CURVE;const{h:o,n:a}=i;Af(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:c}=e;if(c&&(!r.is0(i.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const l=n2(r,s);function u(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function d(U,O,$){const{x:y,y:w}=O.toAffine(),T=r.toBytes(y);if(Pd($,"isCompressed"),$){u();const D=!r.isOdd(w);return ui(t2(D),T)}else return ui(Uint8Array.of(4),T,r.toBytes(w))}function f(U){eo(U,void 0,"Point");const{publicKey:O,publicKeyUncompressed:$}=l,y=U.length,w=U[0],T=U.subarray(1);if(y===O&&(w===2||w===3)){const D=r.fromBytes(T);if(!r.isValid(D))throw new Error("bad point: is not on curve, wrong x");const R=g(D);let k;try{k=r.sqrt(R)}catch(H){const ee=H instanceof Error?": "+H.message:"";throw new Error("bad point: is not on curve, sqrt error"+ee)}u();const j=r.isOdd(k);return(w&1)===1!==j&&(k=r.neg(k)),{x:D,y:k}}else if(y===$&&w===4){const D=r.BYTES,R=r.fromBytes(T.subarray(0,D)),k=r.fromBytes(T.subarray(D,D*2));if(!m(R,k))throw new Error("bad point: is not on curve");return{x:R,y:k}}else throw new Error(`bad point: got length ${y}, expected compressed=${O} or uncompressed=${$}`)}const h=e.toBytes||d,p=e.fromBytes||f;function g(U){const O=r.sqr(U),$=r.mul(O,U);return r.add(r.add($,r.mul(U,i.a)),i.b)}function m(U,O){const $=r.sqr(O),y=g(U);return r.eql($,y)}if(!m(i.Gx,i.Gy))throw new Error("bad curve params: generator point");const E=r.mul(r.pow(i.a,_u),TF),A=r.mul(r.sqr(i.b),BigInt(27));if(r.is0(r.add(E,A)))throw new Error("bad curve params: a or b");function b(U,O,$=!1){if(!r.isValid(O)||$&&r.is0(O))throw new Error(`bad point coordinate ${U}`);return O}function _(U){if(!(U instanceof N))throw new Error("ProjectivePoint expected")}function C(U){if(!c||!c.basises)throw new Error("no endo");return xF(U,c.basises,s.ORDER)}const S=aw((U,O)=>{const{X:$,Y:y,Z:w}=U;if(r.eql(w,r.ONE))return{x:$,y};const T=U.is0();O==null&&(O=T?r.ONE:r.inv(w));const D=r.mul($,O),R=r.mul(y,O),k=r.mul(w,O);if(T)return{x:r.ZERO,y:r.ZERO};if(!r.eql(k,r.ONE))throw new Error("invZ was invalid");return{x:D,y:R}}),x=aw(U=>{if(U.is0()){if(e.allowInfinityPoint&&!r.is0(U.Y))return;throw new Error("bad point: ZERO")}const{x:O,y:$}=U.toAffine();if(!r.isValid(O)||!r.isValid($))throw new Error("bad point: x or y not field elements");if(!m(O,$))throw new Error("bad point: equation left != right");if(!U.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function P(U,O,$,y,w){return $=new N(r.mul($.X,U),$.Y,$.Z),O=Dd(y,O),$=Dd(w,$),O.add($)}class N{constructor(O,$,y){this.X=b("x",O),this.Y=b("y",$,!0),this.Z=b("z",y),Object.freeze(this)}static CURVE(){return i}static fromAffine(O){const{x:$,y}=O||{};if(!O||!r.isValid($)||!r.isValid(y))throw new Error("invalid affine point");if(O instanceof N)throw new Error("projective point not allowed");return r.is0($)&&r.is0(y)?N.ZERO:new N($,y,r.ONE)}static fromBytes(O){const $=N.fromAffine(p(eo(O,void 0,"point")));return $.assertValidity(),$}static fromHex(O){return N.fromBytes(Qt("pointHex",O))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(O=8,$=!0){return M.createCache(this,O),$||this.multiply(_u),this}assertValidity(){x(this)}hasEvenY(){const{y:O}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(O)}equals(O){_(O);const{X:$,Y:y,Z:w}=this,{X:T,Y:D,Z:R}=O,k=r.eql(r.mul($,R),r.mul(T,w)),j=r.eql(r.mul(y,R),r.mul(D,w));return k&&j}negate(){return new N(this.X,r.neg(this.Y),this.Z)}double(){const{a:O,b:$}=i,y=r.mul($,_u),{X:w,Y:T,Z:D}=this;let R=r.ZERO,k=r.ZERO,j=r.ZERO,H=r.mul(w,w),ee=r.mul(T,T),K=r.mul(D,D),G=r.mul(w,T);return G=r.add(G,G),j=r.mul(w,D),j=r.add(j,j),R=r.mul(O,j),k=r.mul(y,K),k=r.add(R,k),R=r.sub(ee,k),k=r.add(ee,k),k=r.mul(R,k),R=r.mul(G,R),j=r.mul(y,j),K=r.mul(O,K),G=r.sub(H,K),G=r.mul(O,G),G=r.add(G,j),j=r.add(H,H),H=r.add(j,H),H=r.add(H,K),H=r.mul(H,G),k=r.add(k,H),K=r.mul(T,D),K=r.add(K,K),H=r.mul(K,G),R=r.sub(R,H),j=r.mul(K,ee),j=r.add(j,j),j=r.add(j,j),new N(R,k,j)}add(O){_(O);const{X:$,Y:y,Z:w}=this,{X:T,Y:D,Z:R}=O;let k=r.ZERO,j=r.ZERO,H=r.ZERO;const ee=i.a,K=r.mul(i.b,_u);let G=r.mul($,T),ce=r.mul(y,D),ge=r.mul(w,R),Ne=r.add($,y),pe=r.add(T,D);Ne=r.mul(Ne,pe),pe=r.add(G,ce),Ne=r.sub(Ne,pe),pe=r.add($,w);let Re=r.add(T,R);return pe=r.mul(pe,Re),Re=r.add(G,ge),pe=r.sub(pe,Re),Re=r.add(y,w),k=r.add(D,R),Re=r.mul(Re,k),k=r.add(ce,ge),Re=r.sub(Re,k),H=r.mul(ee,pe),k=r.mul(K,ge),H=r.add(k,H),k=r.sub(ce,H),H=r.add(ce,H),j=r.mul(k,H),ce=r.add(G,G),ce=r.add(ce,G),ge=r.mul(ee,ge),pe=r.mul(K,pe),ce=r.add(ce,ge),ge=r.sub(G,ge),ge=r.mul(ee,ge),pe=r.add(pe,ge),G=r.mul(ce,pe),j=r.add(j,G),G=r.mul(Re,pe),k=r.mul(Ne,k),k=r.sub(k,G),G=r.mul(Ne,ce),H=r.mul(Re,H),H=r.add(H,G),new N(k,j,H)}subtract(O){return this.add(O.negate())}is0(){return this.equals(N.ZERO)}multiply(O){const{endo:$}=e;if(!s.isValidNot0(O))throw new Error("invalid scalar: out of range");let y,w;const T=D=>M.cached(this,D,R=>Uh(N,R));if($){const{k1neg:D,k1:R,k2neg:k,k2:j}=C(O),{p:H,f:ee}=T(R),{p:K,f:G}=T(j);w=ee.add(G),y=P($.beta,H,K,D,k)}else{const{p:D,f:R}=T(O);y=D,w=R}return Uh(N,[y,w])[0]}multiplyUnsafe(O){const{endo:$}=e,y=this;if(!s.isValid(O))throw new Error("invalid scalar: out of range");if(O===_s||y.is0())return N.ZERO;if(O===aa)return y;if(M.hasCache(this))return this.multiply(O);if($){const{k1neg:w,k1:T,k2neg:D,k2:R}=C(O),{p1:k,p2:j}=gF(N,y,T,R);return P($.beta,k,j,w,D)}else return M.unsafe(y,O)}multiplyAndAddUnsafe(O,$,y){const w=this.multiplyUnsafe($).add(O.multiplyUnsafe(y));return w.is0()?void 0:w}toAffine(O){return S(this,O)}isTorsionFree(){const{isTorsionFree:O}=e;return o===aa?!0:O?O(N,this):M.unsafe(this,a).is0()}clearCofactor(){const{clearCofactor:O}=e;return o===aa?this:O?O(N,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(O=!0){return Pd(O,"isCompressed"),this.assertValidity(),h(N,this,O)}toHex(O=!0){return oa(this.toBytes(O))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(O=!0){return this.toBytes(O)}_setWindowSize(O){this.precompute(O)}static normalizeZ(O){return Uh(N,O)}static msm(O,$){return mF(N,s,O,$)}static fromPrivateKey(O){return N.BASE.multiply(Jo(s,O))}}N.BASE=new N(i.Gx,i.Gy,r.ONE),N.ZERO=new N(r.ZERO,r.ONE,r.ZERO),N.Fp=r,N.Fn=s;const L=s.BITS,M=new pF(N,e.endo?Math.ceil(L/2):L);return N.BASE.precompute(8),N}function t2(t){return Uint8Array.of(t?2:3)}function n2(t,e){return{secretKey:e.BYTES,publicKey:1+t.BYTES,publicKeyUncompressed:1+2*t.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function RF(t,e={}){const{Fn:n}=t,r=e.randomBytes||Po,s=Object.assign(n2(t.Fp,n),{seed:ZA(n.ORDER)});function i(f){try{return!!Jo(n,f)}catch{return!1}}function o(f,h){const{publicKey:p,publicKeyUncompressed:g}=s;try{const m=f.length;return h===!0&&m!==p||h===!1&&m!==g?!1:!!t.fromBytes(f)}catch{return!1}}function a(f=r(s.seed)){return dF(eo(f,s.seed,"seed"),n.ORDER)}function c(f,h=!0){return t.BASE.multiply(Jo(n,f)).toBytes(h)}function l(f){const h=a(f);return{secretKey:h,publicKey:c(h)}}function u(f){if(typeof f=="bigint")return!1;if(f instanceof t)return!0;const{secretKey:h,publicKey:p,publicKeyUncompressed:g}=s;if(n.allowedLengths||h===p)return;const m=Qt("key",f).length;return m===p||m===g}function d(f,h,p=!0){if(u(f)===!0)throw new Error("first arg must be private key");if(u(h)===!1)throw new Error("second arg must be public key");const g=Jo(n,f);return t.fromHex(h).multiply(g).toBytes(p)}return Object.freeze({getPublicKey:c,getSharedSecret:d,keygen:l,Point:t,utils:{isValidSecretKey:i,isValidPublicKey:o,randomSecretKey:a,isValidPrivateKey:i,randomPrivateKey:a,normPrivateKeyToScalar:f=>Jo(n,f),precompute(f=8,h=t.BASE){return h.precompute(f,!1)}},lengths:s})}function PF(t,e,n={}){yf(e),Af(n,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=n.randomBytes||Po,s=n.hmac||(($,...y)=>vf(e,$,ui(...y))),{Fp:i,Fn:o}=t,{ORDER:a,BITS:c}=o,{keygen:l,getPublicKey:u,getSharedSecret:d,utils:f,lengths:h}=RF(t,n),p={prehash:!1,lowS:typeof n.lowS=="boolean"?n.lowS:!1,format:void 0,extraEntropy:!1},g="compact";function m($){const y=a>>aa;return $>y}function E($,y){if(!o.isValidNot0(y))throw new Error(`invalid signature ${$}: out of range 1..Point.Fn.ORDER`);return y}function A($,y){y0(y);const w=h.signature,T=y==="compact"?w:y==="recovered"?w+1:void 0;return eo($,T,`${y} signature`)}class b{constructor(y,w,T){this.r=E("r",y),this.s=E("s",w),T!=null&&(this.recovery=T),Object.freeze(this)}static fromBytes(y,w=g){A(y,w);let T;if(w==="der"){const{r:j,s:H}=Es.toSig(eo(y));return new b(j,H)}w==="recovered"&&(T=y[0],w="compact",y=y.subarray(1));const D=o.BYTES,R=y.subarray(0,D),k=y.subarray(D,D*2);return new b(o.fromBytes(R),o.fromBytes(k),T)}static fromHex(y,w){return this.fromBytes(Od(y),w)}addRecoveryBit(y){return new b(this.r,this.s,y)}recoverPublicKey(y){const w=i.ORDER,{r:T,s:D,recovery:R}=this;if(R==null||![0,1,2,3].includes(R))throw new Error("recovery id invalid");if(a*e2<w&&R>1)throw new Error("recovery id is ambiguous for h>1 curve");const k=R===2||R===3?T+a:T;if(!i.isValid(k))throw new Error("recovery id 2 or 3 invalid");const j=i.toBytes(k),H=t.fromBytes(ui(t2((R&1)===0),j)),ee=o.inv(k),K=C(Qt("msgHash",y)),G=o.create(-K*ee),ce=o.create(D*ee),ge=t.BASE.multiplyUnsafe(G).add(H.multiplyUnsafe(ce));if(ge.is0())throw new Error("point at infinify");return ge.assertValidity(),ge}hasHighS(){return m(this.s)}toBytes(y=g){if(y0(y),y==="der")return Od(Es.hexFromSig(this));const w=o.toBytes(this.r),T=o.toBytes(this.s);if(y==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return ui(Uint8Array.of(this.recovery),w,T)}return ui(w,T)}toHex(y){return oa(this.toBytes(y))}assertValidity(){}static fromCompact(y){return b.fromBytes(Qt("sig",y),"compact")}static fromDER(y){return b.fromBytes(Qt("sig",y),"der")}normalizeS(){return this.hasHighS()?new b(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return oa(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return oa(this.toBytes("compact"))}}const _=n.bits2int||function($){if($.length>8192)throw new Error("input is too large");const y=_f($),w=$.length*8-c;return w>0?y>>BigInt(w):y},C=n.bits2int_modN||function($){return o.create(_($))},S=Hl(c);function x($){return g0("num < 2^"+c,$,_s,S),o.toBytes($)}function P($,y){return eo($,void 0,"message"),y?eo(e($),void 0,"prehashed message"):$}function N($,y,w){if(["recovered","canonical"].some(ce=>ce in w))throw new Error("sign() legacy options not supported");const{lowS:T,prehash:D,extraEntropy:R}=Fh(w,p);$=P($,D);const k=C($),j=Jo(o,y),H=[x(j),x(k)];if(R!=null&&R!==!1){const ce=R===!0?r(h.secretKey):R;H.push(Qt("extraEntropy",ce))}const ee=ui(...H),K=k;function G(ce){const ge=_(ce);if(!o.isValidNot0(ge))return;const Ne=o.inv(ge),pe=t.BASE.multiply(ge).toAffine(),Re=o.create(pe.x);if(Re===_s)return;const st=o.create(Ne*o.create(K+Re*j));if(st===_s)return;let wt=(pe.x===Re?0:2)|Number(pe.y&aa),St=st;return T&&m(st)&&(St=o.neg(st),wt^=1),new b(Re,St,wt)}return{seed:ee,k2sig:G}}function L($,y,w={}){$=Qt("message",$);const{seed:T,k2sig:D}=N($,y,w);return nF(e.outputLen,o.BYTES,s)(T,D)}function M($){let y;const w=typeof $=="string"||mf($),T=!w&&$!==null&&typeof $=="object"&&typeof $.r=="bigint"&&typeof $.s=="bigint";if(!w&&!T)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(T)y=new b($.r,$.s);else if(w){try{y=b.fromBytes(Qt("sig",$),"der")}catch(D){if(!(D instanceof Es.Err))throw D}if(!y)try{y=b.fromBytes(Qt("sig",$),"compact")}catch{return!1}}return y||!1}function U($,y,w,T={}){const{lowS:D,prehash:R,format:k}=Fh(T,p);if(w=Qt("publicKey",w),y=P(Qt("message",y),R),"strict"in T)throw new Error("options.strict was renamed to lowS");const j=k===void 0?M($):b.fromBytes(Qt("sig",$),k);if(j===!1)return!1;try{const H=t.fromBytes(w);if(D&&j.hasHighS())return!1;const{r:ee,s:K}=j,G=C(y),ce=o.inv(K),ge=o.create(G*ce),Ne=o.create(ee*ce),pe=t.BASE.multiplyUnsafe(ge).add(H.multiplyUnsafe(Ne));return pe.is0()?!1:o.create(pe.x)===ee}catch{return!1}}function O($,y,w={}){const{prehash:T}=Fh(w,p);return y=P(y,T),b.fromBytes($,"recovered").recoverPublicKey(y).toBytes()}return Object.freeze({keygen:l,getPublicKey:u,getSharedSecret:d,utils:f,lengths:h,Point:t,sign:L,verify:U,recoverPublicKey:O,Signature:b,hash:e})}function kF(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},n=t.Fp;let r=t.allowedPrivateKeyLengths?Array.from(new Set(t.allowedPrivateKeyLengths.map(o=>Math.ceil(o/2)))):void 0;const s=Pi(e.n,{BITS:t.nBitLength,allowedLengths:r,modFromBytes:t.wrapPrivateKey}),i={Fp:n,Fn:s,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:i}}function DF(t){const{CURVE:e,curveOpts:n}=kF(t),r={hmac:t.hmac,randomBytes:t.randomBytes,lowS:t.lowS,bits2int:t.bits2int,bits2int_modN:t.bits2int_modN};return{CURVE:e,curveOpts:n,hash:t.hash,ecdsaOpts:r}}function $F(t,e){const n=e.Point;return Object.assign({},e,{ProjectivePoint:n,CURVE:Object.assign({},t,GA(n.Fn.ORDER,n.Fn.BITS))})}function UF(t){const{CURVE:e,curveOpts:n,hash:r,ecdsaOpts:s}=DF(t),i=OF(e,n),o=PF(i,r,s);return $F(t,o)}function b0(t,e){const n=r=>UF({...t,hash:r});return{...n(e),create:n}}const r2={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},s2={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},i2={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},BF=Pi(r2.p),LF=Pi(s2.p),MF=Pi(i2.p),FF=b0({...r2,Fp:BF,lowS:!1},wf);b0({...s2,Fp:LF,lowS:!1},qL),b0({...i2,Fp:MF,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},zL);const jF=FF,o2="base10",un="base16",_n="base64pad",di="base64url",Wl="utf8",a2=0,Ns=1,zl=2,HF=0,gw=1,yc=12,Jg=32;function WF(){const t=m0.utils.randomPrivateKey(),e=m0.getPublicKey(t);return{privateKey:xn(t,un),publicKey:xn(e,un)}}function w0(){const t=Po(Jg);return xn(t,un)}function zF(t,e){const n=m0.getSharedSecret(tr(t,un),tr(e,un)),r=eF(Cf,n,void 0,void 0,Jg);return xn(r,un)}function qu(t){const e=Cf(tr(t,un));return xn(e,un)}function Qn(t){const e=Cf(tr(t,Wl));return xn(e,un)}function c2(t){return tr(`${t}`,o2)}function _o(t){return Number(xn(t,o2))}function l2(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function u2(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),n=(4-e.length%4)%4;return e+"=".repeat(n)}function qF(t){const e=c2(typeof t.type<"u"?t.type:a2);if(_o(e)===Ns&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const n=typeof t.senderPublicKey<"u"?tr(t.senderPublicKey,un):void 0,r=typeof t.iv<"u"?tr(t.iv,un):Po(yc),s=tr(t.symKey,un),i=UA(s,r).encrypt(tr(t.message,Wl)),o=d2({type:e,sealed:i,iv:r,senderPublicKey:n});return t.encoding===di?l2(o):o}function VF(t){const e=tr(t.symKey,un),{sealed:n,iv:r}=pl({encoded:t.encoded,encoding:t.encoding}),s=UA(e,r).decrypt(n);if(s===null)throw new Error("Failed to decrypt");return xn(s,Wl)}function KF(t,e){const n=c2(zl),r=Po(yc),s=tr(t,Wl),i=d2({type:n,sealed:s,iv:r});return e===di?l2(i):i}function GF(t,e){const{sealed:n}=pl({encoded:t,encoding:e});return xn(n,Wl)}function d2(t){if(_o(t.type)===zl)return xn(mc([t.type,t.sealed]),_n);if(_o(t.type)===Ns){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return xn(mc([t.type,t.senderPublicKey,t.iv,t.sealed]),_n)}return xn(mc([t.type,t.iv,t.sealed]),_n)}function pl(t){const e=(t.encoding||_n)===di?u2(t.encoded):t.encoded,n=tr(e,_n),r=n.slice(HF,gw),s=gw;if(_o(r)===Ns){const c=s+Jg,l=c+yc,u=n.slice(s,c),d=n.slice(c,l),f=n.slice(l);return{type:r,sealed:f,iv:d,senderPublicKey:u}}if(_o(r)===zl){const c=n.slice(s),l=Po(yc);return{type:r,sealed:c,iv:l}}const i=s+yc,o=n.slice(s,i),a=n.slice(i);return{type:r,sealed:a,iv:o}}function YF(t,e){const n=pl({encoded:t,encoding:e==null?void 0:e.encoding});return f2({type:_o(n.type),senderPublicKey:typeof n.senderPublicKey<"u"?xn(n.senderPublicKey,un):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function f2(t){const e=(t==null?void 0:t.type)||a2;if(e===Ns){if(typeof(t==null?void 0:t.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(t==null?void 0:t.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t==null?void 0:t.senderPublicKey,receiverPublicKey:t==null?void 0:t.receiverPublicKey}}function mw(t){return t.type===Ns&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function yw(t){return t.type===zl}function ZF(t){const e=Buffer.from(t.x,"base64"),n=Buffer.from(t.y,"base64");return mc([new Uint8Array([4]),e,n])}function JF(t,e){const[n,r,s]=t.split("."),i=Buffer.from(u2(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${n}.${r}`,l=Cf(c),u=ZF(e);if(!jF.verify(mc([o,a]),l,u))throw new Error("Invalid signature");return Zp(t).payload}const XF="irn";function $d(t){return(t==null?void 0:t.relay)||{protocol:XF}}function Xo(t){const e=AB[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var QF=Object.defineProperty,e7=Object.defineProperties,t7=Object.getOwnPropertyDescriptors,bw=Object.getOwnPropertySymbols,n7=Object.prototype.hasOwnProperty,r7=Object.prototype.propertyIsEnumerable,ww=(t,e,n)=>e in t?QF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,jh=(t,e)=>{for(var n in e||(e={}))n7.call(e,n)&&ww(t,n,e[n]);if(bw)for(var n of bw(e))r7.call(e,n)&&ww(t,n,e[n]);return t},s7=(t,e)=>e7(t,t7(e));function i7(t,e="-"){const n={},r="relay"+e;return Object.keys(t).forEach(s=>{if(s.startsWith(r)){const i=s.replace(r,""),o=t[s];n[i]=o}}),n}function Ew(t){if(!t.includes("wc:")){const l=gA(t);l!=null&&l.includes("wc:")&&(t=l)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),n=t.indexOf("?")!==-1?t.indexOf("?"):void 0,r=t.substring(0,e),s=t.substring(e+1,n).split("@"),i=typeof n<"u"?t.substring(n):"",o=new URLSearchParams(i),a=Object.fromEntries(o.entries()),c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:r,topic:o7(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:i7(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function o7(t){return t.startsWith("//")?t.substring(2):t}function a7(t,e="-"){const n="relay",r={};return Object.keys(t).forEach(s=>{const i=s,o=n+e+i;t[i]&&(r[o]=t[i])}),r}function vw(t){const e=new URLSearchParams,n=jh(jh(s7(jh({},a7(t.relay)),{symKey:t.symKey}),t.expiryTimestamp&&{expiryTimestamp:t.expiryTimestamp.toString()}),t.methods&&{methods:t.methods.join(",")});return Object.entries(n).sort(([r],[s])=>r.localeCompare(s)).forEach(([r,s])=>{s!==void 0&&e.append(r,String(s))}),`${t.protocol}:${t.topic}@${t.version}?${e}`}function Au(t,e,n){return`${t}?wc_ev=${n}&topic=${e}`}var c7=Object.defineProperty,l7=Object.defineProperties,u7=Object.getOwnPropertyDescriptors,Cw=Object.getOwnPropertySymbols,d7=Object.prototype.hasOwnProperty,f7=Object.prototype.propertyIsEnumerable,_w=(t,e,n)=>e in t?c7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,h7=(t,e)=>{for(var n in e||(e={}))d7.call(e,n)&&_w(t,n,e[n]);if(Cw)for(var n of Cw(e))f7.call(e,n)&&_w(t,n,e[n]);return t},p7=(t,e)=>l7(t,u7(e));function Ua(t){const e=[];return t.forEach(n=>{const[r,s]=n.split(":");e.push(`${r}:${s}`)}),e}function h2(t){const e=[];return Object.values(t).forEach(n=>{e.push(...Ua(n.accounts))}),[...new Set(e)]}function g7(t){const e=[];return Object.values(t).forEach(n=>{e.push(...n.methods)}),[...new Set(e)]}function m7(t){const e=[];return Object.values(t).forEach(n=>{e.push(...n.events)}),[...new Set(e)]}function y7(t,e){const n=[];return Object.values(t).forEach(r=>{Ua(r.accounts).includes(e)&&n.push(...r.methods)}),n}function b7(t,e){const n=[];return Object.values(t).forEach(r=>{Ua(r.accounts).includes(e)&&n.push(...r.events)}),n}function If(t){return t.includes(":")}function Qo(t){return If(t)?t.split(":")[0]:t}function Aw(t){var e,n,r;const s={};if(!Kr(t))return s;for(const[i,o]of Object.entries(t)){const a=If(i)?[i]:o.chains,c=o.methods||[],l=o.events||[],u=Qo(i);s[u]=p7(h7({},s[u]),{chains:Vr(a,(e=s[u])==null?void 0:e.chains),methods:Vr(c,(n=s[u])==null?void 0:n.methods),events:Vr(l,(r=s[u])==null?void 0:r.events)})}return s}function w7(t){const e={};return t==null||t.forEach(n=>{var r;const[s,i]=n.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(n),(r=e[s].chains)==null||r.push(`${s}:${i}`)}),e}function Iw(t,e){e=e.map(r=>r.replace("did:pkh:",""));const n=w7(e);for(const[r,s]of Object.entries(n))s.methods?s.methods=Vr(s.methods,t):s.methods=t,s.events=["chainChanged","accountsChanged"];return n}function E7(t,e){var n,r,s,i,o,a;const c=Aw(t),l=Aw(e),u={},d=Object.keys(c).concat(Object.keys(l));for(const f of d)u[f]={chains:Vr((n=c[f])==null?void 0:n.chains,(r=l[f])==null?void 0:r.chains),methods:Vr((s=c[f])==null?void 0:s.methods,(i=l[f])==null?void 0:i.methods),events:Vr((o=c[f])==null?void 0:o.events,(a=l[f])==null?void 0:a.events)};return u}const v7={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},C7={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function X(t,e){const{message:n,code:r}=C7[t];return{message:e?`${n} ${e}`:n,code:r}}function nt(t,e){const{message:n,code:r}=v7[t];return{message:e?`${n} ${e}`:n,code:r}}function Ts(t,e){return!!Array.isArray(t)}function Kr(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function Rt(t){return typeof t>"u"}function yt(t,e){return e&&Rt(t)?!0:typeof t=="string"&&!!t.trim().length}function Xg(t,e){return typeof t=="number"&&!isNaN(t)}function _7(t,e){const{requiredNamespaces:n}=e,r=Object.keys(t.namespaces),s=Object.keys(n);let i=!0;return Qi(s,r)?(r.forEach(o=>{const{accounts:a,methods:c,events:l}=t.namespaces[o],u=Ua(a),d=n[o];(!Qi(uA(o,d),u)||!Qi(d.methods,c)||!Qi(d.events,l))&&(i=!1)}),i):!1}function Ud(t){return yt(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function A7(t){if(yt(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const n=e[0]+":"+e[1];return!!e[2]&&Ud(n)}}return!1}function I7(t){function e(n){try{return typeof new URL(n)<"u"}catch{return!1}}try{if(yt(t,!1)){if(e(t))return!0;const n=gA(t);return e(n)}}catch{}return!1}function S7(t){var e;return(e=t==null?void 0:t.proposer)==null?void 0:e.publicKey}function x7(t){return t==null?void 0:t.topic}function N7(t,e){let n=null;return yt(t==null?void 0:t.publicKey,!1)||(n=X("MISSING_OR_INVALID",`${e} controller public key should be a string`)),n}function Sw(t){let e=!0;return Ts(t)?t.length&&(e=t.every(n=>yt(n,!1))):e=!1,e}function T7(t,e,n){let r=null;return Ts(e)&&e.length?e.forEach(s=>{r||Ud(s)||(r=nt("UNSUPPORTED_CHAINS",`${n}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):Ud(t)||(r=nt("UNSUPPORTED_CHAINS",`${n}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),r}function O7(t,e,n){let r=null;return Object.entries(t).forEach(([s,i])=>{if(r)return;const o=T7(s,uA(s,i),`${e} ${n}`);o&&(r=o)}),r}function R7(t,e){let n=null;return Ts(t)?t.forEach(r=>{n||A7(r)||(n=nt("UNSUPPORTED_ACCOUNTS",`${e}, account ${r} should be a string and conform to "namespace:chainId:address" format`))}):n=nt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n}function P7(t,e){let n=null;return Object.values(t).forEach(r=>{if(n)return;const s=R7(r==null?void 0:r.accounts,`${e} namespace`);s&&(n=s)}),n}function k7(t,e){let n=null;return Sw(t==null?void 0:t.methods)?Sw(t==null?void 0:t.events)||(n=nt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):n=nt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),n}function p2(t,e){let n=null;return Object.values(t).forEach(r=>{if(n)return;const s=k7(r,`${e}, namespace`);s&&(n=s)}),n}function D7(t,e,n){let r=null;if(t&&Kr(t)){const s=p2(t,e);s&&(r=s);const i=O7(t,e,n);i&&(r=i)}else r=X("MISSING_OR_INVALID",`${e}, ${n} should be an object with data`);return r}function Hh(t,e){let n=null;if(t&&Kr(t)){const r=p2(t,e);r&&(n=r);const s=P7(t,e);s&&(n=s)}else n=X("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return n}function g2(t){return yt(t.protocol,!0)}function $7(t,e){let n=!1;return t?t&&Ts(t)&&t.length&&t.forEach(r=>{n=g2(r)}):n=!0,n}function U7(t){return typeof t=="number"}function wn(t){return typeof t<"u"&&typeof t!==null}function B7(t){return!(!t||typeof t!="object"||!t.code||!Xg(t.code)||!t.message||!yt(t.message,!1))}function L7(t){return!(Rt(t)||!yt(t.method,!1))}function M7(t){return!(Rt(t)||Rt(t.result)&&Rt(t.error)||!Xg(t.id)||!yt(t.jsonrpc,!1))}function F7(t){return!(Rt(t)||!yt(t.name,!1))}function xw(t,e){return!(!Ud(e)||!h2(t).includes(e))}function j7(t,e,n){return yt(n,!1)?y7(t,e).includes(n):!1}function H7(t,e,n){return yt(n,!1)?b7(t,e).includes(n):!1}function Nw(t,e,n){let r=null;const s=W7(t),i=z7(e),o=Object.keys(s),a=Object.keys(i),c=Tw(Object.keys(t)),l=Tw(Object.keys(e)),u=c.filter(d=>!l.includes(d));return u.length&&(r=X("NON_CONFORMING_NAMESPACES",`${n} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),Qi(o,a)||(r=X("NON_CONFORMING_NAMESPACES",`${n} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(d=>{if(!d.includes(":")||r)return;const f=Ua(e[d].accounts);f.includes(d)||(r=X("NON_CONFORMING_NAMESPACES",`${n} namespaces accounts don't satisfy namespace accounts for ${d}
        Required: ${d}
        Approved: ${f.toString()}`))}),o.forEach(d=>{r||(Qi(s[d].methods,i[d].methods)?Qi(s[d].events,i[d].events)||(r=X("NON_CONFORMING_NAMESPACES",`${n} namespaces events don't satisfy namespace events for ${d}`)):r=X("NON_CONFORMING_NAMESPACES",`${n} namespaces methods don't satisfy namespace methods for ${d}`))}),r}function W7(t){const e={};return Object.keys(t).forEach(n=>{var r;n.includes(":")?e[n]=t[n]:(r=t[n].chains)==null||r.forEach(s=>{e[s]={methods:t[n].methods,events:t[n].events}})}),e}function Tw(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function z7(t){const e={};return Object.keys(t).forEach(n=>{if(n.includes(":"))e[n]=t[n];else{const r=Ua(t[n].accounts);r==null||r.forEach(s=>{e[s]={accounts:t[n].accounts.filter(i=>i.includes(`${s}:`)),methods:t[n].methods,events:t[n].events}})}}),e}function q7(t,e){return Xg(t)&&t<=e.max&&t>=e.min}function Ow(){const t=Fl();return new Promise(e=>{switch(t){case zn.browser:e(V7());break;case zn.reactNative:e(K7());break;case zn.node:e(G7());break;default:e(!0)}})}function V7(){return $a()&&(navigator==null?void 0:navigator.onLine)}async function K7(){if(Ri()&&typeof global<"u"&&global!=null&&global.NetInfo){const t=await(global==null?void 0:global.NetInfo.fetch());return t==null?void 0:t.isConnected}return!0}function G7(){return!0}function Y7(t){switch(Fl()){case zn.browser:Z7(t);break;case zn.reactNative:J7(t);break}}function Z7(t){!Ri()&&$a()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function J7(t){Ri()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>t(e==null?void 0:e.isConnected)))}function X7(){var t;return $a()&&Eo()?((t=Eo())==null?void 0:t.visibilityState)==="visible":!0}const Wh={};class Xa{static get(e){return Wh[e]}static set(e,n){Wh[e]=n}static delete(e){delete Wh[e]}}function Q7(t){const e=Da.decode(t);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function ej({publicKey:t,signature:e,payload:n}){var r;const s=E0(n.method),i=128|parseInt(((r=n.version)==null?void 0:r.toString())||"4"),o=rj(n.address),a=n.era==="00"?new Uint8Array([0]):E0(n.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");const c=parseInt(n.nonce,16),l=new Uint8Array([c&255,c>>8&255]),u=BigInt(`0x${nj(n.tip)}`),d=ij(u),f=new Uint8Array([0,...t,o,...e,...a,...l,...d,...s]),h=sj(f.length+1);return new Uint8Array([...h,i,...f])}function tj(t){const e=E0(t),n=UB.blake2b(e,void 0,32);return"0x"+Buffer.from(n).toString("hex")}function E0(t){return new Uint8Array(t.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function nj(t){return t.startsWith("0x")?t.slice(2):t}function rj(t){const e=Da.decode(t)[0];return e===42?0:e===60?2:1}function sj(t){if(t<64)return new Uint8Array([t<<2]);if(t<16384){const e=t<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(t<1<<30){const e=t<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function ij(t){if(t<BigInt(1)<<BigInt(6))return new Uint8Array([Number(t<<BigInt(2))]);if(t<BigInt(1)<<BigInt(14)){const e=t<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(t<BigInt(1)<<BigInt(30)){const e=t<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function oj(t){const e=Uint8Array.from(Buffer.from(t.signature,"hex")),n=Q7(t.transaction.address),r=ej({publicKey:n,signature:e,payload:t.transaction}),s=Buffer.from(r).toString("hex");return tj(s)}function Qg({logger:t,name:e}){const n=typeof t=="string"?Gd({opts:{level:t,name:e}}).logger:t;return n.level=typeof t=="string"?t:t.level,n}const aj="PARSE_ERROR",cj="INVALID_REQUEST",lj="METHOD_NOT_FOUND",uj="INVALID_PARAMS",m2="INTERNAL_ERROR",em="SERVER_ERROR",dj=[-32700,-32600,-32601,-32602,-32603],bc={[aj]:{code:-32700,message:"Parse error"},[cj]:{code:-32600,message:"Invalid Request"},[lj]:{code:-32601,message:"Method not found"},[uj]:{code:-32602,message:"Invalid params"},[m2]:{code:-32603,message:"Internal error"},[em]:{code:-32e3,message:"Server error"}},y2=em;function fj(t){return dj.includes(t)}function Rw(t){return Object.keys(bc).includes(t)?bc[t]:bc[y2]}function hj(t){const e=Object.values(bc).find(n=>n.code===t);return e||bc[y2]}function b2(t,e,n){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${e}`):t}var w2={},ls={},Pw;function pj(){if(Pw)return ls;Pw=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.isBrowserCryptoAvailable=ls.getSubtleCrypto=ls.getBrowerCrypto=void 0;function t(){return(Mr==null?void 0:Mr.crypto)||(Mr==null?void 0:Mr.msCrypto)||{}}ls.getBrowerCrypto=t;function e(){const r=t();return r.subtle||r.webkitSubtle}ls.getSubtleCrypto=e;function n(){return!!t()&&!!e()}return ls.isBrowserCryptoAvailable=n,ls}var us={},kw;function gj(){if(kw)return us;kw=1,Object.defineProperty(us,"__esModule",{value:!0}),us.isBrowser=us.isNode=us.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}us.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}us.isNode=e;function n(){return!t()&&!e()}return us.isBrowser=n,us}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Dl;e.__exportStar(pj(),t),e.__exportStar(gj(),t)})(w2);function Br(t=3){const e=Date.now()*Math.pow(10,t),n=Math.floor(Math.random()*Math.pow(10,t));return e+n}function gi(t=6){return BigInt(Br(t))}function yr(t,e,n){return{id:n||Br(),jsonrpc:"2.0",method:t,params:e}}function gl(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Sf(t,e,n){return{id:t,jsonrpc:"2.0",error:mj(e)}}function mj(t,e){return typeof t>"u"?Rw(m2):(typeof t=="string"&&(t=Object.assign(Object.assign({},Rw(em)),{message:t})),fj(t.code)&&(t=hj(t.code)),t)}let yj=class{},bj=class extends yj{constructor(){super()}},wj=class extends bj{constructor(e){super()}};const Ej="^https?:",vj="^wss?:";function Cj(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function E2(t,e){const n=Cj(t);return typeof n>"u"?!1:new RegExp(e).test(n)}function Dw(t){return E2(t,Ej)}function $w(t){return E2(t,vj)}function _j(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function v2(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function tm(t){return v2(t)&&"method"in t}function xf(t){return v2(t)&&(Lr(t)||er(t))}function Lr(t){return"result"in t}function er(t){return"error"in t}let nm=class extends wj{constructor(e){super(e),this.events=new cr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async request(e,n){return this.requestStrict(yr(e.method,e.params||[],e.id||gi().toString()),n)}async requestStrict(e,n){return new Promise(async(r,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{er(i)?s(i.error):r(i.result)});try{await this.connection.send(e,n)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),xf(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const Aj=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),Ij=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Uw=t=>t.split("?")[0],Bw=10,Sj=Aj();let xj=class{constructor(e){if(this.url=e,this.events=new cr.EventEmitter,this.registering=!1,!$w(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,n)=>{if(typeof this.socket>"u"){n(new Error("Connection already closed"));return}this.socket.onclose=r=>{this.onClose(r),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ks(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!$w(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));r(this.socket)})})}return this.url=e,this.registering=!0,new Promise((n,r)=>{const s=w2.isReactNative()?void 0:{rejectUnauthorized:!_j(e)},i=new Sj(e,[],s);Ij()?i.onerror=o=>{const a=o;r(this.emitError(a.error))}:i.on("error",o=>{r(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),n(i)}})}onOpen(e){e.onmessage=n=>this.onPayload(n),e.onclose=n=>this.onClose(n),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?po(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const r=this.parseError(n),s=r.message||r.toString(),i=Sf(e,s);this.events.emit("payload",i)}parseError(e,n=this.url){return b2(e,Uw(n),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Bw&&this.events.setMaxListeners(Bw)}emitError(e){const n=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${Uw(this.url)}`));return this.events.emit("register_error",n),n}};var Nj={};const C2="wc",_2=2,v0="core",Xr=`${C2}@2:${v0}:`,Tj={logger:"error"},Oj={database:":memory:"},Rj="crypto",Lw="client_ed25519_seed",Pj=J.ONE_DAY,kj="keychain",Dj="0.3",$j="messages",Uj="0.3",Bj=J.SIX_HOURS,Lj="publisher",A2="irn",Mj="error",I2="wss://relay.walletconnect.org",Fj="relayer",mt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},jj="_subscription",Kn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Hj=.1,C0="2.23.0",et={link_mode:"link_mode",relay:"relay"},Vu={inbound:"inbound",outbound:"outbound"},Wj="0.3",zj="WALLETCONNECT_CLIENT_ID",Mw="WALLETCONNECT_LINK_MODE_APPS",Un={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},qj="subscription",Vj="0.3",Kj="pairing",Gj="0.3",Qa={wc_pairingDelete:{req:{ttl:J.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:J.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:J.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:J.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:J.ONE_DAY,prompt:!1,tag:0},res:{ttl:J.ONE_DAY,prompt:!1,tag:0}}},Vi={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},ur={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Yj="history",Zj="0.3",Jj="expirer",Jn={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Xj="0.3",Qj="verify-api",eH="https://verify.walletconnect.com",S2="https://verify.walletconnect.org",wc=S2,tH=`${wc}/v3`,nH=[eH,S2],rH="echo",sH="https://echo.walletconnect.com",Ur={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},hs={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},dr={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success",session_request_response_started:"session_request_response_started",session_request_response_validation_success:"session_request_response_validation_success",session_request_response_publish_started:"session_request_response_publish_started"},Li={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found",session_request_response_validation_failure:"session_request_response_validation_failure",session_request_response_publish_failure:"session_request_response_publish_failure"},Mi={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},ec={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},iH=.1,oH="event-client",aH=86400,cH="https://pulse.walletconnect.org/batch";function lH(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,E=0,A=p.length;E!==A&&p[E]===0;)E++,g++;for(var b=(A-E)*u+1>>>0,_=new Uint8Array(b);E!==A;){for(var C=p[E],S=0,x=b-1;(C!==0||S<m)&&x!==-1;x--,S++)C+=256*_[x]>>>0,_[x]=C%a>>>0,C=C/a>>>0;if(C!==0)throw new Error("Non-zero carry");m=S,E++}for(var P=b-m;P!==b&&_[P]===0;)P++;for(var N=c.repeat(g);P<b;++P)N+=t.charAt(_[P]);return N}function f(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,E=0;p[g]===c;)m++,g++;for(var A=(p.length-g)*l+1>>>0,b=new Uint8Array(A);p[g];){var _=n[p.charCodeAt(g)];if(_===255)return;for(var C=0,S=A-1;(_!==0||C<E)&&S!==-1;S--,C++)_+=a*b[S]>>>0,b[S]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");E=C,g++}if(p[g]!==" "){for(var x=A-E;x!==A&&b[x]===0;)x++;for(var P=new Uint8Array(m+(A-x)),N=m;x!==A;)P[N++]=b[x++];return P}}}function h(p){var g=f(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:f,decode:h}}var uH=lH,dH=uH;const x2=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},fH=t=>new TextEncoder().encode(t),hH=t=>new TextDecoder().decode(t);class pH{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class gH{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return N2(this,e)}}class mH{constructor(e){this.decoders=e}or(e){return N2(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const N2=(t,e)=>new mH({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class yH{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new pH(e,n,r),this.decoder=new gH(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Nf=({name:t,prefix:e,encode:n,decode:r})=>new yH(t,e,n,r),ql=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=dH(n,e);return Nf({prefix:t,name:e,encode:r,decode:i=>x2(s(i))})},bH=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},wH=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},zt=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>Nf({prefix:e,name:t,encode(s){return wH(s,r,n)},decode(s){return bH(s,r,n,t)}}),EH=Nf({prefix:"\0",name:"identity",encode:t=>hH(t),decode:t=>fH(t)});var vH=Object.freeze({__proto__:null,identity:EH});const CH=zt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var _H=Object.freeze({__proto__:null,base2:CH});const AH=zt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var IH=Object.freeze({__proto__:null,base8:AH});const SH=ql({prefix:"9",name:"base10",alphabet:"0123456789"});var xH=Object.freeze({__proto__:null,base10:SH});const NH=zt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),TH=zt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var OH=Object.freeze({__proto__:null,base16:NH,base16upper:TH});const RH=zt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),PH=zt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),kH=zt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),DH=zt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),$H=zt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),UH=zt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),BH=zt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),LH=zt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),MH=zt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var FH=Object.freeze({__proto__:null,base32:RH,base32upper:PH,base32pad:kH,base32padupper:DH,base32hex:$H,base32hexupper:UH,base32hexpad:BH,base32hexpadupper:LH,base32z:MH});const jH=ql({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),HH=ql({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var WH=Object.freeze({__proto__:null,base36:jH,base36upper:HH});const zH=ql({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),qH=ql({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var VH=Object.freeze({__proto__:null,base58btc:zH,base58flickr:qH});const KH=zt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),GH=zt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),YH=zt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ZH=zt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var JH=Object.freeze({__proto__:null,base64:KH,base64pad:GH,base64url:YH,base64urlpad:ZH});const T2=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),XH=T2.reduce((t,e,n)=>(t[n]=e,t),[]),QH=T2.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function eW(t){return t.reduce((e,n)=>(e+=XH[n],e),"")}function tW(t){const e=[];for(const n of t){const r=QH[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const nW=Nf({prefix:"ðŸš€",name:"base256emoji",encode:eW,decode:tW});var rW=Object.freeze({__proto__:null,base256emoji:nW}),sW=O2,Fw=128,iW=-128,oW=Math.pow(2,31);function O2(t,e,n){e=e||[],n=n||0;for(var r=n;t>=oW;)e[n++]=t&255|Fw,t/=128;for(;t&iW;)e[n++]=t&255|Fw,t>>>=7;return e[n]=t|0,O2.bytes=n-r+1,e}var aW=_0,cW=128,jw=127;function _0(t,r){var n=0,r=r||0,s=0,i=r,o,a=t.length;do{if(i>=a)throw _0.bytes=0,new RangeError("Could not decode varint");o=t[i++],n+=s<28?(o&jw)<<s:(o&jw)*Math.pow(2,s),s+=7}while(o>=cW);return _0.bytes=i-r,n}var lW=Math.pow(2,7),uW=Math.pow(2,14),dW=Math.pow(2,21),fW=Math.pow(2,28),hW=Math.pow(2,35),pW=Math.pow(2,42),gW=Math.pow(2,49),mW=Math.pow(2,56),yW=Math.pow(2,63),bW=function(t){return t<lW?1:t<uW?2:t<dW?3:t<fW?4:t<hW?5:t<pW?6:t<gW?7:t<mW?8:t<yW?9:10},wW={encode:sW,decode:aW,encodingLength:bW},R2=wW;const Hw=(t,e,n=0)=>(R2.encode(t,e,n),e),Ww=t=>R2.encodingLength(t),A0=(t,e)=>{const n=e.byteLength,r=Ww(t),s=r+Ww(n),i=new Uint8Array(s+n);return Hw(t,i,0),Hw(n,i,r),i.set(e,s),new EW(t,n,e,i)};class EW{constructor(e,n,r,s){this.code=e,this.size=n,this.digest=r,this.bytes=s}}const P2=({name:t,code:e,encode:n})=>new vW(t,e,n);class vW{constructor(e,n,r){this.name=e,this.code=n,this.encode=r}digest(e){if(e instanceof Uint8Array){const n=this.encode(e);return n instanceof Uint8Array?A0(this.code,n):n.then(r=>A0(this.code,r))}else throw Error("Unknown type, must be binary type")}}const k2=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),CW=P2({name:"sha2-256",code:18,encode:k2("SHA-256")}),_W=P2({name:"sha2-512",code:19,encode:k2("SHA-512")});var AW=Object.freeze({__proto__:null,sha256:CW,sha512:_W});const D2=0,IW="identity",$2=x2,SW=t=>A0(D2,$2(t)),xW={code:D2,name:IW,encode:$2,digest:SW};var NW=Object.freeze({__proto__:null,identity:xW});new TextEncoder,new TextDecoder;const zw={...vH,..._H,...IH,...xH,...OH,...FH,...WH,...VH,...JH,...rW};({...AW,...NW});function U2(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function TW(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?U2(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function B2(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const qw=B2("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),zh=B2("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=TW(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),OW={utf8:qw,"utf-8":qw,hex:zw.base16,latin1:zh,ascii:zh,binary:zh,...zw};function RW(t,e="utf8"){const n=OW[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?U2(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}var PW=Object.defineProperty,kW=(t,e,n)=>e in t?PW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Dr=(t,e,n)=>kW(t,typeof e!="symbol"?e+"":e,n);class DW{constructor(e,n){this.core=e,this.logger=n,Dr(this,"keychain",new Map),Dr(this,"name",kj),Dr(this,"version",Dj),Dr(this,"initialized",!1),Dr(this,"storagePrefix",Xr),Dr(this,"init",async()=>{if(!this.initialized){const r=await this.getKeyChain();typeof r<"u"&&(this.keychain=r),this.initialized=!0}}),Dr(this,"has",r=>(this.isInitialized(),this.keychain.has(r))),Dr(this,"set",async(r,s)=>{this.isInitialized(),this.keychain.set(r,s),await this.persist()}),Dr(this,"get",r=>{this.isInitialized();const s=this.keychain.get(r);if(typeof s>"u"){const{message:i}=X("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(i)}return s}),Dr(this,"del",async r=>{this.isInitialized(),this.keychain.delete(r),await this.persist()}),this.core=e,this.logger=On(n,this.name)}get context(){return Tn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,a0(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?c0(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=X("NOT_INITIALIZED",this.name);throw new Error(e)}}}var $W=Object.defineProperty,UW=(t,e,n)=>e in t?$W(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,xt=(t,e,n)=>UW(t,typeof e!="symbol"?e+"":e,n);class BW{constructor(e,n,r){this.core=e,this.logger=n,xt(this,"name",Rj),xt(this,"keychain"),xt(this,"randomSessionIdentifier",w0()),xt(this,"initialized",!1),xt(this,"clientId"),xt(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),xt(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),xt(this,"getClientId",async()=>{if(this.isInitialized(),this.clientId)return this.clientId;const s=await this.getClientSeed(),i=ob(s),o=e_(i.publicKey);return this.clientId=o,o}),xt(this,"generateKeyPair",()=>{this.isInitialized();const s=WF();return this.setPrivateKey(s.publicKey,s.privateKey)}),xt(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=ob(i),a=this.randomSessionIdentifier;return await uD(a,s,Pj,o)}),xt(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=zF(a,i);return this.setSymKey(c,o)}),xt(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||qu(s);return await this.keychain.set(o,s),o}),xt(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),xt(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),xt(this,"encode",async(s,i,o)=>{this.isInitialized();const a=f2(o),c=ks(i);if(yw(a))return KF(c,o==null?void 0:o.encoding);if(mw(a)){const f=a.senderPublicKey,h=a.receiverPublicKey;s=await this.generateSharedKey(f,h)}const l=this.getSymKey(s),{type:u,senderPublicKey:d}=a;return qF({type:u,symKey:l,message:c,senderPublicKey:d,encoding:o==null?void 0:o.encoding})}),xt(this,"decode",async(s,i,o)=>{this.isInitialized();const a=YF(i,o);if(yw(a)){const c=GF(i,o==null?void 0:o.encoding);return po(c)}if(mw(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;s=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(s),l=VF({symKey:c,encoded:i,encoding:o==null?void 0:o.encoding});return po(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),xt(this,"getPayloadType",(s,i=_n)=>{const o=pl({encoded:s,encoding:i});return _o(o.type)}),xt(this,"getPayloadSenderPublicKey",(s,i=_n)=>{const o=pl({encoded:s,encoding:i});return o.senderPublicKey?xn(o.senderPublicKey,un):void 0}),this.core=e,this.logger=On(n,this.name),this.keychain=r||new DW(this.core,this.logger)}get context(){return Tn(this.logger)}async setPrivateKey(e,n){return await this.keychain.set(e,n),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Lw)}catch{e=w0(),await this.keychain.set(Lw,e)}return RW(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=X("NOT_INITIALIZED",this.name);throw new Error(e)}}}var LW=Object.defineProperty,MW=Object.defineProperties,FW=Object.getOwnPropertyDescriptors,Vw=Object.getOwnPropertySymbols,jW=Object.prototype.hasOwnProperty,HW=Object.prototype.propertyIsEnumerable,I0=(t,e,n)=>e in t?LW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,WW=(t,e)=>{for(var n in e||(e={}))jW.call(e,n)&&I0(t,n,e[n]);if(Vw)for(var n of Vw(e))HW.call(e,n)&&I0(t,n,e[n]);return t},zW=(t,e)=>MW(t,FW(e)),Dn=(t,e,n)=>I0(t,typeof e!="symbol"?e+"":e,n);class qW extends cP{constructor(e,n){super(e,n),this.logger=e,this.core=n,Dn(this,"messages",new Map),Dn(this,"messagesWithoutClientAck",new Map),Dn(this,"name",$j),Dn(this,"version",Uj),Dn(this,"initialized",!1),Dn(this,"storagePrefix",Xr),Dn(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const r=await this.getRelayerMessages();typeof r<"u"&&(this.messages=r);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}finally{this.initialized=!0}}}),Dn(this,"set",async(r,s,i)=>{this.isInitialized();const o=Qn(s);let a=this.messages.get(r);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(r,a),i===Vu.inbound){const c=this.messagesWithoutClientAck.get(r)||{};this.messagesWithoutClientAck.set(r,zW(WW({},c),{[o]:s}))}return await this.persist(),o}),Dn(this,"get",r=>{this.isInitialized();let s=this.messages.get(r);return typeof s>"u"&&(s={}),s}),Dn(this,"getWithoutAck",r=>{this.isInitialized();const s={};for(const i of r){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),Dn(this,"has",(r,s)=>{this.isInitialized();const i=this.get(r),o=Qn(s);return typeof i[o]<"u"}),Dn(this,"ack",async(r,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(r);if(typeof i>"u")return;const o=Qn(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(r):this.messagesWithoutClientAck.set(r,i),await this.persist()}),Dn(this,"del",async r=>{this.isInitialized(),this.messages.delete(r),this.messagesWithoutClientAck.delete(r),await this.persist()}),this.logger=On(e,this.name),this.core=n}get context(){return Tn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,a0(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,a0(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?c0(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?c0(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=X("NOT_INITIALIZED",this.name);throw new Error(e)}}}var VW=Object.defineProperty,KW=Object.defineProperties,GW=Object.getOwnPropertyDescriptors,Kw=Object.getOwnPropertySymbols,YW=Object.prototype.hasOwnProperty,ZW=Object.prototype.propertyIsEnumerable,S0=(t,e,n)=>e in t?VW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Wo=(t,e)=>{for(var n in e||(e={}))YW.call(e,n)&&S0(t,n,e[n]);if(Kw)for(var n of Kw(e))ZW.call(e,n)&&S0(t,n,e[n]);return t},Gw=(t,e)=>KW(t,GW(e)),Gn=(t,e,n)=>S0(t,typeof e!="symbol"?e+"":e,n);class JW extends lP{constructor(e,n){super(e,n),this.relayer=e,this.logger=n,Gn(this,"events",new cr.EventEmitter),Gn(this,"name",Lj),Gn(this,"queue",new Map),Gn(this,"publishTimeout",J.toMiliseconds(J.ONE_MINUTE)),Gn(this,"initialPublishTimeout",J.toMiliseconds(J.ONE_SECOND*15)),Gn(this,"needsTransportRestart",!1),Gn(this,"publish",async(r,s,i)=>{var o,a,c,l,u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:r,message:s,opts:i}});const d=(i==null?void 0:i.ttl)||Bj,f=(i==null?void 0:i.prompt)||!1,h=(i==null?void 0:i.tag)||0,p=(i==null?void 0:i.id)||gi().toString(),g=Xo($d().protocol),m={id:p,method:(i==null?void 0:i.publishMethod)||g.publish,params:Wo({topic:r,message:s,ttl:d,prompt:f,tag:h,attestation:i==null?void 0:i.attestation},i==null?void 0:i.tvf)},E=`Failed to publish payload, please try again. id:${p} tag:${h}`;try{Rt((o=m.params)==null?void 0:o.prompt)&&((a=m.params)==null||delete a.prompt),Rt((c=m.params)==null?void 0:c.tag)&&((l=m.params)==null||delete l.tag);const A=new Promise(async b=>{const _=({id:S})=>{var x;((x=m.id)==null?void 0:x.toString())===S.toString()&&(this.removeRequestFromQueue(S),this.relayer.events.removeListener(mt.publish,_),b())};this.relayer.events.on(mt.publish,_);const C=Wr(new Promise((S,x)=>{this.rpcPublish(m,i).then(S).catch(P=>{this.logger.warn(P,P==null?void 0:P.message),x(P)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${p} tag:${h}`);try{await C,this.events.removeListener(mt.publish,_)}catch(S){this.queue.set(p,{request:m,opts:i,attempt:1}),this.logger.warn(S,S==null?void 0:S.message)}});this.logger.trace({type:"method",method:"publish",params:{id:p,topic:r,message:s,opts:i}}),await Wr(A,this.publishTimeout,E)}catch(A){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(A),(u=i==null?void 0:i.internal)!=null&&u.throwOnFailedPublish)throw A}finally{this.queue.delete(p)}}),Gn(this,"publishCustom",async r=>{var s,i,o,a,c;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:r});const{payload:l,opts:u={}}=r,{attestation:d,tvf:f,publishMethod:h,prompt:p,tag:g,ttl:m=J.FIVE_MINUTES}=u,E=u.id||gi().toString(),A=Xo($d().protocol),b=h||A.publish,_={id:E,method:b,params:Wo(Gw(Wo({},l),{ttl:m,prompt:p,tag:g,attestation:d}),f)},C=`Failed to publish custom payload, please try again. id:${E} tag:${g}`;try{Rt((s=_.params)==null?void 0:s.prompt)&&((i=_.params)==null||delete i.prompt),Rt((o=_.params)==null?void 0:o.tag)&&((a=_.params)==null||delete a.tag);const S=new Promise(async x=>{const P=({id:L})=>{var M;((M=_.id)==null?void 0:M.toString())===L.toString()&&(this.removeRequestFromQueue(L),this.relayer.events.removeListener(mt.publish,P),x())};this.relayer.events.on(mt.publish,P);const N=Wr(new Promise((L,M)=>{this.rpcPublish(_,u).then(L).catch(U=>{this.logger.warn(U,U==null?void 0:U.message),M(U)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${b} id:${E} tag:${g}`);try{await N,this.events.removeListener(mt.publish,P)}catch(L){this.queue.set(E,{request:_,opts:u,attempt:1}),this.logger.warn(L,L==null?void 0:L.message)}});this.logger.trace({type:"method",method:"publish",params:{id:E,payload:l,opts:u}}),await Wr(S,this.publishTimeout,C)}catch(S){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(S),(c=u==null?void 0:u.internal)!=null&&c.throwOnFailedPublish)throw S}finally{this.queue.delete(E)}}),Gn(this,"on",(r,s)=>{this.events.on(r,s)}),Gn(this,"once",(r,s)=>{this.events.once(r,s)}),Gn(this,"off",(r,s)=>{this.events.off(r,s)}),Gn(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.relayer=e,this.logger=On(n,this.name),this.registerEventListeners()}get context(){return Tn(this.logger)}async rpcPublish(e,n){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});const r=await this.relayer.request(e);return this.relayer.events.emit(mt.publish,Wo(Wo({},e),n)),this.logger.debug("Successfully Published Payload"),r}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,n)=>{var r;const s=e.attempt+1;this.queue.set(n,Gw(Wo({},e),{attempt:s})),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${(r=e.request.params)==null?void 0:r.tag}, attempt: ${s}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(To.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(mt.connection_stalled);return}this.checkQueue()}),this.relayer.on(mt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var XW=Object.defineProperty,QW=(t,e,n)=>e in t?XW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,zo=(t,e,n)=>QW(t,typeof e!="symbol"?e+"":e,n);class ez{constructor(){zo(this,"map",new Map),zo(this,"set",(e,n)=>{const r=this.get(e);this.exists(e,n)||this.map.set(e,[...r,n])}),zo(this,"get",e=>this.map.get(e)||[]),zo(this,"exists",(e,n)=>this.get(e).includes(n)),zo(this,"delete",(e,n)=>{if(typeof n>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const r=this.get(e);if(!this.exists(e,n))return;const s=r.filter(i=>i!==n);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),zo(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var tz=Object.defineProperty,nz=Object.defineProperties,rz=Object.getOwnPropertyDescriptors,Yw=Object.getOwnPropertySymbols,sz=Object.prototype.hasOwnProperty,iz=Object.prototype.propertyIsEnumerable,x0=(t,e,n)=>e in t?tz(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,tc=(t,e)=>{for(var n in e||(e={}))sz.call(e,n)&&x0(t,n,e[n]);if(Yw)for(var n of Yw(e))iz.call(e,n)&&x0(t,n,e[n]);return t},qh=(t,e)=>nz(t,rz(e)),Ge=(t,e,n)=>x0(t,typeof e!="symbol"?e+"":e,n);class oz extends fP{constructor(e,n){super(e,n),this.relayer=e,this.logger=n,Ge(this,"subscriptions",new Map),Ge(this,"topicMap",new ez),Ge(this,"events",new cr.EventEmitter),Ge(this,"name",qj),Ge(this,"version",Vj),Ge(this,"pending",new Map),Ge(this,"cached",[]),Ge(this,"initialized",!1),Ge(this,"storagePrefix",Xr),Ge(this,"subscribeTimeout",J.toMiliseconds(J.ONE_MINUTE)),Ge(this,"initialSubscribeTimeout",J.toMiliseconds(J.ONE_SECOND*15)),Ge(this,"clientId"),Ge(this,"batchSubscribeTopicsLimit",500),Ge(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),Ge(this,"subscribe",async(r,s)=>{var i;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}});try{const o=$d(s),a={topic:r,relay:o,transportType:s==null?void 0:s.transportType};(i=s==null?void 0:s.internal)!=null&&i.skipSubscribe||this.pending.set(r,a);const c=await this.rpcSubscribe(r,o,s);return typeof c=="string"&&(this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}})),c}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}}),Ge(this,"unsubscribe",async(r,s)=>{this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(r,s.id,s):await this.unsubscribeByTopic(r,s)}),Ge(this,"isSubscribed",r=>new Promise(s=>{s(this.topicMap.topics.includes(r))})),Ge(this,"isKnownTopic",r=>new Promise(s=>{s(this.topicMap.topics.includes(r)||this.pending.has(r)||this.cached.some(i=>i.topic===r))})),Ge(this,"on",(r,s)=>{this.events.on(r,s)}),Ge(this,"once",(r,s)=>{this.events.once(r,s)}),Ge(this,"off",(r,s)=>{this.events.off(r,s)}),Ge(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),Ge(this,"start",async()=>{await this.onConnect()}),Ge(this,"stop",async()=>{await this.onDisconnect()}),Ge(this,"restart",async()=>{await this.restore(),await this.onRestart()}),Ge(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const r=[];this.pending.forEach(s=>{r.push(s)}),await this.batchSubscribe(r)}),Ge(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(To.pulse,async()=>{await this.checkPending()}),this.events.on(Un.created,async r=>{const s=Un.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()}),this.events.on(Un.deleted,async r=>{const s=Un.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()})}),this.relayer=e,this.logger=On(n,this.name),this.clientId=""}get context(){return Tn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,n){let r=!1;try{r=this.getSubscription(e).topic===n}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,n){const r=this.topicMap.get(e);await Promise.all(r.map(async s=>await this.unsubscribeById(e,s,n)))}async unsubscribeById(e,n,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:n,opts:r}});try{const s=$d(r);await this.restartToComplete({topic:e,id:n,relay:s}),await this.rpcUnsubscribe(e,n,s);const i=nt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,n,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:n,opts:r}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,n,r){var s,i;const o=await this.getSubscriptionId(e);if((s=r==null?void 0:r.internal)!=null&&s.skipSubscribe)return o;(!r||(r==null?void 0:r.transportType)===et.relay)&&await this.restartToComplete({topic:e,id:e,relay:n});const a={method:Xo(n.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});const c=(i=r==null?void 0:r.internal)==null?void 0:i.throwOnFailedPublish;try{if((r==null?void 0:r.transportType)===et.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(d=>this.logger.warn(d))},J.toMiliseconds(J.ONE_SECOND)),o;const l=new Promise(async d=>{const f=h=>{h.topic===e&&(this.events.removeListener(Un.created,f),d(h.id))};this.events.on(Un.created,f);try{const h=await Wr(new Promise((p,g)=>{this.relayer.request(a).catch(m=>{this.logger.warn(m,m==null?void 0:m.message),g(m)}).then(p)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(Un.created,f),d(h)}catch{}}),u=await Wr(l,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&c)throw new Error(`Subscribing to ${e} failed, please try again`);return u?o:null}catch(l){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(mt.connection_stalled),c)throw l}return null}async rpcBatchSubscribe(e){if(!e.length)return;const n=e[0].relay,r={method:Xo(n.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await Wr(new Promise(s=>{this.relayer.request(r).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(mt.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const n=e[0].relay,r={method:Xo(n.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});let s;try{s=await await Wr(new Promise((i,o)=>{this.relayer.request(r).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(mt.connection_stalled)}return s}rpcUnsubscribe(e,n,r){const s={method:Xo(r.protocol).unsubscribe,params:{topic:e,id:n}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,n){this.setSubscription(e,qh(tc({},n),{id:e})),this.pending.delete(n.topic)}onBatchSubscribe(e){e.length&&e.forEach(n=>{this.setSubscription(n.id,tc({},n)),this.pending.delete(n.topic)})}async onUnsubscribe(e,n,r){this.events.removeAllListeners(n),this.hasSubscription(n,e)&&this.deleteSubscription(n,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,n){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:n}),this.addSubscription(e,n)}addSubscription(e,n){this.subscriptions.set(e,tc({},n)),this.topicMap.set(n.topic,e),this.events.emit(Un.created,n)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const n=this.subscriptions.get(e);if(!n){const{message:r}=X("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return n}deleteSubscription(e,n){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:n});const r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(Un.deleted,qh(tc({},r),{reason:n}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Un.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],n=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<n;r++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Un.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(n=>{var r;return n.topic===((r=this.subscriptions.get(n.id))==null?void 0:r.topic)})){const{message:n}=X("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async n=>qh(tc({},n),{id:await this.getSubscriptionId(n.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const n=await this.rpcBatchFetchMessages(e);n&&n.messages&&(await lL(J.toMiliseconds(J.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(n.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=X("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return Qn(e+await this.getClientId())}}var az=Object.defineProperty,Zw=Object.getOwnPropertySymbols,cz=Object.prototype.hasOwnProperty,lz=Object.prototype.propertyIsEnumerable,N0=(t,e,n)=>e in t?az(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Jw=(t,e)=>{for(var n in e||(e={}))cz.call(e,n)&&N0(t,n,e[n]);if(Zw)for(var n of Zw(e))lz.call(e,n)&&N0(t,n,e[n]);return t},Me=(t,e,n)=>N0(t,typeof e!="symbol"?e+"":e,n);class uz extends uP{constructor(e){var n;super(e),Me(this,"protocol","wc"),Me(this,"version",2),Me(this,"core"),Me(this,"logger"),Me(this,"events",new cr.EventEmitter),Me(this,"provider"),Me(this,"messages"),Me(this,"subscriber"),Me(this,"publisher"),Me(this,"name",Fj),Me(this,"transportExplicitlyClosed",!1),Me(this,"initialized",!1),Me(this,"connectionAttemptInProgress",!1),Me(this,"relayUrl"),Me(this,"projectId"),Me(this,"packageName"),Me(this,"bundleId"),Me(this,"hasExperiencedNetworkDisruption",!1),Me(this,"pingTimeout"),Me(this,"heartBeatTimeout",J.toMiliseconds(J.THIRTY_SECONDS+J.FIVE_SECONDS)),Me(this,"reconnectTimeout"),Me(this,"connectPromise"),Me(this,"reconnectInProgress",!1),Me(this,"requestsInFlight",[]),Me(this,"connectTimeout",J.toMiliseconds(J.ONE_SECOND*15)),Me(this,"request",async r=>{var s,i;this.logger.debug("Publishing Request Payload");const o=r.id||gi().toString();await this.toEstablishConnection();try{this.logger.trace({id:o,method:r.method,topic:(s=r.params)==null?void 0:s.topic},"relayer.request - publishing...");const a=`${o}:${((i=r.params)==null?void 0:i.tag)||""}`;this.requestsInFlight.push(a);const c=await this.provider.request(r);return this.requestsInFlight=this.requestsInFlight.filter(l=>l!==a),c}catch(a){throw this.logger.debug(`Failed to Publish Request: ${o}`),a}}),Me(this,"resetPingTimeout",()=>{Td()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var r,s,i,o;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(o=(i=(s=(r=this.provider)==null?void 0:r.connection)==null?void 0:s.socket)==null?void 0:i.terminate)==null||o.call(i)}catch(a){this.logger.warn(a,a==null?void 0:a.message)}},this.heartBeatTimeout))}),Me(this,"onPayloadHandler",r=>{this.onProviderPayload(r),this.resetPingTimeout()}),Me(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected ðŸ›œ"),this.startPingTimeout(),this.events.emit(mt.connect)}),Me(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected ðŸ›‘"),this.requestsInFlight=[],this.onProviderDisconnect()}),Me(this,"onProviderErrorHandler",r=>{this.logger.fatal(`Fatal socket error: ${r.message}`),this.events.emit(mt.error,r),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),Me(this,"registerProviderListeners",()=>{this.provider.on(Kn.payload,this.onPayloadHandler),this.provider.on(Kn.connect,this.onConnectHandler),this.provider.on(Kn.disconnect,this.onDisconnectHandler),this.provider.on(Kn.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=Qg({logger:(n=e.logger)!=null?n:Mj,name:this.name}),this.messages=new qW(this.logger,e.core),this.subscriber=new oz(this,this.logger),this.publisher=new JW(this,this.logger),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||I2,KB()?this.packageName=Lb():GB()&&(this.bundleId=Lb()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e==null?void 0:e.message))}get context(){return Tn(this.logger)}get connected(){var e,n,r;return((r=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===1||!1}get connecting(){var e,n,r;return((r=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,n,r){this.isInitialized(),await this.publisher.publish(e,n,r),await this.recordMessageEvent({topic:e,message:n,publishedAt:Date.now(),transportType:et.relay},Vu.outbound)}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,n){var r,s,i;this.isInitialized(),(!(n!=null&&n.transportType)||(n==null?void 0:n.transportType)==="relay")&&await this.toEstablishConnection();const o=typeof((r=n==null?void 0:n.internal)==null?void 0:r.throwOnFailedPublish)>"u"?!0:(s=n==null?void 0:n.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",c;const l=u=>{u.topic===e&&(this.subscriber.off(Un.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(Un.created,l)}),new Promise(async(u,d)=>{a=await this.subscriber.subscribe(e,Jw({internal:{throwOnFailedPublish:o}},n)).catch(f=>{o&&d(f)})||a,u()})]),a}async unsubscribe(e,n){this.isInitialized(),await this.subscriber.unsubscribe(e,n)}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Wr(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(n,r)=>{await this.connect(e).then(n).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Ow())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const n=e.sort((r,s)=>r.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${n.length} message events sorted`);for(const r of n)try{await this.onMessageEvent(r)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+(s==null?void 0:s.message))}this.logger.trace(`Batch of ${n.length} message events processed`)}async onLinkMessageEvent(e,n){const{topic:r}=e;if(!n.sessionExists){const s=gt(J.FIVE_MINUTES),i={topic:r,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,i)}this.events.emit(mt.message,e),await this.recordMessageEvent(e,Vu.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let n=1;for(;n<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${n}...`),await this.createProvider(),await new Promise(async(r,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to connect"))};this.provider.once(Kn.disconnect,i),await Wr(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(Kn.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Kn.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Kn.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,r()})}catch(r){await this.subscriber.stop();const s=r;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${n}`);break}await new Promise(r=>setTimeout(r,J.toMiliseconds(n*1))),n++}}startPingTimeout(){var e,n,r,s,i;if(Td())try{(n=(e=this.provider)==null?void 0:e.connection)!=null&&n.socket&&((i=(s=(r=this.provider)==null?void 0:r.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o==null?void 0:o.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new nm(new xj(QB({sdkVersion:C0,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,n){const{topic:r,message:s}=e;await this.messages.set(r,s,n)}async shouldIgnoreMessageEvent(e){const{topic:n,message:r}=e;if(!r||r.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(n))return this.logger.warn(`Ignoring message for unknown topic ${n}`),!0;const s=this.messages.has(n,r);return s&&this.logger.warn(`Ignoring duplicate message: ${r}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),tm(e)){if(!e.method.endsWith(jj))return;const n=e.params,{topic:r,message:s,publishedAt:i,attestation:o}=n.data,a={topic:r,message:s,publishedAt:i,transportType:et.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Jw({type:"event",event:n.id},a)),this.events.emit(n.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else xf(e)&&this.events.emit(mt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,Vu.inbound),this.events.emit(mt.message,e))}async acknowledgePayload(e){const n=gl(e.id,!0);await this.provider.connection.send(n)}unregisterProviderListeners(){this.provider.off(Kn.payload,this.onPayloadHandler),this.provider.off(Kn.connect,this.onConnectHandler),this.provider.off(Kn.disconnect,this.onDisconnectHandler),this.provider.off(Kn.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await Ow();Y7(async n=>{e!==n&&(e=n,n?await this.transportOpen().catch(r=>this.logger.error(r,r==null?void 0:r.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(To.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&X7())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(n){this.logger.warn(n,n==null?void 0:n.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(mt.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e==null?void 0:e.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},J.toMiliseconds(Hj)))))}isInitialized(){if(!this.initialized){const{message:e}=X("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function dz(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function Xw(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function Qw(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const fz="[object RegExp]",hz="[object String]",pz="[object Number]",gz="[object Boolean]",e1="[object Arguments]",mz="[object Symbol]",yz="[object Date]",bz="[object Map]",wz="[object Set]",Ez="[object Array]",vz="[object Function]",Cz="[object ArrayBuffer]",Vh="[object Object]",_z="[object Error]",Az="[object DataView]",Iz="[object Uint8Array]",Sz="[object Uint8ClampedArray]",xz="[object Uint16Array]",Nz="[object Uint32Array]",Tz="[object BigUint64Array]",Oz="[object Int8Array]",Rz="[object Int16Array]",Pz="[object Int32Array]",kz="[object BigInt64Array]",Dz="[object Float32Array]",$z="[object Float64Array]";function Uz(){}function t1(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(t)==="[object Object]":!1}function Bz(t,e,n){return dc(t,e,void 0,void 0,void 0,void 0,n)}function dc(t,e,n,r,s,i,o){const a=o(t,e,n,r,s,i);if(a!==void 0)return a;if(typeof t==typeof e)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return t===e;case"number":return t===e||Object.is(t,e);case"function":return t===e;case"object":return Ec(t,e,i,o)}return Ec(t,e,i,o)}function Ec(t,e,n,r){if(Object.is(t,e))return!0;let s=Qw(t),i=Qw(e);if(s===e1&&(s=Vh),i===e1&&(i=Vh),s!==i)return!1;switch(s){case hz:return t.toString()===e.toString();case pz:{const c=t.valueOf(),l=e.valueOf();return dz(c,l)}case gz:case yz:case mz:return Object.is(t.valueOf(),e.valueOf());case fz:return t.source===e.source&&t.flags===e.flags;case vz:return t===e}n=n??new Map;const o=n.get(t),a=n.get(e);if(o!=null&&a!=null)return o===e;n.set(t,e),n.set(e,t);try{switch(s){case bz:{if(t.size!==e.size)return!1;for(const[c,l]of t.entries())if(!e.has(c)||!dc(l,e.get(c),c,t,e,n,r))return!1;return!0}case wz:{if(t.size!==e.size)return!1;const c=Array.from(t.values()),l=Array.from(e.values());for(let u=0;u<c.length;u++){const d=c[u],f=l.findIndex(h=>dc(d,h,void 0,t,e,n,r));if(f===-1)return!1;l.splice(f,1)}return!0}case Ez:case Iz:case Sz:case xz:case Nz:case Tz:case Oz:case Rz:case Pz:case kz:case Dz:case $z:{if(typeof Buffer<"u"&&Buffer.isBuffer(t)!==Buffer.isBuffer(e)||t.length!==e.length)return!1;for(let c=0;c<t.length;c++)if(!dc(t[c],e[c],c,t,e,n,r))return!1;return!0}case Cz:return t.byteLength!==e.byteLength?!1:Ec(new Uint8Array(t),new Uint8Array(e),n,r);case Az:return t.byteLength!==e.byteLength||t.byteOffset!==e.byteOffset?!1:Ec(new Uint8Array(t),new Uint8Array(e),n,r);case _z:return t.name===e.name&&t.message===e.message;case Vh:{if(!(Ec(t.constructor,e.constructor,n,r)||t1(t)&&t1(e)))return!1;const c=[...Object.keys(t),...Xw(t)],l=[...Object.keys(e),...Xw(e)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){const d=c[u],f=t[d];if(!Object.hasOwn(e,d))return!1;const h=e[d];if(!dc(f,h,d,t,e,n,r))return!1}return!0}default:return!1}}finally{n.delete(t),n.delete(e)}}function Lz(t,e){return Bz(t,e,Uz)}var Mz=Object.defineProperty,n1=Object.getOwnPropertySymbols,Fz=Object.prototype.hasOwnProperty,jz=Object.prototype.propertyIsEnumerable,T0=(t,e,n)=>e in t?Mz(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,r1=(t,e)=>{for(var n in e||(e={}))Fz.call(e,n)&&T0(t,n,e[n]);if(n1)for(var n of n1(e))jz.call(e,n)&&T0(t,n,e[n]);return t},yn=(t,e,n)=>T0(t,typeof e!="symbol"?e+"":e,n);class ko extends dP{constructor(e,n,r,s=Xr,i=void 0){super(e,n,r,s),this.core=e,this.logger=n,this.name=r,yn(this,"map",new Map),yn(this,"version",Wj),yn(this,"cached",[]),yn(this,"initialized",!1),yn(this,"getKey"),yn(this,"storagePrefix",Xr),yn(this,"recentlyDeleted",[]),yn(this,"recentlyDeletedLimit",200),yn(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!Rt(o)?this.map.set(this.getKey(o),o):S7(o)?this.map.set(o.id,o):x7(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),yn(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),yn(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),yn(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>Lz(a[c],o[c]))):this.values)),yn(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=r1(r1({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),yn(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=On(n,this.name),this.storagePrefix=s,this.getKey=i}get context(){return Tn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const n=this.map.get(e);if(!n){if(this.recentlyDeleted.includes(e)){const{message:s}=X("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:r}=X("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(r),new Error(r)}return n}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:n}=X("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=X("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Hz=Object.defineProperty,Wz=(t,e,n)=>e in t?Hz(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ke=(t,e,n)=>Wz(t,typeof e!="symbol"?e+"":e,n);class zz{constructor(e,n){this.core=e,this.logger=n,ke(this,"name",Kj),ke(this,"version",Gj),ke(this,"events",new wg),ke(this,"pairings"),ke(this,"initialized",!1),ke(this,"storagePrefix",Xr),ke(this,"ignoredPayloadTypes",[Ns]),ke(this,"registeredMethods",[]),ke(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),ke(this,"register",({methods:r})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...r])]}),ke(this,"create",async r=>{this.isInitialized();const s=w0(),i=await this.core.crypto.setSymKey(s),o=gt(J.FIVE_MINUTES),a={protocol:A2},c={topic:i,expiry:o,relay:a,active:!1,methods:r==null?void 0:r.methods},l=vw({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:r==null?void 0:r.methods});return this.events.emit(Vi.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:r==null?void 0:r.transportType,internal:r==null?void 0:r.internal}),{topic:i,uri:l}}),ke(this,"pair",async r=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:r==null?void 0:r.uri,trace:[Ur.pairing_started]}});this.isValidPair(r,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:l}=Ew(r.uri);s.props.properties.topic=i,s.addTrace(Ur.pairing_uri_validation_success),s.addTrace(Ur.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(i)){if(u=this.pairings.get(i),s.addTrace(Ur.existing_pairing),u.active)throw s.setError(hs.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(Ur.pairing_not_expired)}const d=c||gt(J.FIVE_MINUTES),f={topic:i,relay:a,expiry:d,active:!1,methods:l};this.core.expirer.set(i,d),await this.pairings.set(i,f),s.addTrace(Ur.store_new_pairing),r.activatePairing&&await this.activate({topic:i}),this.events.emit(Vi.create,f),s.addTrace(Ur.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(Ur.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(hs.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(h){throw s.setError(hs.subscribe_pairing_topic_failure),h}return s.addTrace(Ur.subscribe_pairing_topic_success),f}),ke(this,"activate",async({topic:r})=>{this.isInitialized();const s=gt(J.FIVE_MINUTES);this.core.expirer.set(r,s),await this.pairings.update(r,{active:!0,expiry:s})}),ke(this,"ping",async r=>{this.isInitialized(),await this.isValidPing(r),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=r;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=zi();this.events.once(qe("pairing_ping",i),({error:l})=>{l?c(l):a()}),await o()}}),ke(this,"updateExpiry",async({topic:r,expiry:s})=>{this.isInitialized(),await this.pairings.update(r,{expiry:s})}),ke(this,"updateMetadata",async({topic:r,metadata:s})=>{this.isInitialized(),await this.pairings.update(r,{peerMetadata:s})}),ke(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),ke(this,"disconnect",async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",nt("USER_DISCONNECTED")),await this.deletePairing(s))}),ke(this,"formatUriFromPairing",r=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=r,c=this.core.crypto.keychain.get(s);return vw({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),ke(this,"sendRequest",async(r,s,i)=>{const o=yr(s,i),a=await this.core.crypto.encode(r,o),c=Qa[s].req;return this.core.history.set(r,o),this.core.relayer.publish(r,a,c),o.id}),ke(this,"sendResult",async(r,s,i)=>{const o=gl(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,l=Qa[c].res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),ke(this,"sendError",async(r,s,i)=>{const o=Sf(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,l=Qa[c]?Qa[c].res:Qa.unregistered_method.res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),ke(this,"deletePairing",async(r,s)=>{await this.core.relayer.unsubscribe(r),await Promise.all([this.pairings.delete(r,nt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(r),s?Promise.resolve():this.core.expirer.del(r)])}),ke(this,"cleanup",async()=>{const r=this.pairings.getAll().filter(s=>Fr(s.expiry));await Promise.all(r.map(s=>this.deletePairing(s.topic)))}),ke(this,"onRelayEventRequest",async r=>{const{topic:s,payload:i}=r;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),ke(this,"onRelayEventResponse",async r=>{const{topic:s,payload:i}=r,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),ke(this,"onPairingPingRequest",async(r,s)=>{const{id:i}=s;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.events.emit(Vi.ping,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),ke(this,"onPairingPingResponse",(r,s)=>{const{id:i}=s;setTimeout(()=>{Lr(s)?this.events.emit(qe("pairing_ping",i),{}):er(s)&&this.events.emit(qe("pairing_ping",i),{error:s.error})},500)}),ke(this,"onPairingDeleteRequest",async(r,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:r}),await this.deletePairing(r),this.events.emit(Vi.delete,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),ke(this,"onUnknownRpcMethodRequest",async(r,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=nt("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,r,a),this.logger.error(a)}catch(a){await this.sendError(i,r,a),this.logger.error(a)}}),ke(this,"onUnknownRpcMethodResponse",r=>{this.registeredMethods.includes(r)||this.logger.error(nt("WC_METHOD_UNSUPPORTED",r))}),ke(this,"isValidPair",(r,s)=>{var i;if(!wn(r)){const{message:a}=X("MISSING_OR_INVALID",`pair() params: ${r}`);throw s.setError(hs.malformed_pairing_uri),new Error(a)}if(!I7(r.uri)){const{message:a}=X("MISSING_OR_INVALID",`pair() uri: ${r.uri}`);throw s.setError(hs.malformed_pairing_uri),new Error(a)}const o=Ew(r==null?void 0:r.uri);if(!((i=o==null?void 0:o.relay)!=null&&i.protocol)){const{message:a}=X("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(hs.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=X("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(hs.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&J.toMiliseconds(o==null?void 0:o.expiryTimestamp)<Date.now()){s.setError(hs.pairing_expired);const{message:a}=X("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),ke(this,"isValidPing",async r=>{if(!wn(r)){const{message:i}=X("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),ke(this,"isValidDisconnect",async r=>{if(!wn(r)){const{message:i}=X("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),ke(this,"isValidPairingTopic",async r=>{if(!yt(r,!1)){const{message:s}=X("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(s)}if(!this.pairings.keys.includes(r)){const{message:s}=X("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(s)}if(Fr(this.pairings.get(r).expiry)){await this.deletePairing(r);const{message:s}=X("EXPIRED",`pairing topic: ${r}`);throw new Error(s)}}),this.core=e,this.logger=On(n,this.name),this.pairings=new ko(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Tn(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=X("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(mt.message,async e=>{const{topic:n,message:r,transportType:s}=e;if(this.pairings.keys.includes(n)&&s!==et.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{const i=await this.core.crypto.decode(n,r);tm(i)?(this.core.history.set(n,i),await this.onRelayEventRequest({topic:n,payload:i})):xf(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:n,payload:i}),this.core.history.delete(n,i.id)),await this.core.relayer.messages.ack(n,r)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(Jn.expired,async e=>{const{topic:n}=pA(e.target);n&&this.pairings.keys.includes(n)&&(await this.deletePairing(n,!0),this.events.emit(Vi.expire,{topic:n}))})}}var qz=Object.defineProperty,Vz=(t,e,n)=>e in t?qz(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Bt=(t,e,n)=>Vz(t,typeof e!="symbol"?e+"":e,n);class Kz extends aP{constructor(e,n){super(e,n),this.core=e,this.logger=n,Bt(this,"records",new Map),Bt(this,"events",new cr.EventEmitter),Bt(this,"name",Yj),Bt(this,"version",Zj),Bt(this,"cached",[]),Bt(this,"initialized",!1),Bt(this,"storagePrefix",Xr),Bt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.records.set(r.id,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Bt(this,"set",(r,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:r,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:r,request:{method:s.method,params:s.params||null},chainId:i,expiry:gt(J.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(ur.created,o)}),Bt(this,"resolve",async r=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:r}),!this.records.has(r.id))return;const s=await this.getRecord(r.id);typeof s.response>"u"&&(s.response=er(r)?{error:r.error}:{result:r.result},this.records.set(s.id,s),this.persist(),this.events.emit(ur.updated,s))}),Bt(this,"get",async(r,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:r,id:s}),await this.getRecord(s))),Bt(this,"delete",(r,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===r){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(ur.deleted,i)}}),this.persist()}),Bt(this,"exists",async(r,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===r:!1)),Bt(this,"on",(r,s)=>{this.events.on(r,s)}),Bt(this,"once",(r,s)=>{this.events.once(r,s)}),Bt(this,"off",(r,s)=>{this.events.off(r,s)}),Bt(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=On(n,this.name)}get context(){return Tn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(n=>{if(typeof n.response<"u")return;const r={topic:n.topic,request:yr(n.request.method,n.request.params,n.id),chainId:n.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const n=this.records.get(e);if(!n){const{message:r}=X("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return n}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ur.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:n}=X("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(ur.created,e=>{const n=ur.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.events.on(ur.updated,e=>{const n=ur.updated;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.events.on(ur.deleted,e=>{const n=ur.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.core.heartbeat.on(To.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(n=>{J.toMiliseconds(n.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${n.id}`),this.records.delete(n.id),this.events.emit(ur.deleted,n,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=X("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Gz=Object.defineProperty,Yz=(t,e,n)=>e in t?Gz(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Xt=(t,e,n)=>Yz(t,typeof e!="symbol"?e+"":e,n);class Zz extends hP{constructor(e,n){super(e,n),this.core=e,this.logger=n,Xt(this,"expirations",new Map),Xt(this,"events",new cr.EventEmitter),Xt(this,"name",Jj),Xt(this,"version",Xj),Xt(this,"cached",[]),Xt(this,"initialized",!1),Xt(this,"storagePrefix",Xr),Xt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.expirations.set(r.target,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Xt(this,"has",r=>{try{const s=this.formatTarget(r);return typeof this.getExpiration(s)<"u"}catch{return!1}}),Xt(this,"set",(r,s)=>{this.isInitialized();const i=this.formatTarget(r),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(Jn.created,{target:i,expiration:o})}),Xt(this,"get",r=>{this.isInitialized();const s=this.formatTarget(r);return this.getExpiration(s)}),Xt(this,"del",r=>{if(this.isInitialized(),this.has(r)){const s=this.formatTarget(r),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Jn.deleted,{target:s,expiration:i})}}),Xt(this,"on",(r,s)=>{this.events.on(r,s)}),Xt(this,"once",(r,s)=>{this.events.once(r,s)}),Xt(this,"off",(r,s)=>{this.events.off(r,s)}),Xt(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=On(n,this.name)}get context(){return Tn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return eL(e);if(typeof e=="number")return tL(e);const{message:n}=X("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(n)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Jn.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:n}=X("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const n=this.expirations.get(e);if(!n){const{message:r}=X("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(r),new Error(r)}return n}checkExpiry(e,n){const{expiry:r}=n;J.toMiliseconds(r)-Date.now()<=0&&this.expire(e,n)}expire(e,n){this.expirations.delete(e),this.events.emit(Jn.expired,{target:e,expiration:n})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,n)=>this.checkExpiry(n,e))}registerEventListeners(){this.core.heartbeat.on(To.pulse,()=>this.checkExpirations()),this.events.on(Jn.created,e=>{const n=Jn.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()}),this.events.on(Jn.expired,e=>{const n=Jn.expired;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()}),this.events.on(Jn.deleted,e=>{const n=Jn.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=X("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Jz=Object.defineProperty,Xz=(t,e,n)=>e in t?Jz(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,pt=(t,e,n)=>Xz(t,typeof e!="symbol"?e+"":e,n);class Qz extends pP{constructor(e,n,r){super(e,n,r),this.core=e,this.logger=n,this.store=r,pt(this,"name",Qj),pt(this,"abortController"),pt(this,"isDevEnv"),pt(this,"verifyUrlV3",tH),pt(this,"storagePrefix",Xr),pt(this,"version",_2),pt(this,"publicKey"),pt(this,"fetchPromise"),pt(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&J.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),pt(this,"register",async s=>{if(!$a()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const l=Eo(),u=this.startAbortTimer(J.ONE_SECOND*5),d=await new Promise((f,h)=>{const p=()=>{window.removeEventListener("message",m),l.body.removeChild(g),h("attestation aborted")};this.abortController.signal.addEventListener("abort",p);const g=l.createElement("iframe");g.src=c,g.style.display="none",g.addEventListener("error",p,{signal:this.abortController.signal});const m=E=>{if(E.data&&typeof E.data=="string")try{const A=JSON.parse(E.data);if(A.type==="verify_attestation"){if(Zp(A.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(g),this.abortController.signal.removeEventListener("abort",p),window.removeEventListener("message",m),f(A.attestation===null?"":A.attestation)}}catch(A){this.logger.warn(A)}};l.body.appendChild(g),window.addEventListener("message",m,{signal:this.abortController.signal})});return this.logger.debug(d,"jwt attestation"),d}catch(l){this.logger.warn(l)}return""}),pt(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(Zp(i).payload.id!==a)return;const l=await this.isValidJwtAttestation(i);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(s==null?void 0:s.verifyUrl);return this.fetchAttestation(o,c)}),pt(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(J.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),pt(this,"getVerifyUrl",s=>{let i=s||wc;return nH.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${wc}`),i=wc),i}),pt(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(J.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),pt(this,"persistPublicKey",async s=>{this.logger.debug(s,"persisting public key to local storage"),await this.store.setItem(this.storeKey,s),this.publicKey=s}),pt(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),pt(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),pt(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),pt(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),pt(this,"validateAttestation",(s,i)=>{const o=JF(s,i.publicKey),a={hasExpired:J.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=On(n,this.name),this.abortController=new AbortController,this.isDevEnv=Hg(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return Tn(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),J.toMiliseconds(e))}}var eq=Object.defineProperty,tq=(t,e,n)=>e in t?eq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,s1=(t,e,n)=>tq(t,typeof e!="symbol"?e+"":e,n);class nq extends gP{constructor(e,n){super(e,n),this.projectId=e,this.logger=n,s1(this,"context",rH),s1(this,"registerDeviceToken",async r=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=r,c=`${sH}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=On(n,this.context)}}var rq=Object.defineProperty,i1=Object.getOwnPropertySymbols,sq=Object.prototype.hasOwnProperty,iq=Object.prototype.propertyIsEnumerable,O0=(t,e,n)=>e in t?rq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,nc=(t,e)=>{for(var n in e||(e={}))sq.call(e,n)&&O0(t,n,e[n]);if(i1)for(var n of i1(e))iq.call(e,n)&&O0(t,n,e[n]);return t},Nt=(t,e,n)=>O0(t,typeof e!="symbol"?e+"":e,n);class oq extends mP{constructor(e,n,r=!0){super(e,n,r),this.core=e,this.logger=n,Nt(this,"context",oH),Nt(this,"storagePrefix",Xr),Nt(this,"storageVersion",iH),Nt(this,"events",new Map),Nt(this,"shouldPersist",!1),Nt(this,"init",async()=>{if(!Hg())try{const s={eventId:Fb(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:fA(this.core.relayer.protocol,this.core.relayer.version,C0)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),Nt(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,l=Fb(),u=this.core.projectId||"",d=Date.now(),f=nc({eventId:l,timestamp:d,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,f),this.shouldPersist=!0),f}),Nt(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return nc(nc({},a),this.setMethods(a.eventId))}),Nt(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),Nt(this,"setEventListeners",()=>{this.core.heartbeat.on(To.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{J.fromMiliseconds(Date.now())-J.fromMiliseconds(s.timestamp)>aH&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),Nt(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),Nt(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),Nt(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),Nt(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),Nt(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,nc(nc({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),Nt(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),Nt(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${cH}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${C0}${i}`,{method:"POST",body:JSON.stringify(s)})}),Nt(this,"getAppDomain",()=>dA().url),this.logger=On(n,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var aq=Object.defineProperty,o1=Object.getOwnPropertySymbols,cq=Object.prototype.hasOwnProperty,lq=Object.prototype.propertyIsEnumerable,R0=(t,e,n)=>e in t?aq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,a1=(t,e)=>{for(var n in e||(e={}))cq.call(e,n)&&R0(t,n,e[n]);if(o1)for(var n of o1(e))lq.call(e,n)&&R0(t,n,e[n]);return t},Je=(t,e,n)=>R0(t,typeof e!="symbol"?e+"":e,n);let uq=class L2 extends rP{constructor(e){var n;super(e),Je(this,"protocol",C2),Je(this,"version",_2),Je(this,"name",v0),Je(this,"relayUrl"),Je(this,"projectId"),Je(this,"customStoragePrefix"),Je(this,"events",new cr.EventEmitter),Je(this,"logger"),Je(this,"heartbeat"),Je(this,"relayer"),Je(this,"crypto"),Je(this,"storage"),Je(this,"history"),Je(this,"expirer"),Je(this,"pairing"),Je(this,"verify"),Je(this,"echoClient"),Je(this,"linkModeSupportedApps"),Je(this,"eventClient"),Je(this,"initialized",!1),Je(this,"logChunkController"),Je(this,"on",(a,c)=>this.events.on(a,c)),Je(this,"once",(a,c)=>this.events.once(a,c)),Je(this,"off",(a,c)=>this.events.off(a,c)),Je(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),Je(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:et.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});const r=this.getGlobalCore(e==null?void 0:e.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||I2,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=K0({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:Tj.logger,name:v0}),{logger:i,chunkLoggerController:o}=Gd({opts:s,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=o,(n=this.logChunkController)!=null&&n.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=On(i,this.name),this.heartbeat=new ER,this.crypto=new BW(this,this.logger,e==null?void 0:e.keychain),this.history=new Kz(this,this.logger),this.expirer=new Zz(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new eP(a1(a1({},Oj),e==null?void 0:e.storageOptions)),this.relayer=new uz({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new zz(this,this.logger),this.verify=new Qz(this,this.logger,this.storage),this.echoClient=new nq(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new oq(this,this.logger,e==null?void 0:e.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const n=new L2(e);await n.initialize();const r=await n.crypto.getClientId();return await n.storage.setItem(zj,r),n}get context(){return Tn(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(Mw,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(Mw)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(e,`Core Initialization Failure at epoch ${Date.now()}`),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${e}`,r=`${n}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[n]}catch(n){console.warn("Failed to get global WalletConnect core",n);return}}setGlobalCore(e){var n;try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${((n=e.opts)==null?void 0:n.customStoragePrefix)||""}`;globalThis[r]=e}catch(r){console.warn("Failed to set global WalletConnect core",r)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&Nj.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const dq=uq,M2="wc",F2=2,j2="client",rm=`${M2}@${F2}:${j2}:`,Kh={name:j2,logger:"error"},c1="WALLETCONNECT_DEEPLINK_CHOICE",fq="proposal",l1="Proposal expired",hq="session",qo=J.SEVEN_DAYS,pq="engine",Lt={wc_sessionPropose:{req:{ttl:J.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:J.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:J.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:J.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:J.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:J.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:J.ONE_DAY,prompt:!1,tag:1104},res:{ttl:J.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:J.ONE_DAY,prompt:!1,tag:1106},res:{ttl:J.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:J.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:J.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:J.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:J.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:J.ONE_DAY,prompt:!1,tag:1112},res:{ttl:J.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:J.ONE_DAY,prompt:!1,tag:1114},res:{ttl:J.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:J.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:J.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:J.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:J.FIVE_MINUTES,prompt:!1,tag:1119}}},Gh={min:J.FIVE_MINUTES,max:J.SEVEN_DAYS},$r={idle:"IDLE",active:"ACTIVE"},gq={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},mq="request",yq=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],bq="wc",wq="auth",Eq="authKeys",vq="pairingTopics",Cq="requests",Tf=`${bq}@${1.5}:${wq}:`,Ku=`${Tf}:PUB_KEY`;var _q=Object.defineProperty,Aq=Object.defineProperties,Iq=Object.getOwnPropertyDescriptors,u1=Object.getOwnPropertySymbols,Sq=Object.prototype.hasOwnProperty,xq=Object.prototype.propertyIsEnumerable,P0=(t,e,n)=>e in t?_q(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,We=(t,e)=>{for(var n in e||(e={}))Sq.call(e,n)&&P0(t,n,e[n]);if(u1)for(var n of u1(e))xq.call(e,n)&&P0(t,n,e[n]);return t},Mt=(t,e)=>Aq(t,Iq(e)),z=(t,e,n)=>P0(t,typeof e!="symbol"?e+"":e,n);class Nq extends EP{constructor(e){super(e),z(this,"name",pq),z(this,"events",new wg),z(this,"initialized",!1),z(this,"requestQueue",{state:$r.idle,queue:[]}),z(this,"sessionRequestQueue",{state:$r.idle,queue:[]}),z(this,"emittedSessionRequests",new uL({limit:500})),z(this,"requestQueueDelay",J.ONE_SECOND),z(this,"expectedPairingMethodMap",new Map),z(this,"recentlyDeletedMap",new Map),z(this,"recentlyDeletedLimit",200),z(this,"relayMessageCache",[]),z(this,"pendingSessions",new Map),z(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Lt)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},J.toMiliseconds(this.requestQueueDelay)))}),z(this,"connect",async n=>{var r;this.isInitialized(),await this.confirmOnlineStateOrThrow();const s=Mt(We({},n),{requiredNamespaces:n.requiredNamespaces||{},optionalNamespaces:n.optionalNamespaces||{}});await this.isValidConnect(s),s.optionalNamespaces=E7(s.requiredNamespaces,s.optionalNamespaces),s.requiredNamespaces={};const{pairingTopic:i,requiredNamespaces:o,optionalNamespaces:a,sessionProperties:c,scopedProperties:l,relays:u,authentication:d,walletPay:f}=s,h=((r=d==null?void 0:d[0])==null?void 0:r.ttl)||Lt.wc_sessionPropose.req.ttl||J.FIVE_MINUTES;this.validateRequestExpiry(h);let p=i,g,m=!1;try{if(p){const N=this.client.core.pairing.pairings.get(p);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),m=N.active}}catch(N){throw this.client.logger.error(`connect() -> pairing.get(${p}) failed`),N}if(!p||!m){const{topic:N,uri:L}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});p=N,g=L}if(!p){const{message:N}=X("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(N)}const E=await this.client.core.crypto.generateKeyPair(),A=gt(h),b=We(Mt(We(We({requiredNamespaces:o,optionalNamespaces:a,relays:u??[{protocol:A2}],proposer:{publicKey:E,metadata:this.client.metadata},expiryTimestamp:A,pairingTopic:p},c&&{sessionProperties:c}),l&&{scopedProperties:l}),{id:Br()}),(d||f)&&{requests:{authentication:d==null?void 0:d.map(N=>{const{domain:L,chains:M,nonce:U,uri:O,exp:$,nbf:y,type:w,statement:T,requestId:D,resources:R,signatureTypes:k}=N;return{domain:L,chains:M,nonce:U,type:w??"caip122",aud:O,version:"1",iat:new Date().toISOString(),exp:$,nbf:y,statement:T,requestId:D,resources:R,signatureTypes:k}}),walletPay:f}}),_=qe("session_connect",b.id),{reject:C,resolve:S,done:x}=zi(h,l1),P=({id:N})=>{N===b.id&&(this.client.events.off("proposal_expire",P),this.pendingSessions.delete(b.id),this.events.emit(_,{error:{message:l1,code:0}}))};return this.client.events.on("proposal_expire",P),this.events.once(_,({error:N,session:L})=>{this.client.events.off("proposal_expire",P),N?C(N):L&&S(L)}),await this.setProposal(b.id,b),await this.sendProposeSession({proposal:b,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:b.id}}}).catch(N=>{throw this.deleteProposal(b.id),N}),{uri:g,approval:x}}),z(this,"pair",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(n)}catch(r){throw this.client.logger.error("pair() failed"),r}}),z(this,"approve",async n=>{var r,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(r=n==null?void 0:n.id)==null?void 0:r.toString(),trace:[dr.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(L){throw o.setError(Li.no_internet_connection),L}try{await this.isValidProposalId(n==null?void 0:n.id)}catch(L){throw this.client.logger.error(`approve() -> proposal.get(${n==null?void 0:n.id}) failed`),o.setError(Li.proposal_not_found),L}try{await this.isValidApprove(n)}catch(L){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(Li.session_approve_namespace_validation_failure),L}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:f,proposalRequestsResponses:h}=n,p=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:g,proposer:m,requiredNamespaces:E,optionalNamespaces:A}=p;let b=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:g});b||(b=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:dr.session_approve_started,properties:{topic:g,trace:[dr.session_approve_started,dr.session_namespaces_validation_success]}}));const _=await this.client.core.crypto.generateKeyPair(),C=m.publicKey,S=await this.client.core.crypto.generateSharedKey(_,C),x=Mt(We(We(We({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:_,metadata:this.client.metadata},expiry:gt(qo)},u&&{sessionProperties:u}),d&&{scopedProperties:d}),f&&{sessionConfig:f}),{proposalRequestsResponses:h}),P=et.relay;b.addTrace(dr.subscribing_session_topic);try{await this.client.core.relayer.subscribe(S,{transportType:P,internal:{skipSubscribe:!0}})}catch(L){throw b.setError(Li.subscribe_session_topic_failure),L}b.addTrace(dr.subscribe_session_topic_success);const N=Mt(We({},x),{topic:S,requiredNamespaces:E,optionalNamespaces:A,pairingTopic:g,acknowledged:!1,self:x.controller,peer:{publicKey:m.publicKey,metadata:m.metadata},controller:_,transportType:et.relay,authentication:h==null?void 0:h.authentication,walletPayResult:h==null?void 0:h.walletPay});await this.client.session.set(S,N),b.addTrace(dr.store_session);try{await this.sendApproveSession({sessionTopic:S,proposal:p,pairingProposalResponse:{relay:{protocol:c??"irn"},responderPublicKey:_},sessionSettleRequest:x,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:We({correlationId:a},this.getTVFApproveParams(N))}}),b.addTrace(dr.session_approve_publish_success)}catch(L){throw this.client.logger.error(L),this.client.session.delete(S,nt("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(S),L}return this.client.core.eventClient.deleteEvent({eventId:b.eventId}),await this.client.core.pairing.updateMetadata({topic:g,metadata:m.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:g}),await this.setExpiry(S,gt(qo)),{topic:S,acknowledged:()=>Promise.resolve(this.client.session.get(S))}}),z(this,"reject",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(n)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:r,reason:s}=n;let i;try{i=this.client.proposal.get(r).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),o}i&&await this.sendError({id:r,topic:i,error:s,rpcOpts:Lt.wc_sessionPropose.reject}),await this.deleteProposal(r)}),z(this,"update",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(n)}catch(d){throw this.client.logger.error("update() -> isValidUpdate() failed"),d}const{topic:r,namespaces:s}=n,{done:i,resolve:o,reject:a}=zi(J.FIVE_MINUTES,"Session update request expired without receiving any acknowledgement"),c=Br(),l=gi().toString(),u=this.client.session.get(r).namespaces;return this.events.once(qe("session_update",c),({error:d})=>{d?a(d):o()}),await this.client.session.update(r,{namespaces:s}),await this.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(d=>{this.client.logger.error(d),this.client.session.update(r,{namespaces:u}),a(d)}),{acknowledged:i}}),z(this,"extend",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(n)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:r}=n,s=Br(),{done:i,resolve:o,reject:a}=zi(J.FIVE_MINUTES,"Session extend request expired without receiving any acknowledgement");return this.events.once(qe("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(r,gt(qo)),this.sendRequest({topic:r,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),z(this,"request",async n=>{this.isInitialized();try{await this.isValidRequest(n)}catch(m){throw this.client.logger.error("request() -> isValidRequest() failed"),m}const{chainId:r,request:s,topic:i,expiry:o=Lt.wc_sessionRequest.req.ttl}=n,a=this.client.session.get(i);(a==null?void 0:a.transportType)===et.relay&&await this.confirmOnlineStateOrThrow();const c=Br(),l=gi().toString(),{done:u,resolve:d,reject:f}=zi(o,"Request expired. Please try again.");this.events.once(qe("session_request",c),({error:m,result:E})=>{m?f(m):d(E)});const h="wc_sessionRequest",p=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(p)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:h,params:{request:Mt(We({},s),{expiryTimestamp:gt(o)}),chainId:r},expiry:o,throwOnFailedPublish:!0,appLink:p}).catch(m=>f(m)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),await u();const g={request:Mt(We({},s),{expiryTimestamp:gt(o)}),chainId:r};return await Promise.all([new Promise(async m=>{await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:h,params:g,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,g)}).catch(E=>f(E)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),m()}),new Promise(async m=>{var E;if(!((E=a.sessionConfig)!=null&&E.disableDeepLink)){const A=await iL(this.client.core.storage,c1);await nL({id:c,topic:i,wcDeepLink:A})}m()}),u()]).then(m=>m[2])}),z(this,"respond",async n=>{var r,s;this.isInitialized();const i=this.client.core.eventClient.createEvent({properties:{topic:(n==null?void 0:n.topic)||((s=(r=n==null?void 0:n.response)==null?void 0:r.id)==null?void 0:s.toString()),trace:[dr.session_request_response_started]}});try{await this.isValidRespond(n)}catch(d){throw i.addTrace(d==null?void 0:d.message),i.setError(Li.session_request_response_validation_failure),d}i.addTrace(dr.session_request_response_validation_success);const{topic:o,response:a}=n,{id:c}=a,l=this.client.session.get(o);l.transportType===et.relay&&await this.confirmOnlineStateOrThrow();const u=this.getAppLinkIfEnabled(l.peer.metadata,l.transportType);try{i.addTrace(dr.session_request_response_publish_started),Lr(a)?await this.sendResult({id:c,topic:o,result:a.result,throwOnFailedPublish:!0,appLink:u}):er(a)&&await this.sendError({id:c,topic:o,error:a.error,appLink:u}),this.cleanupAfterResponse(n)}catch(d){throw i.addTrace(d==null?void 0:d.message),i.setError(Li.session_request_response_publish_failure),d}}),z(this,"ping",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(n)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:r}=n;if(this.client.session.keys.includes(r)){const s=Br(),i=gi().toString(),{done:o,resolve:a,reject:c}=zi(J.FIVE_MINUTES,"Ping request expired without receiving any acknowledgement");this.events.once(qe("session_ping",s),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:r,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(r)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:r}))}),z(this,"emit",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(n);const{topic:r,event:s,chainId:i}=n,o=gi().toString(),a=Br();await this.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),z(this,"disconnect",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(n);const{topic:r}=n;if(this.client.session.keys.includes(r))await this.sendRequest({topic:r,method:"wc_sessionDelete",params:nt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:r,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(r))await this.client.core.pairing.disconnect({topic:r});else{const{message:s}=X("MISMATCHED_TOPIC",`Session or pairing topic not found: ${r}`);throw new Error(s)}}),z(this,"find",n=>(this.isInitialized(),this.client.session.getAll().filter(r=>_7(r,n)))),z(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),z(this,"authenticate",async(n,r)=>{var s;this.isInitialized(),this.isValidAuthenticate(n);const i=r&&this.client.core.linkModeSupportedApps.includes(r)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?et.link_mode:et.relay;o===et.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:u,nonce:d,type:f,exp:h,nbf:p,methods:g=[],expiry:m}=n,E=[...n.resources||[]],{topic:A,uri:b}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:A,uri:b}});const _=await this.client.core.crypto.generateKeyPair(),C=qu(_);if(await Promise.all([this.client.auth.authKeys.set(Ku,{responseTopic:C,publicKey:_}),this.client.auth.pairingTopics.set(C,{topic:C,pairingTopic:A})]),await this.client.core.relayer.subscribe(C,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${A}`),g.length>0){const{namespace:R}=xs(a[0]);let k=_M(R,"request",g);zu(E)&&(k=IM(k,E.pop())),E.push(k)}const S=m&&m>Lt.wc_sessionAuthenticate.req.ttl?m:Lt.wc_sessionAuthenticate.req.ttl,x={authPayload:{type:f??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:d,iat:new Date().toISOString(),exp:h,nbf:p,resources:E},requester:{publicKey:_,metadata:this.client.metadata},expiryTimestamp:gt(S)},P={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},N={requiredNamespaces:{},optionalNamespaces:P,relays:[{protocol:"irn"}],pairingTopic:A,proposer:{publicKey:_,metadata:this.client.metadata},expiryTimestamp:gt(Lt.wc_sessionPropose.req.ttl),id:Br()},{done:L,resolve:M,reject:U}=zi(S,"Request expired"),O=Br(),$=qe("session_connect",N.id),y=qe("session_request",O),w=async({error:R,session:k})=>{this.events.off(y,T),R?U(R):k&&M({session:k})},T=async R=>{var k,j,H;if(await this.deletePendingAuthRequest(O,{message:"fulfilled",code:0}),R.error){const pe=nt("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return R.error.code===pe.code?void 0:(this.events.off($,w),U(R.error.message))}await this.deleteProposal(N.id),this.events.off($,w);const{cacaos:ee,responder:K}=R.result,G=[],ce=[];for(const pe of ee){await Jb({cacao:pe,projectId:this.client.core.projectId})||(this.client.logger.error(pe,"Signature verification failed"),U(nt("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:Re}=pe,st=zu(Re.resources),wt=[l0(Re.iss)],St=Rd(Re.iss);if(st){const tn=Xb(st),Qr=Qb(st);G.push(...tn),wt.push(...Qr)}for(const tn of wt)ce.push(`${tn}:${St}`)}const ge=await this.client.core.crypto.generateSharedKey(_,K.publicKey);let Ne;G.length>0&&(Ne={topic:ge,acknowledged:!0,self:{publicKey:_,metadata:this.client.metadata},peer:K,controller:K.publicKey,expiry:gt(qo),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:A,namespaces:Iw([...new Set(G)],[...new Set(ce)]),transportType:o},await this.client.core.relayer.subscribe(ge,{transportType:o}),await this.client.session.set(ge,Ne),A&&await this.client.core.pairing.updateMetadata({topic:A,metadata:K.metadata}),Ne=this.client.session.get(ge)),(k=this.client.metadata.redirect)!=null&&k.linkMode&&(j=K.metadata.redirect)!=null&&j.linkMode&&(H=K.metadata.redirect)!=null&&H.universal&&r&&(this.client.core.addLinkModeSupportedApp(K.metadata.redirect.universal),this.client.session.update(ge,{transportType:et.link_mode})),M({auths:ee,session:Ne})};this.events.once($,w),this.events.once(y,T);let D;try{if(i){const R=yr("wc_sessionAuthenticate",x,O);this.client.core.history.set(A,R);const k=await this.client.core.crypto.encode("",R,{type:zl,encoding:di});D=Au(r,A,k)}else await Promise.all([this.sendRequest({topic:A,method:"wc_sessionAuthenticate",params:x,expiry:n.expiry,throwOnFailedPublish:!0,clientRpcId:O}),this.sendRequest({topic:A,method:"wc_sessionPropose",params:N,expiry:Lt.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:N.id})])}catch(R){throw this.events.off($,w),this.events.off(y,T),R}return await this.setProposal(N.id,N),await this.setAuthRequest(O,{request:Mt(We({},x),{verifyContext:{}}),pairingTopic:A,transportType:o}),{uri:D??b,response:L}}),z(this,"approveSessionAuthenticate",async n=>{const{id:r,auths:s}=n,i=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[Mi.authenticated_session_approve_started]}});try{this.isInitialized()}catch(m){throw i.setError(ec.no_internet_connection),m}const o=this.getPendingAuthRequest(r);if(!o)throw i.setError(ec.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${r}`);const a=o.transportType||et.relay;a===et.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=qu(c),d={type:Ns,receiverPublicKey:c,senderPublicKey:l},f=[],h=[];for(const m of s){if(!await Jb({cacao:m,projectId:this.client.core.projectId})){i.setError(ec.invalid_cacao);const C=nt("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:u,error:C,encodeOpts:d}),new Error(C.message)}i.addTrace(Mi.cacaos_verified);const{p:E}=m,A=zu(E.resources),b=[l0(E.iss)],_=Rd(E.iss);if(A){const C=Xb(A),S=Qb(A);f.push(...C),b.push(...S)}for(const C of b)h.push(`${C}:${_}`)}const p=await this.client.core.crypto.generateSharedKey(l,c);i.addTrace(Mi.create_authenticated_session_topic);let g;if((f==null?void 0:f.length)>0){g={topic:p,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:gt(qo),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:Iw([...new Set(f)],[...new Set(h)]),transportType:a},i.addTrace(Mi.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(p,{transportType:a})}catch(m){throw i.setError(ec.subscribe_authenticated_session_topic_failure),m}i.addTrace(Mi.subscribe_authenticated_session_topic_success),await this.client.session.set(p,g),i.addTrace(Mi.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(Mi.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:r,result:{cacaos:s,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(m){throw i.setError(ec.authenticated_session_approve_publish_failure),m}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:g}}),z(this,"rejectSessionAuthenticate",async n=>{this.isInitialized();const{id:r,reason:s}=n,i=this.getPendingAuthRequest(r);if(!i)throw new Error(`Could not find pending auth request with id ${r}`);i.transportType===et.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=qu(o),l={type:Ns,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:r,topic:c,error:s,encodeOpts:l,rpcOpts:Lt.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(r,{message:"rejected",code:0}),await this.deleteProposal(r)}),z(this,"formatAuthMessage",n=>{this.isInitialized();const{request:r,iss:s}=n;return RA(r,s)}),z(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const n=this.relayMessageCache.shift();n&&await this.onRelayMessage(n)}catch(n){this.client.logger.error(n)}},50)}),z(this,"cleanupDuplicatePairings",async n=>{if(n.pairingTopic)try{const r=this.client.core.pairing.pairings.get(n.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===n.peer.metadata.url&&i.topic&&i.topic!==r.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(r){this.client.logger.error(r)}}),z(this,"deleteSession",async n=>{var r;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=n,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,nt("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(c1).catch(l=>this.client.logger.warn(l)),s===((r=this.sessionRequestQueue.queue[0])==null?void 0:r.topic)&&(this.sessionRequestQueue.state=$r.idle),await Promise.all(this.getPendingSessionRequests().filter(l=>l.topic===s).map(l=>this.deletePendingSessionRequest(l.id,nt("USER_DISCONNECTED")))),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),z(this,"deleteProposal",async(n,r)=>{if(r)try{const s=this.client.proposal.get(n),i=this.client.core.eventClient.getEvent({topic:s.pairingTopic});i==null||i.setError(Li.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(n,nt("USER_DISCONNECTED")),r?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"proposal")}),z(this,"deletePendingSessionRequest",async(n,r,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==n),s&&(this.sessionRequestQueue.state=$r.idle,this.client.events.emit("session_request_expire",{id:n}))}),z(this,"deletePendingAuthRequest",async(n,r,s=!1)=>{await Promise.all([this.client.auth.requests.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)])}),z(this,"setExpiry",async(n,r)=>{this.client.session.keys.includes(n)&&(this.client.core.expirer.set(n,r),await this.client.session.update(n,{expiry:r}))}),z(this,"setProposal",async(n,r)=>{this.client.core.expirer.set(n,gt(Lt.wc_sessionPropose.req.ttl)),await this.client.proposal.set(n,r)}),z(this,"setAuthRequest",async(n,r)=>{const{request:s,pairingTopic:i,transportType:o=et.relay}=r;this.client.core.expirer.set(n,s.expiryTimestamp),await this.client.auth.requests.set(n,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:n,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),z(this,"setPendingSessionRequest",async n=>{const{id:r,topic:s,params:i,verifyContext:o}=n,a=i.request.expiryTimestamp||gt(Lt.wc_sessionRequest.req.ttl);this.client.core.expirer.set(r,a),await this.client.pendingRequest.set(r,{id:r,topic:s,params:i,verifyContext:o})}),z(this,"sendRequest",async n=>{const{topic:r,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:d,publishOpts:f={}}=n,h=yr(s,i,c);let p;const g=!!u;try{const A=g?di:_n;p=await this.client.core.crypto.encode(r,h,{encoding:A})}catch(A){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${r} failed`),A}let m;if(yq.includes(s)){const A=Qn(JSON.stringify(h)),b=Qn(p);m=await this.client.core.verify.register({id:b,decryptedId:A})}const E=We(We({},Lt[s].req),f);if(E.attestation=m,o&&(E.ttl=o),a&&(E.id=a),this.client.core.history.set(r,h),g){const A=Au(u,r,p);await global.Linking.openURL(A,this.client.name)}else E.tvf=Mt(We({},d),{correlationId:h.id}),l?(E.internal=Mt(We({},E.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(r,p,E)):this.client.core.relayer.publish(r,p,E).catch(A=>this.client.logger.error(A));return h.id}),z(this,"sendProposeSession",async n=>{const{proposal:r,publishOpts:s}=n,i=yr("wc_sessionPropose",r,r.id);this.client.core.history.set(r.pairingTopic,i);const o=await this.client.core.crypto.encode(r.pairingTopic,i,{encoding:_n}),a=Qn(JSON.stringify(i)),c=Qn(o),l=await this.client.core.verify.register({id:c,decryptedId:a});await this.client.core.relayer.publishCustom({payload:{pairingTopic:r.pairingTopic,sessionProposal:o},opts:Mt(We({},s),{publishMethod:"wc_proposeSession",attestation:l})})}),z(this,"sendApproveSession",async n=>{const{sessionTopic:r,pairingProposalResponse:s,proposal:i,sessionSettleRequest:o,publishOpts:a}=n,c=gl(i.id,s),l=await this.client.core.crypto.encode(i.pairingTopic,c,{encoding:_n}),u=yr("wc_sessionSettle",o,a==null?void 0:a.id),d=await this.client.core.crypto.encode(r,u,{encoding:_n});this.client.core.history.set(r,u),await this.client.core.relayer.publishCustom({payload:{sessionTopic:r,pairingTopic:i.pairingTopic,sessionProposalResponse:l,sessionSettlementRequest:d},opts:Mt(We({},a),{publishMethod:"wc_approveSession"})})}),z(this,"sendResult",async n=>{const{id:r,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=n,l=gl(r,i);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const p=d?di:_n;u=await this.client.core.crypto.encode(s,l,Mt(We({},a||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),p}let f,h;try{f=await this.client.core.history.get(s,r);const p=f.request;try{h=this.getTVFParams(r,p.params,i)}catch(g){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${g==null?void 0:g.message}`)}}catch(p){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${r}) failed`),p}if(d){const p=Au(c,s,u);await global.Linking.openURL(p,this.client.name)}else{const p=f.request.method,g=Lt[p].res;g.tvf=Mt(We({},h),{correlationId:r}),o?(g.internal=Mt(We({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,u,g)):this.client.core.relayer.publish(s,u,g).catch(m=>this.client.logger.error(m))}await this.client.core.history.resolve(l)}),z(this,"sendError",async n=>{const{id:r,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=n,l=Sf(r,i);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const h=d?di:_n;u=await this.client.core.crypto.encode(s,l,Mt(We({},o||{}),{encoding:h}))}catch(h){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),h}let f;try{f=await this.client.core.history.get(s,r)}catch(h){throw this.client.logger.error(`sendError() -> history.get(${s}, ${r}) failed`),h}if(d){const h=Au(c,s,u);await global.Linking.openURL(h,this.client.name)}else{const h=f.request.method,p=a||Lt[h].res;this.client.core.relayer.publish(s,u,p)}await this.client.core.history.resolve(l)}),z(this,"cleanup",async()=>{const n=[],r=[];this.client.session.getAll().forEach(s=>{let i=!1;Fr(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&n.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{Fr(s.expiryTimestamp)&&r.push(s.id)}),await Promise.all([...n.map(s=>this.deleteSession({topic:s})),...r.map(s=>this.deleteProposal(s))])}),z(this,"onProviderMessageEvent",async n=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(n):await this.onRelayMessage(n)}),z(this,"onRelayEventRequest",async n=>{this.requestQueue.queue.push(n),await this.processRequestsQueue()}),z(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===$r.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=$r.active;const n=this.requestQueue.queue.shift();if(n)try{await this.processRequest(n)}catch(r){this.client.logger.warn(r)}}this.requestQueue.state=$r.idle}),z(this,"processRequest",async n=>{const{topic:r,payload:s,attestation:i,transportType:o,encryptedId:a}=n,c=s.method;if(!this.shouldIgnorePairingRequest({topic:r,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:r,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(r,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(r,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(r,s);case"wc_sessionPing":return await this.onSessionPingRequest(r,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(r,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(r,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),z(this,"onRelayEventResponse",async n=>{const{topic:r,payload:s,transportType:i}=n,o=(await this.client.core.history.get(r,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(r,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(r,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(r,s);case"wc_sessionExtend":return this.onSessionExtendResponse(r,s);case"wc_sessionPing":return this.onSessionPingResponse(r,s);case"wc_sessionRequest":return this.onSessionRequestResponse(r,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(r,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),z(this,"onRelayEventUnknownPayload",n=>{const{topic:r}=n,{message:s}=X("MISSING_OR_INVALID",`Decoded payload on topic ${r} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),z(this,"shouldIgnorePairingRequest",n=>{const{topic:r,requestMethod:s}=n,i=this.expectedPairingMethodMap.get(r);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),z(this,"onSessionProposeRequest",async n=>{const{topic:r,payload:s,attestation:i,encryptedId:o}=n,{params:a,id:c}=s;try{const l=this.client.core.eventClient.getEvent({topic:r});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l==null||l.setError(hs.proposal_listener_not_found)),this.isValidConnect(We({},s.params));const u=a.expiryTimestamp||gt(Lt.wc_sessionPropose.req.ttl),d=We({id:c,pairingTopic:r,expiryTimestamp:u,attestation:i,encryptedId:o},a);await this.setProposal(c,d);const f=await this.getVerifyContext({attestationId:i,hash:Qn(JSON.stringify(s)),encryptedId:o,metadata:d.proposer.metadata});l==null||l.addTrace(Ur.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:f})}catch(l){await this.sendError({id:c,topic:r,error:l,rpcOpts:Lt.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),z(this,"onSessionProposeResponse",async(n,r,s)=>{const{id:i}=r;if(Lr(r)){const{result:o}=r;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(i,{sessionTopic:u,pairingTopic:n,proposalId:i,publicKey:c});const d=await this.client.core.relayer.subscribe(u,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),await this.client.core.pairing.activate({topic:n})}else if(er(r)){await this.deleteProposal(i);const o=qe("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:r.error})}}),z(this,"onSessionSettleRequest",async(n,r)=>{const{id:s,params:i}=r;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:f,proposalRequestsResponses:h}=r.params,p=[...this.pendingSessions.values()].find(E=>E.sessionTopic===n);if(!p)return this.client.logger.error(`Pending session not found for topic ${n}`);const g=this.client.proposal.get(p.proposalId),m=Mt(We(We(We({topic:n,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:p.pairingTopic,requiredNamespaces:g.requiredNamespaces,optionalNamespaces:g.optionalNamespaces,controller:a.publicKey,self:{publicKey:p.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),d&&{scopedProperties:d}),f&&{sessionConfig:f}),{transportType:et.relay,authentication:h==null?void 0:h.authentication,walletPayResult:h==null?void 0:h.walletPay});await this.client.session.set(m.topic,m),await this.setExpiry(m.topic,m.expiry),await this.client.core.pairing.updateMetadata({topic:p.pairingTopic,metadata:m.peer.metadata}),this.pendingSessions.delete(p.proposalId),this.deleteProposal(p.proposalId,!1),this.cleanupDuplicatePairings(m),await this.sendResult({id:r.id,topic:n,throwOnFailedPublish:!0,result:!0}),this.client.events.emit("session_connect",{session:m}),this.events.emit(qe("session_connect",p.proposalId),{session:m})}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),z(this,"onSessionSettleResponse",async(n,r)=>{const{id:s}=r;Lr(r)?(await this.client.session.update(n,{acknowledged:!0}),this.events.emit(qe("session_approve",s),{})):er(r)&&(await this.client.session.delete(n,nt("USER_DISCONNECTED")),this.events.emit(qe("session_approve",s),{error:r.error}))}),z(this,"onSessionUpdateRequest",async(n,r)=>{const{params:s,id:i}=r;try{const o=`${n}_session_update`,a=Xa.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:n,error:nt("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(We({topic:n},s));try{Xa.set(o,i),await this.client.session.update(n,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:n,result:!0})}catch(c){throw Xa.delete(o),c}this.client.events.emit("session_update",{id:i,topic:n,params:s})}catch(o){await this.sendError({id:i,topic:n,error:o}),this.client.logger.error(o)}}),z(this,"isRequestOutOfSync",(n,r)=>r.toString().slice(0,-3)<n.toString().slice(0,-3)),z(this,"onSessionUpdateResponse",(n,r)=>{const{id:s}=r,i=qe("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Lr(r)?this.events.emit(qe("session_update",s),{}):er(r)&&this.events.emit(qe("session_update",s),{error:r.error})}),z(this,"onSessionExtendRequest",async(n,r)=>{const{id:s}=r;try{this.isValidExtend({topic:n}),await this.setExpiry(n,gt(qo)),await this.sendResult({id:s,topic:n,result:!0}),this.client.events.emit("session_extend",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),z(this,"onSessionExtendResponse",(n,r)=>{const{id:s}=r,i=qe("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Lr(r)?this.events.emit(qe("session_extend",s),{}):er(r)&&this.events.emit(qe("session_extend",s),{error:r.error})}),z(this,"onSessionPingRequest",async(n,r)=>{const{id:s}=r;try{this.isValidPing({topic:n}),await this.sendResult({id:s,topic:n,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),z(this,"onSessionPingResponse",(n,r)=>{const{id:s}=r,i=qe("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);Lr(r)?this.events.emit(qe("session_ping",s),{}):er(r)&&this.events.emit(qe("session_ping",s),{error:r.error})},500)}),z(this,"onSessionDeleteRequest",async(n,r)=>{const{id:s}=r;try{await this.isValidDisconnect({topic:n,reason:r.params}),this.cleanupPendingSentRequestsForTopic({topic:n,error:nt("USER_DISCONNECTED")}),await this.deleteSession({topic:n,id:s})}catch(i){this.client.logger.error(i)}}),z(this,"onSessionRequest",async n=>{var r,s,i;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=n,{id:d,params:f}=a;try{await this.isValidRequest(We({topic:o},f));const h=this.client.session.get(o),p=await this.getVerifyContext({attestationId:c,hash:Qn(JSON.stringify(yr("wc_sessionRequest",f,d))),encryptedId:l,metadata:h.peer.metadata,transportType:u}),g={id:d,topic:o,params:f,verifyContext:p};await this.setPendingSessionRequest(g),u===et.link_mode&&(r=h.peer.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp((s=h.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(h){await this.sendError({id:d,topic:o,error:h}),this.client.logger.error(h)}}),z(this,"onSessionRequestResponse",(n,r)=>{const{id:s}=r,i=qe("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Lr(r)?this.events.emit(qe("session_request",s),{result:r.result}):er(r)&&this.events.emit(qe("session_request",s),{error:r.error})}),z(this,"onSessionEventRequest",async(n,r)=>{const{id:s,params:i}=r;try{const o=`${n}_session_event_${i.event.name}`,a=Xa.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(We({topic:n},i)),this.client.events.emit("session_event",{id:s,topic:n,params:i}),Xa.set(o,s)}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),z(this,"onSessionAuthenticateResponse",(n,r)=>{const{id:s}=r;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:n,payload:r}),Lr(r)?this.events.emit(qe("session_request",s),{result:r.result}):er(r)&&this.events.emit(qe("session_request",s),{error:r.error})}),z(this,"onSessionAuthenticateRequest",async n=>{var r;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=n;try{const{requester:l,authPayload:u,expiryTimestamp:d}=i.params,f=await this.getVerifyContext({attestationId:o,hash:Qn(JSON.stringify(i)),encryptedId:a,metadata:l.metadata,transportType:c}),h={requester:l,pairingTopic:s,id:i.id,authPayload:u,verifyContext:f,expiryTimestamp:d};await this.setAuthRequest(i.id,{request:h,pairingTopic:s,transportType:c}),c===et.link_mode&&(r=l.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:f})}catch(l){this.client.logger.error(l);const u=i.params.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),f=this.getAppLinkIfEnabled(i.params.requester.metadata,c),h={type:Ns,receiverPublicKey:u,senderPublicKey:d};await this.sendError({id:i.id,topic:s,error:l,encodeOpts:h,rpcOpts:Lt.wc_sessionAuthenticate.autoReject,appLink:f})}}),z(this,"addSessionRequestToSessionRequestQueue",n=>{this.sessionRequestQueue.queue.push(n)}),z(this,"cleanupAfterResponse",n=>{this.deletePendingSessionRequest(n.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=$r.idle,this.processSessionRequestQueue()},J.toMiliseconds(this.requestQueueDelay))}),z(this,"cleanupPendingSentRequestsForTopic",({topic:n,error:r})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===n&&i.request.method==="wc_sessionRequest").forEach(i=>{this.events.emit(qe("session_request",i.request.id),{error:r})})}),z(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===$r.active){this.client.logger.info("session request queue is already active.");return}const n=this.sessionRequestQueue.queue[0];if(!n){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(n)}catch(r){this.client.logger.error(r)}}),z(this,"emitSessionRequest",n=>{if(this.emittedSessionRequests.has(n.id)){this.client.logger.warn({id:n.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${n.id}`);return}this.sessionRequestQueue.state=$r.active,this.emittedSessionRequests.add(n.id),this.client.events.emit("session_request",n)}),z(this,"onPairingCreated",n=>{if(n.methods&&this.expectedPairingMethodMap.set(n.topic,n.methods),n.active)return;const r=this.client.proposal.getAll().find(s=>s.pairingTopic===n.topic);r&&this.onSessionProposeRequest({topic:n.topic,payload:yr("wc_sessionPropose",Mt(We({},r),{requiredNamespaces:r.requiredNamespaces,optionalNamespaces:r.optionalNamespaces,relays:r.relays,proposer:r.proposer,sessionProperties:r.sessionProperties,scopedProperties:r.scopedProperties}),r.id),attestation:r.attestation,encryptedId:r.encryptedId})}),z(this,"isValidConnect",async n=>{if(!wn(n)){const{message:l}=X("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(n)}`);throw new Error(l)}const{pairingTopic:r,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=n;if(Rt(r)||await this.isValidPairingTopic(r),!$7(c)){const{message:l}=X("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(s&&!Rt(s)&&Kr(s)!==0){const l="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(l):this.client.logger.warn(l),this.validateNamespaces(s,"requiredNamespaces")}if(i&&!Rt(i)&&Kr(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),o&&!Rt(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!Rt(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(u=>l.includes(u.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),z(this,"validateNamespaces",(n,r)=>{const s=D7(n,"connect()",r);if(s)throw new Error(s.message)}),z(this,"isValidApprove",async n=>{if(!wn(n))throw new Error(X("MISSING_OR_INVALID",`approve() params: ${n}`).message);const{id:r,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=n;this.checkRecentlyDeleted(r),await this.isValidProposalId(r);const c=this.client.proposal.get(r),l=Hh(s,"approve()");if(l)throw new Error(l.message);const u=Nw(c.requiredNamespaces,s,"approve()");if(u)throw new Error(u.message);if(!yt(i,!0)){const{message:d}=X("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(d)}if(o&&!Rt(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!Rt(a)){this.validateSessionProps(a,"scopedProperties");const d=new Set(Object.keys(s));if(!Object.keys(a).every(f=>d.has(f.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(d).join(", ")}`)}}),z(this,"isValidReject",async n=>{if(!wn(n)){const{message:i}=X("MISSING_OR_INVALID",`reject() params: ${n}`);throw new Error(i)}const{id:r,reason:s}=n;if(this.checkRecentlyDeleted(r),await this.isValidProposalId(r),!B7(s)){const{message:i}=X("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),z(this,"isValidSessionSettleRequest",n=>{if(!wn(n)){const{message:l}=X("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${n}`);throw new Error(l)}const{relay:r,controller:s,namespaces:i,expiry:o}=n;if(!g2(r)){const{message:l}=X("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=N7(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=Hh(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(Fr(o)){const{message:l}=X("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),z(this,"isValidUpdate",async n=>{if(!wn(n)){const{message:c}=X("MISSING_OR_INVALID",`update() params: ${n}`);throw new Error(c)}const{topic:r,namespaces:s}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const i=this.client.session.get(r),o=Hh(s,"update()");if(o)throw new Error(o.message);const a=Nw(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),z(this,"isValidExtend",async n=>{if(!wn(n)){const{message:s}=X("MISSING_OR_INVALID",`extend() params: ${n}`);throw new Error(s)}const{topic:r}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r)}),z(this,"isValidRequest",async n=>{if(!wn(n)){const{message:c}=X("MISSING_OR_INVALID",`request() params: ${n}`);throw new Error(c)}const{topic:r,request:s,chainId:i,expiry:o}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const{namespaces:a}=this.client.session.get(r);if(!xw(a,i)){const{message:c}=X("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!L7(s)){const{message:c}=X("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!j7(a,i,s.method)){const{message:c}=X("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}this.validateRequestExpiry(o)}),z(this,"isValidRespond",async n=>{var r;if(!wn(n)){const{message:a}=X("MISSING_OR_INVALID",`respond() params: ${n}`);throw new Error(a)}const{topic:s,response:i}=n;try{await this.isValidSessionTopic(s)}catch(a){throw(r=n==null?void 0:n.response)!=null&&r.id&&this.cleanupAfterResponse(n),a}if(!M7(i)){const{message:a}=X("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(a)}const o=this.client.pendingRequest.get(i.id);if(o.topic!==s){const{message:a}=X("MISMATCHED_TOPIC",`Request response topic mismatch. reqId: ${i.id}, expected topic: ${o.topic}, received topic: ${s}`);throw new Error(a)}}),z(this,"isValidPing",async n=>{if(!wn(n)){const{message:s}=X("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),z(this,"isValidEmit",async n=>{if(!wn(n)){const{message:a}=X("MISSING_OR_INVALID",`emit() params: ${n}`);throw new Error(a)}const{topic:r,event:s,chainId:i}=n;await this.isValidSessionTopic(r);const{namespaces:o}=this.client.session.get(r);if(!xw(o,i)){const{message:a}=X("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!F7(s)){const{message:a}=X("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!H7(o,i,s.name)){const{message:a}=X("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),z(this,"isValidDisconnect",async n=>{if(!wn(n)){const{message:s}=X("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),z(this,"isValidAuthenticate",n=>{const{chains:r,uri:s,domain:i,nonce:o}=n;if(!Array.isArray(r)||r.length===0)throw new Error("chains is required and must be a non-empty array");if(!yt(s,!1))throw new Error("uri is required parameter");if(!yt(i,!1))throw new Error("domain is required parameter");if(!yt(o,!1))throw new Error("nonce is required parameter");if([...new Set(r.map(c=>xs(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=xs(r[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),z(this,"getVerifyContext",async n=>{const{attestationId:r,hash:s,encryptedId:i,metadata:o,transportType:a}=n,c={verified:{verifyUrl:o.verifyUrl||wc,validation:"UNKNOWN",origin:o.url||""}};try{if(a===et.link_mode){const u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:r,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),z(this,"validateSessionProps",(n,r)=>{Object.values(n).forEach((s,i)=>{if(s==null){const{message:o}=X("MISSING_OR_INVALID",`${r} must contain an existing value for each key. Received: ${s} for key ${Object.keys(n)[i]}`);throw new Error(o)}})}),z(this,"getPendingAuthRequest",n=>{const r=this.client.auth.requests.get(n);return typeof r=="object"?r:void 0}),z(this,"addToRecentlyDeleted",(n,r)=>{if(this.recentlyDeletedMap.set(n,r),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),z(this,"checkRecentlyDeleted",n=>{const r=this.recentlyDeletedMap.get(n);if(r){const{message:s}=X("MISSING_OR_INVALID",`Record was recently deleted - ${r}: ${n}`);throw new Error(s)}}),z(this,"isLinkModeEnabled",(n,r)=>{var s,i,o,a,c,l,u,d,f;return!n||r!==et.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=n==null?void 0:n.redirect)==null?void 0:u.universal)!==void 0&&((d=n==null?void 0:n.redirect)==null?void 0:d.universal)!==""&&((f=n==null?void 0:n.redirect)==null?void 0:f.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(n.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),z(this,"getAppLinkIfEnabled",(n,r)=>{var s;return this.isLinkModeEnabled(n,r)?(s=n==null?void 0:n.redirect)==null?void 0:s.universal:void 0}),z(this,"handleLinkModeMessage",({url:n})=>{if(!n||!n.includes("wc_ev")||!n.includes("topic"))return;const r=Mb(n,"topic")||"",s=decodeURIComponent(Mb(n,"wc_ev")||""),i=this.client.session.keys.includes(r);i&&this.client.session.update(r,{transportType:et.link_mode}),this.client.core.dispatchEnvelope({topic:r,message:s,sessionExists:i})}),z(this,"registerLinkModeListeners",async()=>{var n;if(Hg()||Ri()&&(n=this.client.metadata.redirect)!=null&&n.linkMode){const r=global==null?void 0:global.Linking;if(typeof r<"u"){r.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await r.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),z(this,"getTVFApproveParams",n=>{try{const r=h2(n.namespaces),s=g7(n.namespaces),i=m7(n.namespaces),o=n.sessionProperties,a=n.scopedProperties;return{approvedChains:r,approvedMethods:s,approvedEvents:i,sessionProperties:o,scopedProperties:a}}catch(r){return this.client.logger.warn(r,"Error getting TVF approve params"),{}}}),z(this,"getTVFParams",(n,r,s)=>{var i,o,a;if(!((i=r.request)!=null&&i.method))return{};const c={correlationId:n,rpcMethods:[r.request.method],chainId:r.chainId};try{const l=this.extractTxHashesFromResult(r.request,s);c.txHashes=l,c.contractAddresses=this.isValidContractData(r.request.params)?[(a=(o=r.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(l){this.client.logger.warn(l,"Error getting TVF params")}return c}),z(this,"isValidContractData",n=>{var r;if(!n)return!1;try{const s=(n==null?void 0:n.data)||((r=n==null?void 0:n[0])==null?void 0:r.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),z(this,"extractTxHashesFromResult",(n,r)=>{var s;try{if(!r)return[];const i=n.method,o=gq[i];if(i==="sui_signTransaction")return[sM(r.transactionBytes)];if(i==="near_signTransaction")return[Kb(r)];if(i==="near_signTransactions")return r.map(c=>Kb(c));if(i==="xrpl_signTransactionFor"||i==="xrpl_signTransaction")return[(s=r.tx_json)==null?void 0:s.hash];if(i==="polkadot_signTransaction")return[oj({transaction:n.params.transactionPayload,signature:r.signature})];if(i==="algo_signTxn")return Ts(r)?r.map(c=>Gb(c)):[Gb(r)];if(i==="cosmos_signDirect")return[oM(r)];if(i==="wallet_sendCalls")return aM(r);if(typeof r=="string")return[r];const a=r[o.key];if(Ts(a))return i==="solana_signAllTransactions"?a.map(c=>rM(c)):a;if(typeof a=="string")return[a]}catch(i){this.client.logger.warn(i,"Error extracting tx hashes from result")}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,n=this.client.core.relayer.messages.getWithoutAck(e);for(const[r,s]of Object.entries(n))for(const i of s)try{await this.onProviderMessageEvent({topic:r,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${r}, message: ${i}`)}}catch(e){this.client.logger.warn(e,"processPendingMessageEvents failed")}}isInitialized(){if(!this.initialized){const{message:e}=X("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(mt.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:n,message:r,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(Ku)?this.client.auth.authKeys.get(Ku):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(n,r,{receiverPublicKey:o,encoding:i===et.link_mode?di:_n});tm(a)?(this.client.core.history.set(n,a),await this.onRelayEventRequest({topic:n,payload:a,attestation:s,transportType:i,encryptedId:Qn(r)})):xf(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:n,payload:a,transportType:i}),this.client.core.history.delete(n,a.id)):(this.client.logger.error(`onRelayMessage() -> unknown payload: ${JSON.stringify(a)}`),await this.onRelayEventUnknownPayload({topic:n,payload:a,transportType:i})),await this.client.core.relayer.messages.ack(n,r)}catch(a){this.client.logger.error(`onRelayMessage() -> failed to process an inbound message: ${r}`),this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(Jn.expired,async e=>{const{topic:n,id:r}=pA(e.target);if(r&&this.client.pendingRequest.keys.includes(r))return await this.deletePendingSessionRequest(r,X("EXPIRED"),!0);if(r&&this.client.auth.requests.keys.includes(r))return await this.deletePendingAuthRequest(r,X("EXPIRED"),!0);n?this.client.session.keys.includes(n)&&(await this.deleteSession({topic:n,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:n})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r}))})}registerPairingEvents(){this.client.core.pairing.events.on(Vi.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(Vi.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!yt(e,!1)){const{message:n}=X("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(n)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:n}=X("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(n)}if(Fr(this.client.core.pairing.pairings.get(e).expiry)){const{message:n}=X("EXPIRED",`pairing topic: ${e}`);throw new Error(n)}}async isValidSessionTopic(e){if(!yt(e,!1)){const{message:n}=X("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(n)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:n}=X("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(n)}if(Fr(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:n}=X("EXPIRED",`session topic: ${e}`);throw new Error(n)}if(!this.client.core.crypto.keychain.has(e)){const{message:n}=X("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(n)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(yt(e,!1)){const{message:n}=X("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(n)}else{const{message:n}=X("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(n)}}async isValidProposalId(e){if(!U7(e)){const{message:n}=X("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(n)}if(!this.client.proposal.keys.includes(e)){const{message:n}=X("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(n)}if(Fr(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:n}=X("EXPIRED",`proposal id: ${e}`);throw new Error(n)}}validateRequestExpiry(e){if(e&&!q7(e,Gh)){const{message:n}=X("MISSING_OR_INVALID",`request() expiry: ${e}. Expiry must be a number (in seconds) between ${Gh.min} and ${Gh.max}`);throw new Error(n)}}}class Tq extends ko{constructor(e,n){super(e,n,fq,rm),this.core=e,this.logger=n}}let Oq=class extends ko{constructor(e,n){super(e,n,hq,rm),this.core=e,this.logger=n}};class Rq extends ko{constructor(e,n){super(e,n,mq,rm,r=>r.id),this.core=e,this.logger=n}}class Pq extends ko{constructor(e,n){super(e,n,Eq,Tf,()=>Ku),this.core=e,this.logger=n}}class kq extends ko{constructor(e,n){super(e,n,vq,Tf),this.core=e,this.logger=n}}class Dq extends ko{constructor(e,n){super(e,n,Cq,Tf,r=>r.id),this.core=e,this.logger=n}}var $q=Object.defineProperty,Uq=(t,e,n)=>e in t?$q(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Yh=(t,e,n)=>Uq(t,typeof e!="symbol"?e+"":e,n);class Bq{constructor(e,n){this.core=e,this.logger=n,Yh(this,"authKeys"),Yh(this,"pairingTopics"),Yh(this,"requests"),this.authKeys=new Pq(this.core,this.logger),this.pairingTopics=new kq(this.core,this.logger),this.requests=new Dq(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var Lq=Object.defineProperty,Mq=(t,e,n)=>e in t?Lq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,De=(t,e,n)=>Mq(t,typeof e!="symbol"?e+"":e,n);class sm extends wP{constructor(e){super(e),De(this,"protocol",M2),De(this,"version",F2),De(this,"name",Kh.name),De(this,"metadata"),De(this,"core"),De(this,"logger"),De(this,"events",new cr.EventEmitter),De(this,"engine"),De(this,"session"),De(this,"proposal"),De(this,"pendingRequest"),De(this,"auth"),De(this,"signConfig"),De(this,"on",(r,s)=>this.events.on(r,s)),De(this,"once",(r,s)=>this.events.once(r,s)),De(this,"off",(r,s)=>this.events.off(r,s)),De(this,"removeListener",(r,s)=>this.events.removeListener(r,s)),De(this,"removeAllListeners",r=>this.events.removeAllListeners(r)),De(this,"connect",async r=>{try{return await this.engine.connect(r)}catch(s){throw this.logger.error(s.message),s}}),De(this,"pair",async r=>{try{return await this.engine.pair(r)}catch(s){throw this.logger.error(s.message),s}}),De(this,"approve",async r=>{try{return await this.engine.approve(r)}catch(s){throw this.logger.error(s.message),s}}),De(this,"reject",async r=>{try{return await this.engine.reject(r)}catch(s){throw this.logger.error(s.message),s}}),De(this,"update",async r=>{try{return await this.engine.update(r)}catch(s){throw this.logger.error(s.message),s}}),De(this,"extend",async r=>{try{return await this.engine.extend(r)}catch(s){throw this.logger.error(s.message),s}}),De(this,"request",async r=>{try{return await this.engine.request(r)}catch(s){throw this.logger.error(s.message),s}}),De(this,"respond",async r=>{try{return await this.engine.respond(r)}catch(s){throw this.logger.error(s.message),s}}),De(this,"ping",async r=>{try{return await this.engine.ping(r)}catch(s){throw this.logger.error(s.message),s}}),De(this,"emit",async r=>{try{return await this.engine.emit(r)}catch(s){throw this.logger.error(s.message),s}}),De(this,"disconnect",async r=>{try{return await this.engine.disconnect(r)}catch(s){throw this.logger.error(s.message),s}}),De(this,"find",r=>{try{return this.engine.find(r)}catch(s){throw this.logger.error(s.message),s}}),De(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(r){throw this.logger.error(r.message),r}}),De(this,"authenticate",async(r,s)=>{try{return await this.engine.authenticate(r,s)}catch(i){throw this.logger.error(i.message),i}}),De(this,"formatAuthMessage",r=>{try{return this.engine.formatAuthMessage(r)}catch(s){throw this.logger.error(s.message),s}}),De(this,"approveSessionAuthenticate",async r=>{try{return await this.engine.approveSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),De(this,"rejectSessionAuthenticate",async r=>{try{return await this.engine.rejectSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),this.name=(e==null?void 0:e.name)||Kh.name,this.metadata=ZB(e==null?void 0:e.metadata),this.signConfig=e==null?void 0:e.signConfig;const n=Qg({logger:(e==null?void 0:e.logger)||Kh.logger,name:this.name});this.logger=n,this.core=(e==null?void 0:e.core)||new dq(e),this.session=new Oq(this.core,this.logger),this.proposal=new Tq(this.core,this.logger),this.pendingRequest=new Rq(this.core,this.logger),this.engine=new Nq(this),this.auth=new Bq(this.core,this.logger)}static async init(e){const n=new sm(e);return await n.initialize(),n}get context(){return Tn(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const Fq=sm;var k0={exports:{}};(function(t,e){var n=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof Mr<"u"&&Mr,r=function(){function i(){this.fetch=!1,this.DOMException=n.DOMException}return i.prototype=n,new i}();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof Mr<"u"&&Mr||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function l(y){return y&&DataView.prototype.isPrototypeOf(y)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(y){return y&&u.indexOf(Object.prototype.toString.call(y))>-1};function f(y){if(typeof y!="string"&&(y=String(y)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(y)||y==="")throw new TypeError('Invalid character in header field name: "'+y+'"');return y.toLowerCase()}function h(y){return typeof y!="string"&&(y=String(y)),y}function p(y){var w={next:function(){var T=y.shift();return{done:T===void 0,value:T}}};return c.iterable&&(w[Symbol.iterator]=function(){return w}),w}function g(y){this.map={},y instanceof g?y.forEach(function(w,T){this.append(T,w)},this):Array.isArray(y)?y.forEach(function(w){if(w.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+w.length);this.append(w[0],w[1])},this):y&&Object.getOwnPropertyNames(y).forEach(function(w){this.append(w,y[w])},this)}g.prototype.append=function(y,w){y=f(y),w=h(w);var T=this.map[y];this.map[y]=T?T+", "+w:w},g.prototype.delete=function(y){delete this.map[f(y)]},g.prototype.get=function(y){return y=f(y),this.has(y)?this.map[y]:null},g.prototype.has=function(y){return this.map.hasOwnProperty(f(y))},g.prototype.set=function(y,w){this.map[f(y)]=h(w)},g.prototype.forEach=function(y,w){for(var T in this.map)this.map.hasOwnProperty(T)&&y.call(w,this.map[T],T,this)},g.prototype.keys=function(){var y=[];return this.forEach(function(w,T){y.push(T)}),p(y)},g.prototype.values=function(){var y=[];return this.forEach(function(w){y.push(w)}),p(y)},g.prototype.entries=function(){var y=[];return this.forEach(function(w,T){y.push([T,w])}),p(y)},c.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function m(y){if(!y._noBody){if(y.bodyUsed)return Promise.reject(new TypeError("Already read"));y.bodyUsed=!0}}function E(y){return new Promise(function(w,T){y.onload=function(){w(y.result)},y.onerror=function(){T(y.error)}})}function A(y){var w=new FileReader,T=E(w);return w.readAsArrayBuffer(y),T}function b(y){var w=new FileReader,T=E(w),D=/charset=([A-Za-z0-9_-]+)/.exec(y.type),R=D?D[1]:"utf-8";return w.readAsText(y,R),T}function _(y){for(var w=new Uint8Array(y),T=new Array(w.length),D=0;D<w.length;D++)T[D]=String.fromCharCode(w[D]);return T.join("")}function C(y){if(y.slice)return y.slice(0);var w=new Uint8Array(y.byteLength);return w.set(new Uint8Array(y)),w.buffer}function S(){return this.bodyUsed=!1,this._initBody=function(y){this.bodyUsed=this.bodyUsed,this._bodyInit=y,y?typeof y=="string"?this._bodyText=y:c.blob&&Blob.prototype.isPrototypeOf(y)?this._bodyBlob=y:c.formData&&FormData.prototype.isPrototypeOf(y)?this._bodyFormData=y:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(y)?this._bodyText=y.toString():c.arrayBuffer&&c.blob&&l(y)?(this._bodyArrayBuffer=C(y.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(y)||d(y))?this._bodyArrayBuffer=C(y):this._bodyText=y=Object.prototype.toString.call(y):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof y=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(y)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var y=m(this);if(y)return y;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var y=m(this);return y||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(A);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var y=m(this);if(y)return y;if(this._bodyBlob)return b(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(_(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(L)}),this.json=function(){return this.text().then(JSON.parse)},this}var x=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function P(y){var w=y.toUpperCase();return x.indexOf(w)>-1?w:y}function N(y,w){if(!(this instanceof N))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');w=w||{};var T=w.body;if(y instanceof N){if(y.bodyUsed)throw new TypeError("Already read");this.url=y.url,this.credentials=y.credentials,w.headers||(this.headers=new g(y.headers)),this.method=y.method,this.mode=y.mode,this.signal=y.signal,!T&&y._bodyInit!=null&&(T=y._bodyInit,y.bodyUsed=!0)}else this.url=String(y);if(this.credentials=w.credentials||this.credentials||"same-origin",(w.headers||!this.headers)&&(this.headers=new g(w.headers)),this.method=P(w.method||this.method||"GET"),this.mode=w.mode||this.mode||null,this.signal=w.signal||this.signal||function(){if("AbortController"in a){var k=new AbortController;return k.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&T)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(T),(this.method==="GET"||this.method==="HEAD")&&(w.cache==="no-store"||w.cache==="no-cache")){var D=/([?&])_=[^&]*/;if(D.test(this.url))this.url=this.url.replace(D,"$1_="+new Date().getTime());else{var R=/\?/;this.url+=(R.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}N.prototype.clone=function(){return new N(this,{body:this._bodyInit})};function L(y){var w=new FormData;return y.trim().split("&").forEach(function(T){if(T){var D=T.split("="),R=D.shift().replace(/\+/g," "),k=D.join("=").replace(/\+/g," ");w.append(decodeURIComponent(R),decodeURIComponent(k))}}),w}function M(y){var w=new g,T=y.replace(/\r?\n[\t ]+/g," ");return T.split("\r").map(function(D){return D.indexOf(`
`)===0?D.substr(1,D.length):D}).forEach(function(D){var R=D.split(":"),k=R.shift().trim();if(k){var j=R.join(":").trim();try{w.append(k,j)}catch(H){console.warn("Response "+H.message)}}}),w}S.call(N.prototype);function U(y,w){if(!(this instanceof U))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(w||(w={}),this.type="default",this.status=w.status===void 0?200:w.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=w.statusText===void 0?"":""+w.statusText,this.headers=new g(w.headers),this.url=w.url||"",this._initBody(y)}S.call(U.prototype),U.prototype.clone=function(){return new U(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},U.error=function(){var y=new U(null,{status:200,statusText:""});return y.ok=!1,y.status=0,y.type="error",y};var O=[301,302,303,307,308];U.redirect=function(y,w){if(O.indexOf(w)===-1)throw new RangeError("Invalid status code");return new U(null,{status:w,headers:{location:y}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(w,T){this.message=w,this.name=T;var D=Error(w);this.stack=D.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function $(y,w){return new Promise(function(T,D){var R=new N(y,w);if(R.signal&&R.signal.aborted)return D(new o.DOMException("Aborted","AbortError"));var k=new XMLHttpRequest;function j(){k.abort()}k.onload=function(){var K={statusText:k.statusText,headers:M(k.getAllResponseHeaders()||"")};R.url.indexOf("file://")===0&&(k.status<200||k.status>599)?K.status=200:K.status=k.status,K.url="responseURL"in k?k.responseURL:K.headers.get("X-Request-URL");var G="response"in k?k.response:k.responseText;setTimeout(function(){T(new U(G,K))},0)},k.onerror=function(){setTimeout(function(){D(new TypeError("Network request failed"))},0)},k.ontimeout=function(){setTimeout(function(){D(new TypeError("Network request timed out"))},0)},k.onabort=function(){setTimeout(function(){D(new o.DOMException("Aborted","AbortError"))},0)};function H(K){try{return K===""&&a.location.href?a.location.href:K}catch{return K}}if(k.open(R.method,H(R.url),!0),R.credentials==="include"?k.withCredentials=!0:R.credentials==="omit"&&(k.withCredentials=!1),"responseType"in k&&(c.blob?k.responseType="blob":c.arrayBuffer&&(k.responseType="arraybuffer")),w&&typeof w.headers=="object"&&!(w.headers instanceof g||a.Headers&&w.headers instanceof a.Headers)){var ee=[];Object.getOwnPropertyNames(w.headers).forEach(function(K){ee.push(f(K)),k.setRequestHeader(K,h(w.headers[K]))}),R.headers.forEach(function(K,G){ee.indexOf(G)===-1&&k.setRequestHeader(G,K)})}else R.headers.forEach(function(K,G){k.setRequestHeader(G,K)});R.signal&&(R.signal.addEventListener("abort",j),k.onreadystatechange=function(){k.readyState===4&&R.signal.removeEventListener("abort",j)}),k.send(typeof R._bodyInit>"u"?null:R._bodyInit)})}return $.polyfill=!0,a.fetch||(a.fetch=$,a.Headers=g,a.Request=N,a.Response=U),o.Headers=g,o.Request=N,o.Response=U,o.fetch=$,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=n.fetch?n:r;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,t.exports=e})(k0,k0.exports);var jq=k0.exports;const d1=Hd(jq);var Hq=Object.defineProperty,Wq=Object.defineProperties,zq=Object.getOwnPropertyDescriptors,f1=Object.getOwnPropertySymbols,qq=Object.prototype.hasOwnProperty,Vq=Object.prototype.propertyIsEnumerable,h1=(t,e,n)=>e in t?Hq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,p1=(t,e)=>{for(var n in e||(e={}))qq.call(e,n)&&h1(t,n,e[n]);if(f1)for(var n of f1(e))Vq.call(e,n)&&h1(t,n,e[n]);return t},g1=(t,e)=>Wq(t,zq(e));const Kq={Accept:"application/json","Content-Type":"application/json"},Gq="POST",m1={headers:Kq,method:Gq},y1=10;let H2=class{constructor(e,n=!1){if(this.url=e,this.disableProviderPing=n,this.events=new cr.EventEmitter,this.isAvailable=!1,this.registering=!1,!Dw(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=n}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const n=ks(e),r=await(await d1(this.url,g1(p1({},m1),{body:n}))).json();this.onPayload({data:r})}catch(n){this.onError(e.id,n)}}async register(e=this.url){if(!Dw(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));r()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const n=ks({id:1,jsonrpc:"2.0",method:"test",params:[]});await d1(e,g1(p1({},m1),{body:n}))}this.onOpen()}catch(n){const r=this.parseError(n);throw this.events.emit("register_error",r),this.onClose(),r}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?po(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const r=this.parseError(n),s=r.message||r.toString(),i=Sf(e,s);this.events.emit("payload",i)}parseError(e,n=this.url){return b2(e,n,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>y1&&this.events.setMaxListeners(y1)}};function im(t){return t==null||typeof t!="object"&&typeof t!="function"}function W2(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function z2(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const Yq="[object RegExp]",q2="[object String]",V2="[object Number]",K2="[object Boolean]",G2="[object Arguments]",Zq="[object Symbol]",Jq="[object Date]",Xq="[object Map]",Qq="[object Set]",eV="[object Array]",tV="[object ArrayBuffer]",nV="[object Object]",rV="[object DataView]",sV="[object Uint8Array]",iV="[object Uint8ClampedArray]",oV="[object Uint16Array]",aV="[object Uint32Array]",cV="[object Int8Array]",lV="[object Int16Array]",uV="[object Int32Array]",dV="[object Float32Array]",fV="[object Float64Array]";function om(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function hV(t,e){return ea(t,void 0,t,new Map,e)}function ea(t,e,n,r=new Map,s=void 0){const i=s==null?void 0:s(t,e,n,r);if(i!=null)return i;if(im(t))return t;if(r.has(t))return r.get(t);if(Array.isArray(t)){const o=new Array(t.length);r.set(t,o);for(let a=0;a<t.length;a++)o[a]=ea(t[a],a,n,r,s);return Object.hasOwn(t,"index")&&(o.index=t.index),Object.hasOwn(t,"input")&&(o.input=t.input),o}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){const o=new RegExp(t.source,t.flags);return o.lastIndex=t.lastIndex,o}if(t instanceof Map){const o=new Map;r.set(t,o);for(const[a,c]of t)o.set(a,ea(c,a,n,r,s));return o}if(t instanceof Set){const o=new Set;r.set(t,o);for(const a of t)o.add(ea(a,void 0,n,r,s));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(t))return t.subarray();if(om(t)){const o=new(Object.getPrototypeOf(t)).constructor(t.length);r.set(t,o);for(let a=0;a<t.length;a++)o[a]=ea(t[a],a,n,r,s);return o}if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);if(t instanceof DataView){const o=new DataView(t.buffer.slice(0),t.byteOffset,t.byteLength);return r.set(t,o),Ki(o,t,n,r,s),o}if(typeof File<"u"&&t instanceof File){const o=new File([t],t.name,{type:t.type});return r.set(t,o),Ki(o,t,n,r,s),o}if(t instanceof Blob){const o=new Blob([t],{type:t.type});return r.set(t,o),Ki(o,t,n,r,s),o}if(t instanceof Error){const o=new t.constructor;return r.set(t,o),o.message=t.message,o.name=t.name,o.stack=t.stack,o.cause=t.cause,Ki(o,t,n,r,s),o}if(typeof t=="object"&&pV(t)){const o=Object.create(Object.getPrototypeOf(t));return r.set(t,o),Ki(o,t,n,r,s),o}return t}function Ki(t,e,n=t,r,s){const i=[...Object.keys(e),...W2(e)];for(let o=0;o<i.length;o++){const a=i[o],c=Object.getOwnPropertyDescriptor(t,a);(c==null||c.writable)&&(t[a]=ea(e[a],a,n,r,s))}}function pV(t){switch(z2(t)){case G2:case eV:case tV:case rV:case K2:case Jq:case dV:case fV:case cV:case lV:case uV:case Xq:case V2:case nV:case Yq:case Qq:case q2:case Zq:case sV:case iV:case oV:case aV:return!0;default:return!1}}function gV(t,e){return hV(t,(n,r,s,i)=>{if(typeof t=="object")switch(Object.prototype.toString.call(t)){case V2:case q2:case K2:{const o=new t.constructor(t==null?void 0:t.valueOf());return Ki(o,t),o}case G2:{const o={};return Ki(o,t),o.length=t.length,o[Symbol.iterator]=t[Symbol.iterator],o}default:return}})}function b1(t){return gV(t)}function w1(t){return t!==null&&typeof t=="object"&&z2(t)==="[object Arguments]"}function E1(t){return typeof t=="object"&&t!==null}function mV(){}function yV(t){return om(t)}function bV(t){var n;if(typeof t!="object"||t==null)return!1;if(Object.getPrototypeOf(t)===null)return!0;if(Object.prototype.toString.call(t)!=="[object Object]"){const r=t[Symbol.toStringTag];return r==null||!((n=Object.getOwnPropertyDescriptor(t,Symbol.toStringTag))!=null&&n.writable)?!1:t.toString()===`[object ${r}]`}let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function wV(t){if(im(t))return t;if(Array.isArray(t)||om(t)||t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);const e=Object.getPrototypeOf(t),n=e.constructor;if(t instanceof Date||t instanceof Map||t instanceof Set)return new n(t);if(t instanceof RegExp){const r=new n(t);return r.lastIndex=t.lastIndex,r}if(t instanceof DataView)return new n(t.buffer.slice(0));if(t instanceof Error){const r=new n(t.message);return r.stack=t.stack,r.name=t.name,r.cause=t.cause,r}if(typeof File<"u"&&t instanceof File)return new n([t],t.name,{type:t.type,lastModified:t.lastModified});if(typeof t=="object"){const r=Object.create(e);return Object.assign(r,t)}return t}function EV(t,...e){const n=e.slice(0,-1),r=e[e.length-1];let s=t;for(let i=0;i<n.length;i++){const o=n[i];s=D0(s,o,r,new Map)}return s}function D0(t,e,n,r){if(im(t)&&(t=Object(t)),e==null||typeof e!="object")return t;if(r.has(e))return wV(r.get(e));if(r.set(e,t),Array.isArray(e)){e=e.slice();for(let i=0;i<e.length;i++)e[i]=e[i]??void 0}const s=[...Object.keys(e),...W2(e)];for(let i=0;i<s.length;i++){const o=s[i];let a=e[o],c=t[o];if(w1(a)&&(a={...a}),w1(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=b1(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const u=[],d=Reflect.ownKeys(c);for(let f=0;f<d.length;f++){const h=d[f];u[h]=c[h]}c=u}else c=[];const l=n(c,a,o,t,e,r);l!=null?t[o]=l:Array.isArray(a)||E1(c)&&E1(a)?t[o]=D0(c,a,n,r):c==null&&bV(a)?t[o]=D0({},a,n,r):c==null&&yV(a)?t[o]=b1(a):(c===void 0||a!==void 0)&&(t[o]=a)}return t}function vV(t,...e){return EV(t,...e,mV)}const v1="error",CV="wss://relay.walletconnect.org",_V="wc",Y2="universal_provider",Iu=`${_V}@2:${Y2}:`,Z2="https://rpc.walletconnect.org/v1/",J2="generic",AV=`${Z2}bundler`,ca="call_status",IV=86400,am={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var SV=Object.defineProperty,xV=Object.defineProperties,NV=Object.getOwnPropertyDescriptors,C1=Object.getOwnPropertySymbols,TV=Object.prototype.hasOwnProperty,OV=Object.prototype.propertyIsEnumerable,_1=(t,e,n)=>e in t?SV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Su=(t,e)=>{for(var n in e||(e={}))TV.call(e,n)&&_1(t,n,e[n]);if(C1)for(var n of C1(e))OV.call(e,n)&&_1(t,n,e[n]);return t},RV=(t,e)=>xV(t,NV(e));function X2(t,e,n){var r;const s=xs(t);return((r=e.rpcMap)==null?void 0:r[s.reference])||`${Z2}?chainId=${s.namespace}:${s.reference}&projectId=${n}`}function PV(t){return t.includes(":")?t.split(":")[1]:t}function Q2(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function kV(t,e){const n=Object.keys(e.namespaces).filter(s=>s.includes(t));if(!n.length)return[];const r=[];return n.forEach(s=>{const i=e.namespaces[s].accounts;r.push(...i)}),r}function A1(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>{var r,s;return((r=n==null?void 0:n.chains)==null?void 0:r.length)&&((s=n==null?void 0:n.chains)==null?void 0:s.length)>0}))}function xu(t={},e={}){const n=A1(I1(t)),r=A1(I1(e));return vV(n,r)}function I1(t){var e,n,r,s,i;const o={};if(!Kr(t))return o;for(const[a,c]of Object.entries(t)){const l=If(a)?[a]:c.chains,u=c.methods||[],d=c.events||[],f=c.rpcMap||{},h=Qo(a);o[h]=RV(Su(Su({},o[h]),c),{chains:Vr(l,(e=o[h])==null?void 0:e.chains),methods:Vr(u,(n=o[h])==null?void 0:n.methods),events:Vr(d,(r=o[h])==null?void 0:r.events)}),(Kr(f)||Kr(((s=o[h])==null?void 0:s.rpcMap)||{}))&&(o[h].rpcMap=Su(Su({},f),(i=o[h])==null?void 0:i.rpcMap))}return o}function S1(t){return t.includes(":")?t.split(":")[2]:t}function x1(t){const e={};for(const[n,r]of Object.entries(t)){const s=r.methods||[],i=r.events||[],o=r.accounts||[],a=If(n)?[n]:r.chains?r.chains:Q2(r.accounts);e[n]={chains:a,methods:s,events:i,accounts:o}}return e}function Zh(t){return typeof t=="number"?t:t.includes("0x")?parseInt(t,16):(t=t.includes(":")?t.split(":")[1]:t,isNaN(Number(t))?t:Number(t))}function DV(t){try{const e=JSON.parse(t);return typeof e=="object"&&e!==null&&!Array.isArray(e)}catch{return!1}}const eI={},la=t=>eI[t],Jh=(t,e)=>{eI[t]=e};var $V=Object.defineProperty,N1=Object.getOwnPropertySymbols,UV=Object.prototype.hasOwnProperty,BV=Object.prototype.propertyIsEnumerable,T1=(t,e,n)=>e in t?$V(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,O1=(t,e)=>{for(var n in e||(e={}))UV.call(e,n)&&T1(t,n,e[n]);if(N1)for(var n of N1(e))BV.call(e,n)&&T1(t,n,e[n]);return t};const R1="eip155",LV=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],MV=t=>t&&t.startsWith("0x")?BigInt(t).toString(10):t,Xh=t=>t&&t.startsWith("0x")?t:`0x${BigInt(t).toString(16)}`,P1=t=>Object.keys(t).filter(e=>LV.includes(e)).reduce((e,n)=>(e[n]=FV(t[n]),e),{}),FV=t=>typeof t=="string"&&DV(t)?JSON.parse(t):t,jV=(t,e,n)=>{const{sessionProperties:r={},scopedProperties:s={}}=t,i={};if(!Kr(s)&&!Kr(r))return;const o=P1(r);for(const a of n){const c=MV(a);if(!c)continue;i[Xh(c)]=o;const l=s==null?void 0:s[`${R1}:${c}`];if(l){const u=l==null?void 0:l[`${R1}:${c}:${e}`];i[Xh(c)]=O1(O1({},i[Xh(c)]),P1(u||l))}}for(const[a,c]of Object.entries(i))Object.keys(c).length===0&&delete i[a];return Object.keys(i).length>0?i:void 0};var HV=Object.defineProperty,WV=(t,e,n)=>e in t?HV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,zV=(t,e,n)=>WV(t,e+"",n);let Qh;class cm{constructor(e){zV(this,"storage"),this.storage=e}async getItem(e){return await this.storage.getItem(e)}async setItem(e,n){return await this.storage.setItem(e,n)}async removeItem(e){return await this.storage.removeItem(e)}static getStorage(e){return Qh||(Qh=new cm(e)),Qh}}var qV=Object.defineProperty,VV=Object.defineProperties,KV=Object.getOwnPropertyDescriptors,k1=Object.getOwnPropertySymbols,GV=Object.prototype.hasOwnProperty,YV=Object.prototype.propertyIsEnumerable,D1=(t,e,n)=>e in t?qV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ZV=(t,e)=>{for(var n in e||(e={}))GV.call(e,n)&&D1(t,n,e[n]);if(k1)for(var n of k1(e))YV.call(e,n)&&D1(t,n,e[n]);return t},JV=(t,e)=>VV(t,KV(e));async function XV(t,e){const n=xs(t.result.capabilities.caip345.caip2),r=t.result.capabilities.caip345.transactionHashes,s=await Promise.allSettled(r.map(d=>QV(n.reference,d,e))),i=s.filter(d=>d.status==="fulfilled").map(d=>d.value).filter(d=>d);s.filter(d=>d.status==="rejected").forEach(d=>console.warn("Failed to fetch transaction receipt:",d.reason));const o=!i.length||i.some(d=>!d),a=i.every(d=>(d==null?void 0:d.status)==="0x1"),c=i.every(d=>(d==null?void 0:d.status)==="0x0"),l=i.some(d=>(d==null?void 0:d.status)==="0x0");let u;return o?u=100:a?u=200:c?u=500:l&&(u=600),{id:t.result.id,version:t.request.version,atomic:t.request.atomicRequired,chainId:t.request.chainId,capabilities:t.result.capabilities,receipts:i,status:u}}async function QV(t,e,n){return await n(parseInt(t)).request(yr("eth_getTransactionReceipt",[e]))}async function eK({sendCalls:t,storage:e}){const n=await e.getItem(ca);await e.setItem(ca,JV(ZV({},n),{[t.result.id]:{request:t.request,result:t.result,expiry:gt(IV)}}))}async function tK({resultId:t,storage:e}){const n=await e.getItem(ca);if(n){delete n[t],await e.setItem(ca,n);for(const r in n)Fr(n[r].expiry)&&delete n[r];await e.setItem(ca,n)}}async function nK({resultId:t,storage:e}){const n=await e.getItem(ca),r=n==null?void 0:n[t];if(r&&!Fr(r.expiry))return r;await tK({resultId:t,storage:e})}var rK=Object.defineProperty,sK=Object.defineProperties,iK=Object.getOwnPropertyDescriptors,$1=Object.getOwnPropertySymbols,oK=Object.prototype.hasOwnProperty,aK=Object.prototype.propertyIsEnumerable,$0=(t,e,n)=>e in t?rK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ep=(t,e)=>{for(var n in e||(e={}))oK.call(e,n)&&$0(t,n,e[n]);if($1)for(var n of $1(e))aK.call(e,n)&&$0(t,n,e[n]);return t},tp=(t,e)=>sK(t,iK(e)),Fi=(t,e,n)=>$0(t,typeof e!="symbol"?e+"":e,n);class cK{constructor(e){Fi(this,"name","eip155"),Fi(this,"client"),Fi(this,"chainId"),Fi(this,"namespace"),Fi(this,"httpProviders"),Fi(this,"events"),Fi(this,"storage"),this.namespace=e.namespace,this.events=la("events"),this.client=la("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain()),this.storage=cm.getStorage(this.client.core.storage)}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e);case"wallet_sendCalls":return await this.sendCalls(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(parseInt(e),n);const r=this.chainId;this.chainId=parseInt(e),this.events.emit(am.DEFAULT_CHAIN_CHANGED,{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${r}`})}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,n){const r=n||X2(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new nm(new H2(r,la("disableProviderPing")))}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=parseInt(PV(n));e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}getHttpProvider(e){const n=e||this.chainId;return this.httpProviders[n]||(this.httpProviders=tp(ep({},this.httpProviders),{[n]:this.createHttpProvider(n)}),this.httpProviders[n])}async handleSwitchChain(e){var n,r;let s=e.request.params?(n=e.request.params[0])==null?void 0:n.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(r=this.namespace.chains)==null?void 0:r[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var n,r,s,i,o;const a=(r=(n=e.request)==null?void 0:n.params)==null?void 0:r[0],c=((i=(s=e.request)==null?void 0:s.params)==null?void 0:i[1])||[];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const l=this.client.session.get(e.topic),u=((o=l==null?void 0:l.sessionProperties)==null?void 0:o.capabilities)||{},d=`${a}${c.join(",")}`,f=u==null?void 0:u[d];if(f)return f;let h;try{h=jV(l,a,c)}catch(g){console.warn("Failed to extract capabilities from session",g)}if(h)return h;const p=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:tp(ep({},l.sessionProperties||{}),{capabilities:tp(ep({},u||{}),{[d]:p})})})}catch(g){console.warn("Failed to update session with capabilities",g)}return p}async getCallStatus(e){var n,r,s;const i=this.client.session.get(e.topic),o=(n=i.sessionProperties)==null?void 0:n.bundler_name;if(o){const l=this.getBundlerUrl(e.chainId,o);try{return await this.getUserOperationReceipt(l,e)}catch(u){console.warn("Failed to fetch call status from bundler",u,l)}}const a=(r=i.sessionProperties)==null?void 0:r.bundler_url;if(a)try{return await this.getUserOperationReceipt(a,e)}catch(l){console.warn("Failed to fetch call status from custom bundler",l,a)}const c=await nK({resultId:(s=e.request.params)==null?void 0:s[0],storage:this.storage});if(c)try{return await XV(c,this.getHttpProvider.bind(this))}catch(l){console.warn("Failed to fetch call status from stored send calls",l,c)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,n){var r;const s=new URL(e),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(yr("eth_getUserOperationReceipt",[(r=n.request.params)==null?void 0:r[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,n){return`${AV}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${n}`}async sendCalls(e){var n,r,s;const i=await this.client.request(e),o=(n=e.request.params)==null?void 0:n[0],a=i==null?void 0:i.id,c=(i==null?void 0:i.capabilities)||{},l=(r=c==null?void 0:c.caip345)==null?void 0:r.caip2,u=(s=c==null?void 0:c.caip345)==null?void 0:s.transactionHashes;return!a||!l||!(u!=null&&u.length)||await eK({sendCalls:{request:o,result:i},storage:this.storage}),i}}var lK=Object.defineProperty,uK=(t,e,n)=>e in t?lK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Vo=(t,e,n)=>uK(t,typeof e!="symbol"?e+"":e,n);class dK{constructor(e){Vo(this,"name",J2),Vo(this,"client"),Vo(this,"httpProviders"),Vo(this,"events"),Vo(this,"namespace"),Vo(this,"chainId"),this.namespace=e.namespace,this.events=la("events"),this.client=la("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n);const r=this.chainId;this.chainId=e,this.events.emit(am.DEFAULT_CHAIN_CHANGED,{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${r}`})}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getNamespaceName(){const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return xs(e).namespace}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){var e,n;const r={};return(n=(e=this.namespace)==null?void 0:e.accounts)==null||n.forEach(s=>{var i,o;const a=xs(s),c=(o=(i=this.namespace)==null?void 0:i.rpcMap)==null?void 0:o[`${a.namespace}:${a.reference}`];r[a.reference]=this.createHttpProvider(s,c)}),r}getHttpProvider(e){const n=xs(e).reference,r=this.httpProviders[n];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||X2(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new nm(new H2(r,la("disableProviderPing")))}}var fK=Object.defineProperty,hK=Object.defineProperties,pK=Object.getOwnPropertyDescriptors,U1=Object.getOwnPropertySymbols,gK=Object.prototype.hasOwnProperty,mK=Object.prototype.propertyIsEnumerable,U0=(t,e,n)=>e in t?fK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,rc=(t,e)=>{for(var n in e||(e={}))gK.call(e,n)&&U0(t,n,e[n]);if(U1)for(var n of U1(e))mK.call(e,n)&&U0(t,n,e[n]);return t},Nu=(t,e)=>hK(t,pK(e)),$n=(t,e,n)=>U0(t,typeof e!="symbol"?e+"":e,n);let yK=class tI{constructor(e){$n(this,"client"),$n(this,"namespaces"),$n(this,"optionalNamespaces"),$n(this,"sessionProperties"),$n(this,"scopedProperties"),$n(this,"events",new wg),$n(this,"rpcProviders",{}),$n(this,"session"),$n(this,"providerOpts"),$n(this,"logger"),$n(this,"uri"),$n(this,"disableProviderPing",!1),$n(this,"connectParams");var n,r;this.providerOpts=e,this.logger=Qg({logger:(n=e.logger)!=null?n:v1,name:(r=this.providerOpts.name)!=null?r:Y2}),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const n=new tI(e);return await n.initialize(),n}async request(e,n,r){const[s,i]=this.validateChain(n);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:rc({},e),chainId:`${s}:${i}`,topic:this.session.topic,expiry:r})}sendAsync(e,n,r,s){const i=new Date().getTime();this.request(e,r,s).then(o=>n(null,gl(i,o))).catch(o=>n(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:nt("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.connectParams=e,this.setNamespaces(e),this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,n){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:r,response:s}=await this.client.authenticate(e,n);r&&(this.uri=r,this.events.emit("display_uri",r));const i=await s();if(this.session=i.session,this.session){const o=x1(this.session.namespaces);this.namespaces=xu(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}removeListener(e,n){this.events.removeListener(e,n)}off(e,n){this.events.off(e,n)}get isWalletConnect(){return!0}async pair(e){var n,r;const{uri:s,approval:i}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties,authentication:(n=this.connectParams)==null?void 0:n.authentication,walletPay:(r=this.connectParams)==null?void 0:r.walletPay});s&&(this.uri=s,this.events.emit("display_uri",s));const o=await i();this.session=o;const a=x1(o.namespaces);return this.namespaces=xu(this.namespaces,a),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,n){try{if(!this.session)return;const[r,s]=this.validateChain(e);this.getProvider(r).setDefaultChain(s,n)}catch(r){if(!/Please call connect/.test(r.message))throw r}}async cleanupPendingPairings(e={}){try{this.logger.info("Cleaning up inactive pairings...");const n=this.client.pairing.getAll();if(!Ts(n))return;for(const r of n)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${n.length}`)}catch(n){this.logger.warn(n,"Failed to cleanup pending pairings")}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,n;if(this.client=this.providerOpts.client||await Fq.init({core:this.providerOpts.core,logger:this.providerOpts.logger||v1,relayUrl:this.providerOpts.relayUrl||CV,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error(r,"Failed to get session"),new Error(`The provided session: ${(n=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:n.topic} doesn't exist in the Sign client`)}else{const r=this.client.session.getAll();this.session=r[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(n=>Qo(n)))];Jh("client",this.client),Jh("events",this.events),Jh("disableProviderPing",this.disableProviderPing),e.forEach(n=>{if(!this.session)return;const r=kV(n,this.session);if((r==null?void 0:r.length)===0)return;const s=Q2(r),i=xu(this.namespaces,this.optionalNamespaces),o=Nu(rc({},i[n]),{accounts:r,chains:s});switch(n){case"eip155":this.rpcProviders[n]=new cK({namespace:o});break;default:this.rpcProviders[n]=new dK({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var n;const{topic:r}=e;r===((n=this.session)==null?void 0:n.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var n;const{params:r,topic:s}=e;if(s!==((n=this.session)==null?void 0:n.topic))return;const{event:i}=r;if(i.name==="accountsChanged"){const o=i.data;o&&Ts(o)&&this.events.emit("accountsChanged",o.map(S1))}else if(i.name==="chainChanged"){const o=r.chainId,a=r.event.data,c=Qo(o),l=Zh(o)!==Zh(a)?`${c}:${Zh(a)}`:o;this.onChainChanged({currentCaipChainId:l})}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:n})=>{var r,s;if(e!==((r=this.session)==null?void 0:r.topic))return;const{namespaces:i}=n,o=(s=this.client)==null?void 0:s.session.get(e);this.session=Nu(rc({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:n})}),this.client.on("session_delete",async e=>{var n;e.topic===((n=this.session)==null?void 0:n.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Nu(rc({},nt("USER_DISCONNECTED")),{data:e.topic})))}),this.on(am.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(Nu(rc({},e),{internal:!0}))})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[J2]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var n;this.getProvider(e).updateNamespace((n=this.session)==null?void 0:n.namespaces[e])})}setNamespaces(e){const{namespaces:n={},optionalNamespaces:r={},sessionProperties:s,scopedProperties:i}=e;this.optionalNamespaces=xu(n,r),this.sessionProperties=s,this.scopedProperties=i}validateChain(e){const[n,r]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[n,r];if(n&&!Object.keys(this.namespaces||{}).map(o=>Qo(o)).includes(n))throw new Error(`Namespace '${n}' is not configured. Please call connect() first with namespace config.`);if(n&&r)return[n,r];const s=Qo(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged({currentCaipChainId:e,previousCaipChainId:n,internal:r=!1}){if(!this.namespaces)return;const[s,i]=this.validateChain(e);i&&(this.updateNamespaceChain(s,i),r?(this.events.emit("chainChanged",i),this.emitAccountsChangedOnChainChange({namespace:s,currentCaipChainId:e,previousCaipChainId:n})):this.getProvider(s).setDefaultChain(i),await this.persist("namespaces",this.namespaces))}emitAccountsChangedOnChainChange({namespace:e,currentCaipChainId:n,previousCaipChainId:r}){var s,i;try{if(r===n)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[e])==null?void 0:i.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${n}:`)).map(S1);if(!Ts(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn(o,"Failed to emit accountsChanged on chain change")}}updateNamespaceChain(e,n){if(!this.namespaces)return;const r=this.namespaces[e]?e:`${e}:${n}`,s={chains:[],methods:[],events:[],defaultChain:n};this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=n):this.namespaces[r]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.connectParams=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,n){var r;const s=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.setItem(`${Iu}/${e}${s}`,n)}async getFromStore(e){var n;const r=((n=this.session)==null?void 0:n.topic)||"";return await this.client.core.storage.getItem(`${Iu}/${e}${r}`)}async deleteFromStore(e){var n;const r=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.removeItem(`${Iu}/${e}${r}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const n=await this.client.core.storage.getKeys();for(const r of n)r.startsWith(Iu)&&await this.client.core.storage.removeItem(r)}catch(n){this.logger.warn(n,"Failed to cleanup storage")}}};const B1=2147483648,bK={convertEVMChainIdToCoinType(t){if(t>=B1)throw new Error("Invalid chainId");return(B1|t)>>>0}},Yn=Qe({suggestions:[],loading:!1}),wK={state:Yn,subscribe(t){return Ft(Yn,()=>t(Yn))},subscribeKey(t,e){return Dt(Yn,t,e)},async resolveName(t){var e,n;try{return await be.lookupEnsName(t)}catch(r){const s=r;throw new Error(((n=(e=s==null?void 0:s.reasons)==null?void 0:e[0])==null?void 0:n.description)||"Error resolving name")}},async isNameRegistered(t){try{return await be.lookupEnsName(t),!0}catch{return!1}},async getSuggestions(t){try{Yn.loading=!0,Yn.suggestions=[];const e=await be.getEnsNameSuggestions(t);return Yn.suggestions=e.suggestions||[],Yn.suggestions}catch(e){const n=vc.parseEnsApiError(e,"Error fetching name suggestions");throw new Error(n)}finally{Yn.loading=!1}},async getNamesForAddress(t){try{if(!I.state.activeCaipNetwork)return[];const n=W.getEnsFromCacheForAddress(t);if(n)return n;const r=await be.reverseLookupEnsName({address:t});return W.updateEnsCache({address:t,ens:r,timestamp:Date.now()}),r}catch(e){const n=vc.parseEnsApiError(e,"Error fetching names for address");throw new Error(n)}},async registerName(t){var s;const e=I.state.activeCaipNetwork,n=(s=I.getAccountData(e==null?void 0:e.chainNamespace))==null?void 0:s.address,r=V.getAuthConnector();if(!e)throw new Error("Network not found");if(!n||!r)throw new Error("Address or auth connector not found");Yn.loading=!0;try{const i=JSON.stringify({name:t,attributes:{},timestamp:Math.floor(Date.now()/1e3)});me.pushTransactionStack({onCancel(){me.replace("RegisterAccountName")}});const o=await Z.signMessage(i);Yn.loading=!1;const a=e.id;if(!a)throw new Error("Network not found");const c=bK.convertEVMChainIdToCoinType(Number(a));await be.registerEnsName({coinType:c,address:n,signature:o,message:i}),I.setAccountProp("profileName",t,e.chainNamespace),W.updateEnsCache({address:n,ens:[{name:t,registered_at:new Date().toISOString(),updated_at:void 0,addresses:{},attributes:[]}],timestamp:Date.now()}),me.replace("RegisterAccountNameSuccess")}catch(i){const o=vc.parseEnsApiError(i,`Error registering name ${t}`);throw me.replace("RegisterAccountName"),new Error(o)}finally{Yn.loading=!1}},validateName(t){return/^[a-zA-Z0-9-]{4,}$/u.test(t)},parseEnsApiError(t,e){var r,s;const n=t;return((s=(r=n==null?void 0:n.reasons)==null?void 0:r[0])==null?void 0:s.description)||e}},vc=ar(wK);function B0(t){try{return new URL(t)}catch{return null}}function EK(t){const e=t.split("/"),n=e.length>0&&e[0]!==void 0?e[0]:"",r=n.lastIndexOf(":");return r===-1?{host:n}:{host:n.slice(0,r),port:n.slice(r+1)}}function vK(t){const e=t.indexOf("://");if(e===-1)return null;const n=t.slice(0,e),r=e+3;let s=t.indexOf("/",r);s===-1&&(s=t.length);const i=t.slice(r,s),o=i.lastIndexOf(":");return o===-1?{scheme:n,host:i}:{scheme:n,host:i.slice(0,o),port:i.slice(o+1)}}function CK(t,e){if(e.includes("://")){const o=B0(e);return o?o.origin===t:!1}const{host:n,port:r}=EK(e),s=t.indexOf("://");if(s!==-1){const o=s+3;let a=t.indexOf("/",o);a===-1&&(a=t.length);const c=t.slice(o,a);if(r!==void 0)return`${n}:${r}`===c;const l=c.split(":")[0];return n===l}const i=B0(t);return i?r!==void 0?n===i.hostname&&r===(i.port||void 0):n===i.hostname:!1}function _K(t,e,n){let r=n,s;const i=r.indexOf("://");i!==-1&&(s=r.slice(0,i),r=r.slice(i+3));const o=r.indexOf("/");o!==-1&&(r=r.slice(0,o));let a=r,c;const l=a.lastIndexOf(":");l!==-1&&(c=a.slice(l+1),a=a.slice(0,l));const u=a.split(".");for(const g of u)if(g.includes("*")&&g!=="*")return!1;const d=t.protocol.replace(/:$/u,"");if(s&&s!==d||c!==void 0&&c!=="*"&&c!==t.port)return!1;const f=vK(e),p=(f?f.host:t.hostname).split(".");if(u.length!==p.length)return!1;for(let g=u.length-1;g>=0;g-=1){const m=u[g],E=p[g];if(m!=="*"&&m!==E)return!1}return!0}const AK={ton:["ton_sendMessage","ton_signData"],solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},Os={RPC_ERROR_CODE:{USER_REJECTED:5e3,USER_REJECTED_METHODS:5002},getMethodsByChainNamespace(t){return AK[t]||[]},createDefaultNamespace(t){return{methods:this.getMethodsByChainNamespace(t),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(t,e){if(!e)return{...t};const n={...t},r=new Set;if(e.methods&&Object.keys(e.methods).forEach(s=>r.add(s)),e.chains&&Object.keys(e.chains).forEach(s=>r.add(s)),e.events&&Object.keys(e.events).forEach(s=>r.add(s)),e.rpcMap&&Object.keys(e.rpcMap).forEach(s=>{const[i]=s.split(":");i&&r.add(i)}),r.forEach(s=>{n[s]||(n[s]=this.createDefaultNamespace(s))}),e.methods&&Object.entries(e.methods).forEach(([s,i])=>{n[s]&&(n[s].methods=i)}),e.chains&&Object.entries(e.chains).forEach(([s,i])=>{n[s]&&(n[s].chains=i)}),e.events&&Object.entries(e.events).forEach(([s,i])=>{n[s]&&(n[s].events=i)}),e.rpcMap){const s=new Set;Object.entries(e.rpcMap).forEach(([i,o])=>{const[a,c]=i.split(":");!a||!c||!n[a]||(n[a].rpcMap||(n[a].rpcMap={}),s.has(a)||(n[a].rpcMap={},s.add(a)),n[a].rpcMap[c]=o)})}return n},createNamespaces(t,e){const n=t.reduce((r,s)=>{const{id:i,chainNamespace:o,rpcUrls:a}=s,c=a.default.http[0];r[o]||(r[o]=this.createDefaultNamespace(o));const l=`${o}:${i}`,u=r[o];switch(u.chains.push(l),l){case"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":u.chains.push("solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ");break;case"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1":u.chains.push("solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K");break}return u!=null&&u.rpcMap&&c&&(u.rpcMap[i]=c),r},{});return this.applyNamespaceOverrides(n,e)},resolveReownName:async t=>{var r;const e=await vc.resolveName(t);return((r=(e!=null&&e.addresses?Object.values(e.addresses):[])[0])==null?void 0:r.address)||!1},getChainsFromNamespaces(t={}){return Object.values(t).flatMap(e=>{const n=e.chains||[],r=e.accounts.map(s=>{const[i,o]=s.split(":");return`${i}:${o}`});return Array.from(new Set([...n,...r]))})},isSessionEventData(t){return typeof t=="object"&&t!==null&&"id"in t&&"topic"in t&&"params"in t&&typeof t.params=="object"&&t.params!==null&&"chainId"in t.params&&"event"in t.params&&typeof t.params.event=="object"&&t.params.event!==null},isUserRejectedRequestError(t){try{if(typeof t=="object"&&t!==null){const e=t,n=typeof e.code=="number",r=n&&e.code===Os.RPC_ERROR_CODE.USER_REJECTED_METHODS,s=n&&e.code===Os.RPC_ERROR_CODE.USER_REJECTED;return r||s}return!1}catch{return!1}},isOriginAllowed(t,e,n){const r=[...e,...n];if(e.length===0)return!0;const s=B0(t);if(!s)return r.some(i=>!i.includes("*")&&i===t);if(s.hostname==="localhost"||s.hostname==="127.0.0.1")return!0;for(const i of r)if(i.includes("*")){if(_K(s,t,i))return!0}else if(CK(t,i))return!0;return!1},listenWcProvider({universalProvider:t,namespace:e,onConnect:n,onDisconnect:r,onAccountsChanged:s,onChainChanged:i,onDisplayUri:o}){n&&t.on("connect",()=>{const a=Os.getWalletConnectAccounts(t,e);n(a)}),r&&t.on("disconnect",()=>{r()}),s&&t.on("accountsChanged",a=>{var c,l,u,d,f;try{const h=((u=(l=(c=t.session)==null?void 0:c.namespaces)==null?void 0:l[e])==null?void 0:u.accounts)||[],p=(f=(d=t.rpcProviders)==null?void 0:d[e])==null?void 0:f.getDefaultChain(),g=a.map(m=>{const E=h.find(_=>_.includes(`${e}:${p}:${m}`));if(!E)return;const{chainId:A,chainNamespace:b}=It.parseCaipAddress(E);return{address:m,chainId:A,chainNamespace:b}}).filter(m=>m!==void 0);g.length>0&&s(g)}catch(h){console.warn("Failed to parse accounts for namespace on accountsChanged event",e,a,h)}}),i&&t.on("chainChanged",a=>{i(a)}),o&&t.on("display_uri",a=>{o(a)})},getWalletConnectAccounts(t,e){var s,i,o,a;const n=new Set,r=(a=(o=(i=(s=t==null?void 0:t.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:a.map(c=>It.parseCaipAddress(c)).filter(({address:c})=>n.has(c.toLowerCase())?!1:(n.add(c.toLowerCase()),!0));return r&&r.length>0?r:[]}},IK=[B.CONNECTOR_ID.AUTH,B.CONNECTOR_ID.WALLET_CONNECT];class nI{constructor(e){this.availableConnectors=[],this.availableConnections=[],this.providerHandlers={},this.eventListeners=new Map,this.getCaipNetworks=n=>I.getCaipNetworks(n),this.getConnectorId=n=>V.getConnectorId(n),e&&this.construct(e)}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get connections(){return this.availableConnections}get networks(){return this.getCaipNetworks(this.namespace)}onAuthConnected({accounts:e,chainId:n}){const r=this.getCaipNetworks().filter(s=>s.chainNamespace===this.namespace).find(s=>s.id.toString()===(n==null?void 0:n.toString()));e&&r&&this.addConnection({connectorId:B.CONNECTOR_ID.AUTH,accounts:e,caipNetwork:r})}setAuthProvider(e){e.onConnect(this.onAuthConnected.bind(this)),e.onSocialConnected(this.onAuthConnected.bind(this)),this.addConnector({id:B.CONNECTOR_ID.AUTH,type:"AUTH",name:B.CONNECTOR_NAMES.AUTH,provider:e,imageId:void 0,chain:this.namespace,chains:[]})}addConnector(...e){const n=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(r=>n.has(r.id)?!1:(n.add(r.id),!0)),this.emit("connectors",this.availableConnectors)}addConnection(...e){const n=new Set;this.availableConnections=[...e,...this.availableConnections].filter(r=>n.has(r.connectorId.toLowerCase())?!1:(n.add(r.connectorId.toLowerCase()),!0)),this.emit("connections",this.availableConnections)}deleteConnection(e){this.availableConnections=this.availableConnections.filter(n=>n.connectorId.toLowerCase()!==e.toLowerCase()),this.emit("connections",this.availableConnections)}clearConnections(e=!1){this.availableConnections=[],e&&this.emit("connections",this.availableConnections)}setStatus(e,n){I.setAccountProp("status",e,n)}on(e,n){var r;this.eventListeners.has(e)||this.eventListeners.set(e,new Set),(r=this.eventListeners.get(e))==null||r.add(n)}off(e,n){const r=this.eventListeners.get(e);r&&r.delete(n)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,n){const r=this.eventListeners.get(e);r&&r.forEach(s=>s(n))}async connectWalletConnect(e){try{return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}catch(n){throw Os.isUserRejectedRequestError(n)?new Zo(n):n}}async switchNetwork(e){var i;const{caipNetwork:n}=e,r=Ye.getProviderId(n.chainNamespace),s=Ye.getProvider(n.chainNamespace);if(!s)throw new Error("Provider not found");if(r==="WALLET_CONNECT"){s.setDefaultChain(n.caipNetworkId);return}if(r==="AUTH"){const o=(i=V.getAuthConnector())==null?void 0:i.provider;if(!o)throw new Error("Auth provider not found");const a=an(n.chainNamespace);await o.switchNetwork({chainId:n.caipNetworkId});const c=await o.getUser({chainId:n.caipNetworkId,preferredAccountType:a});this.emit("switchNetwork",c)}}getWalletConnectConnector(){const e=this.connectors.find(n=>n.id==="walletConnect");if(!e)throw new Error("WalletConnectConnector not found");return e}onConnect(e,n){if(e.length>0){const{address:r,chainId:s}=Q.getAccount(e[0]),i=this.getCaipNetworks().filter(a=>a.chainNamespace===this.namespace).find(a=>a.id.toString()===(s==null?void 0:s.toString())),o=this.connectors.find(a=>a.id===n);r&&(this.emit("accountChanged",{address:r,chainId:s,connector:o}),this.addConnection({connectorId:n,accounts:e.map(a=>{const{address:c}=Q.getAccount(a);return{address:c}}),caipNetwork:i}))}}onAccountsChanged(e,n,r=!0){var s,i;if(e.length>0){const{address:o}=Q.getAccount(e[0]),a=this.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors});o&&((s=this.getConnectorId(B.CHAIN.EVM))==null?void 0:s.toLowerCase())===n.toLowerCase()&&this.emit("accountChanged",{address:o,chainId:(i=a==null?void 0:a.caipNetwork)==null?void 0:i.id,connector:a==null?void 0:a.connector}),this.addConnection({connectorId:n,accounts:e.map(c=>{const{address:l}=Q.getAccount(c);return{address:l}}),caipNetwork:a==null?void 0:a.caipNetwork})}else r&&this.onDisconnect(n)}onDisconnect(e){var n;this.removeProviderListeners(e),this.deleteConnection(e),((n=this.getConnectorId(B.CHAIN.EVM))==null?void 0:n.toLowerCase())===e.toLowerCase()&&this.emitFirstAvailableConnection(),this.connections.length===0&&this.emit("disconnect")}onChainChanged(e,n){var o;const r=typeof e=="string"&&e.startsWith("0x")?parseInt(e,16).toString():e.toString(),s=this.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors}),i=this.getCaipNetworks().filter(a=>a.chainNamespace===this.namespace).find(a=>a.id.toString()===r);s&&this.addConnection({connectorId:n,accounts:s.accounts,caipNetwork:i}),((o=this.getConnectorId(B.CHAIN.EVM))==null?void 0:o.toLowerCase())===n.toLowerCase()&&this.emit("switchNetwork",{chainId:r})}listenProviderEvents(e,n){if(IK.includes(e))return;const r=o=>this.onAccountsChanged(o,e),s=o=>this.onChainChanged(o,e),i=()=>this.onDisconnect(e);this.providerHandlers[e]||(n.on("disconnect",i),n.on("accountsChanged",r),n.on("chainChanged",s),this.providerHandlers[e]={provider:n,disconnect:i,accountsChanged:r,chainChanged:s})}removeProviderListeners(e){if(this.providerHandlers[e]){const{provider:n,disconnect:r,accountsChanged:s,chainChanged:i}=this.providerHandlers[e];n.removeListener("disconnect",r),n.removeListener("accountsChanged",s),n.removeListener("chainChanged",i),this.providerHandlers[e]=null}}emitFirstAvailableConnection(){var n;const e=this.getConnection({connections:this.connections,connectors:this.connectors});if(e){const[r]=e.accounts;this.emit("accountChanged",{address:r==null?void 0:r.address,chainId:(n=e.caipNetwork)==null?void 0:n.id,connector:e.connector})}}getConnection({address:e,connectorId:n,connections:r,connectors:s}){if(n){const o=r.find(l=>l.connectorId.toLowerCase()===n.toLowerCase());if(!o)return null;const a=s.find(l=>l.id.toLowerCase()===o.connectorId.toLowerCase()),c=e?o.accounts.find(l=>l.address.toLowerCase()===e.toLowerCase()):o.accounts[0];return{...o,account:c,connector:a}}const i=r.find(o=>o.accounts.length>0&&s.some(a=>a.id.toLowerCase()===o.connectorId.toLowerCase()));if(i){const[o]=i.accounts,a=s.find(c=>c.id.toLowerCase()===i.connectorId.toLowerCase());return{...i,account:o,connector:a}}return null}}let ji=null;const Fn={getSIWX(){return F.state.siwx},async initializeIfEnabled(t=I.getActiveCaipAddress()){var i,o,a;const e=F.state.siwx;if(!(e&&t))return;const[n,r,s]=t.split(":");if(I.checkIfSupportedNetwork(n,`${n}:${r}`))try{if((i=F.state.remoteFeatures)!=null&&i.emailCapture){const l=(o=I.getAccountData(n))==null?void 0:o.user;await Pe.open({view:"DataCapture",data:{email:(l==null?void 0:l.email)??void 0}});return}if(ji&&await ji,(await e.getSessions(`${n}:${r}`,s)).length)return;await Pe.open({view:"SIWXSignMessage"})}catch(c){console.error("SIWXUtil:initializeIfEnabled",c),ve.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(c)}),await((a=Z._getClient())==null?void 0:a.disconnect().catch(console.error)),me.reset("Connect"),Hr.showError("A problem occurred while trying initialize authentication")}},async isAuthenticated(t=I.getActiveCaipAddress()){if(!F.state.siwx||!t)return!0;const{chainNamespace:n,chainId:r,address:s}=It.parseCaipAddress(t),i=`${n}:${r}`;return(await Fn.getSessions({address:s,caipNetworkId:i})).length>0},async requestSignMessage(){const t=F.state.siwx,e=Q.getPlainAddress(I.getActiveCaipAddress()),n=Cs();if(!t)throw new Error("SIWX is not enabled");if(!e)throw new Error("No ActiveCaipAddress found");if(!n)throw new Error("No ActiveCaipNetwork or client found");try{const r=await t.createMessage({chainId:n.caipNetworkId,accountAddress:e}),s=r.toString();let i="";t.signMessage?i=await t.signMessage({message:s,chainId:n.caipNetworkId,accountAddress:e}):(V.getConnectorId(n.chainNamespace)===B.CONNECTOR_ID.AUTH&&me.pushTransactionStack({}),i=await Z.signMessage(s)||""),await t.addSession({data:r,message:s,signature:i}),I.setLastConnectedSIWECaipNetwork(n),Pe.close(),ve.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(r){(!Pe.state.open||me.state.view==="ApproveTransaction")&&await Pe.open({view:"SIWXSignMessage"}),Hr.showError("Error signing message"),ve.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(r)}),console.error("SWIXUtil:requestSignMessage",r)}},async cancelSignMessage(){var t;try{const e=this.getSIWX();if((t=e==null?void 0:e.getRequired)==null?void 0:t.call(e)){const r=I.getLastConnectedSIWECaipNetwork();if(r){const s=await(e==null?void 0:e.getSessions(r==null?void 0:r.caipNetworkId,Q.getPlainAddress(I.getActiveCaipAddress())||""));s&&s.length>0?await I.switchActiveNetwork(r):await Z.disconnect()}else await Z.disconnect()}else Pe.close();Pe.close(),ve.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(e){console.error("SIWXUtil:cancelSignMessage",e)}},async getAllSessions(){const t=this.getSIWX(),e=I.getAllRequestedCaipNetworks(),n=[];return await Promise.all(e.map(async r=>{const s=await(t==null?void 0:t.getSessions(r.caipNetworkId,Q.getPlainAddress(I.getActiveCaipAddress())||""));s&&n.push(...s)})),n},async getSessions(t){const e=F.state.siwx;let n=t==null?void 0:t.address;if(!n){const s=I.getActiveCaipAddress();n=Q.getPlainAddress(s)}let r=t==null?void 0:t.caipNetworkId;if(!r){const s=I.getActiveCaipNetwork();r=s==null?void 0:s.caipNetworkId}return e&&n&&r?e.getSessions(r,n):[]},async isSIWXCloseDisabled(){var e;const t=this.getSIWX();if(t){const n=me.state.view==="ApproveTransaction",r=me.state.view==="SIWXSignMessage";if(n||r)return((e=t.getRequired)==null?void 0:e.call(t))&&(await this.getSessions()).length===0}return!1},async authConnectorAuthenticate({authConnector:t,chainId:e,socialUri:n,preferredAccountType:r,chainNamespace:s}){var d;const i=Fn.getSIWX(),o=Cs();if(!i||!s.includes(B.CHAIN.EVM)||(d=F.state.remoteFeatures)!=null&&d.emailCapture){const f=await t.connect({chainId:e,socialUri:n,preferredAccountType:r});return{address:f.address,chainId:f.chainId,accounts:f.accounts}}const a=`${s}:${e}`,c=await i.createMessage({chainId:a,accountAddress:"<<AccountAddress>>"}),l={accountAddress:c.accountAddress,chainId:c.chainId,domain:c.domain,uri:c.uri,version:c.version,nonce:c.nonce,notBefore:c.notBefore,statement:c.statement,resources:c.resources,requestId:c.requestId,issuedAt:c.issuedAt,expirationTime:c.expirationTime,serializedMessage:c.toString()},u=await t.connect({chainId:e,socialUri:n,siwxMessage:l,preferredAccountType:r});return l.accountAddress=u.address,l.serializedMessage=u.message||"",u.signature&&u.message&&await Fn.addEmbeddedWalletSession(l,u.message,u.signature),I.setLastConnectedSIWECaipNetwork(o),{address:u.address,chainId:u.chainId,accounts:u.accounts}},async addEmbeddedWalletSession(t,e,n){if(ji)return ji;const r=Fn.getSIWX();return r?(ji=r.addSession({data:t,message:e,signature:n}).finally(()=>{ji=null}),ji):Promise.resolve()},async universalProviderAuthenticate({universalProvider:t,chains:e,methods:n}){var l,u,d;const r=Fn.getSIWX(),s=Cs(),i=new Set(e.map(f=>f.split(":")[0]));if(!r||i.size!==1||!i.has("eip155"))return!1;const o=await r.createMessage({chainId:((l=Cs())==null?void 0:l.caipNetworkId)||"",accountAddress:""}),a=await t.authenticate({nonce:o.nonce,domain:o.domain,uri:o.uri,exp:o.expirationTime,iat:o.issuedAt,nbf:o.notBefore,requestId:o.requestId,version:o.version,resources:o.resources,statement:o.statement,chainId:o.chainId,methods:n,chains:[o.chainId,...e.filter(f=>f!==o.chainId)]});Hr.showLoading("Authenticating...",{autoClose:!1});const c={...a.session.peer.metadata,name:a.session.peer.metadata.name,icon:(u=a.session.peer.metadata.icons)==null?void 0:u[0],type:"WALLET_CONNECT"};if(I.setAccountProp("connectedWalletInfo",c,Array.from(i)[0]),(d=a==null?void 0:a.auths)!=null&&d.length){const f=a.auths.map(h=>{const p=t.client.formatAuthMessage({request:h.p,iss:h.p.iss});return{data:{...h.p,accountAddress:h.p.iss.split(":").slice(-1).join(""),chainId:h.p.iss.split(":").slice(2,4).join(":"),uri:h.p.aud??"",version:h.p.version||o.version,expirationTime:h.p.exp,issuedAt:h.p.iat,notBefore:h.p.nbf},message:p,signature:h.s.s,cacao:h}});try{await r.setSessions(f),s&&I.setLastConnectedSIWECaipNetwork(s),ve.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:Fn.getSIWXEventProperties()})}catch(h){throw console.error("SIWX:universalProviderAuth - failed to set sessions",h),ve.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:Fn.getSIWXEventProperties(h)}),await t.disconnect().catch(console.error),h}finally{Hr.hide()}}return!0},getSIWXEventProperties(t){var n;const e=I.state.activeChain;if(!e)throw new Error("SIWXUtil:getSIWXEventProperties - namespace is required");return{network:((n=I.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)||"",isSmartAccount:an(e)===ft.ACCOUNT_TYPES.SMART_ACCOUNT,message:t?Q.parseError(t):void 0}},async clearSessions(){const t=this.getSIWX();t&&await t.setSessions([])}};class rI{constructor({provider:e,namespace:n}){this.id=B.CONNECTOR_ID.WALLET_CONNECT,this.name="WalletConnect",this.type="WALLET_CONNECT",this.imageId="ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",this.getCaipNetworks=I.getCaipNetworks.bind(I),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=n}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const n=this.getCaipNetworks(),r=F.state.universalProviderConfigOverride,s=Os.createNamespaces(n,r);await this.provider.connect({optionalNamespaces:s})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(n=>n.caipNetworkId);return Fn.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:SK})}}const SK=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],fr=Qe({message:"",variant:"info",open:!1}),xK={state:fr,subscribeKey(t,e){return Dt(fr,t,e)},open(t,e){const{debug:n}=F.state,{code:r,displayMessage:s,debugMessage:i}=t;s&&n&&(fr.message=s,fr.variant=e,fr.open=!0),i&&console.error(typeof i=="function"?i():i,r?{code:r}:void 0)},warn(t,e,n){fr.open=!0,fr.message=t,fr.variant="warning",e&&console.warn(e,n)},close(){fr.open=!1,fr.message="",fr.variant="info"}},ct=ar(xK),NK={eip155:{native:{assetNamespace:"slip44",assetReference:"60"},defaultTokenNamespace:"erc20"},solana:{native:{assetNamespace:"slip44",assetReference:"501"},defaultTokenNamespace:"token"}};class TK extends Error{}function OK(){const{sdkType:t,sdkVersion:e,projectId:n}=F.getSnapshot(),r=new URL("https://rpc.walletconnect.org/v1/json-rpc");return r.searchParams.set("projectId",n),r.searchParams.set("st",t),r.searchParams.set("sv",e),r.searchParams.set("source","fund-wallet"),r.toString()}async function lm(t,e){const n=OK(),{projectId:r}=F.getSnapshot(),s={jsonrpc:"2.0",id:1,method:t,params:{...e||{},projectId:r}},o=await(await fetch(n,{method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}})).json();if(o.error)throw new TK(o.error.message);return o}async function UJ(t){return(await lm("reown_getExchanges",t)).result}async function BJ(t){return(await lm("reown_getExchangePayUrl",t)).result}async function LJ(t){return(await lm("reown_getExchangeBuyStatus",t)).result}function MJ(t,e){const{chainNamespace:n,chainId:r}=It.parseCaipNetworkId(t),s=NK[n];if(!s)throw new Error(`Unsupported chain namespace for CAIP-19 formatting: ${n}`);let i=s.native.assetNamespace,o=s.native.assetReference;return e!=="native"&&(i=s.defaultTokenNamespace,o=e),`${`${n}:${r}`}/${i}:${o}`}const RK={network:"eip155:1",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},PK={network:"eip155:8453",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},sI={network:"eip155:8453",asset:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},kK={asset:"0x036CbD53842c5426634e7929541eC2318f3dCF7e"},DK={network:"eip155:84532",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},$K={network:"eip155:1",asset:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},UK={network:"eip155:42161",asset:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},BK={network:"eip155:137",asset:"0x2791bca1f2de4661ed88a30c99a7a9449aa84174",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},LK={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},MK={network:"eip155:1",asset:"0xdAC17F958D2ee523a2206206994597C13D831ec7",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},FK={network:"eip155:10",asset:"0x94b008aA00579c1307B0EF2c499aD98a8ce58e58",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},jK={network:"eip155:42161",asset:"0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},HK={network:"eip155:137",asset:"0xc2132d05d31c914a87c6611c10748aeb04b58e8f",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},WK={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},zK={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"native",metadata:{name:"Solana",symbol:"SOL",decimals:9}},qK={ethereumETH:RK,baseETH:PK,baseUSDC:sI,baseSepoliaETH:DK,ethereumUSDC:$K,arbitrumUSDC:UK,polygonUSDC:BK,solanaUSDC:LK,ethereumUSDT:MK,optimismUSDT:FK,arbitrumUSDT:jK,polygonUSDT:HK,solanaUSDT:WK,solanaSOL:zK};function FJ(t){return Object.values(qK).filter(e=>e.network===t)}const mr={getConnectorsByType(t,e,n){const{customWallets:r}=F.state,s=W.getRecentWallets(),i=mi.filterOutDuplicateWallets(e),o=mi.filterOutDuplicateWallets(n),a=t.filter(d=>d.type==="MULTI_CHAIN"),c=t.filter(d=>d.type==="ANNOUNCED"),l=t.filter(d=>d.type==="INJECTED"),u=t.filter(d=>d.type==="EXTERNAL");return{custom:r,recent:s,external:u,multiChain:a,announced:c,injected:l,recommended:i,featured:o}},showConnector(t){var s;const e=(s=t.info)==null?void 0:s.rdns,n=!!e&&se.state.excludedWallets.some(i=>!!i.rdns&&i.rdns===e),r=!!t.name&&se.state.excludedWallets.some(i=>aE.isLowerCaseMatch(i.name,t.name));return!(t.type==="INJECTED"&&(t.name==="Browser Wallet"&&(!Q.isMobile()||Q.isMobile()&&!e&&!Z.checkInstalled())||n||r)||(t.type==="ANNOUNCED"||t.type==="EXTERNAL")&&(n||r))},getIsConnectedWithWC(){return Array.from(I.state.chains.values()).some(n=>V.getConnectorId(n.namespace)===B.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:t,featured:e,custom:n,recent:r,announced:s,injected:i,multiChain:o,external:a,overriddenConnectors:c=(l=>(l=F.state.features)==null?void 0:l.connectorTypeOrder)()??[]}){const d=[{type:"walletConnect",isEnabled:!0},{type:"recent",isEnabled:r.length>0},{type:"injected",isEnabled:[...i,...s,...o].length>0},{type:"featured",isEnabled:e.length>0},{type:"custom",isEnabled:n&&n.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:t.length>0}].filter(g=>g.isEnabled),f=new Set(d.map(g=>g.type)),h=c.filter(g=>f.has(g)).map(g=>({type:g,isEnabled:!0})),p=d.filter(({type:g})=>!h.some(({type:E})=>E===g));return Array.from(new Set([...h,...p].map(({type:g})=>g)))},sortConnectorsByExplorerWallet(t){return[...t].sort((e,n)=>e.explorerWallet&&n.explorerWallet?(e.explorerWallet.order??0)-(n.explorerWallet.order??0):e.explorerWallet?-1:n.explorerWallet?1:0)},getAuthName({email:t,socialUsername:e,socialProvider:n}){return e?n&&n==="discord"&&e.endsWith("0")?e.slice(0,-1):e:t.length>30?`${t.slice(0,-3)}...`:t},async fetchProviderData(t){var e,n;try{if(t.name==="Browser Wallet"&&!Q.isMobile())return{accounts:[],chainId:void 0};if(t.id===B.CONNECTOR_ID.AUTH)return{accounts:[],chainId:void 0};const[r,s]=await Promise.all([(e=t.provider)==null?void 0:e.request({method:"eth_accounts"}),(n=t.provider)==null?void 0:n.request({method:"eth_chainId"}).then(i=>Number(i))]);return{accounts:r,chainId:s}}catch(r){return console.warn(`Failed to fetch provider data for ${t.name}`,r),{accounts:[],chainId:void 0}}},getFilteredCustomWallets(t){const e=W.getRecentWallets(),n=V.state.connectors.map(o=>{var a;return(a=o.info)==null?void 0:a.rdns}).filter(Boolean),r=e.map(o=>o.rdns).filter(Boolean),s=n.concat(r);if(s.includes("io.metamask.mobile")&&Q.isMobile()){const o=s.indexOf("io.metamask.mobile");s[o]="io.metamask"}return t.filter(o=>!s.includes(String(o==null?void 0:o.rdns)))},hasWalletConnector(t){return V.state.connectors.some(e=>e.id===t.id||e.name===t.name)},isWalletCompatibleWithCurrentChain(t){const e=I.state.activeChain;return e&&t.chains?t.chains.some(n=>{const r=n.split(":")[0];return e===r}):!0},getFilteredRecentWallets(){return W.getRecentWallets().filter(n=>!mi.isExcluded(n)).filter(n=>!this.hasWalletConnector(n)).filter(n=>this.isWalletCompatibleWithCurrentChain(n))},getCappedRecommendedWallets(t){const{connectors:e}=V.state,{customWallets:n,featuredWalletIds:r}=F.state,s=e.find(A=>A.id==="walletConnect"),i=e.filter(A=>A.type==="INJECTED"||A.type==="ANNOUNCED"||A.type==="MULTI_CHAIN");if(!s&&!i.length&&!(n!=null&&n.length))return[];const o=Up.isEmailEnabled(),a=Up.isSocialsEnabled(),c=i.filter(A=>A.name!=="Browser Wallet"&&A.name!=="WalletConnect"),l=(r==null?void 0:r.length)||0,u=(n==null?void 0:n.length)||0,d=c.length||0,f=o?1:0,h=a?1:0,p=l+u+d+f+h,m=Math.max(0,4-p);return m<=0?[]:mi.filterOutDuplicateWallets(t).slice(0,m)},processConnectorsByType(t,e=!0){const n=mr.sortConnectorsByExplorerWallet([...t]);return e?n.filter(mr.showConnector):n},connectorList(){const t=mr.getConnectorsByType(V.state.connectors,se.state.recommended,se.state.featured),e=this.processConnectorsByType(t.announced.filter(h=>h.id!=="walletConnect")),n=this.processConnectorsByType(t.injected),r=this.processConnectorsByType(t.multiChain.filter(h=>h.name!=="WalletConnect"),!1),s=t.custom,i=t.recent,o=this.processConnectorsByType(t.external.filter(h=>h.id!==B.CONNECTOR_ID.COINBASE_SDK&&h.id!==B.CONNECTOR_ID.BASE_ACCOUNT)),a=t.recommended,c=t.featured,l=mr.getConnectorTypeOrder({custom:s,recent:i,announced:e,injected:n,multiChain:r,recommended:a,featured:c,external:o}),u=V.state.connectors.find(h=>h.id==="walletConnect"),d=Q.isMobile(),f=[];for(const h of l)switch(h){case"walletConnect":{!d&&u&&f.push({kind:"connector",subtype:"walletConnect",connector:u});break}case"recent":{mr.getFilteredRecentWallets().forEach(g=>f.push({kind:"wallet",subtype:"recent",wallet:g}));break}case"injected":{r.forEach(p=>f.push({kind:"connector",subtype:"multiChain",connector:p})),e.forEach(p=>f.push({kind:"connector",subtype:"announced",connector:p})),n.forEach(p=>f.push({kind:"connector",subtype:"injected",connector:p}));break}case"featured":{c.forEach(p=>f.push({kind:"wallet",subtype:"featured",wallet:p}));break}case"custom":{mr.getFilteredCustomWallets(s??[]).forEach(g=>f.push({kind:"wallet",subtype:"custom",wallet:g}));break}case"external":{o.forEach(p=>f.push({kind:"connector",subtype:"external",connector:p}));break}case"recommended":{mr.getCappedRecommendedWallets(a).forEach(g=>f.push({kind:"wallet",subtype:"recommended",wallet:g}));break}default:console.warn(`Unknown connector type: ${h}`)}return f},hasInjectedConnectors(){return V.state.connectors.filter(t=>(t.type==="INJECTED"||t.type==="ANNOUNCED"||t.type==="MULTI_CHAIN")&&t.name!=="Browser Wallet"&&t.name!=="WalletConnect").length}},mi={filterOutDuplicatesByRDNS(t){const e=F.state.enableEIP6963?V.state.connectors:[],n=W.getRecentWallets(),r=e.map(a=>{var c;return(c=a.info)==null?void 0:c.rdns}).filter(Boolean),s=n.map(a=>a.rdns).filter(Boolean),i=r.concat(s);if(i.includes("io.metamask.mobile")&&Q.isMobile()){const a=i.indexOf("io.metamask.mobile");i[a]="io.metamask"}return t.filter(a=>!(a!=null&&a.rdns&&i.includes(String(a.rdns))||!(a!=null&&a.rdns)&&e.some(l=>l.name===a.name)))},filterOutDuplicatesByIds(t){const e=V.state.connectors.filter(a=>a.type==="ANNOUNCED"||a.type==="INJECTED"||a.type==="MULTI_CHAIN"),n=W.getRecentWallets(),r=e.map(a=>{var c;return a.explorerId||((c=a.explorerWallet)==null?void 0:c.id)||a.id}),s=n.map(a=>a.id),i=r.concat(s);return t.filter(a=>!i.includes(a==null?void 0:a.id))},filterOutDuplicateWallets(t){const e=this.filterOutDuplicatesByRDNS(t);return this.filterOutDuplicatesByIds(e)},markWalletsAsInstalled(t){const{connectors:e}=V.state,{featuredWalletIds:n}=F.state,r=e.filter(o=>o.type==="ANNOUNCED").reduce((o,a)=>{var c;return(c=a.info)!=null&&c.rdns&&(o[a.info.rdns]=!0),o},{});return t.map(o=>({...o,installed:!!o.rdns&&!!r[o.rdns??""]})).sort((o,a)=>{const c=Number(a.installed)-Number(o.installed);if(c!==0)return c;if(n!=null&&n.length){const l=n.indexOf(o.id),u=n.indexOf(a.id);if(l!==-1&&u!==-1)return l-u;if(l!==-1)return-1;if(u!==-1)return 1}return 0})},getConnectOrderMethod(t,e){var c;const n=(t==null?void 0:t.connectMethodsOrder)||((c=F.state.features)==null?void 0:c.connectMethodsOrder),r=e||V.state.connectors;if(n)return n;const{injected:s,announced:i}=mr.getConnectorsByType(r,se.state.recommended,se.state.featured),o=s.filter(mr.showConnector),a=i.filter(mr.showConnector);return o.length||a.length?["wallet","email","social"]:Oe.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(t){const e=!!t.rdns&&se.state.excludedWallets.some(r=>r.rdns===t.rdns),n=!!t.name&&se.state.excludedWallets.some(r=>aE.isLowerCaseMatch(r.name,t.name));return e||n},markWalletsWithDisplayIndex(t){return t.map((e,n)=>({...e,display_index:n}))},filterWalletsByWcSupport(t){return Z.state.wcBasic?t.filter(e=>e.supports_wc):Q.isMobile()?t.filter(e=>e.supports_wc||Oe.MANDATORY_WALLET_IDS_ON_MOBILE.includes(e.id)):t},getWalletConnectWallets(t){var i;const e=[...se.state.featured,...se.state.recommended];((i=se.state.filteredWallets)==null?void 0:i.length)>0?e.push(...se.state.filteredWallets):e.push(...t);const n=Q.uniqueBy(e,"id"),r=mi.markWalletsAsInstalled(n),s=mi.filterWalletsByWcSupport(r);return mi.markWalletsWithDisplayIndex(s)}},on={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",OKX_CONNECTOR_NAME:"OKX Wallet",BINANCE_CONNECTOR_NAME:"Binance Wallet",EIP155:B.CHAIN.EVM,ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"AUTH",getSDKVersionWarningMessage(t,e){return`
     @@@@@@@           @@@@@@@@@@@@@@@@@@      
   @@@@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@@@   
  @@@@@@@@@@@@@    @@@@@@@@@@@@@@@@@@@@@@@@@@  
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@  
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@   @@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@   @@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@  @@@@@@@@@@@@@
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@   @@@@@@@@@@@@@    
 @@@@@@   @@@@@@  @@@@@@@@@@@   @@@@@@@@@@@@@@    
 @@@@@@   @@@@@@  @@@@@@@@@@@  @@@@@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@   @@@@@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@  
  @@@@@@@@@@@@@    @@@@@@@@@@@@@@@@@@@@@@@@@@  
   @@@@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@@@   
      @@@@@            @@@@@@@@@@@@@@@@@@  
      
AppKit SDK version ${t} is outdated. Latest version is ${e}. Please update to the latest version for bug fixes and new features.
            
Changelog: https://github.com/reown-com/appkit/releases
NPM Registry: https://www.npmjs.com/package/@reown/appkit`}},VK={NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200","00000008819873e925422c1ff0f99f7c":"b3406e4a-bbfc-44fb-e3a6-89673c78b700","-239":"20f673c0-095e-49b2-07cf-eb5049dcf600","-3":"20f673c0-095e-49b2-07cf-eb5049dcf600"}},As={getCaipTokens(t){if(!t)return;const e={};return Object.entries(t).forEach(([n,r])=>{e[`${on.EIP155}:${n}`]=r}),e},isLowerCaseMatch(t,e){return(t==null?void 0:t.toLowerCase())===(e==null?void 0:e.toLowerCase())},getActiveNamespaceConnectedToAuth(){const t=I.state.activeChain;return B.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(e=>V.getConnectorId(e)===B.CONNECTOR_ID.AUTH&&e===t)},withRetry({conditionFn:t,intervalMs:e,maxRetries:n}){let r=0;return new Promise(s=>{async function i(){return r+=1,await t()?s(!0):r>=n?s(!1):(setTimeout(i,e),null)}i()})},userChainIdToChainNamespace(t){if(typeof t=="number")return B.CHAIN.EVM;const[e]=t.split(":");return e},getOtherAuthNamespaces(t){return t?B.AUTH_CONNECTOR_SUPPORTED_CHAINS.filter(r=>r!==t):[]},getConnectorStorageInfo(t,e){const r=W.getConnections()[e]??[];return{hasDisconnected:W.isConnectorDisconnected(t,e),hasConnected:r.some(s=>As.isLowerCaseMatch(s.connectorId,t))}}},KK=new AbortController,rt={EmbeddedWalletAbortController:KK,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"ORIGIN_NOT_ALLOWED"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{code:"APKT001",displayMessage:"Network Not Found",debugMessage:"The specified network is not recognized. Please ensure it is included in the `networks` array of your `createAppKit` configuration."},ORIGIN_NOT_ALLOWED:{code:"APKT002",displayMessage:"Invalid App Configuration",debugMessage:()=>`The origin ${ac()?window.origin:"unknown"} is not in your allow list. Please update your allowed domains at https://dashboard.reown.com. [PID: ${F.state.projectId}]`},IFRAME_LOAD_FAILED:{code:"APKT003",displayMessage:"Network Error: Wallet Load Failed",debugMessage:()=>"Failed to load the embedded wallet. This may be due to network issues or server downtime. Please check your network connection and try again shortly. Contact support if the issue persists."},IFRAME_REQUEST_TIMEOUT:{code:"APKT004",displayMessage:"Wallet Request Timeout",debugMessage:()=>"The request to the embedded wallet timed out. Please check your network connection and try again shortly. Contact support if the issue persists."},UNVERIFIED_DOMAIN:{code:"APKT005",displayMessage:"Unverified Domain",debugMessage:()=>"Embedded wallet load failed. Ensure your domain is verified in https://dashboard.reown.com."},JWT_TOKEN_NOT_VALID:{code:"APKT006",displayMessage:"Session Expired",debugMessage:"Your session is invalid or expired. Please check your systemâ€™s date and time settings, then reconnect."},INVALID_PROJECT_ID:{code:"APKT007",displayMessage:"Invalid Project ID",debugMessage:"The specified project ID is invalid. Please visit https://dashboard.reown.com to obtain a valid project ID."},PROJECT_ID_NOT_CONFIGURED:{code:"APKT008",displayMessage:"Project ID Missing",debugMessage:"No project ID is configured. You can create and configure a project ID at https://dashboard.reown.com."},SERVER_ERROR_APP_CONFIGURATION:{code:"APKT009",displayMessage:"Server Error",debugMessage:t=>`Unable to fetch App Configuration. ${t}. Please check your network connection and try again shortly. Contact support if the issue persists.`},RATE_LIMITED_APP_CONFIGURATION:{code:"APKT010",displayMessage:"Rate Limited",debugMessage:"You have been rate limited while retrieving App Configuration. Please wait a few minutes and try again. Contact support if the issue persists."}},ALERT_WARNINGS:{LOCAL_CONFIGURATION_IGNORED:{debugMessage:t=>`[Reown Config Notice] ${t}`},INACTIVE_NAMESPACE_NOT_CONNECTED:{code:"APKTW001",displayMessage:"Inactive Namespace Not Connected",debugMessage:(t,e)=>`An error occurred while connecting an inactive namespace ${t}: "${e}"`},INVALID_EMAIL:{code:"APKTW002",displayMessage:"Invalid Email Address",debugMessage:"Please enter a valid email address"}}},iI={TOKEN_ADDRESSES_BY_SYMBOL:{USDC:{8453:sI.asset,84532:kK.asset}},getTokenSymbolByAddress(t){if(!t)return;const[e]=Object.entries(iI.TOKEN_ADDRESSES_BY_SYMBOL).find(([n,r])=>Object.values(r).includes(t))??[];return e}},GK={createLogger(t,e="error"){const n=K0({level:e}),{logger:r}=Gd({opts:n});return r.error=(...s)=>{for(const i of s)if(i instanceof Error){t(i,...s);return}t(void 0,...s)},r}},YK="rpc.walletconnect.org";function L1(t,e){const n=new URL("https://rpc.walletconnect.org/v1/");return n.searchParams.set("chainId",t),n.searchParams.set("projectId",e),n.toString()}const np=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","eip155:80094","eip155:80069","eip155:560048","eip155:31","eip155:2818","eip155:57054","eip155:911867","eip155:534351","eip155:1112","eip155:534352","eip155:1111","eip155:146","eip155:130","eip155:1284","eip155:30","eip155:2810","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],jr={extendRpcUrlWithProjectId(t,e){let n=!1;try{n=new URL(t).host===YK}catch{n=!1}if(n){const r=new URL(t);return r.searchParams.has("projectId")||r.searchParams.set("projectId",e),r.toString()}return t},isCaipNetwork(t){return"chainNamespace"in t&&"caipNetworkId"in t},getChainNamespace(t){return this.isCaipNetwork(t)?t.chainNamespace:B.CHAIN.EVM},getCaipNetworkId(t){return this.isCaipNetwork(t)?t.caipNetworkId:`${B.CHAIN.EVM}:${t.id}`},getDefaultRpcUrl(t,e,n){var s,i,o;const r=(o=(i=(s=t.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null?void 0:o[0];return np.includes(e)?L1(e,n):r||""},extendCaipNetwork(t,{customNetworkImageUrls:e,projectId:n,customRpcUrls:r}){var f,h,p,g,m,E,A;const s=this.getChainNamespace(t),i=this.getCaipNetworkId(t),o=(p=(h=(f=t.rpcUrls)==null?void 0:f.default)==null?void 0:h.http)==null?void 0:p[0],a=this.getDefaultRpcUrl(t,i,n),c=((E=(m=(g=t==null?void 0:t.rpcUrls)==null?void 0:g.chainDefault)==null?void 0:m.http)==null?void 0:E[0])||o,l=((A=r==null?void 0:r[i])==null?void 0:A.map(b=>b.url))||[],u=[...l,...a?[a]:[]],d=[...l];return c&&!d.includes(c)&&d.push(c),{...t,chainNamespace:s,caipNetworkId:i,assets:{imageId:VK.NetworkImageIds[t.id],imageUrl:e==null?void 0:e[t.id]},rpcUrls:{...t.rpcUrls,default:{http:u},chainDefault:{http:d}}}},extendCaipNetworks(t,{customNetworkImageUrls:e,projectId:n,customRpcUrls:r}){return t.map(s=>jr.extendCaipNetwork(s,{customNetworkImageUrls:e,customRpcUrls:r,projectId:n}))},getViemTransport(t,e,n){var s,i,o;const r=[];return n==null||n.forEach(a=>{r.push(iu(a.url,a.config))}),np.includes(t.caipNetworkId)&&r.push(iu(L1(t.caipNetworkId,e),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),(o=(i=(s=t==null?void 0:t.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null||o.forEach(a=>{r.push(iu(a))}),by(r)},extendWagmiTransports(t,e,n){if(np.includes(t.caipNetworkId)){const r=this.getDefaultRpcUrl(t,t.caipNetworkId,e);return by([n,iu(r)])}return n},getUnsupportedNetwork(t){return{id:t.split(":")[1],caipNetworkId:t,name:B.UNSUPPORTED_NETWORK_NAME,chainNamespace:t.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(t){var c;const e=W.getActiveCaipNetworkId(),n=I.getAllRequestedCaipNetworks(),r=Array.from(((c=I.state.chains)==null?void 0:c.keys())||[]),s=e==null?void 0:e.split(":")[0],i=s?r.includes(s):!1,o=n==null?void 0:n.find(l=>l.caipNetworkId===e);return i&&!o&&e?this.getUnsupportedNetwork(e):o||t||(n==null?void 0:n[0])}};class ao{constructor(){}static getInstance({projectId:e,chainId:n,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a}){var d;const{metadata:c,sdkVersion:l,sdkType:u}=F.getSnapshot();return ao.instance||(ao.instance=new hx({projectId:e,chainId:n,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a,enableCloudAuthAccount:!!((d=F.state.remoteFeatures)!=null&&d.emailCapture),metadata:c,sdkVersion:l,sdkType:u})),ao.instance}}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Gu=globalThis,um=Gu.ShadowRoot&&(Gu.ShadyCSS===void 0||Gu.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,dm=Symbol(),M1=new WeakMap;let oI=class{constructor(e,n,r){if(this._$cssResult$=!0,r!==dm)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=n}get styleSheet(){let e=this.o;const n=this.t;if(um&&e===void 0){const r=n!==void 0&&n.length===1;r&&(e=M1.get(n)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&M1.set(n,e))}return e}toString(){return this.cssText}};const gr=t=>new oI(typeof t=="string"?t:t+"",void 0,dm),fi=(t,...e)=>{const n=t.length===1?t[0]:e.reduce((r,s,i)=>r+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[i+1],t[0]);return new oI(n,t,dm)},ZK=(t,e)=>{if(um)t.adoptedStyleSheets=e.map(n=>n instanceof CSSStyleSheet?n:n.styleSheet);else for(const n of e){const r=document.createElement("style"),s=Gu.litNonce;s!==void 0&&r.setAttribute("nonce",s),r.textContent=n.cssText,t.appendChild(r)}},F1=um?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let n="";for(const r of e.cssRules)n+=r.cssText;return gr(n)})(t):t;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:JK,defineProperty:XK,getOwnPropertyDescriptor:QK,getOwnPropertyNames:eG,getOwnPropertySymbols:tG,getPrototypeOf:nG}=Object,Ei=globalThis,j1=Ei.trustedTypes,rG=j1?j1.emptyScript:"",rp=Ei.reactiveElementPolyfillSupport,Cc=(t,e)=>t,L0={toAttribute(t,e){switch(e){case Boolean:t=t?rG:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=t!==null;break;case Number:n=t===null?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch{n=null}}return n}},aI=(t,e)=>!JK(t,e),H1={attribute:!0,type:String,converter:L0,reflect:!1,useDefault:!1,hasChanged:aI};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),Ei.litPropertyMetadata??(Ei.litPropertyMetadata=new WeakMap);let Yo=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,n=H1){if(n.state&&(n.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((n=Object.create(n)).wrapped=!0),this.elementProperties.set(e,n),!n.noAccessor){const r=Symbol(),s=this.getPropertyDescriptor(e,r,n);s!==void 0&&XK(this.prototype,e,s)}}static getPropertyDescriptor(e,n,r){const{get:s,set:i}=QK(this.prototype,e)??{get(){return this[n]},set(o){this[n]=o}};return{get:s,set(o){const a=s==null?void 0:s.call(this);i==null||i.call(this,o),this.requestUpdate(e,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??H1}static _$Ei(){if(this.hasOwnProperty(Cc("elementProperties")))return;const e=nG(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Cc("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Cc("properties"))){const n=this.properties,r=[...eG(n),...tG(n)];for(const s of r)this.createProperty(s,n[s])}const e=this[Symbol.metadata];if(e!==null){const n=litPropertyMetadata.get(e);if(n!==void 0)for(const[r,s]of n)this.elementProperties.set(r,s)}this._$Eh=new Map;for(const[n,r]of this.elementProperties){const s=this._$Eu(n,r);s!==void 0&&this._$Eh.set(s,n)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const n=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const s of r)n.unshift(F1(s))}else e!==void 0&&n.push(F1(e));return n}static _$Eu(e,n){const r=n.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(n=>this.enableUpdating=n),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(n=>n(this))}addController(e){var n;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((n=e.hostConnected)==null||n.call(e))}removeController(e){var n;(n=this._$EO)==null||n.delete(e)}_$E_(){const e=new Map,n=this.constructor.elementProperties;for(const r of n.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return ZK(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(n=>{var r;return(r=n.hostConnected)==null?void 0:r.call(n)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(n=>{var r;return(r=n.hostDisconnected)==null?void 0:r.call(n)})}attributeChangedCallback(e,n,r){this._$AK(e,r)}_$ET(e,n){var i;const r=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,r);if(s!==void 0&&r.reflect===!0){const o=(((i=r.converter)==null?void 0:i.toAttribute)!==void 0?r.converter:L0).toAttribute(n,r.type);this._$Em=e,o==null?this.removeAttribute(s):this.setAttribute(s,o),this._$Em=null}}_$AK(e,n){var i,o;const r=this.constructor,s=r._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const a=r.getPropertyOptions(s),c=typeof a.converter=="function"?{fromAttribute:a.converter}:((i=a.converter)==null?void 0:i.fromAttribute)!==void 0?a.converter:L0;this._$Em=s;const l=c.fromAttribute(n,a.type);this[s]=l??((o=this._$Ej)==null?void 0:o.get(s))??l,this._$Em=null}}requestUpdate(e,n,r,s=!1,i){var o;if(e!==void 0){const a=this.constructor;if(s===!1&&(i=this[e]),r??(r=a.getPropertyOptions(e)),!((r.hasChanged??aI)(i,n)||r.useDefault&&r.reflect&&i===((o=this._$Ej)==null?void 0:o.get(e))&&!this.hasAttribute(a._$Eu(e,r))))return;this.C(e,n,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,n,{useDefault:r,reflect:s,wrapped:i},o){r&&!(this._$Ej??(this._$Ej=new Map)).has(e)&&(this._$Ej.set(e,o??n??this[e]),i!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||r||(n=void 0),this._$AL.set(e,n)),s===!0&&this._$Em!==e&&(this._$Eq??(this._$Eq=new Set)).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(n){Promise.reject(n)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var r;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[i,o]of this._$Ep)this[i]=o;this._$Ep=void 0}const s=this.constructor.elementProperties;if(s.size>0)for(const[i,o]of s){const{wrapped:a}=o,c=this[i];a!==!0||this._$AL.has(i)||c===void 0||this.C(i,void 0,o,c)}}let e=!1;const n=this._$AL;try{e=this.shouldUpdate(n),e?(this.willUpdate(n),(r=this._$EO)==null||r.forEach(s=>{var i;return(i=s.hostUpdate)==null?void 0:i.call(s)}),this.update(n)):this._$EM()}catch(s){throw e=!1,this._$EM(),s}e&&this._$AE(n)}willUpdate(e){}_$AE(e){var n;(n=this._$EO)==null||n.forEach(r=>{var s;return(s=r.hostUpdated)==null?void 0:s.call(r)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&(this._$Eq=this._$Eq.forEach(n=>this._$ET(n,this[n]))),this._$EM()}updated(e){}firstUpdated(e){}};Yo.elementStyles=[],Yo.shadowRootOptions={mode:"open"},Yo[Cc("elementProperties")]=new Map,Yo[Cc("finalized")]=new Map,rp==null||rp({ReactiveElement:Yo}),(Ei.reactiveElementVersions??(Ei.reactiveElementVersions=[])).push("2.1.2");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const _c=globalThis,W1=t=>t,Bd=_c.trustedTypes,z1=Bd?Bd.createPolicy("lit-html",{createHTML:t=>t}):void 0,cI="$lit$",hi=`lit$${Math.random().toFixed(9).slice(2)}$`,lI="?"+hi,sG=`<${lI}>`,Ao=document,ml=()=>Ao.createComment(""),yl=t=>t===null||typeof t!="object"&&typeof t!="function",fm=Array.isArray,iG=t=>fm(t)||typeof(t==null?void 0:t[Symbol.iterator])=="function",sp=`[ 	
\f\r]`,sc=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,q1=/-->/g,V1=/>/g,Hi=RegExp(`>|${sp}(?:([^\\s"'>=/]+)(${sp}*=${sp}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),K1=/'/g,G1=/"/g,uI=/^(?:script|style|textarea|title)$/i,dI=t=>(e,...n)=>({_$litType$:t,strings:e,values:n}),WJ=dI(1),zJ=dI(2),xa=Symbol.for("lit-noChange"),Pt=Symbol.for("lit-nothing"),Y1=new WeakMap,ro=Ao.createTreeWalker(Ao,129);function fI(t,e){if(!fm(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return z1!==void 0?z1.createHTML(e):e}const oG=(t,e)=>{const n=t.length-1,r=[];let s,i=e===2?"<svg>":e===3?"<math>":"",o=sc;for(let a=0;a<n;a++){const c=t[a];let l,u,d=-1,f=0;for(;f<c.length&&(o.lastIndex=f,u=o.exec(c),u!==null);)f=o.lastIndex,o===sc?u[1]==="!--"?o=q1:u[1]!==void 0?o=V1:u[2]!==void 0?(uI.test(u[2])&&(s=RegExp("</"+u[2],"g")),o=Hi):u[3]!==void 0&&(o=Hi):o===Hi?u[0]===">"?(o=s??sc,d=-1):u[1]===void 0?d=-2:(d=o.lastIndex-u[2].length,l=u[1],o=u[3]===void 0?Hi:u[3]==='"'?G1:K1):o===G1||o===K1?o=Hi:o===q1||o===V1?o=sc:(o=Hi,s=void 0);const h=o===Hi&&t[a+1].startsWith("/>")?" ":"";i+=o===sc?c+sG:d>=0?(r.push(l),c.slice(0,d)+cI+c.slice(d)+hi+h):c+hi+(d===-2?a:h)}return[fI(t,i+(t[n]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),r]};class bl{constructor({strings:e,_$litType$:n},r){let s;this.parts=[];let i=0,o=0;const a=e.length-1,c=this.parts,[l,u]=oG(e,n);if(this.el=bl.createElement(l,r),ro.currentNode=this.el.content,n===2||n===3){const d=this.el.content.firstChild;d.replaceWith(...d.childNodes)}for(;(s=ro.nextNode())!==null&&c.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const d of s.getAttributeNames())if(d.endsWith(cI)){const f=u[o++],h=s.getAttribute(d).split(hi),p=/([.?@])?(.*)/.exec(f);c.push({type:1,index:i,name:p[2],strings:h,ctor:p[1]==="."?cG:p[1]==="?"?lG:p[1]==="@"?uG:Of}),s.removeAttribute(d)}else d.startsWith(hi)&&(c.push({type:6,index:i}),s.removeAttribute(d));if(uI.test(s.tagName)){const d=s.textContent.split(hi),f=d.length-1;if(f>0){s.textContent=Bd?Bd.emptyScript:"";for(let h=0;h<f;h++)s.append(d[h],ml()),ro.nextNode(),c.push({type:2,index:++i});s.append(d[f],ml())}}}else if(s.nodeType===8)if(s.data===lI)c.push({type:2,index:i});else{let d=-1;for(;(d=s.data.indexOf(hi,d+1))!==-1;)c.push({type:7,index:i}),d+=hi.length-1}i++}}static createElement(e,n){const r=Ao.createElement("template");return r.innerHTML=e,r}}function Na(t,e,n=t,r){var o,a;if(e===xa)return e;let s=r!==void 0?(o=n._$Co)==null?void 0:o[r]:n._$Cl;const i=yl(e)?void 0:e._$litDirective$;return(s==null?void 0:s.constructor)!==i&&((a=s==null?void 0:s._$AO)==null||a.call(s,!1),i===void 0?s=void 0:(s=new i(t),s._$AT(t,n,r)),r!==void 0?(n._$Co??(n._$Co=[]))[r]=s:n._$Cl=s),s!==void 0&&(e=Na(t,s._$AS(t,e.values),s,r)),e}class aG{constructor(e,n){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:n},parts:r}=this._$AD,s=((e==null?void 0:e.creationScope)??Ao).importNode(n,!0);ro.currentNode=s;let i=ro.nextNode(),o=0,a=0,c=r[0];for(;c!==void 0;){if(o===c.index){let l;c.type===2?l=new Vl(i,i.nextSibling,this,e):c.type===1?l=new c.ctor(i,c.name,c.strings,this,e):c.type===6&&(l=new dG(i,this,e)),this._$AV.push(l),c=r[++a]}o!==(c==null?void 0:c.index)&&(i=ro.nextNode(),o++)}return ro.currentNode=Ao,s}p(e){let n=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,n),n+=r.strings.length-2):r._$AI(e[n])),n++}}class Vl{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,n,r,s){this.type=2,this._$AH=Pt,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=r,this.options=s,this._$Cv=(s==null?void 0:s.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=n.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,n=this){e=Na(this,e,n),yl(e)?e===Pt||e==null||e===""?(this._$AH!==Pt&&this._$AR(),this._$AH=Pt):e!==this._$AH&&e!==xa&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):iG(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==Pt&&yl(this._$AH)?this._$AA.nextSibling.data=e:this.T(Ao.createTextNode(e)),this._$AH=e}$(e){var i;const{values:n,_$litType$:r}=e,s=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=bl.createElement(fI(r.h,r.h[0]),this.options)),r);if(((i=this._$AH)==null?void 0:i._$AD)===s)this._$AH.p(n);else{const o=new aG(s,this),a=o.u(this.options);o.p(n),this.T(a),this._$AH=o}}_$AC(e){let n=Y1.get(e.strings);return n===void 0&&Y1.set(e.strings,n=new bl(e)),n}k(e){fm(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let r,s=0;for(const i of e)s===n.length?n.push(r=new Vl(this.O(ml()),this.O(ml()),this,this.options)):r=n[s],r._$AI(i),s++;s<n.length&&(this._$AR(r&&r._$AB.nextSibling,s),n.length=s)}_$AR(e=this._$AA.nextSibling,n){var r;for((r=this._$AP)==null?void 0:r.call(this,!1,!0,n);e!==this._$AB;){const s=W1(e).nextSibling;W1(e).remove(),e=s}}setConnected(e){var n;this._$AM===void 0&&(this._$Cv=e,(n=this._$AP)==null||n.call(this,e))}}class Of{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,n,r,s,i){this.type=1,this._$AH=Pt,this._$AN=void 0,this.element=e,this.name=n,this._$AM=s,this.options=i,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=Pt}_$AI(e,n=this,r,s){const i=this.strings;let o=!1;if(i===void 0)e=Na(this,e,n,0),o=!yl(e)||e!==this._$AH&&e!==xa,o&&(this._$AH=e);else{const a=e;let c,l;for(e=i[0],c=0;c<i.length-1;c++)l=Na(this,a[r+c],n,c),l===xa&&(l=this._$AH[c]),o||(o=!yl(l)||l!==this._$AH[c]),l===Pt?e=Pt:e!==Pt&&(e+=(l??"")+i[c+1]),this._$AH[c]=l}o&&!s&&this.j(e)}j(e){e===Pt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class cG extends Of{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===Pt?void 0:e}}class lG extends Of{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==Pt)}}class uG extends Of{constructor(e,n,r,s,i){super(e,n,r,s,i),this.type=5}_$AI(e,n=this){if((e=Na(this,e,n,0)??Pt)===xa)return;const r=this._$AH,s=e===Pt&&r!==Pt||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,i=e!==Pt&&(r===Pt||s);s&&this.element.removeEventListener(this.name,this,r),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var n;typeof this._$AH=="function"?this._$AH.call(((n=this.options)==null?void 0:n.host)??this.element,e):this._$AH.handleEvent(e)}}class dG{constructor(e,n,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){Na(this,e)}}const ip=_c.litHtmlPolyfillSupport;ip==null||ip(bl,Vl),(_c.litHtmlVersions??(_c.litHtmlVersions=[])).push("3.3.2");const fG=(t,e,n)=>{const r=(n==null?void 0:n.renderBefore)??e;let s=r._$litPart$;if(s===void 0){const i=(n==null?void 0:n.renderBefore)??null;r._$litPart$=s=new Vl(e.insertBefore(ml(),i),i,void 0,n??{})}return s._$AI(t),s};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const co=globalThis;class Yu extends Yo{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var n;const e=super.createRenderRoot();return(n=this.renderOptions).renderBefore??(n.renderBefore=e.firstChild),e}update(e){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=fG(n,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return xa}}var iE;Yu._$litElement$=!0,Yu.finalized=!0,(iE=co.litElementHydrateSupport)==null||iE.call(co,{LitElement:Yu});const op=co.litElementPolyfillSupport;op==null||op({LitElement:Yu});(co.litElementVersions??(co.litElementVersions=[])).push("4.2.2");const hG={black:"#202020",white:"#FFFFFF",white010:"rgba(255, 255, 255, 0.1)",accent010:"rgba(9, 136, 240, 0.1)",accent020:"rgba(9, 136, 240, 0.2)",accent030:"rgba(9, 136, 240, 0.3)",accent040:"rgba(9, 136, 240, 0.4)",accent050:"rgba(9, 136, 240, 0.5)",accent060:"rgba(9, 136, 240, 0.6)",accent070:"rgba(9, 136, 240, 0.7)",accent080:"rgba(9, 136, 240, 0.8)",accent090:"rgba(9, 136, 240, 0.9)",accent100:"rgba(9, 136, 240, 1.0)",accentSecondary010:"rgba(199, 185, 148, 0.1)",accentSecondary020:"rgba(199, 185, 148, 0.2)",accentSecondary030:"rgba(199, 185, 148, 0.3)",accentSecondary040:"rgba(199, 185, 148, 0.4)",accentSecondary050:"rgba(199, 185, 148, 0.5)",accentSecondary060:"rgba(199, 185, 148, 0.6)",accentSecondary070:"rgba(199, 185, 148, 0.7)",accentSecondary080:"rgba(199, 185, 148, 0.8)",accentSecondary090:"rgba(199, 185, 148, 0.9)",accentSecondary100:"rgba(199, 185, 148, 1.0)",productWalletKit:"#FFB800",productAppKit:"#FF573B",productCloud:"#0988F0",productDocumentation:"#008847",neutrals050:"#F6F6F6",neutrals100:"#F3F3F3",neutrals200:"#E9E9E9",neutrals300:"#D0D0D0",neutrals400:"#BBB",neutrals500:"#9A9A9A",neutrals600:"#6C6C6C",neutrals700:"#4F4F4F",neutrals800:"#363636",neutrals900:"#2A2A2A",neutrals1000:"#252525",semanticSuccess010:"rgba(48, 164, 107, 0.1)",semanticSuccess020:"rgba(48, 164, 107, 0.2)",semanticSuccess030:"rgba(48, 164, 107, 0.3)",semanticSuccess040:"rgba(48, 164, 107, 0.4)",semanticSuccess050:"rgba(48, 164, 107, 0.5)",semanticSuccess060:"rgba(48, 164, 107, 0.6)",semanticSuccess070:"rgba(48, 164, 107, 0.7)",semanticSuccess080:"rgba(48, 164, 107, 0.8)",semanticSuccess090:"rgba(48, 164, 107, 0.9)",semanticSuccess100:"rgba(48, 164, 107, 1.0)",semanticError010:"rgba(223, 74, 52, 0.1)",semanticError020:"rgba(223, 74, 52, 0.2)",semanticError030:"rgba(223, 74, 52, 0.3)",semanticError040:"rgba(223, 74, 52, 0.4)",semanticError050:"rgba(223, 74, 52, 0.5)",semanticError060:"rgba(223, 74, 52, 0.6)",semanticError070:"rgba(223, 74, 52, 0.7)",semanticError080:"rgba(223, 74, 52, 0.8)",semanticError090:"rgba(223, 74, 52, 0.9)",semanticError100:"rgba(223, 74, 52, 1.0)",semanticWarning010:"rgba(243, 161, 63, 0.1)",semanticWarning020:"rgba(243, 161, 63, 0.2)",semanticWarning030:"rgba(243, 161, 63, 0.3)",semanticWarning040:"rgba(243, 161, 63, 0.4)",semanticWarning050:"rgba(243, 161, 63, 0.5)",semanticWarning060:"rgba(243, 161, 63, 0.6)",semanticWarning070:"rgba(243, 161, 63, 0.7)",semanticWarning080:"rgba(243, 161, 63, 0.8)",semanticWarning090:"rgba(243, 161, 63, 0.9)",semanticWarning100:"rgba(243, 161, 63, 1.0)"},Ld={core:{backgroundAccentPrimary:"#0988F0",backgroundAccentCertified:"#C7B994",backgroundWalletKit:"#FFB800",backgroundAppKit:"#FF573B",backgroundCloud:"#0988F0",backgroundDocumentation:"#008847",backgroundSuccess:"rgba(48, 164, 107, 0.20)",backgroundError:"rgba(223, 74, 52, 0.20)",backgroundWarning:"rgba(243, 161, 63, 0.20)",textAccentPrimary:"#0988F0",textAccentCertified:"#C7B994",textWalletKit:"#FFB800",textAppKit:"#FF573B",textCloud:"#0988F0",textDocumentation:"#008847",textSuccess:"#30A46B",textError:"#DF4A34",textWarning:"#F3A13F",borderAccentPrimary:"#0988F0",borderSecondary:"#C7B994",borderSuccess:"#30A46B",borderError:"#DF4A34",borderWarning:"#F3A13F",foregroundAccent010:"rgba(9, 136, 240, 0.1)",foregroundAccent020:"rgba(9, 136, 240, 0.2)",foregroundAccent040:"rgba(9, 136, 240, 0.4)",foregroundAccent060:"rgba(9, 136, 240, 0.6)",foregroundSecondary020:"rgba(199, 185, 148, 0.2)",foregroundSecondary040:"rgba(199, 185, 148, 0.4)",foregroundSecondary060:"rgba(199, 185, 148, 0.6)",iconAccentPrimary:"#0988F0",iconAccentCertified:"#C7B994",iconSuccess:"#30A46B",iconError:"#DF4A34",iconWarning:"#F3A13F",glass010:"rgba(255, 255, 255, 0.1)",zIndex:"9999"},dark:{overlay:"rgba(0, 0, 0, 0.50)",backgroundPrimary:"#202020",backgroundInvert:"#FFFFFF",textPrimary:"#FFFFFF",textSecondary:"#9A9A9A",textTertiary:"#BBBBBB",textInvert:"#202020",borderPrimary:"#2A2A2A",borderPrimaryDark:"#363636",borderSecondary:"#4F4F4F",foregroundPrimary:"#252525",foregroundSecondary:"#2A2A2A",foregroundTertiary:"#363636",iconDefault:"#9A9A9A",iconInverse:"#FFFFFF"},light:{overlay:"rgba(230 , 230, 230, 0.5)",backgroundPrimary:"#FFFFFF",borderPrimaryDark:"#E9E9E9",backgroundInvert:"#202020",textPrimary:"#202020",textSecondary:"#9A9A9A",textTertiary:"#6C6C6C",textInvert:"#FFFFFF",borderPrimary:"#E9E9E9",borderSecondary:"#D0D0D0",foregroundPrimary:"#F3F3F3",foregroundSecondary:"#E9E9E9",foregroundTertiary:"#D0D0D0",iconDefault:"#9A9A9A",iconInverse:"#202020"}},pG={1:"4px",2:"8px",10:"10px",3:"12px",4:"16px",6:"24px",5:"20px",8:"32px",16:"64px",20:"80px",32:"128px",64:"256px",128:"512px",round:"9999px"},gG={0:"0px","01":"2px",1:"4px",2:"8px",3:"12px",4:"16px",5:"20px",6:"24px",7:"28px",8:"32px",9:"36px",10:"40px",12:"48px",14:"56px",16:"64px",20:"80px",32:"128px",64:"256px"},mG={regular:"KHTeka",mono:"KHTekaMono"},yG={regular:"400",medium:"500"},bG={h1:"50px",h2:"44px",h3:"38px",h4:"32px",h5:"26px",h6:"20px",large:"16px",medium:"14px",small:"12px"},wG={"h1-regular-mono":{lineHeight:"50px",letterSpacing:"-3px"},"h1-regular":{lineHeight:"50px",letterSpacing:"-1px"},"h1-medium":{lineHeight:"50px",letterSpacing:"-0.84px"},"h2-regular-mono":{lineHeight:"44px",letterSpacing:"-2.64px"},"h2-regular":{lineHeight:"44px",letterSpacing:"-0.88px"},"h2-medium":{lineHeight:"44px",letterSpacing:"-0.88px"},"h3-regular-mono":{lineHeight:"38px",letterSpacing:"-2.28px"},"h3-regular":{lineHeight:"38px",letterSpacing:"-0.76px"},"h3-medium":{lineHeight:"38px",letterSpacing:"-0.76px"},"h4-regular-mono":{lineHeight:"32px",letterSpacing:"-1.92px"},"h4-regular":{lineHeight:"32px",letterSpacing:"-0.32px"},"h4-medium":{lineHeight:"32px",letterSpacing:"-0.32px"},"h5-regular-mono":{lineHeight:"26px",letterSpacing:"-1.56px"},"h5-regular":{lineHeight:"26px",letterSpacing:"-0.26px"},"h5-medium":{lineHeight:"26px",letterSpacing:"-0.26px"},"h6-regular-mono":{lineHeight:"20px",letterSpacing:"-1.2px"},"h6-regular":{lineHeight:"20px",letterSpacing:"-0.6px"},"h6-medium":{lineHeight:"20px",letterSpacing:"-0.6px"},"lg-regular-mono":{lineHeight:"16px",letterSpacing:"-0.96px"},"lg-regular":{lineHeight:"18px",letterSpacing:"-0.16px"},"lg-medium":{lineHeight:"18px",letterSpacing:"-0.16px"},"md-regular-mono":{lineHeight:"14px",letterSpacing:"-0.84px"},"md-regular":{lineHeight:"16px",letterSpacing:"-0.14px"},"md-medium":{lineHeight:"16px",letterSpacing:"-0.14px"},"sm-regular-mono":{lineHeight:"12px",letterSpacing:"-0.72px"},"sm-regular":{lineHeight:"14px",letterSpacing:"-0.12px"},"sm-medium":{lineHeight:"14px",letterSpacing:"-0.12px"}},EG={"ease-out-power-2":"cubic-bezier(0.23, 0.09, 0.08, 1.13)","ease-out-power-1":"cubic-bezier(0.12, 0.04, 0.2, 1.06)","ease-in-power-2":"cubic-bezier(0.92, -0.13, 0.77, 0.91)","ease-in-power-1":"cubic-bezier(0.88, -0.06, 0.8, 0.96)","ease-inout-power-2":"cubic-bezier(0.77, 0.09, 0.23, 1.13)","ease-inout-power-1":"cubic-bezier(0.88, 0.04, 0.12, 1.06)"},vG={xl:"400ms",lg:"200ms",md:"125ms",sm:"75ms"},M0={colors:hG,fontFamily:mG,fontWeight:yG,textSize:bG,typography:wG,tokens:{core:Ld.core,theme:Ld.dark},borderRadius:pG,spacing:gG,durations:vG,easings:EG},Z1="--apkt";function Tu(t){if(!t)return{};const e={};return e["font-family"]=t["--apkt-font-family"]??t["--w3m-font-family"]??"KHTeka",e.accent=t["--apkt-accent"]??t["--w3m-accent"]??"#0988F0",e["color-mix"]=t["--apkt-color-mix"]??t["--w3m-color-mix"]??"#000",e["color-mix-strength"]=t["--apkt-color-mix-strength"]??t["--w3m-color-mix-strength"]??0,e["font-size-master"]=t["--apkt-font-size-master"]??t["--w3m-font-size-master"]??"10px",e["border-radius-master"]=t["--apkt-border-radius-master"]??t["--w3m-border-radius-master"]??"4px",t["--apkt-z-index"]!==void 0?e["z-index"]=t["--apkt-z-index"]:t["--w3m-z-index"]!==void 0&&(e["z-index"]=t["--w3m-z-index"]),e}const ys={createCSSVariables(t){const e={},n={};function r(i,o,a=""){for(const[c,l]of Object.entries(i)){const u=a?`${a}-${c}`:c;l&&typeof l=="object"&&Object.keys(l).length?(o[c]={},r(l,o[c],u)):typeof l=="string"&&(o[c]=`${Z1}-${u}`)}}function s(i,o){for(const[a,c]of Object.entries(i))c&&typeof c=="object"?(o[a]={},s(c,o[a])):typeof c=="string"&&(o[a]=`var(${c})`)}return r(t,e),s(e,n),{cssVariables:e,cssVariablesVarPrefix:n}},assignCSSVariables(t,e){const n={};function r(s,i,o){for(const[a,c]of Object.entries(s)){const l=o?`${o}-${a}`:a,u=i[a];c&&typeof c=="object"?r(c,u,l):typeof u=="string"&&(n[`${Z1}-${l}`]=u)}}return r(t,e),n},createRootStyles(t,e){const n={...M0,tokens:{...M0.tokens,theme:t==="light"?Ld.light:Ld.dark}},{cssVariables:r}=ys.createCSSVariables(n),s=ys.assignCSSVariables(r,n),i=ys.generateW3MVariables(e),o=ys.generateW3MOverrides(e),a=ys.generateScaledVariables(e),c=ys.generateBaseVariables(s),l={...s,...c,...i,...o,...a},u=ys.applyColorMixToVariables(e,l),d={...l,...u};return`:root {${Object.entries(d).map(([h,p])=>`${h}:${p.replace("/[:;{}</>]/g","")};`).join("")}}`},generateW3MVariables(t){if(!t)return{};const e=Tu(t),n={};return n["--w3m-font-family"]=e["font-family"],n["--w3m-accent"]=e.accent,n["--w3m-color-mix"]=e["color-mix"],n["--w3m-color-mix-strength"]=`${e["color-mix-strength"]}%`,n["--w3m-font-size-master"]=e["font-size-master"],n["--w3m-border-radius-master"]=e["border-radius-master"],n},generateW3MOverrides(t){if(!t)return{};const e=Tu(t),n={};if(t["--apkt-accent"]||t["--w3m-accent"]){const r=e.accent;n["--apkt-tokens-core-iconAccentPrimary"]=r,n["--apkt-tokens-core-borderAccentPrimary"]=r,n["--apkt-tokens-core-textAccentPrimary"]=r,n["--apkt-tokens-core-backgroundAccentPrimary"]=r}return(t["--apkt-font-family"]||t["--w3m-font-family"])&&(n["--apkt-fontFamily-regular"]=e["font-family"]),e["z-index"]!==void 0&&(n["--apkt-tokens-core-zIndex"]=`${e["z-index"]}`),n},generateScaledVariables(t){if(!t)return{};const e=Tu(t),n={};if(t["--apkt-font-size-master"]||t["--w3m-font-size-master"]){const r=parseFloat(e["font-size-master"].replace("px",""));n["--apkt-textSize-h1"]=`${Number(r)*5}px`,n["--apkt-textSize-h2"]=`${Number(r)*4.4}px`,n["--apkt-textSize-h3"]=`${Number(r)*3.8}px`,n["--apkt-textSize-h4"]=`${Number(r)*3.2}px`,n["--apkt-textSize-h5"]=`${Number(r)*2.6}px`,n["--apkt-textSize-h6"]=`${Number(r)*2}px`,n["--apkt-textSize-large"]=`${Number(r)*1.6}px`,n["--apkt-textSize-medium"]=`${Number(r)*1.4}px`,n["--apkt-textSize-small"]=`${Number(r)*1.2}px`}if(t["--apkt-border-radius-master"]||t["--w3m-border-radius-master"]){const r=parseFloat(e["border-radius-master"].replace("px",""));n["--apkt-borderRadius-1"]=`${Number(r)}px`,n["--apkt-borderRadius-2"]=`${Number(r)*2}px`,n["--apkt-borderRadius-3"]=`${Number(r)*3}px`,n["--apkt-borderRadius-4"]=`${Number(r)*4}px`,n["--apkt-borderRadius-5"]=`${Number(r)*5}px`,n["--apkt-borderRadius-6"]=`${Number(r)*6}px`,n["--apkt-borderRadius-8"]=`${Number(r)*8}px`,n["--apkt-borderRadius-16"]=`${Number(r)*16}px`,n["--apkt-borderRadius-20"]=`${Number(r)*20}px`,n["--apkt-borderRadius-32"]=`${Number(r)*32}px`,n["--apkt-borderRadius-64"]=`${Number(r)*64}px`,n["--apkt-borderRadius-128"]=`${Number(r)*128}px`}return n},generateColorMixCSS(t,e){if(!(t!=null&&t["--w3m-color-mix"])||!t["--w3m-color-mix-strength"])return"";const n=t["--w3m-color-mix"],r=t["--w3m-color-mix-strength"];if(!r||r===0)return"";const s=Object.keys(e||{}).filter(o=>{const a=o.includes("-tokens-core-background")||o.includes("-tokens-core-text")||o.includes("-tokens-core-border")||o.includes("-tokens-core-foreground")||o.includes("-tokens-core-icon")||o.includes("-tokens-theme-background")||o.includes("-tokens-theme-text")||o.includes("-tokens-theme-border")||o.includes("-tokens-theme-foreground")||o.includes("-tokens-theme-icon"),c=o.includes("-borderRadius-")||o.includes("-spacing-")||o.includes("-textSize-")||o.includes("-fontFamily-")||o.includes("-fontWeight-")||o.includes("-typography-")||o.includes("-duration-")||o.includes("-ease-")||o.includes("-path-")||o.includes("-width-")||o.includes("-height-")||o.includes("-visual-size-")||o.includes("-modal-width")||o.includes("-cover");return a&&!c});return s.length===0?"":` @supports (background: color-mix(in srgb, white 50%, black)) {
      :root {
        ${s.map(o=>{const a=(e==null?void 0:e[o])||"";return a.includes("color-mix")||a.startsWith("#")||a.startsWith("rgb")?`${o}: color-mix(in srgb, ${n} ${r}%, ${a});`:`${o}: color-mix(in srgb, ${n} ${r}%, var(${o}-base, ${a}));`}).join("")}
      }
    }`},generateBaseVariables(t){const e={},n=t["--apkt-tokens-theme-backgroundPrimary"];n&&(e["--apkt-tokens-theme-backgroundPrimary-base"]=n);const r=t["--apkt-tokens-core-backgroundAccentPrimary"];return r&&(e["--apkt-tokens-core-backgroundAccentPrimary-base"]=r),e},applyColorMixToVariables(t,e){const n={};e!=null&&e["--apkt-tokens-theme-backgroundPrimary"]&&(n["--apkt-tokens-theme-backgroundPrimary"]="var(--apkt-tokens-theme-backgroundPrimary-base)"),e!=null&&e["--apkt-tokens-core-backgroundAccentPrimary"]&&(n["--apkt-tokens-core-backgroundAccentPrimary"]="var(--apkt-tokens-core-backgroundAccentPrimary-base)");const r=Tu(t),s=r["color-mix"],i=r["color-mix-strength"];if(!i||i===0)return n;const o=Object.keys(e||{}).filter(a=>{const c=a.includes("-tokens-core-background")||a.includes("-tokens-core-text")||a.includes("-tokens-core-border")||a.includes("-tokens-core-foreground")||a.includes("-tokens-core-icon")||a.includes("-tokens-theme-background")||a.includes("-tokens-theme-text")||a.includes("-tokens-theme-border")||a.includes("-tokens-theme-foreground")||a.includes("-tokens-theme-icon")||a.includes("-tokens-theme-overlay"),l=a.includes("-borderRadius-")||a.includes("-spacing-")||a.includes("-textSize-")||a.includes("-fontFamily-")||a.includes("-fontWeight-")||a.includes("-typography-")||a.includes("-duration-")||a.includes("-ease-")||a.includes("-path-")||a.includes("-width-")||a.includes("-height-")||a.includes("-visual-size-")||a.includes("-modal-width")||a.includes("-cover");return c&&!l});return o.length===0||o.forEach(a=>{const c=(e==null?void 0:e[a])||"";a.endsWith("-base")||(a==="--apkt-tokens-theme-backgroundPrimary"||a==="--apkt-tokens-core-backgroundAccentPrimary"?n[a]=`color-mix(in srgb, ${s} ${i}%, var(${a}-base))`:c.includes("color-mix")||c.startsWith("#")||c.startsWith("rgb")?n[a]=`color-mix(in srgb, ${s} ${i}%, ${c})`:n[a]=`color-mix(in srgb, ${s} ${i}%, var(${a}-base, ${c}))`)}),n}},{cssVariablesVarPrefix:CG}=ys.createCSSVariables(M0);function qJ(t,...e){return fi(t,...e.map(n=>gr(typeof n=="function"?n(CG):n)))}let Gi,so,zr,jn,Md;const ps={"KHTeka-500-woff2":"https://fonts.reown.com/KHTeka-Medium.woff2","KHTeka-400-woff2":"https://fonts.reown.com/KHTeka-Regular.woff2","KHTeka-300-woff2":"https://fonts.reown.com/KHTeka-Light.woff2","KHTekaMono-400-woff2":"https://fonts.reown.com/KHTekaMono-Regular.woff2","KHTeka-500-woff":"https://fonts.reown.com/KHTeka-Light.woff","KHTeka-400-woff":"https://fonts.reown.com/KHTeka-Regular.woff","KHTeka-300-woff":"https://fonts.reown.com/KHTeka-Light.woff","KHTekaMono-400-woff":"https://fonts.reown.com/KHTekaMono-Regular.woff"};function Fd(t,e="dark"){Gi&&document.head.removeChild(Gi),Gi=document.createElement("style"),Gi.textContent=ys.createRootStyles(e,t),document.head.appendChild(Gi)}function VJ(t,e="dark"){if(Md=t,so=document.createElement("style"),zr=document.createElement("style"),jn=document.createElement("style"),so.textContent=ua(t).core.cssText,zr.textContent=ua(t).dark.cssText,jn.textContent=ua(t).light.cssText,document.head.appendChild(so),document.head.appendChild(zr),document.head.appendChild(jn),Fd(t,e),F0(e),!((t==null?void 0:t["--apkt-font-family"])||(t==null?void 0:t["--w3m-font-family"])))for(const[r,s]of Object.entries(ps)){const i=document.createElement("link");i.rel="preload",i.href=s,i.as="font",i.type=r.includes("woff2")?"font/woff2":"font/woff",i.crossOrigin="anonymous",document.head.appendChild(i)}F0(e)}function F0(t="dark"){zr&&jn&&Gi&&(t==="light"?(Fd(Md,t),zr.removeAttribute("media"),jn.media="enabled"):(Fd(Md,t),jn.removeAttribute("media"),zr.media="enabled"))}function _G(t){var e,n,r;if(Md=t,so&&zr&&jn){so.textContent=ua(t).core.cssText,zr.textContent=ua(t).dark.cssText,jn.textContent=ua(t).light.cssText;const s=(t==null?void 0:t["--apkt-font-family"])||(t==null?void 0:t["--w3m-font-family"]);s&&(so.textContent=(e=so.textContent)==null?void 0:e.replace("font-family: KHTeka",`font-family: ${s}`),zr.textContent=(n=zr.textContent)==null?void 0:n.replace("font-family: KHTeka",`font-family: ${s}`),jn.textContent=(r=jn.textContent)==null?void 0:r.replace("font-family: KHTeka",`font-family: ${s}`))}if(Gi){const s=(jn==null?void 0:jn.media)==="enabled"?"light":"dark";Fd(t,s)}}function ua(t){const e=!!(t!=null&&t["--apkt-font-family"]||t!=null&&t["--w3m-font-family"]);return{core:fi`
      ${e?fi``:fi`
            @font-face {
              font-family: 'KHTeka';
              src:
                url(${gr(ps["KHTeka-400-woff2"])}) format('woff2'),
                url(${gr(ps["KHTeka-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
              font-display: swap;
            }

            @font-face {
              font-family: 'KHTeka';
              src:
                url(${gr(ps["KHTeka-300-woff2"])}) format('woff2'),
                url(${gr(ps["KHTeka-300-woff"])}) format('woff');
              font-weight: 300;
              font-style: normal;
            }

            @font-face {
              font-family: 'KHTekaMono';
              src:
                url(${gr(ps["KHTekaMono-400-woff2"])}) format('woff2'),
                url(${gr(ps["KHTekaMono-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
            }

            @font-face {
              font-family: 'KHTeka';
              src:
                url(${gr(ps["KHTeka-400-woff2"])}) format('woff2'),
                url(${gr(ps["KHTeka-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
            }
          `}

      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --apkt-modal-width: 370px;

        --apkt-visual-size-inherit: inherit;
        --apkt-visual-size-sm: 40px;
        --apkt-visual-size-md: 55px;
        --apkt-visual-size-lg: 80px;

        --apkt-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --apkt-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --apkt-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --apkt-width-network-sm: 36px;
        --apkt-width-network-md: 48px;
        --apkt-width-network-lg: 86px;

        --apkt-duration-dynamic: 0ms;
        --apkt-height-network-sm: 40px;
        --apkt-height-network-md: 54px;
        --apkt-height-network-lg: 96px;
      }
    `,dark:fi`
      :root {
      }
    `,light:fi`
      :root {
      }
    `}}const KJ=fi`
  div,
  span,
  iframe,
  a,
  img,
  form,
  button,
  label,
  *::after,
  *::before {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    backface-visibility: hidden;
  }

  :host {
    font-family: var(--apkt-fontFamily-regular);
  }
`,GJ=fi`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;

    will-change: background-color, color, border, box-shadow, width, height, transform, opacity;
    outline: none;
    border: none;
    text-decoration: none;
    transition:
      background-color var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      color var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      border var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      box-shadow var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      width var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      height var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      transform var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      opacity var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      scale var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      border-radius var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2);
    will-change:
      background-color, color, border, box-shadow, width, height, transform, opacity, scale,
      border-radius;
  }

  a:active:not([disabled]),
  button:active:not([disabled]) {
    scale: 0.975;
    transform-origin: center;
  }

  button:disabled {
    cursor: default;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,Ou={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603};class AG extends nI{async setUniversalProvider(e){if(!this.namespace)throw new Error("UniversalAdapter:setUniversalProvider - namespace is required");return this.addConnector(new rI({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace})),Promise.resolve()}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect(),this.emit("disconnect")}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}return{connections:[]}}syncConnections(){return Promise.resolve()}async getAccounts({namespace:e}){var s,i,o,a;const n=this.provider,r=((a=(o=(i=(s=n==null?void 0:n.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:a.map(c=>{const[,,l]=c.split(":");return l}).filter((c,l,u)=>u.indexOf(c)===l))||[];return Promise.resolve({accounts:r.map(c=>Q.createAccount(e,c,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){var o,a,c,l,u;if(!(e.caipNetwork&&Oe.BALANCE_SUPPORTED_CHAINS.includes((o=e.caipNetwork)==null?void 0:o.chainNamespace))||(a=e.caipNetwork)!=null&&a.testnet)return{balance:"0.00",symbol:((c=e.caipNetwork)==null?void 0:c.nativeCurrency.symbol)||""};const r=I.getAccountData();if(r!=null&&r.balanceLoading&&e.chainId===((l=I.state.activeCaipNetwork)==null?void 0:l.id))return{balance:(r==null?void 0:r.balance)||"0.00",symbol:(r==null?void 0:r.balanceSymbol)||""};const i=(await I.fetchTokenBalance()).find(d=>{var f,h;return d.chainId===`${(f=e.caipNetwork)==null?void 0:f.chainNamespace}:${e.chainId}`&&d.symbol===((h=e.caipNetwork)==null?void 0:h.nativeCurrency.symbol)});return{balance:(i==null?void 0:i.quantity.numeric)||"0.00",symbol:(i==null?void 0:i.symbol)||((u=e.caipNetwork)==null?void 0:u.nativeCurrency.symbol)||""}}async signMessage(e){var o,a,c;const{provider:n,message:r,address:s}=e;if(!n)throw new Error("UniversalAdapter:signMessage - provider is undefined");let i="";return((o=I.state.activeCaipNetwork)==null?void 0:o.chainNamespace)===B.CHAIN.SOLANA?i=(await n.request({method:"solana_signMessage",params:{message:Da.encode(new TextEncoder().encode(r)),pubkey:s}},(a=I.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)).signature:i=await n.request({method:"personal_sign",params:[r,s]},(c=I.state.activeCaipNetwork)==null?void 0:c.caipNetworkId),{signature:i}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}emitFirstAvailableConnection(){}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){var s,i,o,a,c,l;const{caipNetwork:n}=e,r=this.getWalletConnectConnector();if(n.chainNamespace===B.CHAIN.EVM)try{await((s=r.provider)==null?void 0:s.request({method:"wallet_switchEthereumChain",params:[{chainId:nr(n.id)}]}))}catch(u){if(u.code===Ou.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||u.code===Ou.ERROR_INVALID_CHAIN_ID||u.code===Ou.ERROR_CODE_DEFAULT||((o=(i=u==null?void 0:u.data)==null?void 0:i.originalError)==null?void 0:o.code)===Ou.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await((l=r.provider)==null?void 0:l.request({method:"wallet_addEthereumChain",params:[{chainId:nr(n.id),rpcUrls:[(a=n==null?void 0:n.rpcUrls.chainDefault)==null?void 0:a.http],chainName:n.name,nativeCurrency:n.nativeCurrency,blockExplorerUrls:[(c=n.blockExplorers)==null?void 0:c.default.url]}]}))}catch{throw new Error("Chain is not supported")}}r.provider.setDefaultChain(n.caipNetworkId)}getWalletConnectProvider(){const e=this.connectors.find(r=>r.type==="WALLET_CONNECT");return e==null?void 0:e.provider}}const IG=["email","socials","swaps","onramp","activity","reownBranding","multiWallet","emailCapture","payWithExchange","payments","reownAuthentication","headless"],Ru={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return!!t.isEnabled&&e.includes("email")},processFallback:t=>t===void 0?Oe.DEFAULT_REMOTE_FEATURES.email:!!t},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return t.isEnabled&&e.length>0?e.filter(n=>n!=="email"):!1},processFallback:t=>t===void 0?Oe.DEFAULT_REMOTE_FEATURES.socials:typeof t=="boolean"?t?Oe.DEFAULT_REMOTE_FEATURES.socials:!1:t},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?Oe.DEFAULT_REMOTE_FEATURES.swaps:typeof t=="boolean"?t?Oe.DEFAULT_REMOTE_FEATURES.swaps:!1:t},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?Oe.DEFAULT_REMOTE_FEATURES.onramp:typeof t=="boolean"?t?Oe.DEFAULT_REMOTE_FEATURES.onramp:!1:t},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?Oe.DEFAULT_REMOTE_FEATURES.activity:!!t},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?Oe.DEFAULT_REMOTE_FEATURES.reownBranding:!!t},emailCapture:{apiFeatureName:"email_capture",localFeatureName:"emailCapture",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>t.isEnabled&&(t.config??[]),processFallback:t=>!1},multiWallet:{apiFeatureName:"multi_wallet",localFeatureName:"multiWallet",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>Oe.DEFAULT_REMOTE_FEATURES.multiWallet},payWithExchange:{apiFeatureName:"fund_from_exchange",localFeatureName:"payWithExchange",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>Oe.DEFAULT_REMOTE_FEATURES.payWithExchange},payments:{apiFeatureName:"payments",localFeatureName:"payments",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>Oe.DEFAULT_REMOTE_FEATURES.payments},reownAuthentication:{apiFeatureName:"reown_authentication",localFeatureName:"reownAuthentication",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>typeof t>"u"?Oe.DEFAULT_REMOTE_FEATURES.reownAuthentication:!!t},headless:{apiFeatureName:"headless",localFeatureName:"headless",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>Oe.DEFAULT_REMOTE_FEATURES.headless}},SG={localSettingsOverridden:new Set,getApiConfig(t,e){return e==null?void 0:e.find(n=>n.id===t)},addWarning(t,e){if(t!==void 0){const n=Ru[e],r=n.isLegacy?`"features.${n.localFeatureName}" (now "${e}")`:`"features.${e}"`;this.localSettingsOverridden.add(r)}},processFeature(t,e,n,r,s){const i=Ru[t],o=e[i.localFeatureName];if(s&&!i.isAvailableOnBasic)return!1;if(r){const a=this.getApiConfig(i.apiFeatureName,n);return(a==null?void 0:a.config)===null?this.processFallbackFeature(t,o):a!=null&&a.config?(o!==void 0&&this.addWarning(o,t),this.processApiFeature(t,a)):!1}return this.processFallbackFeature(t,o)},processApiFeature(t,e){return Ru[t].processApi(e)},processFallbackFeature(t,e){return Ru[t].processFallback(e)},async fetchRemoteFeatures(t){const e=t.basic??!1,n=t.features||{};this.localSettingsOverridden.clear();let r=null,s=!1;try{r=await se.fetchProjectConfig(),s=r!=null}catch(o){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",o)}const i=s&&!e?Oe.DEFAULT_REMOTE_FEATURES:Oe.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(const o of IG){const a=this.processFeature(o,n,r,s,e);Object.assign(i,{[o]:a})}}catch(o){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",o),Oe.DEFAULT_REMOTE_FEATURES}if(s&&this.localSettingsOverridden.size>0){const o=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;ct.open({debugMessage:rt.ALERT_WARNINGS.LOCAL_CONFIGURATION_IGNORED.debugMessage(o)},"warning")}return i}};class xG{constructor(e){this.chainNamespaces=[],this.features={},this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(n,r)=>{var s,i,o;if(n){const a=(s=I.getCaipNetworks(n))==null?void 0:s.find(u=>u.id===r);if(a)return a;const c=(i=I.getNetworkData(n))==null?void 0:i.caipNetwork;return c||((o=I.getRequestedCaipNetworks(n).filter(u=>u.chainNamespace===n))==null?void 0:o[0])}return I.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const n=this.getCaipNetwork();if(n)return n.id},this.getCaipNetworks=n=>I.getCaipNetworks(n),this.getActiveChainNamespace=()=>I.state.activeChain,this.setRequestedCaipNetworks=(n,r)=>{I.setRequestedCaipNetworks(n,r)},this.getApprovedCaipNetworkIds=()=>I.getAllApprovedCaipNetworkIds(),this.getCaipAddress=n=>{var r,s;return I.state.activeChain===n||!n?I.state.activeCaipAddress:(s=(r=I.state.chains.get(n))==null?void 0:r.accountState)==null?void 0:s.caipAddress},this.setClientId=n=>{be.setClientId(n)},this.getProvider=n=>Ye.getProvider(n),this.getProviderType=n=>Ye.getProviderId(n),this.getPreferredAccountType=n=>an(n),this.setCaipAddress=(n,r,s=!1)=>{I.setAccountProp("caipAddress",n,r,s),I.setAccountProp("address",Q.getPlainAddress(n),r,s)},this.setBalance=(n,r,s)=>{I.setAccountProp("balance",n,s),I.setAccountProp("balanceSymbol",r,s)},this.setProfileName=(n,r)=>{I.setAccountProp("profileName",n,r)},this.setProfileImage=(n,r)=>{I.setAccountProp("profileImage",n,r)},this.setUser=(n,r)=>{I.setAccountProp("user",n,r)},this.resetAccount=n=>{I.resetAccount(n)},this.setCaipNetwork=n=>{I.setActiveCaipNetwork(n)},this.setCaipNetworkOfNamespace=(n,r)=>{I.setChainNetworkData(r,{caipNetwork:n})},this.setStatus=(n,r)=>{I.setAccountProp("status",n,r),V.isConnected()?W.setConnectionStatus("connected"):W.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=n=>{var r;return(r=I.getAccountData(n))==null?void 0:r.address},this.setConnectors=n=>{const r=[...V.state.allConnectors,...n];V.setConnectors(r)},this.setConnections=(n,r)=>{W.setConnections(n,r),Z.setConnections(n,r)},this.fetchIdentity=n=>be.fetchIdentity(n),this.getReownName=n=>vc.getNamesForAddress(n),this.getConnectors=()=>V.getConnectors(),this.getConnectorImage=n=>lC.getConnectorImage(n),this.getConnections=n=>this.remoteFeatures.multiWallet?bd.getConnectionsData(n).connections:(ct.open(B.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.getRecentConnections=n=>this.remoteFeatures.multiWallet?bd.getConnectionsData(n).recentConnections:(ct.open(B.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.switchConnection=async n=>{if(!this.remoteFeatures.multiWallet){ct.open(B.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}await Z.switchConnection(n)},this.deleteConnection=n=>{if(!this.remoteFeatures.multiWallet){ct.open(B.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}W.deleteAddressFromConnection(n),Z.syncStorageConnections()},this.setConnectedWalletInfo=(n,r)=>{const s=Ye.getProviderId(r),i=n?{...n,type:s}:void 0;I.setAccountProp("connectedWalletInfo",i,r)},this.getIsConnectedState=()=>!!I.state.activeCaipAddress,this.addAddressLabel=(n,r,s)=>{var o;const i=((o=I.getAccountData(s))==null?void 0:o.addressLabels)||{};I.setAccountProp("addressLabels",{...i,[n]:r},s)},this.removeAddressLabel=(n,r)=>{var i;const s=((i=I.getAccountData(r))==null?void 0:i.addressLabels)||{};I.setAccountProp("addressLabels",{...s,[n]:void 0},r)},this.getAddress=n=>{var s;const r=n||I.state.activeChain;return(s=I.getAccountData(r))==null?void 0:s.address},this.resetNetwork=n=>{I.resetNetwork(n)},this.addConnector=n=>{V.addConnector(n)},this.resetWcConnection=()=>{Z.resetWcConnection()},this.setAddressExplorerUrl=(n,r)=>{I.setAccountProp("addressExplorerUrl",n,r)},this.setSmartAccountDeployed=(n,r)=>{I.setAccountProp("smartAccountDeployed",n,r)},this.setPreferredAccountType=(n,r)=>{I.setAccountProp("preferredAccountType",n,r)},this.setEIP6963Enabled=n=>{F.setEIP6963Enabled(n)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.readyPromise=this.initialize(e)}getChainNamespacesSet(e,n){const r=e==null?void 0:e.map(i=>i.namespace).filter(i=>!!i);if(r!=null&&r.length)return[...new Set(r)];const s=n==null?void 0:n.map(i=>i.chainNamespace);return[...new Set(s)]}async initialize(e){var n,r,s,i,o,a;if(this.initializeProjectSettings(e),this.initControllers(e),await this.initChainAdapters(),this.sendInitializeEvent(e),(n=e.features)!=null&&n.headless&&!mr.hasInjectedConnectors()&&se.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1,fetchWalletRanks:!1,fetchRecommendedWallets:!0}),F.state.enableReconnect?(await this.syncExistingConnection(),await this.syncAdapterConnections()):await this.unSyncExistingConnection(),!e.basic&&!e.manualWCControl&&(this.remoteFeatures=await SG.fetchRemoteFeatures(e)),await se.fetchUsage(),F.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&Fp.setOnrampProviders(this.remoteFeatures.onramp),((r=F.state.remoteFeatures)!=null&&r.email||Array.isArray((s=F.state.remoteFeatures)==null?void 0:s.socials)&&((i=F.state.remoteFeatures)==null?void 0:i.socials.length)>0)&&await this.checkAllowedOrigins(),(o=F.state.features)!=null&&o.reownAuthentication||(a=F.state.remoteFeatures)!=null&&a.reownAuthentication){const{ReownAuthentication:c}=await _t(async()=>{const{ReownAuthentication:u}=await import("./features-3CHfQQze.js");return{ReownAuthentication:u}},[]),l=F.state.siwx;l instanceof c||(l&&console.warn("ReownAuthentication option is enabled, SIWX configuration will be overridden."),F.setSIWX(new c))}}async openSend(e){var i;const n=e.namespace||I.state.activeChain,r=this.getCaipAddress(n),s=(i=this.getCaipNetwork(n))==null?void 0:i.id;if(!r)throw new Error("openSend: caipAddress not found");if((s==null?void 0:s.toString())!==e.chainId.toString()){const o=I.getCaipNetworkById(e.chainId,n);if(!o)throw new Error(`openSend: caipNetwork with chainId ${e.chainId} not found`);await this.switchNetwork(o,{throwOnFailure:!0})}try{const o=iI.getTokenSymbolByAddress(e.assetAddress);o&&await se.fetchTokenImages([o])}catch{}return await Pe.open({view:"WalletSend",data:{send:e}}),new Promise((o,a)=>{const c=Se.subscribeKey("hash",d=>{d&&(u(),o({hash:d}))}),l=Pe.subscribe(d=>{d.open||(u(),a(new Error("Modal closed")))}),u=this.createCleanupHandler([c,l])})}toModalOptions(){function e(r){return(r==null?void 0:r.view)==="Swap"}function n(r){return(r==null?void 0:r.view)==="WalletSend"}return{isSwap:e,isSend:n}}async checkAllowedOrigins(){try{const e=await se.fetchAllowedOrigins();if(!Q.isClient())return;const n=window.location.origin;Os.isOriginAllowed(n,e,B.DEFAULT_ALLOWED_ANCESTORS)||ct.open(rt.ALERT_ERRORS.ORIGIN_NOT_ALLOWED,"error")}catch(e){if(!(e instanceof Error))return;switch(e.message){case"RATE_LIMITED":ct.open(rt.ALERT_ERRORS.RATE_LIMITED_APP_CONFIGURATION,"error");break;case"SERVER_ERROR":{const n=e.cause instanceof Error?e.cause:e;ct.open({displayMessage:rt.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.displayMessage,debugMessage:rt.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.debugMessage(n.message)},"error");break}}}}createCleanupHandler(e){return()=>{e.forEach(n=>{try{n()}catch{}})}}sendInitializeEvent(e){var r;const{...n}=e;delete n.adapters,delete n.universalProvider,ve.sendEvent({type:"track",event:"INITIALIZE",properties:{...n,networks:e.networks.map(s=>s.id),siweConfig:{options:((r=e.siweConfig)==null?void 0:r.options)||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initAdapterController(){fC.initialize(this.chainAdapters)}initializeThemeController(e){e.themeMode&&En.setThemeMode(e.themeMode),e.themeVariables&&En.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient)throw new Error("ConnectionControllerClient must be set");I.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient});const n=this.getDefaultNetwork();n&&I.setActiveCaipNetwork(n)}initializeConnectionController(e){Z.initialize(e.adapters??[]),Z.setWcBasic(e.basic??!1)}initializeConnectorController(){V.initialize(this.chainNamespaces)}initializeProjectSettings(e){F.setProjectId(e.projectId),F.setSdkVersion(e.sdkVersion)}initializeOptionsController(e){var s;F.setDebug(e.debug!==!1),F.setEnableWalletGuide(e.enableWalletGuide!==!1),F.setEnableWallets(e.enableWallets!==!1),F.setEIP6963Enabled(e.enableEIP6963!==!1),F.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),F.setEnableReconnect(e.enableReconnect!==!1),F.setEnableMobileFullScreen(e.enableMobileFullScreen===!0),F.setCoinbasePreference(e.coinbasePreference),F.setEnableAuthLogger(e.enableAuthLogger!==!1),F.setCustomRpcUrls(e.customRpcUrls),F.setEnableEmbedded(e.enableEmbedded),F.setAllWallets(e.allWallets),F.setIncludeWalletIds(e.includeWalletIds),F.setExcludeWalletIds(e.excludeWalletIds),F.setFeaturedWalletIds(e.featuredWalletIds),F.setTokens(e.tokens),F.setTermsConditionsUrl(e.termsConditionsUrl),F.setPrivacyPolicyUrl(e.privacyPolicyUrl),F.setCustomWallets(e.customWallets),F.setFeatures(e.features),F.setAllowUnsupportedChain(e.allowUnsupportedChain),F.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),F.setPreferUniversalLinks(e.experimental_preferUniversalLinks),F.setDefaultAccountTypes(e.defaultAccountTypes);const n=this.getDefaultMetaData();if(!e.metadata&&n&&(e.metadata=n),F.setMetadata(e.metadata),F.setDisableAppend(e.disableAppend),F.setEnableEmbedded(e.enableEmbedded),F.setSIWX(e.siwx),this.features=F.state.features??{},!e.projectId){ct.open(rt.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(((s=e.adapters)==null?void 0:s.find(i=>i.namespace===B.CHAIN.EVM))&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");F.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){var e,n,r,s;return Q.isClient()?{name:((n=(e=document.getElementsByTagName("title"))==null?void 0:e[0])==null?void 0:n.textContent)||"",description:((r=document.querySelector('meta[property="og:description"]'))==null?void 0:r.content)||"",url:window.location.origin,icons:[((s=document.querySelector('link[rel~="icon"]'))==null?void 0:s.href)||""]}:null}setUnsupportedNetwork(e){const n=this.getActiveChainNamespace();if(n){const r=jr.getUnsupportedNetwork(`${n}:${e}`);I.setActiveCaipNetwork(r)}}getDefaultNetwork(){return jr.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,n){return jr.extendCaipNetwork(e,{customNetworkImageUrls:n.chainImages,projectId:n.projectId})}extendCaipNetworks(e){return jr.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const n=e.networks.find(s=>{var i;return s.id===((i=e.defaultNetwork)==null?void 0:i.id)});return n?jr.extendCaipNetwork(n,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}async disconnectConnector(e,n){var r,s;try{this.setLoading(!0,e);let i={connections:[]};const o=this.getAdapter(e);return(((s=(r=I.state.chains.get(e))==null?void 0:r.accountState)==null?void 0:s.caipAddress)||!F.state.enableReconnect)&&(o!=null&&o.disconnect)&&(i=await o.disconnect({id:n})),this.setLoading(!1,e),i}catch(i){throw this.setLoading(!1,e),new Error(`Failed to disconnect chains: ${i.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{var l;const e=I.state.activeChain,n=this.getAdapter(e),r=(l=this.getCaipNetwork(e))==null?void 0:l.id,s=Z.getConnections(e),i=this.remoteFeatures.multiWallet,o=s.length>0;if(!n)throw new Error("Adapter not found");const a=await n.connectWalletConnect(r);(!o||!i)&&this.close(),this.setClientId((a==null?void 0:a.clientId)||null),W.setConnectedNamespaces([...I.state.chains.keys()]),await this.syncWalletConnectAccount(),await Fn.initializeIfEnabled()},connectExternal:async e=>{const n=await this.onConnectExternal(e);return await this.connectInactiveNamespaces(e,n),n?{address:n.address}:void 0},reconnectExternal:async({id:e,info:n,type:r,provider:s})=>{var a;const i=I.state.activeChain,o=this.getAdapter(i);if(!i)throw new Error("reconnectExternal: namespace not found");if(!o)throw new Error("reconnectExternal: adapter not found");o!=null&&o.reconnect&&(await(o==null?void 0:o.reconnect({id:e,info:n,type:r,provider:s,chainId:(a=this.getCaipNetwork())==null?void 0:a.id})),W.addConnectedNamespace(i),this.syncConnectedWalletInfo(i))},disconnectConnector:async e=>{await this.disconnectConnector(e.namespace,e.id)},disconnect:async e=>{var l;const{id:n,chainNamespace:r,initialDisconnect:s}=e||{},i=r||I.state.activeChain,o=V.getConnectorId(i),a=n===B.CONNECTOR_ID.AUTH||o===B.CONNECTOR_ID.AUTH,c=n===B.CONNECTOR_ID.WALLET_CONNECT||o===B.CONNECTOR_ID.WALLET_CONNECT;try{const u=Array.from(I.state.chains.keys());let d=r?[r]:u;(c||a)&&(d=u);const f=d.map(async g=>{const m=V.getConnectorId(g),E=n||m,A=await this.disconnectConnector(g,E);A&&(a&&W.deleteConnectedSocialProvider(),A.connections.forEach(b=>{W.addDisconnectedConnectorId(b.connectorId,g)})),s&&this.onDisconnectNamespace({chainNamespace:g,closeModal:!1})}),h=await Promise.allSettled(f);Se.resetSend(),Z.resetWcConnection(),(l=Fn.getSIWX())!=null&&l.signOutOnDisconnect&&await Fn.clearSessions(),V.setFilterByNamespace(void 0),Z.syncStorageConnections();const p=h.filter(g=>g.status==="rejected");if(p.length>0)throw new Error(p.map(g=>g.reason.message).join(", "));ve.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:r||"all"}})}catch(u){throw new Error(`Failed to disconnect chains: ${u.message}`)}},checkInstalled:e=>e?e.some(n=>{var r;return!!((r=window.ethereum)!=null&&r[String(n)])}):!!window.ethereum,signMessage:async e=>{const n=I.state.activeChain,r=this.getAdapter(I.state.activeChain);if(!n)throw new Error("signMessage: namespace not found");if(!r)throw new Error("signMessage: adapter not found");const s=this.getAddress(n);if(!s)throw new Error("signMessage: address not found");const i=await(r==null?void 0:r.signMessage({message:e,address:s,provider:Ye.getProvider(n)}));return(i==null?void 0:i.signature)||""},sendTransaction:async e=>{const n=e.chainNamespace;if(!n)throw new Error("sendTransaction: namespace not found");if(Oe.SEND_SUPPORTED_NAMESPACES.includes(n)){const r=this.getAdapter(n);if(!r)throw new Error("sendTransaction: adapter not found");const s=Ye.getProvider(n),i=await(r==null?void 0:r.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:s}));return(i==null?void 0:i.hash)||""}return""},estimateGas:async e=>{const n=e.chainNamespace;if(n===B.CHAIN.EVM){const r=this.getAdapter(n);if(!r)throw new Error("estimateGas: adapter is required but got undefined");const s=Ye.getProvider(n),i=this.getCaipNetwork();if(!i)throw new Error("estimateGas: caipNetwork is required but got undefined");const o=await(r==null?void 0:r.estimateGas({...e,provider:s,caipNetwork:i}));return(o==null?void 0:o.gas)||0n}return 0n},getEnsAvatar:async()=>{var s;const e=I.state.activeChain;if(!e)throw new Error("getEnsAvatar: namespace is required but got undefined");const n=this.getAddress(e);if(!n)throw new Error("getEnsAvatar: address not found");await this.syncIdentity({address:n,chainId:Number((s=this.getCaipNetwork())==null?void 0:s.id),chainNamespace:e});const r=I.getAccountData();return(r==null?void 0:r.profileImage)||!1},getEnsAddress:async e=>await Os.resolveReownName(e),writeContract:async e=>{const n=I.state.activeChain,r=this.getAdapter(n);if(!n)throw new Error("writeContract: namespace is required but got undefined");if(!r)throw new Error("writeContract: adapter is required but got undefined");const s=this.getCaipNetwork(),i=this.getCaipAddress(),o=Ye.getProvider(n);if(!s||!i)throw new Error("writeContract: caipNetwork or caipAddress is required but got undefined");const a=await(r==null?void 0:r.writeContract({...e,caipNetwork:s,provider:o,caipAddress:i}));return a==null?void 0:a.hash},parseUnits:(e,n)=>{const r=this.getAdapter(I.state.activeChain);if(!r)throw new Error("parseUnits: adapter is required but got undefined");return(r==null?void 0:r.parseUnits({value:e,decimals:n}))??0n},formatUnits:(e,n)=>{const r=this.getAdapter(I.state.activeChain);if(!r)throw new Error("formatUnits: adapter is required but got undefined");return(r==null?void 0:r.formatUnits({value:e,decimals:n}))??"0"},getCapabilities:async e=>{const n=this.getAdapter(I.state.activeChain);if(!n)throw new Error("getCapabilities: adapter is required but got undefined");return await(n==null?void 0:n.getCapabilities(e))},grantPermissions:async e=>{const n=this.getAdapter(I.state.activeChain);if(!n)throw new Error("grantPermissions: adapter is required but got undefined");return await(n==null?void 0:n.grantPermissions(e))},revokePermissions:async e=>{const n=this.getAdapter(I.state.activeChain);if(!n)throw new Error("revokePermissions: adapter is required but got undefined");return n!=null&&n.revokePermissions?await n.revokePermissions(e):"0x"},walletGetAssets:async e=>{const n=this.getAdapter(I.state.activeChain);if(!n)throw new Error("walletGetAssets: adapter is required but got undefined");return await(n==null?void 0:n.walletGetAssets(e))??{}},updateBalance:e=>{const n=this.getAddress(e),r=this.getCaipNetwork(e);!r||!n||this.updateNativeBalance(n,r==null?void 0:r.id,e)}},Z.setClient(this.connectionControllerClient)}async onConnectExternal(e){var l,u,d,f,h,p,g,m;const n=I.state.activeChain,r=e.chain||n,s=this.getAdapter(r);let i=!0;if(e.type===on.CONNECTOR_TYPE_AUTH&&B.AUTH_CONNECTOR_SUPPORTED_CHAINS.some(b=>V.getConnectorId(b)===B.CONNECTOR_ID.AUTH)&&e.chain!==n&&(i=!1),e.chain&&e.chain!==n&&!e.caipNetwork){const E=this.getCaipNetworks().find(A=>A.chainNamespace===e.chain);E&&i&&this.setCaipNetwork(E)}if(!r)throw new Error("connectExternal: namespace not found");if(!s)throw new Error("connectExternal: adapter not found");const o=this.getCaipNetwork(r),a=e.caipNetwork||o,c=await s.connect({id:e.id,address:e.address,info:e.info,type:e.type,provider:e.provider,socialUri:e.socialUri,chainId:((l=e.caipNetwork)==null?void 0:l.id)||(o==null?void 0:o.id),rpcUrl:((h=(f=(d=(u=e.caipNetwork)==null?void 0:u.rpcUrls)==null?void 0:d.default)==null?void 0:f.http)==null?void 0:h[0])||((m=(g=(p=o==null?void 0:o.rpcUrls)==null?void 0:p.default)==null?void 0:g.http)==null?void 0:m[0])});if(c)return W.addConnectedNamespace(r),this.syncProvider({...c,chainNamespace:r}),this.setStatus("connected",r),this.syncConnectedWalletInfo(r),W.removeDisconnectedConnectorId(e.id,r),{address:c.address,connectedCaipNetwork:a}}async connectInactiveNamespaces(e,n){var a;const r=e.type===on.CONNECTOR_TYPE_AUTH,s=As.getOtherAuthNamespaces((a=n==null?void 0:n.connectedCaipNetwork)==null?void 0:a.chainNamespace),i=I.state.activeCaipNetwork,o=this.getAdapter(i==null?void 0:i.chainNamespace);r&&(await Promise.all(s.map(async c=>{var l,u,d;try{const f=Ye.getProvider(c),h=this.getCaipNetwork(c),p=this.getAdapter(c);await(p==null?void 0:p.connect({...e,provider:f,socialUri:void 0,chainId:h==null?void 0:h.id,rpcUrl:(d=(u=(l=h==null?void 0:h.rpcUrls)==null?void 0:l.default)==null?void 0:u.http)==null?void 0:d[0]}))&&(W.addConnectedNamespace(c),W.removeDisconnectedConnectorId(e.id,c),this.setStatus("connected",c),this.syncConnectedWalletInfo(c))}catch(f){ct.warn(rt.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.displayMessage,rt.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.debugMessage(c,f instanceof Error?f.message:void 0),rt.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.code)}})),i&&await(o==null?void 0:o.switchNetwork({caipNetwork:i})))}getApprovedCaipNetworksData(){var n,r,s,i,o;if(Ye.getProviderId(I.state.activeChain)===on.CONNECTOR_TYPE_WALLET_CONNECT){const a=(r=(n=this.universalProvider)==null?void 0:n.session)==null?void 0:r.namespaces;return{supportsAllNetworks:((o=(i=(s=this.universalProvider)==null?void 0:s.session)==null?void 0:i.peer)==null?void 0:o.metadata.name)==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(a)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){const n=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const s=Ye.getProviderId(n);if(e.chainNamespace===I.state.activeChain){const i=this.getAdapter(n);await(i==null?void 0:i.switchNetwork({caipNetwork:e}))}else if(this.setCaipNetwork(e),s===on.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const i=this.getAddressByChainNamespace(n);i&&this.syncAccount({address:i,chainId:e.id,chainNamespace:n})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(n=>{const r=n.chains||[],s=n.accounts.map(i=>{const{chainId:o,chainNamespace:a}=It.parseCaipAddress(i);return`${a}:${o}`});return Array.from(new Set([...r,...s]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((n,r)=>{var i,o;const s=e==null?void 0:e.find(a=>a.namespace===r);return s?(s.construct({namespace:r,projectId:(i=this.options)==null?void 0:i.projectId,networks:(o=this.caipNetworks)==null?void 0:o.filter(({chainNamespace:a})=>a===r)}),n[r]=s):n[r]=new AG({namespace:r,networks:this.getCaipNetworks()}),n},{})}async initChainAdapter(e){this.onConnectors(e),this.listenAdapter(e);const n=this.getAdapter(e);if(!n)throw new Error("adapter not found");await n.syncConnectors(),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)})),this.initAdapterController()}onConnectors(e){const n=this.getAdapter(e);n==null||n.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const n=this.getAdapter(e);if(!n)return;const r=W.getConnectionStatus();F.state.enableReconnect===!1?this.setStatus("disconnected",e):r==="connected"?this.setStatus("connecting",e):r==="disconnected"?(W.clearAddressCache(),this.setStatus(r,e)):this.setStatus(r,e),n.on("switchNetwork",({address:s,chainId:i})=>{var l,u;const o=this.getCaipNetworks().find(d=>d.id.toString()===i.toString()||d.caipNetworkId.toString()===i.toString()),a=I.state.activeChain===e,c=(u=(l=I.state.chains.get(e))==null?void 0:l.accountState)==null?void 0:u.address;if(o){const d=a&&s?s:c;d&&this.syncAccount({address:d,chainId:o.id,chainNamespace:e})}else this.setUnsupportedNetwork(i)}),n.on("disconnect",()=>{const s=this.remoteFeatures.multiWallet,i=Array.from(Z.state.connections.values()).flat();this.onDisconnectNamespace({chainNamespace:e,closeModal:!s||i.length===0})}),n.on("connections",s=>{this.setConnections(s,e)}),n.on("pendingTransactions",()=>{const s=this.getAddress(e),i=I.state.activeCaipNetwork;!s||!(i!=null&&i.id)||this.updateNativeBalance(s,i.id,i.chainNamespace)}),n.on("accountChanged",({address:s,chainId:i,connector:o})=>{var u,d;this.handlePreviousConnectorConnection(o);const a=I.state.activeChain===e;o!=null&&o.provider&&(this.syncProvider({id:o.id,type:o.type,provider:o==null?void 0:o.provider,chainNamespace:e}),this.syncConnectedWalletInfo(e));const c=(d=(u=I.getNetworkData(e))==null?void 0:u.caipNetwork)==null?void 0:d.id,l=i||c;a&&l?this.syncAccount({address:s,chainId:l,chainNamespace:e}):!a&&l?(this.syncAccountInfo(s,l,e),this.syncBalance({address:s,chainId:l,chainNamespace:e})):this.syncAccountInfo(s,i,e),W.addConnectedNamespace(e)})}async handlePreviousConnectorConnection(e){var c;const n=e==null?void 0:e.chain,r=e==null?void 0:e.id,s=V.getConnectorId(n),i=(c=F.state.remoteFeatures)==null?void 0:c.multiWallet,a=n&&r&&s&&s!==r&&!i;try{a&&await Z.disconnect({id:s,namespace:n})}catch(l){console.warn("Error disconnecting previous connector",l)}}async createUniversalProviderForAdapter(e){var n,r,s;await this.getUniversalProvider(),this.universalProvider&&await((s=(r=(n=this.chainAdapters)==null?void 0:n[e])==null?void 0:r.setUniversalProvider)==null?void 0:s.call(r,this.universalProvider))}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async unSyncExistingConnection(){try{await Promise.allSettled(this.chainNamespaces.map(e=>Z.disconnect({namespace:e,initialDisconnect:!0})))}catch(e){console.error("Error disconnecting existing connections:",e)}}async reconnectWalletConnect(){await this.syncWalletConnectAccount();const e=this.getAddress();this.getCaipAddress()||W.deleteRecentWallet();const n=W.getRecentWallet();ve.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:e,properties:{method:Q.isMobile()?"mobile":"qrcode",name:(n==null?void 0:n.name)||"Unknown",reconnect:!0,view:me.state.view,walletRank:n==null?void 0:n.order}})}async syncNamespaceConnection(e){try{e===B.CHAIN.EVM&&Q.isSafeApp()&&V.setConnectorId(B.CONNECTOR_ID.SAFE,e);const n=V.getConnectorId(e);switch(this.setStatus("connecting",e),n){case B.CONNECTOR_ID.WALLET_CONNECT:await this.reconnectWalletConnect();break;case B.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(n){console.warn("AppKit couldn't sync existing connection",n),this.setStatus("disconnected",e)}}onDisconnectNamespace(e){const{chainNamespace:n,closeModal:r}=e||{};I.resetAccount(n),I.resetNetwork(n),W.removeConnectedNamespace(n);const s=Array.from(I.state.chains.keys());(n?[n]:s).forEach(o=>W.addDisconnectedConnectorId(V.getConnectorId(o)||"",o)),V.removeConnectorId(n),Ye.resetChain(n),this.setUser(null,n),this.setStatus("disconnected",n),this.setConnectedWalletInfo(null,n),r!==!1&&Pe.close()}async syncAdapterConnections(){await Promise.allSettled(this.chainNamespaces.map(e=>{const n=this.getAdapter(e),r=this.getCaipAddress(e),s=this.getCaipNetwork(e);return n==null?void 0:n.syncConnections({connectToFirstConnector:!r,caipNetwork:s})}))}async syncAdapterConnection(e){var a,c,l,u,d;const n=this.getAdapter(e),r=this.getCaipNetwork(e),s=V.getConnectorId(e),o=V.getConnectors(e).find(f=>f.id===s);try{if(!n||!o)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!(r!=null&&r.id))throw new Error("CaipNetwork not found");const f=await(n==null?void 0:n.syncConnection({namespace:e,id:o.id,chainId:r.id,rpcUrl:(l=(c=(a=r==null?void 0:r.rpcUrls)==null?void 0:a.default)==null?void 0:c.http)==null?void 0:l[0]}));f?(this.syncProvider({...f,chainNamespace:e}),await this.syncAccount({...f,chainNamespace:e}),this.setStatus("connected",e),ve.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:f.address,properties:{method:"browser",name:((u=o.info)==null?void 0:u.name)||o.name||"Unknown",reconnect:!0,view:me.state.view,walletRank:(d=o==null?void 0:o.explorerWallet)==null?void 0:d.order}})):this.setStatus("disconnected",e)}catch{this.onDisconnectNamespace({chainNamespace:e,closeModal:!1})}}async syncWalletConnectAccount(){var r,s;const e=Object.keys(((s=(r=this.universalProvider)==null?void 0:r.session)==null?void 0:s.namespaces)||{}),n=this.chainNamespaces.map(async i=>{var d,f,h,p,g;const o=this.getAdapter(i);if(!o)return;const a=((p=(h=(f=(d=this.universalProvider)==null?void 0:d.session)==null?void 0:f.namespaces)==null?void 0:h[i])==null?void 0:p.accounts)||[],c=(g=I.state.activeCaipNetwork)==null?void 0:g.id,l=a.find(m=>{const{chainId:E}=It.parseCaipAddress(m);return E===(c==null?void 0:c.toString())})||a[0];if(l){const m=It.validateCaipAddress(l),{chainId:E,address:A}=It.parseCaipAddress(m);if(Ye.setProviderId(i,on.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&I.state.activeCaipNetwork&&o.namespace!==B.CHAIN.EVM){const b=o.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:I.state.activeCaipNetwork});Ye.setProvider(i,b)}else Ye.setProvider(i,this.universalProvider);V.setConnectorId(B.CONNECTOR_ID.WALLET_CONNECT,i),W.addConnectedNamespace(i),await this.syncAccount({address:A,chainId:E,chainNamespace:i})}else e.includes(i)&&this.setStatus("disconnected",i);const u=this.getApprovedCaipNetworksData();this.syncConnectedWalletInfo(i),I.setApprovedCaipNetworksData(i,{approvedCaipNetworkIds:u.approvedCaipNetworkIds,supportsAllNetworks:u.supportsAllNetworks})});await Promise.all(n)}syncProvider({type:e,provider:n,id:r,chainNamespace:s}){Ye.setProviderId(s,e),Ye.setProvider(s,n),V.setConnectorId(r,s)}async syncAccount(e){var d,f;const n=e.chainNamespace===I.state.activeChain,r=I.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:s,chainId:i,chainNamespace:o}=e,{chainId:a}=W.getActiveNetworkProps(),c=(r==null?void 0:r.id)||a,l=((d=I.state.activeCaipNetwork)==null?void 0:d.name)===B.UNSUPPORTED_NETWORK_NAME,u=I.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(l&&!u)&&c){let h=this.getCaipNetworks().find(E=>E.id.toString()===c.toString()),p=this.getCaipNetworks().find(E=>E.chainNamespace===o);if(!u&&!h&&!p){const E=this.getApprovedCaipNetworkIds()||[],A=E.find(_=>{var C;return((C=It.parseCaipNetworkId(_))==null?void 0:C.chainId)===c.toString()}),b=E.find(_=>{var C;return((C=It.parseCaipNetworkId(_))==null?void 0:C.chainNamespace)===o});h=this.getCaipNetworks().find(_=>_.caipNetworkId===A),p=this.getCaipNetworks().find(_=>_.caipNetworkId===b||"deprecatedCaipNetworkId"in _&&_.deprecatedCaipNetworkId===b)}const g=h||p;(g==null?void 0:g.chainNamespace)===I.state.activeChain?F.state.enableNetworkSwitch&&!F.state.allowUnsupportedChain&&((f=I.state.activeCaipNetwork)==null?void 0:f.name)===B.UNSUPPORTED_NETWORK_NAME?I.showUnsupportedChainUI():this.setCaipNetwork(g):n||r&&this.setCaipNetworkOfNamespace(r,o),this.syncConnectedWalletInfo(o);const m=this.getAddress(o);As.isLowerCaseMatch(s,m)||this.syncAccountInfo(s,g==null?void 0:g.id,o),n?await this.syncBalance({address:s,chainId:g==null?void 0:g.id,chainNamespace:o}):await this.syncBalance({address:s,chainId:r==null?void 0:r.id,chainNamespace:o}),this.syncIdentity({address:s,chainId:i,chainNamespace:o})}}async syncAccountInfo(e,n,r){const s=this.getCaipAddress(r),i=n||(s==null?void 0:s.split(":")[1]);if(!i)return;const o=`${r}:${i}:${e}`;this.setCaipAddress(o,r,!0),await this.syncIdentity({address:e,chainId:i,chainNamespace:r})}async syncReownName(e,n){try{const r=await this.getReownName(e);if(r[0]){const s=r[0];this.setProfileName(s.name,n)}else this.setProfileName(null,n)}catch{this.setProfileName(null,n)}}syncConnectedWalletInfo(e){var s;const n=V.getConnectorId(e),r=Ye.getProviderId(e);if(r===on.CONNECTOR_TYPE_ANNOUNCED||r===on.CONNECTOR_TYPE_INJECTED){if(n){const o=this.getConnectors().find(a=>{var d,f;const c=a.id===n,l=((d=a.info)==null?void 0:d.rdns)===n,u=(f=a.connectors)==null?void 0:f.some(h=>{var p;return h.id===n||((p=h.info)==null?void 0:p.rdns)===n});return c||l||!!u});if(o){const{info:a,name:c,imageUrl:l}=o,u=l||this.getConnectorImage(o);this.setConnectedWalletInfo({name:c,icon:u,...a},e)}}}else if(r===on.CONNECTOR_TYPE_WALLET_CONNECT){const i=Ye.getProvider(e);i!=null&&i.session&&this.setConnectedWalletInfo({...i.session.peer.metadata,name:i.session.peer.metadata.name,icon:(s=i.session.peer.metadata.icons)==null?void 0:s[0]},e)}else if(n&&(n===B.CONNECTOR_ID.COINBASE_SDK||n===B.CONNECTOR_ID.COINBASE)){const i=this.getConnectors().find(l=>l.id===n),o=(i==null?void 0:i.name)||"Coinbase Wallet",a=(i==null?void 0:i.imageUrl)||this.getConnectorImage(i),c=i==null?void 0:i.info;this.setConnectedWalletInfo({...c,name:o,icon:a},e)}}async syncBalance(e){!xc.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(r=>{var s;return r.id.toString()===((s=e.chainId)==null?void 0:s.toString())})||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(e,n,r){const s=this.getAdapter(r),i=I.getCaipNetworkByNamespace(r,n);if(s){const o=await s.getBalance({address:e,chainId:n,caipNetwork:i,tokens:this.options.tokens});return this.setBalance(o.balance,o.symbol,r),o}}async initializeUniversalAdapter(){var s,i,o,a,c,l,u,d,f,h;const e=GK.createLogger((p,...g)=>{p&&this.handleAlertError(p),console.error(...g)}),n={projectId:(s=this.options)==null?void 0:s.projectId,metadata:{name:(i=this.options)!=null&&i.metadata?(o=this.options)==null?void 0:o.metadata.name:"",description:(a=this.options)!=null&&a.metadata?(c=this.options)==null?void 0:c.metadata.description:"",url:(l=this.options)!=null&&l.metadata?(u=this.options)==null?void 0:u.metadata.url:"",icons:(d=this.options)!=null&&d.metadata?(f=this.options)==null?void 0:f.metadata.icons:[""]},logger:e};F.setManualWCControl(!!((h=this.options)!=null&&h.manualWCControl)),this.universalProvider=this.options.universalProvider??await yK.init(n);const r=this.universalProvider.disconnect.bind(this.universalProvider);this.universalProvider.disconnect=async()=>{try{return await r()}catch(p){if(p instanceof Error&&p.message.includes("Missing or invalid. Record was recently deleted"))return;throw p}},F.state.enableReconnect===!1&&this.universalProvider.session&&await this.universalProvider.disconnect(),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&this.chainNamespaces.forEach(e=>{Os.listenWcProvider({universalProvider:this.universalProvider,namespace:e,onDisplayUri:n=>{Z.setUri(n)},onConnect:n=>{const{address:r}=Q.getAccount(n[0]);Z.finalizeWcConnection(r)},onDisconnect:()=>{I.state.noAdapters&&this.resetAccount(e),Z.resetWcConnection()},onChainChanged:n=>{const r=I.state.activeChain,s=r&&V.state.activeConnectorIds[r]===B.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(I.state.noAdapters||s)){const i=this.getCaipNetworks().find(a=>a.id.toString()===n.toString()||a.caipNetworkId.toString()===n.toString()),o=this.getCaipNetwork();if(!i){this.setUnsupportedNetwork(n);return}(o==null?void 0:o.id.toString())!==(i==null?void 0:i.id.toString())&&(o==null?void 0:o.chainNamespace)===(i==null?void 0:i.chainNamespace)&&this.setCaipNetwork(i)}},onAccountsChanged:n=>{const r=I.state.activeChain,s=r&&V.state.activeConnectorIds[r]===B.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(I.state.noAdapters||s)){const i=n==null?void 0:n[0];i&&this.syncAccount({address:i.address,chainId:i.chainId,chainNamespace:i.chainNamespace})}}})})}createUniversalProvider(){var e;return!this.universalProviderInitPromise&&Q.isClient()&&((e=this.options)!=null&&e.projectId)&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){ve.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}getDisabledCaipNetworks(){const e=I.getAllApprovedCaipNetworkIds(),n=I.getAllRequestedCaipNetworks();return Q.sortRequestedNetworks(e,n).filter(s=>I.isCaipNetworkDisabled(s))}handleAlertError(e){const n=Object.entries(rt.UniversalProviderErrors).find(([,{message:a}])=>e.message.includes(a)),[r,s]=n??[],{message:i,alertErrorKey:o}=s??{};if(r&&i&&!this.reportedAlertErrors[r]){const a=rt.ALERT_ERRORS[o];a&&(ct.open(a,"error"),this.reportedAlertErrors[r]=!0)}}getAdapter(e){var n;if(e)return(n=this.chainAdapters)==null?void 0:n[e]}createAdapter(e){var s,i;if(!e)return;const n=e.namespace;if(!n)return;this.createClients();const r=e;r.namespace=n,r.construct({namespace:n,projectId:(s=this.options)==null?void 0:s.projectId,networks:(i=this.caipNetworks)==null?void 0:i.filter(({chainNamespace:o})=>o===n)}),this.chainNamespaces.includes(n)||this.chainNamespaces.push(n),this.chainAdapters&&(this.chainAdapters[n]=r)}async open(e){await this.injectModalUi(),e!=null&&e.uri&&Z.setUri(e.uri);const{isSwap:n,isSend:r}=this.toModalOptions();return n(e)?Pe.open({...e,data:{swap:e.arguments}}):r(e)&&e.arguments?this.openSend(e.arguments):Pe.open(e)}async close(){await this.injectModalUi(),Pe.close()}setLoading(e,n){Pe.setLoading(e,n)}async disconnect(e){await Z.disconnect({namespace:e})}getSIWX(){return F.state.siwx}getError(){return""}getChainId(){var e;return(e=I.state.activeCaipNetwork)==null?void 0:e.id}async switchNetwork(e,{throwOnFailure:n=!1}={}){const r=this.getCaipNetworks().find(s=>s.id===e.id);if(!r){ct.open(rt.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await I.switchActiveNetwork(r,{throwOnFailure:n})}getWalletProvider(){return I.state.activeChain?Ye.state.providers[I.state.activeChain]:null}getWalletProviderType(){return Ye.getProviderId(I.state.activeChain)}subscribeProviders(e){return Ye.subscribeProviders(e)}getThemeMode(){return En.state.themeMode}getThemeVariables(){return En.state.themeVariables}setThemeMode(e){En.setThemeMode(e),F0(En.state.themeMode)}setTermsConditionsUrl(e){F.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){F.setPrivacyPolicyUrl(e)}setThemeVariables(e){En.setThemeVariables(e),_G(En.state.themeVariables)}subscribeTheme(e){return En.subscribe(e)}subscribeConnections(e){return this.remoteFeatures.multiWallet?Z.subscribe(e):(ct.open(B.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),()=>{})}getWalletInfo(e){var r,s;if(e)return(s=(r=I.state.chains.get(e))==null?void 0:r.accountState)==null?void 0:s.connectedWalletInfo;const n=I.getAccountData();return n==null?void 0:n.connectedWalletInfo}getAccount(e){const n=e||I.state.activeChain,r=V.getAuthConnector(n),s=I.getAccountData(n),i=W.getConnectedConnectorId(I.state.activeChain),o=Z.getConnections(n);if(!n)throw new Error("AppKit:getAccount - namespace is required");const a=o.flatMap(c=>c.accounts.map(({address:l,type:u,publicKey:d})=>Q.createAccount(n,l,u||"eoa",d)));if(s)return{allAccounts:a,caipAddress:s.caipAddress,address:Q.getPlainAddress(s.caipAddress),isConnected:!!s.caipAddress,status:s.status,embeddedWalletInfo:r&&i===B.CONNECTOR_ID.AUTH?{user:s.user?{...s.user,username:W.getConnectedSocialUsername()}:void 0,authProvider:s.socialProvider||"email",accountType:an(n),isSmartAccountDeployed:!!s.smartAccountDeployed}:void 0}}subscribeAccount(e,n){const r=()=>{const s=this.getAccount(n);s&&e(s)};n?I.subscribeChainProp("accountState",r,n):I.subscribe(r),V.subscribe(r)}subscribeNetwork(e){return I.subscribe(({activeCaipNetwork:n})=>{e({caipNetwork:n,chainId:n==null?void 0:n.id,caipNetworkId:n==null?void 0:n.caipNetworkId})})}subscribeWalletInfo(e,n){return n?I.subscribeChainProp("accountState",r=>e(r==null?void 0:r.connectedWalletInfo),n):I.subscribeChainProp("accountState",r=>e(r==null?void 0:r.connectedWalletInfo))}subscribeShouldUpdateToAddress(e){I.subscribeChainProp("accountState",n=>e(n==null?void 0:n.shouldUpdateToAddress))}subscribeCaipNetworkChange(e){I.subscribeKey("activeCaipNetwork",e)}getState(){return Wn.state}getRemoteFeatures(){return F.state.remoteFeatures}subscribeState(e){return Wn.subscribe(e)}subscribeRemoteFeatures(e){return F.subscribeKey("remoteFeatures",e)}showErrorMessage(e){Hr.showError(e)}showSuccessMessage(e){Hr.showSuccess(e)}getEvent(){return{...ve.state}}subscribeEvents(e){return ve.subscribe(e)}replace(e){me.replace(e)}redirect(e){me.push(e)}popTransactionStack(e){me.popTransactionStack(e)}isOpen(){return Pe.state.open}isTransactionStackEmpty(){return me.state.transactionStack.length===0}static getInstance(){return this.instance}updateFeatures(e){F.setFeatures(e)}updateRemoteFeatures(e){F.setRemoteFeatures(e)}updateOptions(e){const r={...F.state||{},...e};F.setOptions(r)}setConnectMethodsOrder(e){F.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){F.setWalletFeaturesOrder(e)}setCollapseWallets(e){F.setCollapseWallets(e)}setSocialsOrder(e){F.setSocialsOrder(e)}getConnectMethodsOrder(){return mi.getConnectOrderMethod(F.state.features,V.getConnectors())}addNetwork(e,n){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const r=this.extendCaipNetwork(n,this.options);this.getCaipNetworks().find(s=>s.id===r.id)||I.addNetwork(r)}removeNetwork(e,n){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(s=>s.id===n)&&I.removeNetwork(e,n)}}let J1=!1;class NG extends xG{async onAuthProviderConnected(e){const n=As.userChainIdToChainNamespace(e==null?void 0:e.chainId);if(e.message&&e.signature&&e.siwxMessage&&await Fn.addEmbeddedWalletSession({chainId:e.siwxMessage.chainId,accountAddress:e.address,notBefore:e.siwxMessage.notBefore,statement:e.siwxMessage.statement,resources:e.siwxMessage.resources,requestId:e.siwxMessage.requestId,issuedAt:e.siwxMessage.issuedAt,domain:e.siwxMessage.domain,uri:e.siwxMessage.uri,version:e.siwxMessage.version,nonce:e.siwxMessage.nonce},e.message,e.signature),!n)throw new Error("AppKit:onAuthProviderConnected - namespace is required");const r=n===B.CHAIN.EVM?`eip155:${e.chainId}:${e.address}`:`${e.chainId}:${e.address}`,s=F.state.defaultAccountTypes[n],i=an(n),o=e.preferredAccountType||i||s;this.setCaipAddress(r,n);const{signature:a,siwxMessage:c,message:l,...u}=e,d=I.getAccountData(n);this.setUser({...(d==null?void 0:d.user)||{},...u},n),this.setSmartAccountDeployed(!!e.smartAccountDeployed,n),this.setPreferredAccountType(o,n),await Promise.all([this.syncAuthConnectorTheme(this.authProvider),this.syncAccount({address:e.address,chainId:e.chainId,chainNamespace:n})]),this.setLoading(!1,n)}setupAuthConnectorListeners(e){e.onRpcRequest(n=>{Hn.checkIfRequestExists(n)?Hn.checkIfRequestIsSafe(n)||this.handleUnsafeRPCRequest():(this.open(),console.error(ft.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:n.method}),setTimeout(()=>{this.showErrorMessage(ft.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),e.rejectRpcRequests())}),e.onRpcError(()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close():this.popTransactionStack("error"))}),e.onRpcSuccess((n,r)=>{const s=Hn.checkIfRequestIsSafe(r),i=this.getAddress(),o=I.state.activeCaipNetwork;s||(i&&(o!=null&&o.id)&&this.updateNativeBalance(i,o.id,o.chainNamespace),this.isTransactionStackEmpty()?this.close():this.popTransactionStack("success"))}),e.onNotConnected(()=>{const n=I.state.activeChain;if(!n)throw new Error("AppKit:onNotConnected - namespace is required");V.getConnectorId(n)===B.CONNECTOR_ID.AUTH&&(this.setCaipAddress(null,n),this.setLoading(!1,n))}),e.onConnect(this.onAuthProviderConnected.bind(this)),e.onSocialConnected(this.onAuthProviderConnected.bind(this)),e.onSetPreferredAccount(({address:n,type:r})=>{const s=I.state.activeChain;if(!s)throw new Error("AppKit:onSetPreferredAccount - namespace is required");n&&this.setPreferredAccountType(r,s)})}async syncAuthConnectorTheme(e){if(!e)return;const n=En.getSnapshot();await e.syncTheme({themeMode:n.themeMode,themeVariables:n.themeVariables,w3mThemeVariables:Nc(n.themeVariables,n.themeMode)})}async syncAuthConnector(e,n){var u,d,f,h,p,g,m,E,A;const r=B.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(n),s=n===I.state.activeChain;if(!r)return;this.setLoading(!0,n);const i=e.getLoginEmailUsed();this.setLoading(i,n),i&&this.setStatus("connecting",n);const o=e.getEmail(),a=e.getUsername(),c=((u=I.getAccountData(n))==null?void 0:u.user)||{};this.setUser({...c,username:a,email:o},n),this.setupAuthConnectorListeners(e);const{isConnected:l}=await e.isConnected();if(n&&r&&s)if(l&&((d=this.connectionControllerClient)!=null&&d.connectExternal)){await e.init(),await this.syncAuthConnectorTheme(e),await((p=this.connectionControllerClient)==null?void 0:p.connectExternal({id:B.CONNECTOR_ID.AUTH,info:{name:B.CONNECTOR_ID.AUTH},type:on.CONNECTOR_TYPE_AUTH,provider:e,chainId:(h=(f=I.getNetworkData(n))==null?void 0:f.caipNetwork)==null?void 0:h.id,chain:n})),this.setStatus("connected",n);const b=W.getConnectedSocialProvider();b?ve.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",address:this.getAddress(),properties:{provider:b,reconnect:!0}}):ve.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:this.getAddress(),properties:{method:"email",name:((A=(E=(m=(g=this.universalProvider)==null?void 0:g.session)==null?void 0:m.peer)==null?void 0:E.metadata)==null?void 0:A.name)||"Unknown",reconnect:!0,view:me.state.view,walletRank:void 0}})}else V.getConnectorId(n)===B.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",n),W.removeConnectedNamespace(n));this.setLoading(!1,n)}async checkExistingTelegramSocialConnection(e){var n;try{if(!Q.isTelegram())return;const r=W.getTelegramSocialProvider();if(!r||!Q.isClient())return;const i=new URL(window.location.href).searchParams.get("result_uri");if(!i)return;r&&I.setAccountProp("socialProvider",r,e),await((n=this.authProvider)==null?void 0:n.init());const o=V.getAuthConnector();r&&o&&(this.setLoading(!0,e),await Z.connectExternal({id:o.id,type:o.type,socialUri:i},o.chain),W.setConnectedSocialProvider(r),W.removeTelegramSocialProvider(),ve.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:r}}))}catch(r){this.setLoading(!1,e),console.error("checkExistingSTelegramocialConnection error",r)}try{const r=new URL(window.location.href);r.searchParams.delete("result_uri"),window.history.replaceState({},document.title,r.toString())}catch(r){console.error("tma social login failed",r)}}createAuthProvider(e){var l,u,d,f;if(!B.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;const r=(l=this.remoteFeatures)==null?void 0:l.email,s=Array.isArray((u=this.remoteFeatures)==null?void 0:u.socials)&&this.remoteFeatures.socials.length>0,i=r||s,a=As.getActiveNamespaceConnectedToAuth()||e;!this.authProvider&&((d=this.options)!=null&&d.projectId)&&i&&(this.authProvider=ao.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:(f=this.getCaipNetwork(a))==null?void 0:f.caipNetworkId,abortController:rt.EmbeddedWalletAbortController,onTimeout:h=>{h==="iframe_load_failed"?ct.open(rt.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):h==="iframe_request_timeout"?ct.open(rt.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):h==="unverified_domain"&&ct.open(rt.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:h=>Cs(h),getCaipNetworks:h=>I.getCaipNetworks(h)}),Wn.subscribeOpen(h=>{var p;!h&&this.isTransactionStackEmpty()&&((p=this.authProvider)==null||p.rejectRpcRequests())}));const c=e===I.state.activeChain&&F.state.enableReconnect;F.state.enableReconnect===!1?this.syncAuthConnectorTheme(this.authProvider):this.authProvider&&c&&(this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){var n,r,s;this.createAuthProvider(e),this.authProvider&&((s=(r=(n=this.chainAdapters)==null?void 0:n[e])==null?void 0:r.setAuthProvider)==null||s.call(r,this.authProvider))}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&se.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){var o,a,c;if(!e)return;const n=I.state.activeChain,r=e.chainNamespace,s=this.getAddressByChainNamespace(r);if(r===n&&((o=I.getAccountData(r))!=null&&o.caipAddress)){const l=this.getAdapter(r);await(l==null?void 0:l.switchNetwork({caipNetwork:e})),this.setCaipNetwork(e)}else{const u=Ye.getProviderId(n)===on.CONNECTOR_TYPE_AUTH,d=Ye.getProviderId(r),f=d===on.CONNECTOR_TYPE_AUTH,h=B.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(r);if(!r)throw new Error("AppKit:switchCaipNetwork - networkNamespace is required");if((u&&d===void 0||f)&&h)try{if(I.state.activeChain=e.chainNamespace,s){const p=this.getAdapter(r);await(p==null?void 0:p.switchNetwork({caipNetwork:e}))}else await((c=(a=this.connectionControllerClient)==null?void 0:a.connectExternal)==null?void 0:c.call(a,{id:B.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:r,chainId:e.id,type:on.CONNECTOR_TYPE_AUTH,caipNetwork:e}));this.setCaipNetwork(e)}catch{const g=this.getAdapter(r);await(g==null?void 0:g.switchNetwork({caipNetwork:e}))}else if(d===on.CONNECTOR_TYPE_WALLET_CONNECT){if(!I.state.noAdapters){const p=this.getAdapter(r);await(p==null?void 0:p.switchNetwork({caipNetwork:e}))}this.setCaipNetwork(e),this.syncWalletConnectAccount()}else this.setCaipNetwork(e),s&&this.syncAccount({address:s,chainId:e.id,chainNamespace:r})}}async initialize(e){var n;await super.initialize(e),(n=this.chainNamespaces)==null||n.forEach(r=>{this.createAuthProviderForAdapter(r)}),await this.injectModalUi(),Wn.set({initialized:!0})}async syncIdentity({address:e,chainId:n,chainNamespace:r}){var a;const s=`${r}:${n}`,i=(a=this.caipNetworks)==null?void 0:a.find(c=>c.caipNetworkId===s);if(i!=null&&i.testnet){this.setProfileName(null,r),this.setProfileImage(null,r);return}const o=V.getConnectorId(r)===B.CONNECTOR_ID.AUTH;try{const{name:c,avatar:l}=await this.fetchIdentity({address:e});!c&&o?await this.syncReownName(e,r):(this.setProfileName(c,r),this.setProfileImage(l,r))}catch{n!==1&&this.setProfileImage(null,r)}}syncConnectedWalletInfo(e){const n=Ye.getProviderId(e);if(n===on.CONNECTOR_TYPE_AUTH){const r=this.authProvider;if(r){const s=W.getConnectedSocialProvider()??"email",i=r.getEmail()??r.getUsername();this.setConnectedWalletInfo({name:n,identifier:i,social:s},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(Q.isClient()&&!J1)try{const e={...Oe.DEFAULT_FEATURES,...this.options.features},n=this.remoteFeatures;if(await this.loadModalComponents(e,n),Q.isClient()&&!document.querySelector("w3m-modal")){const s=document.createElement("w3m-modal");!F.state.disableAppend&&!F.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",s)}J1=!0}catch(e){console.error("Error injecting modal UI:",e)}}async loadModalComponents(e,n){if(!Q.isClient())return;const r=[];(n.email||n.socials&&n.socials.length>0)&&r.push(_t(()=>import("./embedded-wallet-BxjSnX0n.js"),__vite__mapDeps([6,7,8,9,10,11,12,13,14,15,16,17,18,19]))),n.email&&r.push(_t(()=>import("./email-Rdhs9bHd.js"),__vite__mapDeps([20,7,21,18,11,17,9,10,16,22,14]))),n.socials&&r.push(_t(()=>import("./socials-kOj-qu62.js"),__vite__mapDeps([23,7,9,24,10,25,17,26,13,16,11,27,8,28]))),n.swaps&&n.swaps.length>0&&r.push(_t(()=>import("./swaps-ydseLVsp.js"),__vite__mapDeps([29,7,16,11,17,9,30,31,32,28,33,8,14,10]))),e.send&&r.push(_t(()=>import("./send-DXxRzXfJ.js"),__vite__mapDeps([34,7,16,11,17,9,35,10,36,18,33,8,28,32,14,37,38]))),e.receive&&r.push(_t(()=>import("./receive-BTJfq6vp.js"),__vite__mapDeps([39,7,9,8,27]))),n.onramp&&n.onramp.length>0&&r.push(_t(()=>import("./onramp-GYjv5BN7.js"),__vite__mapDeps([40,7,9,41,11,24,10,8,42,43,18,16,17,26,14]))),n.payWithExchange&&r.push(_t(()=>import("./pay-with-exchange-TZ_iRJtk.js"),__vite__mapDeps([44,7,9,8,15,41,11,28,16,36,10,18,45,17,14,37,35]))),n.activity&&r.push(_t(()=>import("./transactions-BD7WJ1x8.js"),__vite__mapDeps([46,7,47,17,9,18,8,28]))),(e.pay||n.payments)&&r.push(_t(()=>import("./index-DIAf_Gi5.js"),__vite__mapDeps([48,7,9,16,11,49,15,8,41,50,35,51,17,26]))),n.emailCapture&&r.push(_t(()=>import("./data-capture-B2IXCRVc.js"),__vite__mapDeps([52,7,21,18,11,53]))),await Promise.all([...r,_t(()=>import("./index-xh0ZPyKN.js"),__vite__mapDeps([54,7,9,8,11,38,17,55,43,18,12,13,51,15,41,16,45,47,28,37,30,31,35,10,14,50,22,24,25,26,27,19,42])),_t(()=>import("./w3m-modal-BMmZVRKH.js"),__vite__mapDeps([56,7,9,49,8,12,13,11,17,31,55,43,18,51,32,16]))])}}const TG="1.8.15";function OG(t){return new NG({...t,sdkVersion:Q.generateSdkVersion(t.adapters??[],"html",TG)})}function Sr(t,e,n){const r=t[e.name];if(typeof r=="function")return r;const s=t[n];return typeof s=="function"?s:i=>e(t,i)}const Zu="3.0.1",RG=()=>`@wagmi/core@${Zu}`;var hI=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},jd,pI;class Tr extends Error{get docsBaseUrl(){return"https://wagmi.sh/core"}get version(){return RG()}constructor(e,n={}){var i;super(),jd.add(this),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WagmiCoreError"});const r=n.cause instanceof Tr?n.cause.details:(i=n.cause)!=null&&i.message?n.cause.message:n.details,s=n.cause instanceof Tr&&n.cause.docsPath||n.docsPath;this.message=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...s?[`Docs: ${this.docsBaseUrl}${s}.html${n.docsSlug?`#${n.docsSlug}`:""}`]:[],...r?[`Details: ${r}`]:[],`Version: ${this.version}`].join(`
`),n.cause&&(this.cause=n.cause),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.shortMessage=e}walk(e){return hI(this,jd,"m",pI).call(this,this,e)}}jd=new WeakSet,pI=function t(e,n){return n!=null&&n(e)?e:e.cause?hI(this,jd,"m",t).call(this,e.cause,n):e};class wl extends Tr{constructor(){super("Chain not configured."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ChainNotConfiguredError"})}}class PG extends Tr{constructor(){super("Connector already connected."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorAlreadyConnectedError"})}}class kG extends Tr{constructor(){super("Connector not connected."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorNotConnectedError"})}}class DG extends Tr{constructor({address:e,connector:n}){super(`Account "${e}" not found for connector "${n.name}".`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorAccountNotFoundError"})}}class $G extends Tr{constructor({connectionChainId:e,connectorChainId:n}){super(`The current chain of the connector (id: ${n}) does not match the connection's chain (id: ${e}).`,{metaMessages:[`Current Chain ID:  ${n}`,`Expected Chain ID: ${e}`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorChainMismatchError"})}}class UG extends Tr{constructor({connector:e}){super(`Connector "${e.name}" unavailable while reconnecting.`,{details:["During the reconnection step, the only connector methods guaranteed to be available are: `id`, `name`, `type`, `uid`.","All other methods are not guaranteed to be available until reconnection completes and connectors are fully restored.","This error commonly occurs for connectors that asynchronously inject after reconnection has already started."].join(" ")}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorUnavailableReconnectingError"})}}async function ap(t,e){var r;let n;if(typeof e.connector=="function"?n=t._internal.connectors.setup(e.connector):n=e.connector,n.uid===t.state.current)throw new PG;try{t.setState(a=>({...a,status:"connecting"})),n.emitter.emit("message",{type:"connecting"});const{connector:s,...i}=e,o=await n.connect(i);return n.emitter.off("connect",t._internal.events.connect),n.emitter.on("change",t._internal.events.change),n.emitter.on("disconnect",t._internal.events.disconnect),await((r=t.storage)==null?void 0:r.setItem("recentConnectorId",n.id)),t.setState(a=>({...a,connections:new Map(a.connections).set(n.uid,{accounts:i.withCapabilities?o.accounts.map(c=>typeof c=="object"?c.address:c):o.accounts,chainId:o.chainId,connector:n}),current:n.uid,status:"connected"})),{accounts:i.withCapabilities?o.accounts.map(a=>typeof a=="object"?a:{address:a,capabilities:{}}):o.accounts,chainId:o.chainId}}catch(s){throw t.setState(i=>({...i,status:i.current?"connected":"disconnected"})),s}}async function Rf(t,e={}){const{assertChainId:n=!0}=e;let r;if(e.connector){const{connector:u}=e;if(t.state.status==="reconnecting"&&!u.getAccounts&&!u.getChainId)throw new UG({connector:u});const[d,f]=await Promise.all([u.getAccounts().catch(h=>{if(e.account===null)return[];throw h}),u.getChainId()]);r={accounts:d,chainId:f,connector:u}}else r=t.state.connections.get(t.state.current);if(!r)throw new kG;const s=e.chainId??r.chainId,i=await r.connector.getChainId();if(n&&i!==s)throw new $G({connectionChainId:s,connectorChainId:i});const o=r.connector;if(o.getClient)return o.getClient({chainId:s});const a=sr(e.account??r.accounts[0]);if(a&&(a.address=Yi(a.address)),e.account&&!r.accounts.some(u=>u.toLowerCase()===a.address.toLowerCase()))throw new DG({address:a.address,connector:o});const c=t.chains.find(u=>u.id===s),l=await r.connector.getProvider({chainId:s});return sC({account:a,chain:c,name:"Connector Client",transport:u=>o8(l)({...u,retryCount:0})})}async function X1(t,e={}){var s,i;let n;if(e.connector)n=e.connector;else{const{connections:o,current:a}=t.state,c=o.get(a);n=c==null?void 0:c.connector}const r=t.state.connections;n&&(await n.disconnect(),n.emitter.off("change",t._internal.events.change),n.emitter.off("disconnect",t._internal.events.disconnect),n.emitter.on("connect",t._internal.events.connect),r.delete(n.uid)),t.setState(o=>{if(r.size===0)return{...o,connections:new Map,current:null,status:"disconnected"};const a=r.values().next().value;return{...o,connections:new Map(r),current:a.connector.uid}});{const o=t.state.current;if(!o)return;const a=(s=t.state.connections.get(o))==null?void 0:s.connector;if(!a)return;await((i=t.storage)==null?void 0:i.setItem("recentConnectorId",a.id))}}async function BG(t,e){const{chainId:n,connector:r,...s}=e;let i;e.account?i=e.account:i=(await Rf(t,{account:e.account,assertChainId:!1,chainId:n,connector:r})).account;const o=t.getClient({chainId:n});return Sr(o,Dv,"estimateGas")({...s,account:i})}async function LG(t,e){const{address:n,blockNumber:r,blockTag:s,chainId:i}=e,o=t.getClient({chainId:i}),c=await Sr(o,BO,"getBalance")(r?{address:n,blockNumber:r}:{address:n,blockTag:s}),l=t.chains.find(u=>u.id===i)??o.chain;return{decimals:l.nativeCurrency.decimals,symbol:l.nativeCurrency.symbol,value:c}}function El(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;let n,r;if(Array.isArray(t)&&Array.isArray(e)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!El(t[r],e[r]))return!1;return!0}if(typeof t.valueOf=="function"&&t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(typeof t.toString=="function"&&t.toString!==Object.prototype.toString)return t.toString()===e.toString();const s=Object.keys(t);if(n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!Object.hasOwn(e,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(i&&!El(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function da(t){const e=t.state.current,n=t.state.connections.get(e),r=n==null?void 0:n.accounts,s=r==null?void 0:r[0],i=t.chains.find(a=>a.id===(n==null?void 0:n.chainId)),o=t.state.status;switch(o){case"connected":return{address:s,addresses:r,chain:i,chainId:n==null?void 0:n.chainId,connector:n==null?void 0:n.connector,isConnected:!0,isConnecting:!1,isDisconnected:!1,isReconnecting:!1,status:o};case"reconnecting":return{address:s,addresses:r,chain:i,chainId:n==null?void 0:n.chainId,connector:n==null?void 0:n.connector,isConnected:!!s,isConnecting:!1,isDisconnected:!1,isReconnecting:!0,status:o};case"connecting":return{address:s,addresses:r,chain:i,chainId:n==null?void 0:n.chainId,connector:n==null?void 0:n.connector,isConnected:!1,isConnecting:!0,isDisconnected:!1,isReconnecting:!1,status:o};case"disconnected":return{address:void 0,addresses:void 0,chain:void 0,chainId:void 0,connector:void 0,isConnected:!1,isConnecting:!1,isDisconnected:!0,isReconnecting:!1,status:o}}}let Pu=[];function gs(t){const e=[...t.state.connections.values()];return t.state.status==="reconnecting"||El(Pu,e)?Pu:(Pu=e,e)}async function MG(t,e){const{account:n,chainId:r,...s}=e,i=n??da(t).address,o=t.getClient({chainId:r});return Sr(o,hg,"prepareTransactionRequest")({...s,...i?{account:i}:{}})}function ku(t,e){const{chainId:n,...r}=e,s=t.getClient({chainId:n});return Sr(s,CO,"readContract")(r)}let cp=!1;async function lp(t,e={}){var l,u;if(cp)return[];cp=!0,t.setState(d=>({...d,status:d.current?"reconnecting":"connecting"}));const n=[];if((l=e.connectors)!=null&&l.length)for(const d of e.connectors){let f;typeof d=="function"?f=t._internal.connectors.setup(d):f=d,n.push(f)}else n.push(...t.connectors);let r;try{r=await((u=t.storage)==null?void 0:u.getItem("recentConnectorId"))}catch{}const s={};for(const[,d]of t.state.connections)s[d.connector.id]=1;r&&(s[r]=0);const i=Object.keys(s).length>0?[...n].sort((d,f)=>(s[d.id]??10)-(s[f.id]??10)):n;let o=!1;const a=[],c=[];for(const d of i){const f=await d.getProvider().catch(()=>{});if(!f||c.some(g=>g===f)||!await d.isAuthorized())continue;const p=await d.connect({isReconnecting:!0}).catch(()=>null);p&&(d.emitter.off("connect",t._internal.events.connect),d.emitter.on("change",t._internal.events.change),d.emitter.on("disconnect",t._internal.events.disconnect),t.setState(g=>{const m=new Map(o?g.connections:new Map).set(d.uid,{accounts:p.accounts,chainId:p.chainId,connector:d});return{...g,current:o?g.current:d.uid,connections:m}}),a.push({accounts:p.accounts,chainId:p.chainId,connector:d}),c.push(f),o=!0)}return(t.state.status==="reconnecting"||t.state.status==="connecting")&&(o?t.setState(d=>({...d,status:"connected"})):t.setState(d=>({...d,connections:new Map,current:null,status:"disconnected"}))),cp=!1,a}async function FG(t,e){const{account:n,chainId:r,connector:s,...i}=e;let o;return typeof n=="object"&&(n==null?void 0:n.type)==="local"?o=t.getClient({chainId:r}):o=await Rf(t,{account:n??void 0,assertChainId:!1,chainId:r,connector:s}),await Sr(o,tC,"sendTransaction")({...i,...n?{account:n}:{},chain:r?{id:r}:null,gas:i.gas??void 0})}async function jG(t,e){const{account:n,connector:r,...s}=e;let i;return typeof n=="object"&&n.type==="local"?i=t.getClient():i=await Rf(t,{account:n,connector:r}),Sr(i,i8,"signMessage")({...s,...n?{account:n}:{}})}class ai extends Tr{constructor(){super("Provider not found."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ProviderNotFoundError"})}}class HG extends Tr{constructor({connector:e}){super(`"${e.name}" does not support programmatic chain switching.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SwitchChainNotSupportedError"})}}async function Q1(t,e){var o;const{addEthereumChainParameter:n,chainId:r}=e,s=t.state.connections.get(((o=e.connector)==null?void 0:o.uid)??t.state.current);if(s){const a=s.connector;if(!a.switchChain)throw new HG({connector:a});return await a.switchChain({addEthereumChainParameter:n,chainId:r})}const i=t.chains.find(a=>a.id===r);if(!i)throw new wl;return t.setState(a=>({...a,chainId:r})),i}async function gI(t,e){const{chainId:n,timeout:r=0,...s}=e,i=t.getClient({chainId:n}),a=await Sr(i,r8,"waitForTransactionReceipt")({...s,timeout:r});if(a.status==="reverted"){const c=Sr(i,aC,"getTransaction"),{from:l,...u}=await c({hash:a.transactionHash}),f=await Sr(i,Xv,"call")({...u,account:l,data:u.input,gasPrice:u.type!=="eip1559"?u.gasPrice:void 0,maxFeePerGas:u.type==="eip1559"?u.maxFeePerGas:void 0,maxPriorityFeePerGas:u.type==="eip1559"?u.maxPriorityFeePerGas:void 0}),h=f!=null&&f.data?EN(`0x${f.data.substring(138)}`):"unknown reason";throw new Error(h)}return{...a,chainId:i.chain.id}}function mI(t,e){const{onChange:n}=e;return t.subscribe(()=>da(t),n,{equalityFn(r,s){const{connector:i,...o}=r,{connector:a,...c}=s;return El(o,c)&&(i==null?void 0:i.id)===(a==null?void 0:a.id)&&(i==null?void 0:i.uid)===(a==null?void 0:a.uid)}})}function WG(t,e){const{onChange:n}=e;return t.subscribe(()=>gs(t),n,{equalityFn:El})}function zG(t,e){const{onChange:n}=e;return t._internal.connectors.subscribe((r,s)=>{n(Object.values(r),s)})}function qG(t,e){const{syncConnectedChain:n=t._internal.syncConnectedChain,...r}=e;let s;const i=c=>{s&&s();const l=t.getClient({chainId:c});return s=Sr(l,s8,"watchPendingTransactions")(r),s},o=i(e.chainId);let a;return n&&!e.chainId&&(a=t.subscribe(({chainId:c})=>c,async c=>i(c))),()=>{o==null||o(),a==null||a()}}async function yI(t,e){const{account:n,chainId:r,connector:s,...i}=e;let o;return typeof n=="object"&&(n==null?void 0:n.type)==="local"?o=t.getClient({chainId:r}):o=await Rf(t,{account:n??void 0,assertChainId:!1,chainId:r,connector:s}),await Sr(o,md,"writeContract")({...i,...n?{account:n}:{},chain:r?{id:r}:null})}function YJ(t){return t}Pf.type="injected";function Pf(t={}){const{shimDisconnect:e=!0,unstable_shimAsyncInject:n}=t;function r(){const c=t.target;if(typeof c=="function"){const l=c();if(l)return l}return typeof c=="object"?c:typeof c=="string"?{...VG[c]??{id:c,name:`${c[0].toUpperCase()}${c.slice(1)}`,provider:`is${c[0].toUpperCase()}${c.slice(1)}`}}:{id:"injected",name:"Injected",provider(l){return l==null?void 0:l.ethereum}}}let s,i,o,a;return c=>({get icon(){return r().icon},get id(){return r().id},get name(){return r().name},type:Pf.type,async setup(){const l=await this.getProvider();l!=null&&l.on&&t.target&&(o||(o=this.onConnect.bind(this),l.on("connect",o)),s||(s=this.onAccountsChanged.bind(this),l.on("accountsChanged",s)))},async connect({chainId:l,isReconnecting:u,withCapabilities:d}={}){var p,g,m,E,A,b;const f=await this.getProvider();if(!f)throw new ai;let h=[];if(u)h=await this.getAccounts().catch(()=>[]);else if(e)try{h=(E=(m=(g=(p=(await f.request({method:"wallet_requestPermissions",params:[{eth_accounts:{}}]}))[0])==null?void 0:p.caveats)==null?void 0:g[0])==null?void 0:m.value)==null?void 0:E.map(C=>Yi(C)),h.length>0&&(h=await this.getAccounts())}catch(_){const C=_;if(C.code===lt.code)throw new lt(C);if(C.code===bi.code)throw C}try{!(h!=null&&h.length)&&!u&&(h=(await f.request({method:"eth_requestAccounts"})).map(S=>Yi(S))),o&&(f.removeListener("connect",o),o=void 0),s||(s=this.onAccountsChanged.bind(this),f.on("accountsChanged",s)),i||(i=this.onChainChanged.bind(this),f.on("chainChanged",i)),a||(a=this.onDisconnect.bind(this),f.on("disconnect",a));let _=await this.getChainId();if(l&&_!==l){const C=await this.switchChain({chainId:l}).catch(S=>{if(S.code===lt.code)throw S;return{id:_}});_=(C==null?void 0:C.id)??_}return e&&await((A=c.storage)==null?void 0:A.removeItem(`${this.id}.disconnected`)),t.target||await((b=c.storage)==null?void 0:b.setItem("injected.connected",!0)),{accounts:d?h.map(C=>({address:C,capabilities:{}})):h,chainId:_}}catch(_){const C=_;throw C.code===lt.code?new lt(C):C.code===bi.code?new bi(C):C}},async disconnect(){var u,d;const l=await this.getProvider();if(!l)throw new ai;i&&(l.removeListener("chainChanged",i),i=void 0),a&&(l.removeListener("disconnect",a),a=void 0),o||(o=this.onConnect.bind(this),l.on("connect",o));try{await oC(()=>l.request({method:"wallet_revokePermissions",params:[{eth_accounts:{}}]}),{timeout:100})}catch{}e&&await((u=c.storage)==null?void 0:u.setItem(`${this.id}.disconnected`,!0)),t.target||await((d=c.storage)==null?void 0:d.removeItem("injected.connected"))},async getAccounts(){const l=await this.getProvider();if(!l)throw new ai;return(await l.request({method:"eth_accounts"})).map(d=>Yi(d))},async getChainId(){const l=await this.getProvider();if(!l)throw new ai;const u=await l.request({method:"eth_chainId"});return Number(u)},async getProvider(){if(typeof window>"u")return;let l;const u=r();return typeof u.provider=="function"?l=u.provider(window):typeof u.provider=="string"?l=Ju(window,u.provider):l=u.provider,l&&!l.removeListener&&("off"in l&&typeof l.off=="function"?l.removeListener=l.off:l.removeListener=()=>{}),l},async isAuthorized(){var l,u;try{if(e&&await((l=c.storage)==null?void 0:l.getItem(`${this.id}.disconnected`))||!t.target&&!await((u=c.storage)==null?void 0:u.getItem("injected.connected")))return!1;if(!await this.getProvider()){if(n!==void 0&&n!==!1){const p=async()=>(typeof window<"u"&&window.removeEventListener("ethereum#initialized",p),!!await this.getProvider()),g=typeof n=="number"?n:1e3;if(await Promise.race([...typeof window<"u"?[new Promise(E=>window.addEventListener("ethereum#initialized",()=>E(p()),{once:!0}))]:[],new Promise(E=>setTimeout(()=>E(p()),g))]))return!0}throw new ai}return!!(await yd(()=>this.getAccounts())).length}catch{return!1}},async switchChain({addEthereumChainParameter:l,chainId:u}){var p,g,m,E;const d=await this.getProvider();if(!d)throw new ai;const f=c.chains.find(A=>A.id===u);if(!f)throw new Jr(new wl);const h=new Promise(A=>{const b=_=>{"chainId"in _&&_.chainId===u&&(c.emitter.off("change",b),A())};c.emitter.on("change",b)});try{return await Promise.all([d.request({method:"wallet_switchEthereumChain",params:[{chainId:re(u)}]}).then(async()=>{await this.getChainId()===u&&c.emitter.emit("change",{chainId:u})}),h]),f}catch(A){const b=A;if(b.code===4902||((g=(p=b==null?void 0:b.data)==null?void 0:p.originalError)==null?void 0:g.code)===4902)try{const{default:_,...C}=f.blockExplorers??{};let S;l!=null&&l.blockExplorerUrls?S=l.blockExplorerUrls:_&&(S=[_.url,...Object.values(C).map(N=>N.url)]);let x;(m=l==null?void 0:l.rpcUrls)!=null&&m.length?x=l.rpcUrls:x=[((E=f.rpcUrls.default)==null?void 0:E.http[0])??""];const P={blockExplorerUrls:S,chainId:re(u),chainName:(l==null?void 0:l.chainName)??f.name,iconUrls:l==null?void 0:l.iconUrls,nativeCurrency:(l==null?void 0:l.nativeCurrency)??f.nativeCurrency,rpcUrls:x};return await Promise.all([d.request({method:"wallet_addEthereumChain",params:[P]}).then(async()=>{if(await this.getChainId()===u)c.emitter.emit("change",{chainId:u});else throw new lt(new Error("User rejected switch after adding network."))}),h]),f}catch(_){throw new lt(_)}throw b.code===lt.code?new lt(b):new Jr(b)}},async onAccountsChanged(l){var u;if(l.length===0)this.onDisconnect();else if(c.emitter.listenerCount("connect")){const d=(await this.getChainId()).toString();this.onConnect({chainId:d}),e&&await((u=c.storage)==null?void 0:u.removeItem(`${this.id}.disconnected`))}else c.emitter.emit("change",{accounts:l.map(d=>Yi(d))})},onChainChanged(l){const u=Number(l);c.emitter.emit("change",{chainId:u})},async onConnect(l){const u=await this.getAccounts();if(u.length===0)return;const d=Number(l.chainId);c.emitter.emit("connect",{accounts:u,chainId:d});const f=await this.getProvider();f&&(o&&(f.removeListener("connect",o),o=void 0),s||(s=this.onAccountsChanged.bind(this),f.on("accountsChanged",s)),i||(i=this.onChainChanged.bind(this),f.on("chainChanged",i)),a||(a=this.onDisconnect.bind(this),f.on("disconnect",a)))},async onDisconnect(l){const u=await this.getProvider();l&&l.code===1013&&u&&(await this.getAccounts()).length||(c.emitter.emit("disconnect"),u&&(i&&(u.removeListener("chainChanged",i),i=void 0),a&&(u.removeListener("disconnect",a),a=void 0),o||(o=this.onConnect.bind(this),u.on("connect",o))))}})}const VG={coinbaseWallet:{id:"coinbaseWallet",name:"Coinbase Wallet",provider(t){return t!=null&&t.coinbaseWalletExtension?t.coinbaseWalletExtension:Ju(t,"isCoinbaseWallet")}},metaMask:{id:"metaMask",name:"MetaMask",provider(t){return Ju(t,e=>{if(!e.isMetaMask||e.isBraveWallet&&!e._events&&!e._state)return!1;const n=["isApexWallet","isAvalanche","isBitKeep","isBlockWallet","isKuCoinWallet","isMathWallet","isOkxWallet","isOKExWallet","isOneInchIOSWallet","isOneInchAndroidWallet","isOpera","isPhantom","isPortal","isRabby","isTokenPocket","isTokenary","isUniswapWallet","isZerion"];for(const r of n)if(e[r])return!1;return!0})}},phantom:{id:"phantom",name:"Phantom",provider(t){var e,n;return(e=t==null?void 0:t.phantom)!=null&&e.ethereum?(n=t.phantom)==null?void 0:n.ethereum:Ju(t,"isPhantom")}}};function Ju(t,e){function n(s){return typeof e=="function"?e(s):typeof e=="string"?s[e]:!0}const r=t.ethereum;if(r!=null&&r.providers)return r.providers.find(s=>n(s));if(r&&n(r))return r}function KG(t){if(typeof window>"u")return;const e=n=>t(n.detail);return window.addEventListener("eip6963:announceProvider",e),window.dispatchEvent(new CustomEvent("eip6963:requestProvider")),()=>window.removeEventListener("eip6963:announceProvider",e)}function GG(){const t=new Set;let e=[];const n=()=>KG(s=>{e.some(({info:i})=>i.uuid===s.info.uuid)||(e=[...e,s],t.forEach(i=>i(e,{added:[s]})))});let r=n();return{_listeners(){return t},clear(){t.forEach(s=>s([],{removed:[...e]})),e=[]},destroy(){this.clear(),t.clear(),r==null||r()},findProvider({rdns:s}){return e.find(i=>i.info.rdns===s)},getProviders(){return e},reset(){this.clear(),r==null||r(),r=n()},subscribe(s,{emitImmediately:i}={}){return t.add(s),i&&s(e,{added:e}),()=>t.delete(s)}}}const YG=t=>(e,n,r)=>{const s=r.subscribe;return r.subscribe=(o,a,c)=>{let l=o;if(a){const u=(c==null?void 0:c.equalityFn)||Object.is;let d=o(r.getState());l=f=>{const h=o(f);if(!u(d,h)){const p=d;a(d=h,p)}},c!=null&&c.fireImmediately&&a(d,d)}return s(l)},t(e,n,r)},ZG=YG;function JG(t,e){let n;try{n=t()}catch{return}return{getItem:s=>{var i;const o=c=>c===null?null:JSON.parse(c,void 0),a=(i=n.getItem(s))!=null?i:null;return a instanceof Promise?a.then(o):o(a)},setItem:(s,i)=>n.setItem(s,JSON.stringify(i,void 0)),removeItem:s=>n.removeItem(s)}}const j0=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return j0(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return j0(r)(n)}}}},XG=(t,e)=>(n,r,s)=>{let i={storage:JG(()=>localStorage),partialize:g=>g,version:0,merge:(g,m)=>({...m,...g}),...e},o=!1;const a=new Set,c=new Set;let l=i.storage;if(!l)return t((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...g)},r,s);const u=()=>{const g=i.partialize({...r()});return l.setItem(i.name,{state:g,version:i.version})},d=s.setState;s.setState=(g,m)=>{d(g,m),u()};const f=t((...g)=>{n(...g),u()},r,s);s.getInitialState=()=>f;let h;const p=()=>{var g,m;if(!l)return;o=!1,a.forEach(A=>{var b;return A((b=r())!=null?b:f)});const E=((m=i.onRehydrateStorage)==null?void 0:m.call(i,(g=r())!=null?g:f))||void 0;return j0(l.getItem.bind(l))(i.name).then(A=>{if(A)if(typeof A.version=="number"&&A.version!==i.version){if(i.migrate)return[!0,i.migrate(A.state,A.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,A.state];return[!1,void 0]}).then(A=>{var b;const[_,C]=A;if(h=i.merge(C,(b=r())!=null?b:f),n(h,!0),_)return u()}).then(()=>{E==null||E(h,void 0),h=r(),o=!0,c.forEach(A=>A(h))}).catch(A=>{E==null||E(void 0,A)})};return s.persist={setOptions:g=>{i={...i,...g},g.storage&&(l=g.storage)},clearStorage:()=>{l==null||l.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>p(),hasHydrated:()=>o,onHydrate:g=>(a.add(g),()=>{a.delete(g)}),onFinishHydration:g=>(c.add(g),()=>{c.delete(g)})},i.skipHydration||p(),h||f},QG=XG,eE=t=>{let e;const n=new Set,r=(l,u)=>{const d=typeof l=="function"?l(e):l;if(!Object.is(d,e)){const f=e;e=u??(typeof d!="object"||d===null)?d:Object.assign({},e,d),n.forEach(h=>h(e,f))}},s=()=>e,a={setState:r,getState:s,getInitialState:()=>c,subscribe:l=>(n.add(l),()=>n.delete(l))},c=e=t(r,s,a);return a},up=t=>t?eE(t):eE;class eY{constructor(e){Object.defineProperty(this,"uid",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"_emitter",{enumerable:!0,configurable:!0,writable:!0,value:new WU})}on(e,n){this._emitter.on(e,n)}once(e,n){this._emitter.once(e,n)}off(e,n){this._emitter.off(e,n)}emit(e,...n){const r=n[0];this._emitter.emit(e,{uid:this.uid,...r})}listenerCount(e){return this._emitter.listenerCount(e)}}function tY(t){return new eY(t)}function nY(t,e){return JSON.parse(t,(n,r)=>{let s=r;return(s==null?void 0:s.__type)==="bigint"&&(s=BigInt(s.value)),(s==null?void 0:s.__type)==="Map"&&(s=new Map(s.value)),(e==null?void 0:e(n,s))??s})}function tE(t,e){return t.slice(0,e).join(".")||"."}function nE(t,e){const{length:n}=t;for(let r=0;r<n;++r)if(t[r]===e)return r+1;return 0}function rY(t,e){const n=typeof t=="function",r=typeof e=="function",s=[],i=[];return function(a,c){if(typeof c=="object")if(s.length){const l=nE(s,this);l===0?s[s.length]=this:(s.splice(l),i.splice(l)),i[i.length]=a;const u=nE(s,c);if(u!==0)return r?e.call(this,a,c,tE(i,u)):`[ref=${tE(i,u)}]`}else s[0]=c,i[0]=a;return n?t.call(this,a,c):c}}function sY(t,e,n,r){return JSON.stringify(t,rY((s,i)=>{let o=i;return typeof o=="bigint"&&(o={__type:"bigint",value:i.toString()}),o instanceof Map&&(o={__type:"Map",value:Array.from(i.entries())}),(e==null?void 0:e(s,o))??o},r),n??void 0)}function iY(t){const{deserialize:e=nY,key:n="wagmi",serialize:r=sY,storage:s=bI}=t;function i(o){return o instanceof Promise?o.then(a=>a).catch(()=>null):o}return{...s,key:n,async getItem(o,a){const c=s.getItem(`${n}.${o}`),l=await i(c);return l?e(l)??null:a??null},async setItem(o,a){const c=`${n}.${o}`;a===null?await i(s.removeItem(c)):await i(s.setItem(c,r(a)))},async removeItem(o){await i(s.removeItem(`${n}.${o}`))}}}const bI={getItem:()=>null,setItem:()=>{},removeItem:()=>{}};function oY(){const t=typeof window<"u"&&window.localStorage?window.localStorage:bI;return{getItem(e){return t.getItem(e)},removeItem(e){t.removeItem(e)},setItem(e,n){try{t.setItem(e,n)}catch{}}}}const H0=256;let Du=H0,$u;function aY(t=11){if(!$u||Du+t>H0*2){$u="",Du=0;for(let e=0;e<H0;e++)$u+=(256+Math.random()*256|0).toString(16).substring(1)}return $u.substring(Du,Du+++t)}function cY(t){const{multiInjectedProviderDiscovery:e=!0,storage:n=iY({storage:oY()}),syncConnectedChain:r=!0,ssr:s=!1,...i}=t,o=typeof window<"u"&&e?GG():void 0,a=up(()=>i.chains),c=up(()=>{const C=[],S=new Set;for(const x of i.connectors??[]){const P=l(x);if(C.push(P),!s&&P.rdns){const N=typeof P.rdns=="string"?[P.rdns]:P.rdns;for(const L of N)S.add(L)}}if(!s&&o){const x=o.getProviders();for(const P of x)S.has(P.info.rdns)||C.push(l(u(P)))}return C});function l(C){var P;const S=tY(aY()),x={...C({emitter:S,chains:a.getState(),storage:n,transports:i.transports}),emitter:S,uid:S.uid};return S.on("connect",b),(P=x.setup)==null||P.call(x),x}function u(C){const{info:S}=C,x=C.provider;return Pf({target:{...S,id:S.rdns,provider:x}})}const d=new Map;function f(C={}){const S=C.chainId??m.getState().chainId,x=a.getState().find(N=>N.id===S);if(C.chainId&&!x)throw new wl;{const N=d.get(m.getState().chainId);if(N&&!x)return N;if(!x)throw new wl}{const N=d.get(S);if(N)return N}let P;if(i.client)P=i.client({chain:x});else{const N=x.id,L=a.getState().map(O=>O.id),M={},U=Object.entries(i);for(const[O,$]of U)if(!(O==="chains"||O==="client"||O==="connectors"||O==="transports"))if(typeof $=="object")if(N in $)M[O]=$[N];else{if(L.some(w=>w in $))continue;M[O]=$}else M[O]=$;P=sC({...M,chain:x,batch:M.batch??{multicall:!0},transport:O=>i.transports[N]({...O,connectors:c})})}return d.set(S,P),P}function h(){return{chainId:a.getState()[0].id,connections:new Map,current:null,status:"disconnected"}}let p;const g="0.0.0-canary-";Zu.startsWith(g)?p=Number.parseInt(Zu.replace(g,""),10):p=Number.parseInt(Zu.split(".")[0]??"0",10);const m=up(ZG(n?QG(h,{migrate(C,S){if(S===p)return C;const x=h(),P=E(C,x.chainId);return{...x,chainId:P}},name:"store",partialize(C){return{connections:{__type:"Map",value:Array.from(C.connections.entries()).map(([S,x])=>{const{id:P,name:N,type:L,uid:M}=x.connector;return[S,{...x,connector:{id:P,name:N,type:L,uid:M}}]})},chainId:C.chainId,current:C.current}},merge(C,S){typeof C=="object"&&C&&"status"in C&&delete C.status;const x=E(C,S.chainId);return{...S,...C,chainId:x}},skipHydration:s,storage:n,version:p}):h));m.setState(h());function E(C,S){return C&&typeof C=="object"&&"chainId"in C&&typeof C.chainId=="number"&&a.getState().some(x=>x.id===C.chainId)?C.chainId:S}r&&m.subscribe(({connections:C,current:S})=>{var x;return S?(x=C.get(S))==null?void 0:x.chainId:void 0},C=>{if(a.getState().some(x=>x.id===C))return m.setState(x=>({...x,chainId:C??x.chainId}))}),o==null||o.subscribe(C=>{const S=new Set,x=new Set;for(const N of c.getState())if(S.add(N.id),N.rdns){const L=typeof N.rdns=="string"?[N.rdns]:N.rdns;for(const M of L)x.add(M)}const P=[];for(const N of C){if(x.has(N.info.rdns))continue;const L=l(u(N));S.has(L.id)||P.push(L)}n&&!m.persist.hasHydrated()||c.setState(N=>[...N,...P],!0)});function A(C){m.setState(S=>{const x=S.connections.get(C.uid);return x?{...S,connections:new Map(S.connections).set(C.uid,{accounts:C.accounts??x.accounts,chainId:C.chainId??x.chainId,connector:x.connector})}:S})}function b(C){m.getState().status==="connecting"||m.getState().status==="reconnecting"||m.setState(S=>{const x=c.getState().find(P=>P.uid===C.uid);return x?(x.emitter.listenerCount("connect")&&x.emitter.off("connect",A),x.emitter.listenerCount("change")||x.emitter.on("change",A),x.emitter.listenerCount("disconnect")||x.emitter.on("disconnect",_),{...S,connections:new Map(S.connections).set(C.uid,{accounts:C.accounts,chainId:C.chainId,connector:x}),current:C.uid,status:"connected"}):S})}function _(C){m.setState(S=>{const x=S.connections.get(C.uid);if(x){const N=x.connector;N.emitter.listenerCount("change")&&x.connector.emitter.off("change",A),N.emitter.listenerCount("disconnect")&&x.connector.emitter.off("disconnect",_),N.emitter.listenerCount("connect")||x.connector.emitter.on("connect",b)}if(S.connections.delete(C.uid),S.connections.size===0)return{...S,connections:new Map,current:null,status:"disconnected"};const P=S.connections.values().next().value;return{...S,connections:new Map(S.connections),current:P.connector.uid}})}return{get chains(){return a.getState()},get connectors(){return c.getState()},storage:n,getClient:f,get state(){return m.getState()},setState(C){let S;typeof C=="function"?S=C(m.getState()):S=C;const x=h();typeof S!="object"&&(S=x),Object.keys(x).some(N=>!(N in S))&&(S=x),m.setState(S,!0)},subscribe(C,S,x){return m.subscribe(C,S,x?{...x,fireImmediately:x.emitImmediately}:void 0)},_internal:{mipd:o,async revalidate(){const C=m.getState(),S=C.connections;let x=C.current;for(const[,P]of S){const N=P.connector;N.isAuthorized&&await N.isAuthorized()||(S.delete(N.uid),x===N.uid&&(x=null))}m.setState(P=>({...P,connections:S,current:x}))},store:m,ssr:!!s,syncConnectedChain:r,transports:i.transports,chains:{setState(C){const S=typeof C=="function"?C(a.getState()):C;if(S.length!==0)return a.setState(S,!0)},subscribe(C){return a.subscribe(C)}},connectors:{providerDetailToConnector:u,setup:l,setState(C){return c.setState(typeof C=="function"?C(c.getState()):C,!0)},subscribe(C){return c.subscribe(C)}},events:{change:A,connect:b,disconnect:_}}}}const lY={gasPriceOracle:{address:"0x420000000000000000000000000000000000000F"},l1Block:{address:"0x4200000000000000000000000000000000000015"},l2CrossDomainMessenger:{address:"0x4200000000000000000000000000000000000007"},l2Erc721Bridge:{address:"0x4200000000000000000000000000000000000014"},l2StandardBridge:{address:"0x4200000000000000000000000000000000000010"},l2ToL1MessagePasser:{address:"0x4200000000000000000000000000000000000016"}},uY={block:g3({format(t){var n;return{transactions:(n=t.transactions)==null?void 0:n.map(r=>{if(typeof r=="string")return r;const s=Rl(r);return s.typeHex==="0x7e"&&(s.isSystemTx=r.isSystemTx,s.mint=r.mint?Er(r.mint):void 0,s.sourceHash=r.sourceHash,s.type="deposit"),s}),stateRoot:t.stateRoot}}}),transaction:h3({format(t){const e={};return t.type==="0x7e"&&(e.isSystemTx=t.isSystemTx,e.mint=t.mint?Er(t.mint):void 0,e.sourceHash=t.sourceHash,e.type="deposit"),e}}),transactionReceipt:$O({format(t){return{l1GasPrice:t.l1GasPrice?Er(t.l1GasPrice):null,l1GasUsed:t.l1GasUsed?Er(t.l1GasUsed):null,l1Fee:t.l1Fee?Er(t.l1Fee):null,l1FeeScalar:t.l1FeeScalar?Number(t.l1FeeScalar):null}}})};function dY(t,e){return pY(t)?hY(t):HO(t,e)}const fY={transaction:dY};function hY(t){gY(t);const{sourceHash:e,data:n,from:r,gas:s,isSystemTx:i,mint:o,to:a,value:c}=t,l=[e,r,a??"0x",o?nr(o):"0x",c?nr(c):"0x",s?nr(s):"0x",i?"0x1":"0x",n??"0x"];return Us(["0x7e",Ni(l)])}function pY(t){return t.type==="deposit"||typeof t.sourceHash<"u"}function gY(t){const{from:e,to:n}=t;if(e&&!jt(e))throw new Nn({address:e});if(n&&!jt(n))throw new Nn({address:n})}const rE={blockTime:2e3,contracts:lY,formatters:uY,serializers:fY},ic=1,Xu=iC({...rE,id:8453,name:"Base",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://mainnet.base.org"]}},blockExplorers:{default:{name:"Basescan",url:"https://basescan.org",apiUrl:"https://api.basescan.org/api"}},contracts:{...rE.contracts,disputeGameFactory:{[ic]:{address:"0x43edB88C4B80fDD2AdFF2412A7BebF9dF42cB40e"}},l2OutputOracle:{[ic]:{address:"0x56315b90c40730925ec5485cf004d835058518A0"}},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:5022},portal:{[ic]:{address:"0x49048044D57e1C92A77f79988d21Fa8fAF74E97e",blockCreated:17482143}},l1StandardBridge:{[ic]:{address:"0x3154Cf16ccdb4C6d922629664174b904d80F2C35",blockCreated:17482143}}},sourceId:ic}),ZJ=iC({...Xu,experimental_preconfirmationTime:200,rpcUrls:{default:{http:["https://mainnet-preconf.base.org"]}}});function mY(t){let e=[],n,r;function s(a){var u,d;const c=I.getCaipNetworks(B.CHAIN.EVM);let l=Number(xc.parseEvmChainId(a));if(!c.some(f=>String(f.id)===String(a))){const f=((u=I.getActiveCaipNetwork(B.CHAIN.EVM))==null?void 0:u.id)||((d=c[0])==null?void 0:d.id);f&&Number.isInteger(Number(f))&&(l=Number(f))}if(!l)throw new Error("ChainId not found in networks");return l}function i(){var a;return n||(n=ao.getInstance({projectId:t.options.projectId,chainId:(a=Cs())==null?void 0:a.caipNetworkId,enableLogger:t.options.enableAuthLogger,onTimeout:c=>{c==="iframe_load_failed"?ct.open(rt.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):c==="iframe_request_timeout"?ct.open(rt.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):c==="unverified_domain"&&ct.open(rt.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},abortController:rt.EmbeddedWalletAbortController,getActiveCaipNetwork:c=>Cs(c),getCaipNetworks:c=>I.getCaipNetworks(c)})),n}async function o(a={}){var g;const c=i();let l=a.chainId;if(a.isReconnecting){const m=xc.parseEvmChainId(c.getLastUsedChainId()||""),E=(g=t.chains)==null?void 0:g[0].id;if(l=m||E,!l)throw new Error("ChainId not found in provider")}const u=an("eip155"),{address:d,chainId:f,accounts:h}=await Fn.authConnectorAuthenticate({authConnector:c,chainId:l,preferredAccountType:u,socialUri:a.socialUri,chainNamespace:B.CHAIN.EVM});e=(h==null?void 0:h.map(m=>m.address))||[d];const p=s(f);return{accounts:e,account:d,chainId:p,chain:{id:p,unsupported:!1}}}return a=>({id:B.CONNECTOR_ID.AUTH,name:B.CONNECTOR_NAMES.AUTH,type:"AUTH",chain:B.CHAIN.EVM,async connect(c={}){if(r){const u=await r;return{accounts:c.withCapabilities?u.accounts.map(d=>({address:d,capabilities:{}})):u.accounts,chainId:u.chainId}}r||(r=new Promise(u=>{u(o(c))}));const l=await r;return r=void 0,{accounts:c.withCapabilities?l.accounts.map(u=>({address:u,capabilities:{}})):l.accounts,chainId:l.chainId}},async disconnect(){await(await this.getProvider()).disconnect()},getAccounts(){return e!=null&&e.length?(a.emitter.emit("change",{accounts:e}),Promise.resolve(e)):Promise.resolve([])},async getProvider(){var c;return this.provider||(this.provider=ao.getInstance({projectId:t.options.projectId,chainId:(c=Cs())==null?void 0:c.caipNetworkId,enableLogger:t.options.enableAuthLogger,abortController:rt.EmbeddedWalletAbortController,onTimeout:l=>{l==="iframe_load_failed"?ct.open(rt.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):l==="iframe_request_timeout"?ct.open(rt.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):l==="unverified_domain"&&ct.open(rt.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:l=>Cs(l),getCaipNetworks:l=>I.getCaipNetworks(l)})),Promise.resolve(this.provider)},async getChainId(){const c=await this.getProvider(),{chainId:l}=await c.getChainId();return s(l)},async isAuthorized(){const l=I.state.activeChain===B.CHAIN.EVM;if(B.AUTH_CONNECTOR_SUPPORTED_CHAINS.some(f=>V.getConnectorId(f)===B.CONNECTOR_ID.AUTH)&&!l)return!1;const d=await this.getProvider();return Promise.resolve(d.getLoginEmailUsed())},async switchChain({chainId:c}){var l;try{const u=a.chains.find(p=>p.id===c);if(!u)throw new Jr(new Error("chain not found on connector."));const d=await this.getProvider(),f=an("eip155"),h=await d.connect({chainId:c,preferredAccountType:f});return e=((l=h==null?void 0:h.accounts)==null?void 0:l.map(p=>p.address))||[h.address],a.emitter.emit("change",{chainId:Number(c),accounts:e}),u}catch(u){throw u instanceof Error?new Jr(u):u}},onAccountsChanged(c){c.length===0?this.onDisconnect():a.emitter.emit("change",{accounts:c.map(Yi)})},onChainChanged(c){const l=Number(c);a.emitter.emit("change",{chainId:l})},async onDisconnect(c){await(await this.getProvider()).disconnect()}})}hm.type="walletConnect";function hm(t){const e=t.isNewChainsStale??!0;let n,r,s,i,o,a,c;return l=>({id:"walletConnect",name:"WalletConnect",type:hm.type,provider:t.universalProvider,async setup(){const u=await this.getProvider().catch(()=>null);u&&(i||(i=this.onConnect.bind(this),u.on("connect",i)),a||(a=this.onSessionDelete.bind(this),u.on("session_delete",a)))},async connect({...u}={}){var d,f,h;try{const p=I.getCaipNetworks(),g=await this.getProvider();if(!g)throw new ai;o||(o=this.onDisplayUri,g.on("display_uri",o));const m=await this.isChainsStale();g.session&&m&&await g.disconnect();const E=F.state.universalProviderConfigOverride;if(!g.session||m){const P=Os.createNamespaces(p,E);await g.connect({optionalNamespaces:P,..."pairingTopic"in u?{pairingTopic:u.pairingTopic}:{}}),this.setRequestedChainsIds(p.map(N=>Number(N.id)))}const A=await this.getAccounts(),b=await this.getChainId(),_=(h=(f=(d=g.session)==null?void 0:d.namespaces)==null?void 0:f.eip155)==null?void 0:h.chains,C=_==null?void 0:_.some(P=>Number(P.split(":")[1])===b);let S=1;C?S=b:_!=null&&_[0]&&(S=Number(_[0].split(":")[1])),o&&(g.removeListener("display_uri",o),o=void 0),i&&(g.removeListener("connect",i),i=void 0),r||(r=this.onAccountsChanged.bind(this),g.on("accountsChanged",r)),s||(s=this.onChainChanged.bind(this),g.on("chainChanged",s)),c||(c=this.onDisconnect.bind(this),g.on("disconnect",c)),a||(a=this.onSessionDelete.bind(this),g.on("session_delete",a));const x=E==null?void 0:E.defaultChain;return g.setDefaultChain(x??`eip155:${S}`),{accounts:A,chainId:S}}catch(p){throw/(user rejected|connection request reset)/i.test(p==null?void 0:p.message)?new lt(p):p}},async disconnect(){const u=await this.getProvider();try{await(u==null?void 0:u.disconnect())}catch(d){if(!/No matching key/i.test(d.message))throw d}finally{s&&(u==null||u.removeListener("chainChanged",s),s=void 0),c&&(u==null||u.removeListener("disconnect",c),c=void 0),i||(i=this.onConnect.bind(this),u==null||u.on("connect",i)),r&&(u==null||u.removeListener("accountsChanged",r),r=void 0),a&&(u==null||u.removeListener("session_delete",a),a=void 0),this.setRequestedChainsIds([])}},async getAccounts(){var g,m,E;const u=await this.getProvider();if(!((g=u==null?void 0:u.session)!=null&&g.namespaces))return[];const d=(E=(m=u==null?void 0:u.session)==null?void 0:m.namespaces[B.CHAIN.EVM])==null?void 0:E.accounts,f=(d==null?void 0:d.map(A=>A.split(":")[2]))??[],h=new Set;return f.filter(A=>{const b=A==null?void 0:A.toLowerCase();return h.has(b)?!1:(h.add(b),!0)})},async getProvider({chainId:u}={}){var h,p;n||(n=t.universalProvider,n==null||n.events.setMaxListeners(Number.POSITIVE_INFINITY));const d=W.getActiveNamespace(),f=(h=I.getActiveCaipNetwork())==null?void 0:h.id;if(u&&f!==u&&d){const g=W.getStoredActiveCaipNetworkId(),m=d?I.getCaipNetworks(d):[],E=m==null?void 0:m.find(A=>A.id===g);E&&E.chainNamespace===B.CHAIN.EVM&&await((p=this.switchChain)==null?void 0:p.call(this,{chainId:Number(E.id)}))}return n},async getChainId(){var p,g,m,E;const u=(p=I.getActiveCaipNetwork(B.CHAIN.EVM))==null?void 0:p.id;if(u)return u;const f=(E=(m=(g=(await this.getProvider()).session)==null?void 0:g.namespaces[B.CHAIN.EVM])==null?void 0:m.chains)==null?void 0:E[0],h=I.getCaipNetworks().find(A=>A.id===f);return h==null?void 0:h.id},async isAuthorized(){try{const[u,d]=await Promise.all([this.getAccounts(),this.getProvider()]);return u.length?await this.isChainsStale()&&d.session?(await d.disconnect().catch(()=>{}),!1):!0:!1}catch{return!1}},async switchChain({addEthereumChainParameter:u,chainId:d}){var p,g,m,E;const f=await this.getProvider();if(!f)throw new ai;const h=I.getCaipNetworks().find(A=>A.id===d);if(!h)throw new Jr(new wl);try{await f.request({method:"wallet_switchEthereumChain",params:[{chainId:re(d)}]}),h!=null&&h.caipNetworkId&&f.setDefaultChain(h==null?void 0:h.caipNetworkId),l.emitter.emit("change",{chainId:Number(d)});const A=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...A,d]),{...h,id:h.id}}catch(A){const b=A;if(/(?:user rejected)/iu.test(b.message))throw new lt(b);try{let _;u!=null&&u.blockExplorerUrls?_=u.blockExplorerUrls:_=(p=h.blockExplorers)!=null&&p.default.url?[(g=h.blockExplorers)==null?void 0:g.default.url]:[];const C=((E=(m=h.rpcUrls)==null?void 0:m.chainDefault)==null?void 0:E.http)||[],S={blockExplorerUrls:_,chainId:re(d),chainName:h.name,iconUrls:u==null?void 0:u.iconUrls,nativeCurrency:h.nativeCurrency,rpcUrls:C};await f.request({method:"wallet_addEthereumChain",params:[S]});const x=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...x,d]),{...h,id:h.id}}catch(_){throw new lt(_)}}},onAccountsChanged(u){u.length===0?this.onDisconnect():l.emitter.emit("change",{accounts:u.map(d=>Yi(d))})},onChainChanged(u){const d=Number(u);l.emitter.emit("change",{chainId:d})},onConnect(u){this.setRequestedChainsIds(I.getCaipNetworks().map(d=>Number(d.id)))},async onDisconnect(u){this.setRequestedChainsIds([]),l.emitter.emit("disconnect");const d=await this.getProvider();r&&(d.removeListener("accountsChanged",r),r=void 0),s&&(d.removeListener("chainChanged",s),s=void 0),c&&(d.removeListener("disconnect",c),c=void 0),a&&(d.removeListener("session_delete",a),a=void 0),i||(i=this.onConnect.bind(this),d.on("connect",i))},onDisplayUri(u){l.emitter.emit("message",{type:"display_uri",data:u})},onSessionDelete(){this.onDisconnect()},getNamespaceChainsIds(){var f,h,p;if(!((f=n==null?void 0:n.session)!=null&&f.namespaces))return[];const u=(p=(h=n==null?void 0:n.session)==null?void 0:h.namespaces[B.CHAIN.EVM])==null?void 0:p.accounts;return(u==null?void 0:u.map(g=>Number.parseInt(g.split(":")[1]??"")))??[]},async getRequestedChainsIds(){var d;const u=await((d=l.storage)==null?void 0:d.getItem(this.requestedChainsStorageKey))??[];return[...new Set(u)]},async isChainsStale(){if(!e)return!1;const u=l.chains.map(h=>h.id),d=this.getNamespaceChainsIds();if(d.length&&!d.some(h=>u.includes(h)))return!1;const f=await this.getRequestedChainsIds();return!u.every(h=>f.includes(Number(h)))},async setRequestedChainsIds(u){var d;await((d=l.storage)==null?void 0:d.setItem(this.requestedChainsStorageKey,u))},get requestedChainsStorageKey(){return`${this.id}.requestedChains`}})}const oc=Qe({pendingTransactions:0}),sE={state:oc,subscribeKey(t,e){return Dt(oc,t,e)},increase(t){oc[t]+=1},decrease(t){oc[t]-=1},reset(t){oc[t]=0}};async function yY(t){if(Q.isSafeApp()){const{safe:e}=await _t(async()=>{const{safe:n}=await import("./index-Djspxcez.js");return{safe:n}},[]);if(e&&!t.some(n=>n.type==="safe"))return e()}return null}async function bY(t){try{const{baseAccount:e}=await _t(async()=>{const{baseAccount:n}=await import("./index-Djspxcez.js");return{baseAccount:n}},[]);if(e&&!t.some(n=>n.id==="baseAccount"))return e()}catch(e){console.error("Failed to import Coinbase Wallet SDK:",e)}return null}const wY={enable:!1,pollingInterval:3e4};class EY extends nI{constructor(e){const n=jr.extendCaipNetworks(e.networks,{projectId:e.projectId,customNetworkImageUrls:{},customRpcUrls:e.customRpcUrls});super(),this.balancePromises={},this.namespace=B.CHAIN.EVM,this.adapterType=B.ADAPTER_TYPES.WAGMI,this.projectId=e.projectId,this.pendingTransactionsFilter={...wY,...e.pendingTransactionsFilter??{}},this.createConfig({...e,networks:n}),this.checkChainId()}construct(e){this.checkChainId(),this.setupWatchers()}async getAccounts(e){const n=this.getWagmiConnector(e.id);if(!n)return{accounts:[]};if(n.id===B.CONNECTOR_ID.AUTH){const i=await n.getProvider();if(!(i!=null&&i.user))return{accounts:[]};const{address:o,accounts:a}=i.user;return Promise.resolve({accounts:(a||[{address:o,type:"eoa"}]).map(c=>Q.createAccount("eip155",c.address,c.type))})}const{addresses:r,address:s}=da(this.wagmiConfig);return Promise.resolve({accounts:[...new Set(r||[s])].map(i=>Q.createAccount("eip155",i||"","eoa"))})}checkChainId(){const{chainId:e}=da(this.wagmiConfig);e&&this.emit("switchNetwork",{chainId:e})}getWagmiConnector(e){return this.wagmiConfig.connectors.find(n=>n.id===e)}createConfig(e){this.wagmiChains=e.networks.filter(s=>s.chainNamespace===B.CHAIN.EVM);const n={},r=[...e.connectors??[]];this.wagmiChains.forEach(s=>{var a,c;const i=(a=e.transports)==null?void 0:a[s.id],o=jr.getCaipNetworkId(s);i?n[s.id]=jr.extendWagmiTransports(s,e.projectId,i):n[s.id]=jr.getViemTransport(s,e.projectId,(c=e.customRpcUrls)==null?void 0:c[o])}),this.wagmiConfig=cY({...e,chains:this.wagmiChains,connectors:r,transports:n})}setupWatchPendingTransactions(){if(!this.pendingTransactionsFilter.enable||this.unwatchPendingTransactions)return;this.unwatchPendingTransactions=qG(this.wagmiConfig,{pollingInterval:this.pendingTransactionsFilter.pollingInterval,onError:()=>{},onTransactions:()=>{this.emit("pendingTransactions"),sE.increase("pendingTransactions")}});const e=sE.subscribeKey("pendingTransactions",n=>{var r;n>=B.LIMITS.PENDING_TRANSACTIONS&&((r=this.unwatchPendingTransactions)==null||r.call(this),e())})}setupWatchers(){WG(this.wagmiConfig,{onChange:e=>{this.clearConnections(),this.addConnection(...e.map(n=>{const r=this.getCaipNetworks().find(i=>i.id===n.chainId),s=n.connector.id===B.CONNECTOR_ID.AUTH;return{accounts:n.accounts.map(i=>({address:this.toChecksummedAddress(i)})),caipNetwork:r,connectorId:n.connector.id,auth:s?{name:W.getConnectedSocialProvider(),username:W.getConnectedSocialUsername()}:void 0}}))}}),mI(this.wagmiConfig,{onChange:(e,n)=>{var r;if(e.status==="disconnected"&&n.address&&this.emit("disconnect"),e!=null&&e.chainId&&(e==null?void 0:e.chainId)!==(n==null?void 0:n.chainId)&&this.emit("switchNetwork",{chainId:e.chainId}),e.status==="connected"){const s=e.address!==(n==null?void 0:n.address),i=e.connector.id!==((r=n.connector)==null?void 0:r.id),o=n.status!=="connected";(s||i||o)&&(this.setupWatchPendingTransactions(),this.handleAccountChanged({address:e.address,chainId:e.chainId,connector:e.connector}))}}})}async addThirdPartyConnectors(){const e=[],{enableCoinbase:n}=F.state||{};if(n!==!1){const s=await bY(this.wagmiConfig.connectors);s&&e.push(s)}const r=await yY(this.wagmiConfig.connectors);r&&e.push(r),await Promise.all(e.map(s=>{const i=this.configureInternalConnector(s);return this.addWagmiConnector(i)}))}addWagmiConnectors(){const e=[];F.state.enableInjected!==!1&&e.push(Pf({shimDisconnect:!0}));const{features:n,remoteFeatures:r,projectId:s,enableAuthLogger:i}=F.state,o=(r==null?void 0:r.email)??(n==null?void 0:n.email)??!0,a=(r==null?void 0:r.socials)??(n==null?void 0:n.socials),c=Array.isArray(a)&&(a==null?void 0:a.length)>0;(o||c)&&e.push(mY({chains:this.wagmiChains,options:{projectId:s,enableAuthLogger:i}})),e.forEach(l=>{this.configureInternalConnector(l)})}configureInternalConnector(e){const n=this.wagmiConfig._internal.connectors.setup(e);return this.wagmiConfig._internal.connectors.setState(r=>[...r,n]),n}async handleAccountChanged({address:e,chainId:n,connector:r}){if(!this.namespace)throw new Error("WagmiAdapter:handleAccountChanged - namespace is required");const s=await r.getProvider().catch(()=>{});this.emit("accountChanged",{address:this.toChecksummedAddress(e),chainId:n,connector:{id:r.id,name:sn.ConnectorNamesMap[r.id]??r.name,imageId:sn.ConnectorImageIds[r.id],type:sn.ConnectorTypesMap[r.type]??"EXTERNAL",info:r.id===B.CONNECTOR_ID.INJECTED?void 0:{rdns:r.id},provider:s,chain:this.namespace,chains:[]}})}async signMessage(e){try{return{signature:await jG(this.wagmiConfig,{message:e.message,account:e.address})}}catch{throw new Error("WagmiAdapter:signMessage - Sign message failed")}}async sendTransaction(e){var a;const{chainId:n,address:r}=da(this.wagmiConfig),s=(a=this.wagmiChains)==null?void 0:a.find(c=>c.id===n),i={account:r,to:e.to,value:Number.isNaN(Number(e.value))?BigInt(0):BigInt(e.value),gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,data:e.data,chain:s,type:"legacy",parameters:["nonce"]};await MG(this.wagmiConfig,i);const o=await FG(this.wagmiConfig,i);return await gI(this.wagmiConfig,{hash:o,timeout:25e3}),{hash:o}}async writeContract(e){var a;const{caipNetwork:n,...r}=e,s=Number(xc.caipNetworkIdToNumber(n.caipNetworkId)),i=(a=this.wagmiChains)==null?void 0:a.find(c=>c.id===s);return{hash:await yI(this.wagmiConfig,{chain:i,address:r.tokenAddress,account:r.fromAddress,abi:r.abi,functionName:r.method,args:r.args,__mode:"prepared"})}}async estimateGas(e){try{return{gas:await BG(this.wagmiConfig,{account:e.address,to:e.to,data:e.data,type:"legacy"})}}catch{throw new Error("WagmiAdapter:estimateGas - error estimating gas")}}parseUnits(e){return t8(e.value,e.decimals)}formatUnits(e){return xl(e.value,e.decimals)}async addWagmiConnector(e){if(!this.namespace)throw new Error("WagmiAdapter:addWagmiConnector - namespace is required");const{enableEIP6963:n}=F.state||{};if(e.type===B.CONNECTOR_ID.INJECTED&&n===!1||e.id===B.CONNECTOR_ID.AUTH||e.id===B.CONNECTOR_ID.WALLET_CONNECT)return;let r;e.id!==B.CONNECTOR_ID.BASE_ACCOUNT&&(r=await e.getProvider().catch(()=>{}));const s=Mn.state.connectorImages;this.addConnector({id:e.id,explorerId:sn.ConnectorExplorerIds[e.id]??sn.ConnectorExplorerIds[e.name],imageUrl:(s==null?void 0:s[e.id])??e.icon,name:sn.ConnectorNamesMap[e.id]??e.name,imageId:sn.ConnectorImageIds[e.id],type:sn.ConnectorTypesMap[e.type]??"EXTERNAL",info:e.id===B.CONNECTOR_ID.INJECTED?void 0:{rdns:e.id},provider:r,chain:this.namespace,chains:[]})}async syncConnectors(){zG(this.wagmiConfig,{onChange:e=>{e.forEach(n=>this.addWagmiConnector(n))}}),this.addWagmiConnectors(),await Promise.all(this.wagmiConfig.connectors.map(e=>this.addWagmiConnector(e))),await this.addThirdPartyConnectors()}async syncConnections(){const e=this.connectors.filter(n=>{const{hasDisconnected:r,hasConnected:s}=As.getConnectorStorageInfo(n.id,this.namespace);return!r&&s}).map(n=>this.getWagmiConnector(n.id)).filter(Boolean);await lp(this.wagmiConfig,{connectors:e})}async syncConnection(e){var l,u;const{id:n,chainId:r}=e,i=gs(this.wagmiConfig).find(d=>d.connector.id===n),o=this.getWagmiConnector(n),a=await(o==null?void 0:o.getProvider());if(Q.isSafeApp()&&n===B.CONNECTOR_ID.SAFE&&!(i!=null&&i.accounts.length)){const d=this.getWagmiConnector("safe");if(d){const f=await ap(this.wagmiConfig,{connector:d,chainId:Number(r)}),h=await d.getProvider();return{chainId:Number(r),address:this.toChecksummedAddress(f.accounts[0]),provider:h,type:(l=i==null?void 0:i.connector.type)==null?void 0:l.toUpperCase(),id:i==null?void 0:i.connector.id}}}return{chainId:Number(i==null?void 0:i.chainId),address:this.toChecksummedAddress(i==null?void 0:i.accounts[0]),provider:a,type:(u=i==null?void 0:i.connector.type)==null?void 0:u.toUpperCase(),id:i==null?void 0:i.connector.id}}async connectWalletConnect(e){try{const n=this.getWalletConnectConnector();await n.authenticate();const r=this.getWagmiConnector("walletConnect");if(!r)throw new Error("UniversalAdapter:connectWalletConnect - connector not found");const s=await ap(this.wagmiConfig,{connector:r,chainId:e?Number(e):void 0});return s.chainId!==Number(e)&&await Q1(this.wagmiConfig,{chainId:s.chainId}),{clientId:await n.provider.client.core.crypto.getClientId()}}catch(n){throw n instanceof lt?new Zo(n):br.isUserRejectedRequestError(n)?new Zo(n):n}}async connect(e){var n,r,s,i,o;try{const{id:a,address:c,provider:l,type:u,info:d,chainId:f,socialUri:h}=e,p=this.getWagmiConnector(a);if(!p)throw new Error("connectionControllerClient:connectExternal - connector is undefined");l&&d&&p.id===B.CONNECTOR_ID.EIP6963&&((n=p.setEip6963Wallet)==null||n.call(p,{provider:l,info:d}));const g=(s=(r=this.wagmiConfig.state)==null?void 0:r.connections)==null?void 0:s.get(p.uid);if(g){await((i=this.wagmiConfig.storage)==null?void 0:i.setItem("recentConnectorId",p.id));const A=[...g.accounts].sort((b,_)=>As.isLowerCaseMatch(b,c)?-1:As.isLowerCaseMatch(_,c)?1:0);return(o=this.wagmiConfig)==null||o.setState(b=>({...b,connections:new Map(b.connections).set(p.uid,{accounts:A,chainId:g.chainId,connector:g.connector}),current:p.uid,status:"connected"})),{address:this.toChecksummedAddress(A[0]),chainId:g.chainId,provider:l,type:u,id:a}}const m=await ap(this.wagmiConfig,{connector:p,chainId:f?Number(f):void 0,socialUri:h}),E=l??await p.getProvider();return{address:this.toChecksummedAddress(m.accounts[0]),chainId:m.chainId,provider:E,type:u,id:a}}catch(a){throw a instanceof lt?new Zo(a):br.isUserRejectedRequestError(a)?new Zo(a):a}}get connections(){return Array.from(this.wagmiConfig.state.connections.values()).map(e=>({accounts:e.accounts.map(n=>({address:this.toChecksummedAddress(n)})),connectorId:e.connector.id}))}async reconnect(e){const{id:n}=e,r=this.getWagmiConnector(n);if(!r)throw new Error("connectionControllerClient:connectExternal - connector is undefined");await lp(this.wagmiConfig,{connectors:[r]})}async getBalance(e){const n=e.address,r=this.getCaipNetworks().find(s=>s.id===e.chainId);if(!n)return Promise.resolve({balance:"0.00",symbol:"ETH"});if(r&&this.wagmiConfig){const s=`${r.caipNetworkId}:${e.address}`,i=this.balancePromises[s];if(i)return i;const o=W.getNativeBalanceCacheForCaipAddress(s);return o?{balance:o.balance,symbol:o.symbol}:(this.balancePromises[s]=new Promise(async a=>{var c,l;try{const u=Number(e.chainId),d=await LG(this.wagmiConfig,{address:e.address,chainId:u,token:(l=(c=e.tokens)==null?void 0:c[r.caipNetworkId])==null?void 0:l.address});W.updateNativeBalanceCache({caipAddress:s,balance:d.formatted,symbol:d.symbol,timestamp:Date.now()}),a({balance:d.formatted,symbol:d.symbol})}catch(u){console.warn("Appkit:WagmiAdapter:getBalance - Error getting balance",u),a({balance:"0.00",symbol:"ETH"})}}).finally(()=>{delete this.balancePromises[s]}),this.balancePromises[s]||{balance:"0.00",symbol:"ETH"})}return{balance:"",symbol:""}}getWalletConnectProvider(){var e;return(e=this.getWagmiConnector("walletConnect"))==null?void 0:e.provider}async disconnect(e){if(e.id){const n=this.getWagmiConnector(e.id),s=gs(this.wagmiConfig).find(i=>As.isLowerCaseMatch(i.connector.id,e.id));return await X1(this.wagmiConfig,{connector:n}),F.state.enableReconnect===!1&&this.deleteConnection(e.id),s?{connections:[{accounts:s.accounts.map(i=>({address:this.toChecksummedAddress(i)})),connectorId:s.connector.id}]}:{connections:[]}}return this.disconnectAll()}async disconnectAll(){const e=gs(this.wagmiConfig),n=await Promise.allSettled(e.map(async r=>{const s=this.getWagmiConnector(r.connector.id);return s&&await X1(this.wagmiConfig,{connector:s}),r}));return this.wagmiConfig.state.connections.clear(),{connections:n.filter(r=>r.status==="fulfilled").map(({value:r})=>({accounts:r.accounts.map(s=>({address:this.toChecksummedAddress(s)})),connectorId:r.connector.id}))}}async switchNetwork(e){var h,p,g,m,E;const{caipNetwork:n}=e,r=this.wagmiConfig.chains.find(A=>A.id.toString()===n.id.toString());if(!r)throw new Error("connectionControllerClient:switchNetwork - wagmiChain is undefined");const{name:s,nativeCurrency:i,rpcUrls:o,blockExplorers:a,id:c}=r,l=((g=(p=(h=n.rpcUrls)==null?void 0:h.chainDefault)==null?void 0:p.http)==null?void 0:g[0])??o.default.http[0]??"",u=(a==null?void 0:a.default.url)??((E=(m=n.blockExplorers)==null?void 0:m.default)==null?void 0:E.url)??"",d=i??n.nativeCurrency,f=s??n.name;await Q1(this.wagmiConfig,{chainId:c,addEthereumChainParameter:{chainName:f,nativeCurrency:d,rpcUrls:[l],blockExplorerUrls:[u]}}),await super.switchNetwork(e)}async getCapabilities(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:getCapabilities - wagmiConfig is undefined");const r=gs(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:getCapabilities - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:getCapabilities - provider is undefined");return await i.request({method:"wallet_getCapabilities",params:[e]})}async grantPermissions(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:grantPermissions - wagmiConfig is undefined");const r=gs(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:grantPermissions - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:grantPermissions - provider is undefined");return i.request({method:"wallet_grantPermissions",params:e})}async revokePermissions(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:revokePermissions - wagmiConfig is undefined");const r=gs(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:revokePermissions - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:revokePermissions - provider is undefined");return i.request({method:"wallet_revokePermissions",params:e})}async walletGetAssets(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:walletGetAssets - wagmiConfig is undefined");const r=gs(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:walletGetAssets - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:walletGetAssets - provider is undefined");return i.request({method:"wallet_getAssets",params:[e]})}setAuthProvider(e){if(!this.namespace)throw new Error("WagmiAdapter:setAuthProvider - namespace is required");this.addConnector({id:B.CONNECTOR_ID.AUTH,type:"AUTH",name:B.CONNECTOR_NAMES.AUTH,provider:e,imageId:sn.ConnectorImageIds[B.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}async setUniversalProvider(e){e.on("connect",()=>{const r=gs(this.wagmiConfig),s=this.getWagmiConnector("walletConnect");if(s&&!r.find(i=>i.connector.id===s.id)){if(I.state.activeChain==="eip155")return;lp(this.wagmiConfig,{connectors:[s]})}});const n=hm({universalProvider:e});return this.configureInternalConnector(n),this.addConnector(new rI({provider:e,caipNetworks:this.getCaipNetworks(),namespace:"eip155"})),Promise.resolve()}toChecksummedAddress(e){return Sl(e.toLowerCase())}}function ki(t){return{formatters:void 0,fees:void 0,serializers:void 0,...t}}ki({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"});ki({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"});ki({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"});ki({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}});ki({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});ki({id:"00000008819873e925422c1ff0f99f7c",caipNetworkId:"bip122:00000008819873e925422c1ff0f99f7c",chainNamespace:"bip122",name:"Bitcoin Signet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});ki({id:"-239",name:"TON",network:"ton-mainnet",nativeCurrency:{name:"TON",symbol:"TON",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Tonscan",url:"https://tonscan.org"}},testnet:!1,chainNamespace:"ton",caipNetworkId:"ton:-239"});ki({id:"-3",name:"TON Testnet",network:"ton-testnet",nativeCurrency:{name:"TON",symbol:"TON",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Tonscan",url:"https://testnet.tonscan.org"}},testnet:!0,chainNamespace:"ton",caipNetworkId:"ton:-3"});const ut={contractAddress:"0x0000000000000000000000000000000000000000",projectId:"e9132f1c6b85ec793477f0e28cbdeaba",prices:{alpha:"0.00005",gamma:"0.00006",omega:"0.00007"},maxSupply:{alpha:1e3,gamma:500,omega:100},rarityNames:["Alpha","Gamma","Omega"]},fc=[{inputs:[{internalType:"enum NFTminimint.Rarity",name:"rarity",type:"uint8"}],name:"mint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"alphaMinted",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"gammaMinted",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"omegaMinted",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"minter",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"enum NFTminimint.Rarity",name:"rarity",type:"uint8"},{indexed:!1,internalType:"uint256",name:"price",type:"uint256"}],name:"NFTMinted",type:"event"}];let He={connected:!1,address:null,appKit:null,wagmiConfig:null,recentMints:[]};function vY(){const t=new EY({networks:[Xu],projectId:ut.projectId,ssr:!1});He.wagmiConfig=t.wagmiConfig,He.appKit=OG({adapters:[t],networks:[Xu],defaultNetwork:Xu,projectId:ut.projectId,metadata:{name:"NFTminimint",description:"Mint NFTs on Base Chain",url:window.location.origin,icons:[`${window.location.origin}/favicon.svg`]},features:{analytics:!1,email:!1,socials:!1},themeMode:"dark",themeVariables:{"--w3m-accent":"#0052ff"}}),mI(He.wagmiConfig,{onChange:e=>{He.connected=e.isConnected,He.address=e.address,gm(),e.isConnected&&mm()}}),console.log("Reown AppKit initialized for Base Chain")}async function pm(){He.appKit&&He.appKit.open()}function CY(){He.appKit&&He.appKit.disconnect(),He.connected=!1,He.address=null,gm()}function gm(){const t=document.getElementById("connectWallet");if(He.connected&&He.address){const e=`${He.address.slice(0,6)}...${He.address.slice(-4)}`;t.textContent=e,t.classList.add("connected"),t.onclick=CY}else t.textContent="Connect Wallet",t.classList.remove("connected"),t.onclick=pm}async function mm(){if(ut.contractAddress==="0x0000000000000000000000000000000000000000"){console.log("Contract not deployed yet");return}try{const[t,e,n,r]=await Promise.all([ku(He.wagmiConfig,{address:ut.contractAddress,abi:fc,functionName:"alphaMinted"}),ku(He.wagmiConfig,{address:ut.contractAddress,abi:fc,functionName:"gammaMinted"}),ku(He.wagmiConfig,{address:ut.contractAddress,abi:fc,functionName:"omegaMinted"}),ku(He.wagmiConfig,{address:ut.contractAddress,abi:fc,functionName:"totalSupply"})]);document.getElementById("alphaRemaining").textContent=ut.maxSupply.alpha-Number(t),document.getElementById("gammaRemaining").textContent=ut.maxSupply.gamma-Number(e),document.getElementById("omegaRemaining").textContent=ut.maxSupply.omega-Number(n),document.getElementById("totalMinted").textContent=Number(r)}catch(t){console.error("Failed to load contract data:",t)}}async function _Y(t){var c,l;if(!He.connected){ri("Please connect your wallet first","error"),pm();return}if(ut.contractAddress==="0x0000000000000000000000000000000000000000"){ri("Contract not deployed yet","error");return}const e=ut.rarityNames[t],r=[ut.prices.alpha,ut.prices.gamma,ut.prices.omega][t],o=document.querySelectorAll(".mint-card")[t].querySelector(".btn-mint"),a=o.textContent;try{o.disabled=!0,o.innerHTML='<span class="spinner"></span> Minting...';const u=BigInt(Math.floor(parseFloat(r)*1e18)),d=await yI(He.wagmiConfig,{address:ut.contractAddress,abi:fc,functionName:"mint",args:[t],value:u});ri("Transaction submitted! Waiting for confirmation...","success"),(await gI(He.wagmiConfig,{hash:d})).status==="success"?(ri(`ðŸŽ‰ ${e} NFT minted successfully!`,"success"),AY(e,d),await mm()):ri("Transaction failed","error")}catch(u){console.error("Mint error:",u),(c=u.message)!=null&&c.includes("User rejected")||u.code===4001?ri("Transaction cancelled","error"):(l=u.message)!=null&&l.includes("insufficient funds")?ri("Insufficient ETH balance","error"):ri(`Mint failed: ${u.shortMessage||u.message}`,"error")}finally{o.disabled=!1,o.textContent=a}}window.mintNFT=_Y;function AY(t,e){const n={rarity:t,txHash:e,time:new Date().toLocaleTimeString(),address:He.address};He.recentMints.unshift(n),He.recentMints.length>6&&He.recentMints.pop(),IY()}function IY(){const t=document.getElementById("recentMints");if(He.recentMints.length===0){t.innerHTML='<p class="empty-state">No mints yet. Be the first!</p>';return}const e={Alpha:"ðŸŸ¢",Gamma:"ðŸŸ£",Omega:"ðŸŸ "};t.innerHTML=He.recentMints.map(n=>{var r,s;return`
    <div class="recent-mint">
      <div class="recent-mint-icon">${e[n.rarity]||"ðŸŽ¨"}</div>
      <div class="recent-mint-info">
        <h4>${n.rarity} Minted</h4>
        <p>${(r=n.address)==null?void 0:r.slice(0,6)}...${(s=n.address)==null?void 0:s.slice(-4)} â€¢ ${n.time}</p>
      </div>
    </div>
  `}).join("")}function ri(t,e="info"){const n=document.getElementById("toastContainer"),r=document.createElement("div");r.className=`toast ${e}`;const s={success:"âœ…",error:"âŒ",info:"â„¹ï¸"};r.innerHTML=`
    <span>${s[e]}</span>
    <span>${t}</span>
  `,n.appendChild(r),setTimeout(()=>{r.style.opacity="0",setTimeout(()=>r.remove(),300)},5e3)}async function SY(){console.log("ðŸŽ¨ NFTminimint initializing..."),console.log("Chain: Base Mainnet"),console.log("Wallet: Reown AppKit + Wagmi"),vY(),document.getElementById("connectWallet").addEventListener("click",pm),ut.contractAddress!=="0x0000000000000000000000000000000000000000"&&(document.getElementById("contractLink").href=`https://basescan.org/address/${ut.contractAddress}`,document.getElementById("contractLink").textContent=`${ut.contractAddress.slice(0,6)}...${ut.contractAddress.slice(-4)}`);const t=da(He.wagmiConfig);t.isConnected&&(He.connected=!0,He.address=t.address,gm(),mm()),console.log("âœ… NFTminimint ready!")}document.addEventListener("DOMContentLoaded",SY);window.nftminimint={state:He,CONFIG:ut};export{HY as $,rN as A,Hm as B,Mx as C,ME as D,G0 as E,sN as F,iN as G,oN as H,$Y as I,BY as J,LY as K,FE as L,MY as M,aN as N,cN as O,dd as P,lN as Q,FY as R,kx as S,jY as T,Bx as U,Wm as V,dN as W,hN as X,fN as Y,pN as Z,gN as _,UY as a,tl as a$,Nn as a0,q as a1,yv as a2,Dp as a3,pO as a4,gO as a5,Gv as a6,of as a7,qT as a8,VT as a9,hc as aA,og as aB,ny as aC,ol as aD,il as aE,sl as aF,Qc as aG,nl as aH,yo as aI,ya as aJ,Kc as aK,qc as aL,Yc as aM,wa as aN,Vc as aO,Zi as aP,zc as aQ,Xc as aR,qn as aS,Gc as aT,bi as aU,Pn as aV,Jr as aW,ba as aX,Zc as aY,rl as aZ,JT as a_,KT as aa,GT as ab,YT as ac,uv as ad,HE as ae,jE as af,WE as ag,yN as ah,bN as ai,wN as aj,a3 as ak,mv as al,cg as am,f3 as an,Ji as ao,bo as ap,Ip as aq,Tp as ar,Op as as,Rp as at,Np as au,Sp as av,xp as aw,al as ax,Pp as ay,ef as az,Ux as b,zE as b$,el as b0,Jc as b1,lt as b2,UT as b3,BT as b4,MT as b5,FT as b6,jT as b7,HT as b8,cv as b9,GZ as bA,mO as bB,ma as bC,iT as bD,Us as bE,Si as bF,Oa as bG,mN as bH,yi as bI,bt as bJ,Hc as bK,rv as bL,oT as bM,Ar as bN,_T as bO,AT as bP,Ss as bQ,IT as bR,Er as bS,GY as bT,xi as bU,EN as bV,AN as bW,Zr as bX,IN as bY,qE as bZ,Jd as b_,lv as ba,WT as bb,l8 as bc,e8 as bd,Qd as be,kT as bf,uy as bg,Uv as bh,sv as bi,Yv as bj,ng as bk,tg as bl,U3 as bm,yT as bn,Sl as bo,Yi as bp,jt as bq,D3 as br,lg as bs,ug as bt,Iv as bu,N3 as bv,Ov as bw,P3 as bx,PO as by,iC as bz,$x as c,CG as c$,fn as c0,re as c1,Zd as c2,nr as c3,Ni as c4,dv as c5,g3 as c6,wv as c7,$v as c8,h3 as c9,sg as cA,Sn as cB,xl as cC,t8 as cD,Qe as cE,LJ as cF,I as cG,ve as cH,Q as cI,Hr as cJ,BJ as cK,MJ as cL,UJ as cM,Oe as cN,F as cO,KI as cP,dC as cQ,be as cR,FJ as cS,Dt as cT,Ft as cU,Pt as cV,qJ as cW,KJ as cX,GJ as cY,Yu as cZ,WJ as c_,Rl as ca,bv as cb,$O as cc,nC as cd,sZ as ce,Tl as cf,l3 as cg,Al as ch,x3 as ci,ev as cj,Z0 as ck,rT as cl,eg as cm,xO as cn,yd as co,oC as cp,r3 as cq,n3 as cr,rr as cs,Ol as ct,gg as cu,FO as cv,jO as cw,Rv as cx,af as cy,HO as cz,Dx as d,Fn as d$,fi as d0,ar as d1,me as d2,Z as d3,B as d4,an as d5,ft as d6,k8 as d7,ct as d8,yg as d9,mo as dA,hd as dB,ga as dC,fd as dD,XY as dE,ZY as dF,I3 as dG,LI as dH,cr as dI,Hd as dJ,on as dK,se as dL,hx as dM,rt as dN,It as dO,Ye as dP,JI as dQ,Nc as dR,Ct as dS,Se as dT,vc as dU,Fp as dV,Mn as dW,wo as dX,br as dY,Mr as dZ,Lu as d_,V as da,YJ as db,wl as dc,_t as dd,ai as de,Pf as df,ig as dg,Xv as dh,Pe as di,lC as dj,En as dk,Ii as dl,FZ as dm,wT as dn,Sc as dp,W as dq,zJ as dr,Hn as ds,aT as dt,nZ as du,de as dv,fe as dw,GE as dx,YY as dy,Y0 as dz,Px as e,hO as e$,VJ as e0,fC as e1,aI as e2,L0 as e3,xa as e4,Hx as e5,eN as e6,RE as e7,wr as e8,go as e9,PZ as eA,Ca as eB,AZ as eC,bs as eD,jv as eE,EZ as eF,hn as eG,Fv as eH,TZ as eI,IZ as eJ,pZ as eK,bZ as eL,gZ as eM,yZ as eN,mZ as eO,wZ as eP,J3 as eQ,Wv as eR,SZ as eS,iO as eT,zv as eU,xZ as eV,fy as eW,Ba as eX,OZ as eY,sO as eZ,aC as e_,DY as ea,mT as eb,Ze as ec,Dv as ed,sr as ee,pd as ef,eC as eg,OO as eh,TO as ei,RO as ej,DO as ek,Zv as el,zZ as em,jZ as en,CO as eo,WZ as ep,HZ as eq,tf as er,yO as es,tZ as et,pv as eu,Il as ev,QN as ew,hZ as ex,va as ey,S3 as ez,Fx as f,lO as f0,gv as f1,ag as f2,gx as f3,qZ as f4,Ea as f5,rZ as f6,s8 as f7,n8 as f8,r8 as f9,fZ as fA,qv as fB,RZ as fC,NZ as fD,Xu as fE,ZJ as fF,WU as fG,Nl as fH,IC as fI,MR as fJ,FR as fK,Ly as fL,xc as fM,Cs as fN,kO as fa,hg as fb,Jf as fc,m3 as fd,k3 as fe,oZ as ff,Ev as fg,aZ as fh,fg as fi,BO as fj,UO as fk,mr as fl,bd as fm,As as fn,mi as fo,jr as fp,$8 as fq,UZ as fr,pg as fs,rE as ft,dY as fu,Pl as fv,lY as fw,uY as fx,dZ as fy,uZ as fz,Ta as g,Lx as h,Ox as i,sC as j,mg as k,o8 as l,by as m,iu as n,tu as o,UE as p,VZ as q,gy as r,a8 as s,dO as t,fO as u,KZ as v,iZ as w,rf as x,DT as y,$T as z};
